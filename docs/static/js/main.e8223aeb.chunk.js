/*! For license information please see main.e8223aeb.chunk.js.LICENSE.txt */
(this.webpackJsonpopenperseus=this.webpackJsonpopenperseus||[]).push([[0],{135:function(e,t,n){},136:function(e,t,n){},137:function(e,t,n){},168:function(e,t){!function(){var e;function t(){if(t.is(arguments[0],E)){for(var e=arguments[0],n=Ue[d](t,e.splice(0,3+t.is(e[0],P))),s=n.set(),r=0,o=e[O];r<o;r++){var l=e[r]||{};i[a](l.type)&&s[L](n[l.type]().attr(l))}return s}return Ue[d](t,arguments)}e="".trim?function(e,t,n){e.setAttribute(t,String(n).trim())}:function(e,t,n){e.setAttribute(t,String(n))},t.version="1.5.2";var n,s=/[, ]+/,i={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},r=/\{(\d+)\}/g,o="prototype",a="hasOwnProperty",l=document,c=window,h={was:Object[o][a].call(c,"Raphael"),is:c.Raphael},p=function(){this.customAttributes={}},u="appendChild",d="apply",g="concat",f="createTouch"in l,m="",b=" ",v=String,x="split",y="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[x](b),j={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},w="join",O="length",C=v[o].toLowerCase,S=Math,k=S.max,_=S.min,T=S.abs,M=S.pow,N=S.PI,P="number",I="string",E="array",A="toString",R="fill",D=Object[o][A],L="push",F=/^url\(['"]?([^\)]+?)['"]?\)$/i,z=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,q={NaN:1,Infinity:1,"-Infinity":1},W=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,B=S.round,V=parseFloat,H=parseInt,U=" progid:DXImageTransform.Microsoft",G=v[o].toUpperCase,$={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Y={along:"along",blur:P,"clip-rect":"csv",cx:P,cy:P,fill:"colour","fill-opacity":P,"font-size":P,height:P,opacity:P,path:"path",r:P,rotation:"csv",rx:P,ry:P,scale:"csv",stroke:"colour","stroke-opacity":P,"stroke-width":P,translation:"csv",width:P,x:P,y:P},K="replace",X=/^(from|to|\d+%?)$/,Z=/\s*,\s*/,J={hs:1,rg:1},Q=/,?([achlmqrstvxz]),?/gi,ee=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/gi,te=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/gi,ne=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,se=function(e,t){return e.key-t.key};if(t.type=c.SVGAngle||l.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==t.type){var ie,re=l.createElement("div");if(re.innerHTML='<v:shape adj="1"/>',(ie=re.firstChild).style.behavior="url(#default#VML)",!ie||"object"!=typeof ie.adj)return t.type=null;re=null}function oe(){for(var e=[],t=0;t<32;t++)e[t]=(~~(16*S.random()))[A](16);return e[12]=4,e[16]=(3&e[16]|8)[A](16),"r-"+e[w]("")}t.svg=!(t.vml="VML"==t.type),p[o]=t[o],n=p[o],t._id=0,t._oid=0,t.fn={},t.is=function(e,t){return"finite"==(t=C.call(t))?!q[a](+e):"null"==t&&null===e||t==typeof e||"object"==t&&e===Object(e)||"array"==t&&Array.isArray&&Array.isArray(e)||D.call(e).slice(8,-1).toLowerCase()==t},t.angle=function(e,n,s,i,r,o){if(null==r){var a=e-s,l=n-i;return a||l?(180*(a<0)+180*S.atan(-l/-a)/N+360)%360:0}return t.angle(e,n,r,o)-t.angle(s,i,r,o)},t.rad=function(e){return e%360*N/180},t.deg=function(e){return 180*e/N%360},t.snapTo=function(e,n,s){if(s=t.is(s,"finite")?s:10,t.is(e,E)){for(var i=e.length;i--;)if(T(e[i]-n)<=s)return e[i]}else{var r=n%(e=+e);if(r<s)return n-r;if(r>e-s)return n-r+e}return n},t.setWindow=function(e){l=(c=e).document};var ae=function(e){if(t.vml){var n,s=/^\s+|\s+$/g;try{var i=new ActiveXObject("htmlfile");i.write("<body>"),i.close(),n=i.body}catch(a){n=createPopup().document.body}var r=n.createTextRange();ae=pe((function(e){try{n.style.color=v(e)[K](s,m);var t=r.queryCommandValue("ForeColor");return"#"+("000000"+(t=(255&t)<<16|65280&t|(16711680&t)>>>16)[A](16)).slice(-6)}catch(a){return"none"}}))}else{var o=l.createElement("i");o.title="Rapha\xebl Colour Picker",o.style.display="none",l.body[u](o),ae=pe((function(e){return o.style.color=e,l.defaultView.getComputedStyle(o,m).getPropertyValue("color")}))}return ae(e)},le=function(){return"hsb("+[this.h,this.s,this.b]+")"},ce=function(){return"hsl("+[this.h,this.s,this.l]+")"},he=function(){return this.hex};function pe(e,t,n){return function s(){var i=Array[o].slice.call(arguments,0),r=i[w]("\u25ba"),l=s.cache=s.cache||{},c=s.count=s.count||[];return l[a](r)||(c[O]>=1e3&&delete l[c.shift()],c[L](r),l[r]=e[d](t,i)),n?n(l[r]):l[r]}}t.hsb2rgb=function(e,n,s,i){return t.is(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(s=e.b,n=e.s,i=(e=e.h).o),t.hsl2rgb(e,n,s/2,i)},t.hsl2rgb=function(e,n,s,i){t.is(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(s=e.l,n=e.s,e=e.h),(e>1||n>1||s>1)&&(e/=360,n/=100,s/=100);var r,o,a,l={},c=["r","g","b"];if(n){o=2*s-(r=s<.5?s*(1+n):s+n-s*n);for(var h=0;h<3;h++)(a=e+1/3*-(h-1))<0&&a++,a>1&&a--,l[c[h]]=6*a<1?o+6*(r-o)*a:2*a<1?r:3*a<2?o+(r-o)*(2/3-a)*6:o}else l={r:s,g:s,b:s};return l.r*=255,l.g*=255,l.b*=255,l.hex="#"+(16777216|l.b|l.g<<8|l.r<<16).toString(16).slice(1),t.is(i,"finite")&&(l.opacity=i),l.toString=he,l},t.rgb2hsb=function(e,n,s){if(null==n&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(s=e.b,n=e.g,e=e.r),null==n&&t.is(e,I)){var i=t.getRGB(e);e=i.r,n=i.g,s=i.b}(e>1||n>1||s>1)&&(e/=255,n/=255,s/=255);var r,o=k(e,n,s),a=_(e,n,s);if(a==o)return{h:0,s:0,b:o,toString:le};var l=o-a;return r=e==o?(n-s)/l:n==o?2+(s-e)/l:4+(e-n)/l,(r/=6)<0&&r++,r>1&&r--,{h:r,s:l/o,b:o,toString:le}},t.rgb2hsl=function(e,n,s){if(null==n&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(s=e.b,n=e.g,e=e.r),null==n&&t.is(e,I)){var i=t.getRGB(e);e=i.r,n=i.g,s=i.b}(e>1||n>1||s>1)&&(e/=255,n/=255,s/=255);var r,o,a=k(e,n,s),l=_(e,n,s),c=(a+l)/2;if(l==a)o={h:0,s:0,l:c};else{var h=a-l;r=e==a?(n-s)/h:n==a?2+(s-e)/h:4+(e-n)/h,(r/=6)<0&&r++,r>1&&r--,o={h:r,s:c<.5?h/(a+l):h/(2-a-l),l:c}}return o.toString=ce,o},t._path2string=function(){return this.join(",")[K](Q,"$1")},t.getRGB=pe((function(e){if(!e||(e=v(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none"};!J[a](e.toLowerCase().substring(0,2))&&"#"!=e.charAt()&&(e=ae(e));var n,s,i,r,o,l,c=e.match(z);return c?(c[2]&&(i=H(c[2].substring(5),16),s=H(c[2].substring(3,5),16),n=H(c[2].substring(1,3),16)),c[3]&&(i=H((o=c[3].charAt(3))+o,16),s=H((o=c[3].charAt(2))+o,16),n=H((o=c[3].charAt(1))+o,16)),c[4]&&(l=c[4][x](Z),n=V(l[0]),"%"==l[0].slice(-1)&&(n*=2.55),s=V(l[1]),"%"==l[1].slice(-1)&&(s*=2.55),i=V(l[2]),"%"==l[2].slice(-1)&&(i*=2.55),"rgba"==c[1].toLowerCase().slice(0,4)&&(r=V(l[3])),l[3]&&"%"==l[3].slice(-1)&&(r/=100)),c[5]?(l=c[5][x](Z),n=V(l[0]),"%"==l[0].slice(-1)&&(n*=2.55),s=V(l[1]),"%"==l[1].slice(-1)&&(s*=2.55),i=V(l[2]),"%"==l[2].slice(-1)&&(i*=2.55),("deg"==l[0].slice(-3)||"\xb0"==l[0].slice(-1))&&(n/=360),"hsba"==c[1].toLowerCase().slice(0,4)&&(r=V(l[3])),l[3]&&"%"==l[3].slice(-1)&&(r/=100),t.hsb2rgb(n,s,i,r)):c[6]?(l=c[6][x](Z),n=V(l[0]),"%"==l[0].slice(-1)&&(n*=2.55),s=V(l[1]),"%"==l[1].slice(-1)&&(s*=2.55),i=V(l[2]),"%"==l[2].slice(-1)&&(i*=2.55),("deg"==l[0].slice(-3)||"\xb0"==l[0].slice(-1))&&(n/=360),"hsla"==c[1].toLowerCase().slice(0,4)&&(r=V(l[3])),l[3]&&"%"==l[3].slice(-1)&&(r/=100),t.hsl2rgb(n,s,i,r)):((c={r:n,g:s,b:i}).hex="#"+(16777216|i|s<<8|n<<16).toString(16).slice(1),t.is(r,"finite")&&(c.opacity=r),c)):{r:-1,g:-1,b:-1,hex:"none",error:1}}),t),t.getColor=function(e){var t=this.getColor.start=this.getColor.start||{h:0,s:1,b:e||.75},n=this.hsb2rgb(t.h,t.s,t.b);return t.h+=.075,t.h>1&&(t.h=0,t.s-=.2,t.s<=0&&(this.getColor.start={h:0,s:1,b:t.b})),n.hex},t.getColor.reset=function(){delete this.start},t.parsePathString=pe((function(e){if(!e)return null;var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},s=[];return t.is(e,E)&&t.is(e[0],E)&&(s=de(e)),s[O]||v(e)[K](ee,(function(e,t,i){var r=[],o=C.call(t);for(i[K](te,(function(e,t){t&&r[L](+t)})),"m"==o&&r[O]>2&&(s[L]([t][g](r.splice(0,2))),o="l",t="m"==t?"l":"L");r[O]>=n[o]&&(s[L]([t][g](r.splice(0,n[o]))),n[o]););})),s[A]=t._path2string,s})),t.findDotsAtSegment=function(e,t,n,s,i,r,o,a,l){var c=1-l,h=M(c,3)*e+3*M(c,2)*l*n+3*c*l*l*i+M(l,3)*o,p=M(c,3)*t+3*M(c,2)*l*s+3*c*l*l*r+M(l,3)*a,u=e+2*l*(n-e)+l*l*(i-2*n+e),d=t+2*l*(s-t)+l*l*(r-2*s+t),g=n+2*l*(i-n)+l*l*(o-2*i+n),f=s+2*l*(r-s)+l*l*(a-2*r+s),m=(1-l)*e+l*n,b=(1-l)*t+l*s,v=(1-l)*i+l*o,x=(1-l)*r+l*a,y=90-180*S.atan((u-g)/(d-f))/N;return(u>g||d<f)&&(y+=180),{x:h,y:p,m:{x:u,y:d},n:{x:g,y:f},start:{x:m,y:b},end:{x:v,y:x},alpha:y}};var ue=pe((function(e){if(!e)return{x:0,y:0,width:0,height:0};for(var t,n=0,s=0,i=[],r=[],o=0,a=(e=je(e))[O];o<a;o++)if("M"==(t=e[o])[0])n=t[1],s=t[2],i[L](n),r[L](s);else{var l=ye(n,s,t[1],t[2],t[3],t[4],t[5],t[6]);i=i[g](l.min.x,l.max.x),r=r[g](l.min.y,l.max.y),n=t[5],s=t[6]}var c=_[d](0,i),h=_[d](0,r);return{x:c,y:h,width:k[d](0,i)-c,height:k[d](0,r)-h}})),de=function(e){var n=[];t.is(e,E)&&t.is(e&&e[0],E)||(e=t.parsePathString(e));for(var s=0,i=e[O];s<i;s++){n[s]=[];for(var r=0,o=e[s][O];r<o;r++)n[s][r]=e[s][r]}return n[A]=t._path2string,n},ge=pe((function(e){t.is(e,E)&&t.is(e&&e[0],E)||(e=t.parsePathString(e));var n=[],s=0,i=0,r=0,o=0,a=0;"M"==e[0][0]&&(r=s=e[0][1],o=i=e[0][2],a++,n[L](["M",s,i]));for(var l=a,c=e[O];l<c;l++){var h=n[l]=[],p=e[l];if(p[0]!=C.call(p[0]))switch(h[0]=C.call(p[0]),h[0]){case"a":h[1]=p[1],h[2]=p[2],h[3]=p[3],h[4]=p[4],h[5]=p[5],h[6]=+(p[6]-s).toFixed(3),h[7]=+(p[7]-i).toFixed(3);break;case"v":h[1]=+(p[1]-i).toFixed(3);break;case"m":r=p[1],o=p[2];default:for(var u=1,d=p[O];u<d;u++)h[u]=+(p[u]-(u%2?s:i)).toFixed(3)}else{h=n[l]=[],"m"==p[0]&&(r=p[1]+s,o=p[2]+i);for(var g=0,f=p[O];g<f;g++)n[l][g]=p[g]}var m=n[l][O];switch(n[l][0]){case"z":s=r,i=o;break;case"h":s+=+n[l][m-1];break;case"v":i+=+n[l][m-1];break;default:s+=+n[l][m-2],i+=+n[l][m-1]}}return n[A]=t._path2string,n}),0,de),fe=pe((function(e){t.is(e,E)&&t.is(e&&e[0],E)||(e=t.parsePathString(e));var n=[],s=0,i=0,r=0,o=0,a=0;"M"==e[0][0]&&(r=s=+e[0][1],o=i=+e[0][2],a++,n[0]=["M",s,i]);for(var l=a,c=e[O];l<c;l++){var h=n[l]=[],p=e[l];if(p[0]!=G.call(p[0]))switch(h[0]=G.call(p[0]),h[0]){case"A":h[1]=p[1],h[2]=p[2],h[3]=p[3],h[4]=p[4],h[5]=p[5],h[6]=+(p[6]+s),h[7]=+(p[7]+i);break;case"V":h[1]=+p[1]+i;break;case"H":h[1]=+p[1]+s;break;case"M":r=+p[1]+s,o=+p[2]+i;default:for(var u=1,d=p[O];u<d;u++)h[u]=+p[u]+(u%2?s:i)}else for(var g=0,f=p[O];g<f;g++)n[l][g]=p[g];switch(h[0]){case"Z":s=r,i=o;break;case"H":s=h[1];break;case"V":i=h[1];break;case"M":r=n[l][n[l][O]-2],o=n[l][n[l][O]-1];default:s=n[l][n[l][O]-2],i=n[l][n[l][O]-1]}}return n[A]=t._path2string,n}),null,de),me=function(e,t,n,s){return[e,t,n,s,n,s]},be=function(e,t,n,s,i,r){var o=1/3,a=2/3;return[o*e+a*n,o*t+a*s,o*i+a*n,o*r+a*s,i,r]},ve=function(e,t,n,s,i,r,o,a,l,c){var h,p=120*N/180,u=N/180*(+i||0),d=[],f=pe((function(e,t,n){return{x:e*S.cos(n)-t*S.sin(n),y:e*S.sin(n)+t*S.cos(n)}}));if(c)M=c[0],P=c[1],k=c[2],_=c[3];else{e=(h=f(e,t,-u)).x,t=h.y,a=(h=f(a,l,-u)).x,l=h.y;S.cos(N/180*i),S.sin(N/180*i);var m=(e-a)/2,b=(t-l)/2,v=m*m/(n*n)+b*b/(s*s);v>1&&(n*=v=S.sqrt(v),s*=v);var y=n*n,j=s*s,C=(r==o?-1:1)*S.sqrt(T((y*j-y*b*b-j*m*m)/(y*b*b+j*m*m))),k=C*n*b/s+(e+a)/2,_=C*-s*m/n+(t+l)/2,M=S.asin(((t-_)/s).toFixed(9)),P=S.asin(((l-_)/s).toFixed(9));(M=e<k?N-M:M)<0&&(M=2*N+M),(P=a<k?N-P:P)<0&&(P=2*N+P),o&&M>P&&(M-=2*N),!o&&P>M&&(P-=2*N)}var I=P-M;if(T(I)>p){var E=P,A=a,R=l;P=M+p*(o&&P>M?1:-1),a=k+n*S.cos(P),l=_+s*S.sin(P),d=ve(a,l,n,s,i,0,o,A,R,[P,E,k,_])}I=P-M;var D=S.cos(M),L=S.sin(M),F=S.cos(P),z=S.sin(P),q=S.tan(I/4),W=4/3*n*q,B=4/3*s*q,V=[e,t],H=[e+W*L,t-B*D],U=[a+W*z,l-B*F],G=[a,l];if(H[0]=2*V[0]-H[0],H[1]=2*V[1]-H[1],c)return[H,U,G][g](d);for(var $=[],Y=0,K=(d=[H,U,G][g](d)[w]()[x](","))[O];Y<K;Y++)$[Y]=Y%2?f(d[Y-1],d[Y],u).y:f(d[Y],d[Y+1],u).x;return $},xe=function(e,t,n,s,i,r,o,a,l){var c=1-l;return{x:M(c,3)*e+3*M(c,2)*l*n+3*c*l*l*i+M(l,3)*o,y:M(c,3)*t+3*M(c,2)*l*s+3*c*l*l*r+M(l,3)*a}},ye=pe((function(e,t,n,s,i,r,o,a){var l,c=i-2*n+e-(o-2*i+n),h=2*(n-e)-2*(i-n),p=e-n,u=(-h+S.sqrt(h*h-4*c*p))/2/c,g=(-h-S.sqrt(h*h-4*c*p))/2/c,f=[t,a],m=[e,o];return T(u)>"1e12"&&(u=.5),T(g)>"1e12"&&(g=.5),u>0&&u<1&&(l=xe(e,t,n,s,i,r,o,a,u),m[L](l.x),f[L](l.y)),g>0&&g<1&&(l=xe(e,t,n,s,i,r,o,a,g),m[L](l.x),f[L](l.y)),c=r-2*s+t-(a-2*r+s),p=t-s,u=(-(h=2*(s-t)-2*(r-s))+S.sqrt(h*h-4*c*p))/2/c,g=(-h-S.sqrt(h*h-4*c*p))/2/c,T(u)>"1e12"&&(u=.5),T(g)>"1e12"&&(g=.5),u>0&&u<1&&(l=xe(e,t,n,s,i,r,o,a,u),m[L](l.x),f[L](l.y)),g>0&&g<1&&(l=xe(e,t,n,s,i,r,o,a,g),m[L](l.x),f[L](l.y)),{min:{x:_[d](0,m),y:_[d](0,f)},max:{x:k[d](0,m),y:k[d](0,f)}}})),je=pe((function(e,t){for(var n=fe(e),s=t&&fe(t),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},r={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o=function(e,t){if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"][g](ve[d](0,[t.x,t.y][g](e.slice(1))));break;case"S":e=["C",t.x+(t.x-(t.bx||t.x)),t.y+(t.y-(t.by||t.y))][g](e.slice(1));break;case"T":t.qx=t.x+(t.x-(t.qx||t.x)),t.qy=t.y+(t.y-(t.qy||t.y)),e=["C"][g](be(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"][g](be(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"][g](me(t.x,t.y,e[1],e[2]));break;case"H":e=["C"][g](me(t.x,t.y,e[1],t.y));break;case"V":e=["C"][g](me(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"][g](me(t.x,t.y,t.X,t.Y))}return e},a=function(e,t){if(e[t][O]>7){e[t].shift();for(var i=e[t];i[O];)e.splice(t++,0,["C"][g](i.splice(0,6)));e.splice(t,1),h=k(n[O],s&&s[O]||0)}},l=function(e,t,i,r,o){e&&t&&"M"==e[o][0]&&"M"!=t[o][0]&&(t.splice(o,0,["M",r.x,r.y]),i.bx=0,i.by=0,i.x=e[o][1],i.y=e[o][2],h=k(n[O],s&&s[O]||0))},c=0,h=k(n[O],s&&s[O]||0);c<h;c++){n[c]=o(n[c],i),a(n,c),s&&(s[c]=o(s[c],r)),s&&a(s,c),l(n,s,i,r,c),l(s,n,r,i,c);var p=n[c],u=s&&s[c],f=p[O],m=s&&u[O];i.x=p[f-2],i.y=p[f-1],i.bx=V(p[f-4])||i.x,i.by=V(p[f-3])||i.y,r.bx=s&&(V(u[m-4])||r.x),r.by=s&&(V(u[m-3])||r.y),r.x=s&&u[m-2],r.y=s&&u[m-1]}return s?[n,s]:n}),null,de),we=pe((function(e){for(var n=[],s=0,i=e[O];s<i;s++){var r={},o=e[s].match(/^([^:]*):?([\d\.]*)/);if(r.color=t.getRGB(o[1]),r.color.error)return null;r.color=r.color.hex,o[2]&&(r.offset=o[2]+"%"),n[L](r)}for(s=1,i=n[O]-1;s<i;s++)if(!n[s].offset){for(var a=V(n[s-1].offset||0),l=0,c=s+1;c<i;c++)if(n[c].offset){l=n[c].offset;break}l||(l=100,c=i);for(var h=((l=V(l))-a)/(c-s+1);s<c;s++)a+=h,n[s].offset=a+"%"}return n})),Oe=function(e,n,s,i){var r;return t.is(e,I)||t.is(e,"object")?(r=t.is(e,I)?l.getElementById(e):e).tagName?null==n?{container:r,width:r.style.pixelWidth||r.offsetWidth,height:r.style.pixelHeight||r.offsetHeight}:{container:r,width:n,height:s}:void 0:{container:1,x:e,y:n,width:s,height:i}},Ce=function(e,t){var n=this;for(var s in t)if(t[a](s)&&!(s in e))switch(typeof t[s]){case"function":!function(t){e[s]=e===n?t:function(){return t[d](n,arguments)}}(t[s]);break;case"object":e[s]=e[s]||{},Ce.call(this,e[s],t[s]);break;default:e[s]=t[s]}},Se=function(e,t){e==t.top&&(t.top=e.prev),e==t.bottom&&(t.bottom=e.next),e.next&&(e.next.prev=e.prev),e.prev&&(e.prev.next=e.next)},ke=function(e,t){t.top!==e&&(Se(e,t),e.next=null,e.prev=t.top,t.top.next=e,t.top=e)},_e=function(e,t){t.bottom!==e&&(Se(e,t),e.next=t.bottom,e.prev=null,t.bottom.prev=e,t.bottom=e)},Te=function(e,t,n){Se(e,n),t==n.top&&(n.top=e),t.next&&(t.next.prev=e),e.next=t.next,e.prev=t,t.next=e},Me=function(e,t,n){Se(e,n),t==n.bottom&&(n.bottom=e),t.prev&&(t.prev.next=e),e.prev=t.prev,t.prev=e,e.next=t},Ne=function(e){return function(){throw new Error("Rapha\xebl: you are calling to method \u201c"+e+"\u201d of removed object")}};if(t.pathToRelative=ge,t.svg){n.svgns="http://www.w3.org/2000/svg",n.xlink="http://www.w3.org/1999/xlink",B=function(e){return+e+.5*(~~e===e)};var Pe=function(t,s){if(!s)return(t=l.createElementNS(n.svgns,t)).style.webkitTapHighlightColor="rgba(0,0,0,0)",t;for(var i in s)s[a](i)&&e(t,i,v(s[i]))};t[A]=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var Ie=function(e,t){var n=Pe("path");t.canvas&&t.canvas[u](n);var s=new Le(n,t);return s.type="path",Re(s,{fill:"none",stroke:"#000",path:e}),s},Ee=function(e,t,n){var s="linear",i=.5,r=.5,o=e.style;if(t=(t=v(t)[K](ne,(function(e,t,n){if(s="radial",t&&n){i=V(t);var o=2*((r=V(n))>.5)-1;M(i-.5,2)+M(r-.5,2)>.25&&(r=S.sqrt(.25-M(i-.5,2))*o+.5)&&.5!=r&&(r=r.toFixed(5)-1e-5*o)}return m})))[x](/\s*\-\s*/),"linear"==s){var a=t.shift();if(a=-V(a),isNaN(a))return null;var c=[0,0,S.cos(a*N/180),S.sin(a*N/180)],h=1/(k(T(c[2]),T(c[3]))||1);c[2]*=h,c[3]*=h,c[2]<0&&(c[0]=-c[2],c[2]=0),c[3]<0&&(c[1]=-c[3],c[3]=0)}var p=we(t);if(!p)return null;var d=e.getAttribute(R);(d=d.match(/^url\(#(.*)\)$/))&&n.defs.removeChild(l.getElementById(d[1]));var g=Pe(s+"Gradient");g.id=oe(),Pe(g,"radial"==s?{fx:i,fy:r}:{x1:c[0],y1:c[1],x2:c[2],y2:c[3]}),n.defs[u](g);for(var f=0,b=p[O];f<b;f++){var y=Pe("stop");Pe(y,{offset:p[f].offset?p[f].offset:f?"100%":"0%","stop-color":p[f].color||"#fff"}),g[u](y)}return Pe(e,{fill:"url(#"+g.id+")",opacity:1,"fill-opacity":1}),o.fill=m,o.opacity=1,o.fillOpacity=1,1},Ae=function(e){var n=e.getBBox();Pe(e.pattern,{patternTransform:t.format("translate({0},{1})",n.x,n.y)})},Re=function(n,i){var r={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},o=n.node,c=n.attrs,h=n.rotate(),p=function(e,t){if(t=r[C.call(t)]){for(var n=e.attrs["stroke-width"]||"1",s={round:n,square:n,butt:0}[e.attrs["stroke-linecap"]||i["stroke-linecap"]]||0,a=[],l=t[O];l--;)a[l]=t[l]*n+(l%2?1:-1)*s;Pe(o,{"stroke-dasharray":a[w](",")})}};i[a]("rotation")&&(h=i.rotation);var d=v(h)[x](s);for(var g in d.length-1?(d[1]=+d[1],d[2]=+d[2]):d=null,V(h)&&n.rotate(0,!0),i)if(i[a](g)){if(!$[a](g))continue;var f=i[g];switch(c[g]=f,g){case"blur":n.blur(f);break;case"rotation":n.rotate(f,!0);break;case"href":case"title":case"target":var y=o.parentNode;if("a"!=C.call(y.tagName)){var j=Pe("a");y.insertBefore(j,o),j[u](o),y=j}"target"==g&&"blank"==f?y.setAttributeNS(n.paper.xlink,"show","new"):y.setAttributeNS(n.paper.xlink,g,f);break;case"cursor":o.style.cursor=f;break;case"clip-rect":var S=v(f)[x](s);if(4==S[O]){n.clip&&n.clip.parentNode.parentNode.removeChild(n.clip.parentNode);var k=Pe("clipPath"),_=Pe("rect");k.id=oe(),Pe(_,{x:S[0],y:S[1],width:S[2],height:S[3]}),k[u](_),n.paper.defs[u](k),Pe(o,{"clip-path":"url(#"+k.id+")"}),n.clip=_}if(!f){var T=l.getElementById(o.getAttribute("clip-path")[K](/(^url\(#|\)$)/g,m));T&&T.parentNode.removeChild(T),Pe(o,{"clip-path":m}),delete n.clip}break;case"path":"path"==n.type&&Pe(o,{d:f?c.path=fe(f):"M0,0"});break;case"width":if(e(o,g,f),!c.fx)break;g="x",f=c.x;case"x":c.fx&&(f=-c.x-(c.width||0));case"rx":if("rx"==g&&"rect"==n.type)break;case"cx":d&&("x"==g||"cx"==g)&&(d[1]+=f-c[g]),e(o,g,f),n.pattern&&Ae(n);break;case"height":if(e(o,g,f),!c.fy)break;g="y",f=c.y;case"y":c.fy&&(f=-c.y-(c.height||0));case"ry":if("ry"==g&&"rect"==n.type)break;case"cy":d&&("y"==g||"cy"==g)&&(d[2]+=f-c[g]),e(o,g,f),n.pattern&&Ae(n);break;case"r":"rect"==n.type?Pe(o,{rx:f,ry:f}):e(o,g,f);break;case"src":"image"==n.type&&o.setAttributeNS(n.paper.xlink,"href",f);break;case"stroke-width":o.style.strokeWidth=f,e(o,g,f),c["stroke-dasharray"]&&p(n,c["stroke-dasharray"]);break;case"stroke-dasharray":p(n,f);break;case"translation":var M=v(f)[x](s);M[0]=+M[0]||0,M[1]=+M[1]||0,d&&(d[1]+=M[0],d[2]+=M[1]),wt.call(n,M[0],M[1]);break;case"scale":M=v(f)[x](s),n.scale(+M[0]||1,+M[1]||+M[0]||1,isNaN(V(M[2]))?null:+M[2],isNaN(V(M[3]))?null:+M[3]);break;case R:var N=v(f).match(F);if(N){k=Pe("pattern");var P=Pe("image");k.id=oe(),Pe(k,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),Pe(P,{x:0,y:0}),P.setAttributeNS(n.paper.xlink,"href",N[1]),k[u](P);var I=l.createElement("img");I.style.cssText="position:absolute;left:-9999em;top-9999em",I.onload=function(){Pe(k,{width:this.offsetWidth,height:this.offsetHeight}),Pe(P,{width:this.offsetWidth,height:this.offsetHeight}),l.body.removeChild(this),n.paper.safari()},l.body[u](I),I.src=N[1],n.paper.defs[u](k),o.style.fill="url(#"+k.id+")",Pe(o,{fill:"url(#"+k.id+")"}),n.pattern=k,n.pattern&&Ae(n);break}var E=t.getRGB(f);if(E.error){if(({circle:1,ellipse:1}[a](n.type)||"r"!=v(f).charAt())&&Ee(o,f,n.paper)){c.gradient=f,c.fill="none";break}}else delete i.gradient,delete c.gradient,!t.is(c.opacity,"undefined")&&t.is(i.opacity,"undefined")&&Pe(o,{opacity:c.opacity}),!t.is(c["fill-opacity"],"undefined")&&t.is(i["fill-opacity"],"undefined")&&Pe(o,{"fill-opacity":c["fill-opacity"]});E[a]("opacity")&&Pe(o,{"fill-opacity":E.opacity>1?E.opacity/100:E.opacity});case"stroke":E=t.getRGB(f),e(o,g,E.hex),"stroke"==g&&E[a]("opacity")&&Pe(o,{"stroke-opacity":E.opacity>1?E.opacity/100:E.opacity});break;case"gradient":({circle:1,ellipse:1}[a](n.type)||"r"!=v(f).charAt())&&Ee(o,f,n.paper);break;case"opacity":c.gradient&&!c[a]("stroke-opacity")&&Pe(o,{"stroke-opacity":f>1?f/100:f});case"fill-opacity":if(c.gradient){var A=l.getElementById(o.getAttribute(R)[K](/^url\(#|\)$/g,m));if(A){var D=A.getElementsByTagName("stop");e(D[D[O]-1],"stop-opacity",f)}break}default:"font-size"==g&&(f=H(f,10)+"px");var L=g[K](/(\-.)/g,(function(e){return G.call(e.substring(1))}));o.style[L]=f,e(o,g,f)}}De(n,i),d?n.rotate(d.join(b)):V(h)&&n.rotate(h,!0)},De=function(e,n){if("text"==e.type&&(n[a]("text")||n[a]("font")||n[a]("font-size")||n[a]("x")||n[a]("y"))){var s=e.attrs,i=e.node,r=i.firstChild?H(l.defaultView.getComputedStyle(i.firstChild,m).getPropertyValue("font-size"),10):10;if(n[a]("text")){for(s.text=n.text;i.firstChild;)i.removeChild(i.firstChild);for(var o=v(n.text)[x]("\n"),c=0,h=o[O];c<h;c++)if(o[c]){var p=Pe("tspan");c&&Pe(p,{dy:1.2*r,x:s.x}),p[u](l.createTextNode(o[c])),i[u](p)}}else for(c=0,h=(o=i.getElementsByTagName("tspan"))[O];c<h;c++)c&&Pe(o[c],{dy:1.2*r,x:s.x});Pe(i,{y:s.y});var d=e.getBBox(),g=s.y-(d.y+d.height/2);g&&t.is(g,"finite")&&Pe(i,{y:s.y+g})}},Le=function(e,n){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.paper=n,this.attrs=this.attrs||{},this.transformations=[],this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},Fe=Le[o];Le[o].rotate=function(e,n,i){if(this.removed)return this;if(null==e)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][w](b):this._.rt.deg;var r=this.getBBox();return(e=v(e)[x](s))[O]-1&&(n=V(e[1]),i=V(e[2])),e=V(e[0]),null!=n&&!1!==n?this._.rt.deg=e:this._.rt.deg+=e,null==i&&(n=null),this._.rt.cx=n,this._.rt.cy=i,n=null==n?r.x+r.width/2:n,i=null==i?r.y+r.height/2:i,this._.rt.deg?(this.transformations[0]=t.format("rotate({0} {1} {2})",this._.rt.deg,n,i),this.clip&&Pe(this.clip,{transform:t.format("rotate({0} {1} {2})",-this._.rt.deg,n,i)})):(this.transformations[0]=m,this.clip&&Pe(this.clip,{transform:m})),Pe(this.node,{transform:this.transformations[w](b)}),this},Le[o].hide=function(){return!this.removed&&(this.node.style.display="none"),this},Le[o].show=function(){return!this.removed&&(this.node.style.display=""),this},Le[o].remove=function(){if(!this.removed){for(var e in Se(this,this.paper),this.node.parentNode.removeChild(this.node),this)delete this[e];this.removed=!0}},Le[o].getBBox=function(){if(this.removed)return this;if("path"==this.type)return ue(this.attrs.path);if("none"==this.node.style.display){this.show();var e=!0}var t={};try{t=this.node.getBBox()}catch(r){}finally{t=t||{}}if("text"==this.type){t={x:t.x,y:1/0,width:0,height:0};for(var n=0,s=this.node.getNumberOfChars();n<s;n++){var i=this.node.getExtentOfChar(n);i.y<t.y&&(t.y=i.y),i.y+i.height-t.y>t.height&&(t.height=i.y+i.height-t.y),i.x+i.width-t.x>t.width&&(t.width=i.x+i.width-t.x)}}return e&&this.hide(),t},Le[o].attr=function(e,n){if(this.removed)return this;if(null==e){var s={};for(var i in this.attrs)this.attrs[a](i)&&(s[i]=this.attrs[i]);return this._.rt.deg&&(s.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(s.scale=this.scale()),s.gradient&&"none"==s.fill&&(s.fill=s.gradient)&&delete s.gradient,s}if(null==n&&t.is(e,I))return"translation"==e?wt.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==R&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(null==n&&t.is(e,E)){for(var r={},o=0,l=e.length;o<l;o++)r[e[o]]=this.attr(e[o]);return r}if(null!=n){var c={};c[e]=n}else null!=e&&t.is(e,"object")&&(c=e);for(var h in this.paper.customAttributes)if(this.paper.customAttributes[a](h)&&c[a](h)&&t.is(this.paper.customAttributes[h],"function")){var p=this.paper.customAttributes[h].apply(this,[][g](c[h]));for(var u in this.attrs[h]=c[h],p)p[a](u)&&(c[u]=p[u])}return Re(this,c),this},Le[o].toFront=function(){if(this.removed)return this;this.node.parentNode[u](this.node);var e=this.paper;return e.top!=this&&ke(this,e),this},Le[o].toBack=function(){if(this.removed)return this;if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),_e(this,this.paper);this.paper}return this},Le[o].insertAfter=function(e){if(this.removed)return this;var t=e.node||e[e.length-1].node;return t.nextSibling?t.parentNode.insertBefore(this.node,t.nextSibling):t.parentNode[u](this.node),Te(this,e,this.paper),this},Le[o].insertBefore=function(e){if(this.removed)return this;var t=e.node||e[0].node;return t.parentNode.insertBefore(this.node,t),Me(this,e,this.paper),this},Le[o].blur=function(e){var t=this;if(0!==+e){var n=Pe("filter"),s=Pe("feGaussianBlur");t.attrs.blur=e,n.id=oe(),Pe(s,{stdDeviation:+e||1.5}),n.appendChild(s),t.paper.defs.appendChild(n),t._blur=n,Pe(t.node,{filter:"url(#"+n.id+")"})}else t._blur&&(t._blur.parentNode.removeChild(t._blur),delete t._blur,delete t.attrs.blur),t.node.removeAttribute("filter")};var ze=function(e,t,n,s){var i=Pe("circle");e.canvas&&e.canvas[u](i);var r=new Le(i,e);return r.attrs={cx:t,cy:n,r:s,fill:"none",stroke:"#000"},r.type="circle",Pe(i,r.attrs),r},qe=function(e,t,n,s,i,r){var o=Pe("rect");e.canvas&&e.canvas[u](o);var a=new Le(o,e);return a.attrs={x:t,y:n,width:s,height:i,r:r||0,rx:r||0,ry:r||0,fill:"none",stroke:"#000"},a.type="rect",Pe(o,a.attrs),a},We=function(e,t,n,s,i){var r=Pe("ellipse");e.canvas&&e.canvas[u](r);var o=new Le(r,e);return o.attrs={cx:t,cy:n,rx:s,ry:i,fill:"none",stroke:"#000"},o.type="ellipse",Pe(r,o.attrs),o},Be=function(e,t,n,s,i,r){var o=Pe("image");Pe(o,{x:n,y:s,width:i,height:r,preserveAspectRatio:"none"}),o.setAttributeNS(e.xlink,"href",t),e.canvas&&e.canvas[u](o);var a=new Le(o,e);return a.attrs={x:n,y:s,width:i,height:r,src:t},a.type="image",a},Ve=function(e,t,n,s){var i=Pe("text");Pe(i,{x:t,y:n,"text-anchor":"middle"}),e.canvas&&e.canvas[u](i);var r=new Le(i,e);return r.attrs={x:t,y:n,"text-anchor":"middle",text:s,font:$.font,stroke:"none",fill:"#000"},r.type="text",Re(r,r.attrs),r},He=function(t,n){return this.width=t||this.width,this.height=n||this.height,e(this.canvas,"width",this.width),e(this.canvas,"height",this.height),this},Ue=function(){var e=Oe[d](0,arguments),n=e&&e.container,s=e.x,i=e.y,r=e.width,o=e.height;if(!n)throw new Error("SVG container not found.");var a=Pe("svg");return s=s||0,i=i||0,Pe(a,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:r=r||512,height:o=o||342}),1==n?(a.style.cssText="position:absolute;left:"+s+"px;top:"+i+"px",l.body[u](a)):n.firstChild?n.insertBefore(a,n.firstChild):n[u](a),(n=new p).width=r,n.height=o,n.canvas=a,Ce.call(n,n,t.fn),n.clear(),n};n.clear=function(){for(var e=this.canvas;e.firstChild;)e.removeChild(e.firstChild);this.bottom=this.top=null,(this.desc=Pe("desc"))[u](l.createTextNode("Created with Rapha\xebl")),e[u](this.desc),e[u](this.defs=Pe("defs"))},n.remove=function(){for(var e in this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this)this[e]=Ne(e)}}if(t.vml){var Ge,$e={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Ye=/([clmz]),?([^clmz]*)/gi,Ke=/ progid:\S+Blur\([^\)]+\)/g,Xe=/-?[^,\s-]+/g,Ze="1000 1000",Je=10,Qe={path:1,rect:1};function et(e,n,s,i,r){return r?t.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",e+r,n,s-2*r,r,-r,i-2*r,2*r-s,2*r-i):t.format("M{0},{1}l{2},0,0,{3},{4},0z",e,n,s,i,-s)}t[A]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version},Ie=function(e,t){var n=Ge("group");n.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",n.coordsize=t.coordsize,n.coordorigin=t.coordorigin;var s=Ge("shape"),i=s.style;i.width=t.width+"px",i.height=t.height+"px",s.coordsize=Ze,s.coordorigin=t.coordorigin,n[u](s);var r=new Le(s,n,t),o={fill:"none",stroke:"#000"};return e&&(o.path=e),r.type="path",r.path=[],r.Path=m,Re(r,o),t.canvas[u](n),r},Re=function(e,n){e.attrs=e.attrs||{};var i,r=e.node,o=e.attrs,c=r.style,h=(n.x!=o.x||n.y!=o.y||n.width!=o.width||n.height!=o.height||n.r!=o.r)&&"rect"==e.type,p=e;for(var d in n)n[a](d)&&(o[d]=n[d]);if(h&&(o.path=et(o.x,o.y,o.width,o.height,o.r),e.X=o.x,e.Y=o.y,e.W=o.width,e.H=o.height),n.href&&(r.href=n.href),n.title&&(r.title=n.title),n.target&&(r.target=n.target),n.cursor&&(c.cursor=n.cursor),"blur"in n&&e.blur(n.blur),(n.path&&"path"==e.type||h)&&(r.path=function(e){var t=/[ahqstv]/gi,n=fe;if(v(e).match(t)&&(n=je),t=/[clmz]/g,n==fe&&!v(e).match(t)){var s=v(e)[K](Ye,(function(e,t,n){var s=[],i="m"==C.call(t),r=$e[t];return n[K](Xe,(function(e){i&&2==s[O]&&(r+=s+$e["m"==t?"l":"L"],s=[]),s[L](B(e*Je))})),r+s}));return s}var i,r,o=n(e);s=[];for(var a=0,l=o[O];a<l;a++){i=o[a],"z"==(r=C.call(o[a][0]))&&(r="x");for(var c=1,h=i[O];c<h;c++)r+=B(i[c]*Je)+(c!=h-1?",":m);s[L](r)}return s[w](b)}(o.path)),null!=n.rotation&&e.rotate(n.rotation,!0),n.translation&&(i=v(n.translation)[x](s),wt.call(e,i[0],i[1]),null!=e._.rt.cx&&(e._.rt.cx+=+i[0],e._.rt.cy+=+i[1],e.setBox(e.attrs,i[0],i[1]))),n.scale&&(i=v(n.scale)[x](s),e.scale(+i[0]||1,+i[1]||+i[0]||1,+i[2]||null,+i[3]||null)),"clip-rect"in n){var g=v(n["clip-rect"])[x](s);if(4==g[O]){g[2]=+g[2]+ +g[0],g[3]=+g[3]+ +g[1];var f=r.clipRect||l.createElement("div"),y=f.style,j=r.parentNode;y.clip=t.format("rect({1}px {2}px {3}px {0}px)",g),r.clipRect||(y.position="absolute",y.top=0,y.left=0,y.width=e.paper.width+"px",y.height=e.paper.height+"px",j.parentNode.insertBefore(f,j),f[u](j),r.clipRect=f)}n["clip-rect"]||r.clipRect&&(r.clipRect.style.clip=m)}if("image"==e.type&&n.src&&(r.src=n.src),"image"==e.type&&n.opacity&&(r.filterOpacity=U+".Alpha(opacity="+100*n.opacity+")",c.filter=(r.filterMatrix||m)+(r.filterOpacity||m)),n.font&&(c.font=n.font),n["font-family"]&&(c.fontFamily='"'+n["font-family"][x](",")[0][K](/^['"]+|['"]+$/g,m)+'"'),n["font-size"]&&(c.fontSize=n["font-size"]),n["font-weight"]&&(c.fontWeight=n["font-weight"]),n["font-style"]&&(c.fontStyle=n["font-style"]),null!=n.opacity||null!=n["stroke-width"]||null!=n.fill||null!=n.stroke||null!=n["stroke-width"]||null!=n["stroke-opacity"]||null!=n["fill-opacity"]||null!=n["stroke-dasharray"]||null!=n["stroke-miterlimit"]||null!=n["stroke-linejoin"]||null!=n["stroke-linecap"]){var S=(r=e.shape||r).getElementsByTagName(R)&&r.getElementsByTagName(R)[0],T=!1;if(!S&&(T=S=Ge(R)),"fill-opacity"in n||"opacity"in n){var M=((+o["fill-opacity"]+1||2)-1)*((+o.opacity+1||2)-1)*((+t.getRGB(n.fill).o+1||2)-1);M=_(k(M,0),1),S.opacity=M}if(n.fill&&(S.on=!0),null!=S.on&&"none"!=n.fill||(S.on=!1),S.on&&n.fill){var N=n.fill.match(F);N?(S.src=N[1],S.type="tile"):(S.color=t.getRGB(n.fill).hex,S.src=m,S.type="solid",t.getRGB(n.fill).error&&(p.type in{circle:1,ellipse:1}||"r"!=v(n.fill).charAt())&&Ee(p,n.fill)&&(o.fill="none",o.gradient=n.fill))}T&&r[u](S);var P=r.getElementsByTagName("stroke")&&r.getElementsByTagName("stroke")[0],I=!1;!P&&(I=P=Ge("stroke")),(n.stroke&&"none"!=n.stroke||n["stroke-width"]||null!=n["stroke-opacity"]||n["stroke-dasharray"]||n["stroke-miterlimit"]||n["stroke-linejoin"]||n["stroke-linecap"])&&(P.on=!0),("none"==n.stroke||null==P.on||0==n.stroke||0==n["stroke-width"])&&(P.on=!1);var E=t.getRGB(n.stroke);P.on&&n.stroke&&(P.color=E.hex),M=((+o["stroke-opacity"]+1||2)-1)*((+o.opacity+1||2)-1)*((+E.o+1||2)-1);var A=.75*(V(n["stroke-width"])||1);if(M=_(k(M,0),1),null==n["stroke-width"]&&(A=o["stroke-width"]),n["stroke-width"]&&(P.weight=A),A&&A<1&&(M*=A)&&(P.weight=1),P.opacity=M,n["stroke-linejoin"]&&(P.joinstyle=n["stroke-linejoin"]||"miter"),P.miterlimit=n["stroke-miterlimit"]||8,n["stroke-linecap"]&&(P.endcap="butt"==n["stroke-linecap"]?"flat":"square"==n["stroke-linecap"]?"square":"round"),n["stroke-dasharray"]){var D={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};P.dashstyle=D[a](n["stroke-dasharray"])?D[n["stroke-dasharray"]]:m}I&&r[u](P)}if("text"==p.type)switch(c=p.paper.span.style,o.font&&(c.font=o.font),o["font-family"]&&(c.fontFamily=o["font-family"]),o["font-size"]&&(c.fontSize=o["font-size"]),o["font-weight"]&&(c.fontWeight=o["font-weight"]),o["font-style"]&&(c.fontStyle=o["font-style"]),p.node.string&&(p.paper.span.innerHTML=v(p.node.string)[K](/</g,"&#60;")[K](/&/g,"&#38;")[K](/\n/g,"<br>")),p.W=o.w=p.paper.span.offsetWidth,p.H=o.h=p.paper.span.offsetHeight,p.X=o.x,p.Y=o.y+B(p.H/2),o["text-anchor"]){case"start":p.node.style["v-text-align"]="left",p.bbx=B(p.W/2);break;case"end":p.node.style["v-text-align"]="right",p.bbx=-B(p.W/2);break;default:p.node.style["v-text-align"]="center"}},Ee=function(e,t){e.attrs=e.attrs||{};e.attrs;var n,s="linear",i=".5 .5";if(e.attrs.gradient=t,t=(t=v(t)[K](ne,(function(e,t,n){return s="radial",t&&n&&(t=V(t),n=V(n),M(t-.5,2)+M(n-.5,2)>.25&&(n=S.sqrt(.25-M(t-.5,2))*(2*(n>.5)-1)+.5),i=t+b+n),m})))[x](/\s*\-\s*/),"linear"==s){var r=t.shift();if(r=-V(r),isNaN(r))return null}var o=we(t);if(!o)return null;if(!(n=(e=e.shape||e.node).getElementsByTagName(R)[0]||Ge(R)).parentNode&&e.appendChild(n),o[O]){n.on=!0,n.method="none",n.color=o[0].color,n.color2=o[o[O]-1].color;for(var a=[],l=0,c=o[O];l<c;l++)o[l].offset&&a[L](o[l].offset+b+o[l].color);n.colors&&(n.colors.value=a[O]?a[w]():"0% "+n.color),"radial"==s?(n.type="gradientradial",n.focus="100%",n.focussize=i,n.focusposition=i):(n.type="gradient",n.angle=(270-r)%360)}return 1},(Fe=(Le=function(e,n,s){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.X=0,this.Y=0,this.attrs={},this.Group=n,this.paper=s,this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1},!s.bottom&&(s.bottom=this),this.prev=s.top,s.top&&(s.top.next=this),s.top=this,this.next=null})[o]).rotate=function(e,t,n){return this.removed?this:null==e?this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][w](b):this._.rt.deg:((e=v(e)[x](s))[O]-1&&(t=V(e[1]),n=V(e[2])),e=V(e[0]),null!=t?this._.rt.deg=e:this._.rt.deg+=e,null==n&&(t=null),this._.rt.cx=t,this._.rt.cy=n,this.setBox(this.attrs,t,n),this.Group.style.rotation=this._.rt.deg,this)},Fe.setBox=function(e,t,n){if(this.removed)return this;var s=this.Group.style,i=this.shape&&this.shape.style||this.node.style;for(var r in e=e||{})e[a](r)&&(this.attrs[r]=e[r]);t=t||this._.rt.cx,n=n||this._.rt.cy;var o,l,c,h,p=this.attrs;switch(this.type){case"circle":o=p.cx-p.r,l=p.cy-p.r,c=h=2*p.r;break;case"ellipse":o=p.cx-p.rx,l=p.cy-p.ry,c=2*p.rx,h=2*p.ry;break;case"image":o=+p.x,l=+p.y,c=p.width||0,h=p.height||0;break;case"text":this.textpath.v=["m",B(p.x),", ",B(p.y-2),"l",B(p.x)+1,", ",B(p.y-2)][w](m),o=p.x-B(this.W/2),l=p.y-this.H/2,c=this.W,h=this.H;break;case"rect":case"path":if(this.attrs.path){var u=ue(this.attrs.path);o=u.x,l=u.y,c=u.width,h=u.height}else o=0,l=0,c=this.paper.width,h=this.paper.height;break;default:o=0,l=0,c=this.paper.width,h=this.paper.height}n=null==n?l+h/2:n;var d,g=(t=null==t?o+c/2:t)-this.paper.width/2,f=n-this.paper.height/2;s.left!=(d=g+"px")&&(s.left=d),s.top!=(d=f+"px")&&(s.top=d),this.X=Qe[a](this.type)?-g:o,this.Y=Qe[a](this.type)?-f:l,this.W=c,this.H=h,Qe[a](this.type)?(i.left!=(d=-g*Je+"px")&&(i.left=d),i.top!=(d=-f*Je+"px")&&(i.top=d)):"text"==this.type?(i.left!=(d=-g+"px")&&(i.left=d),i.top!=(d=-f+"px")&&(i.top=d)):(s.width!=(d=this.paper.width+"px")&&(s.width=d),s.height!=(d=this.paper.height+"px")&&(s.height=d),i.left!=(d=o-g+"px")&&(i.left=d),i.top!=(d=l-f+"px")&&(i.top=d),i.width!=(d=c+"px")&&(i.width=d),i.height!=(d=h+"px")&&(i.height=d))},Fe.hide=function(){return!this.removed&&(this.Group.style.display="none"),this},Fe.show=function(){return!this.removed&&(this.Group.style.display="block"),this},Fe.getBBox=function(){return this.removed?this:Qe[a](this.type)?ue(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}},Fe.remove=function(){if(!this.removed){for(var e in Se(this,this.paper),this.node.parentNode.removeChild(this.node),this.Group.parentNode.removeChild(this.Group),this.shape&&this.shape.parentNode.removeChild(this.shape),this)delete this[e];this.removed=!0}},Fe.attr=function(e,n){if(this.removed)return this;if(null==e){var s={};for(var i in this.attrs)this.attrs[a](i)&&(s[i]=this.attrs[i]);return this._.rt.deg&&(s.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(s.scale=this.scale()),s.gradient&&"none"==s.fill&&(s.fill=s.gradient)&&delete s.gradient,s}if(null==n&&t.is(e,"string"))return"translation"==e?wt.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==R&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(this.attrs&&null==n&&t.is(e,E)){var r,o={};for(i=0,r=e[O];i<r;i++)o[e[i]]=this.attr(e[i]);return o}var l;if(null!=n&&((l={})[e]=n),null==n&&t.is(e,"object")&&(l=e),l){for(var c in this.paper.customAttributes)if(this.paper.customAttributes[a](c)&&l[a](c)&&t.is(this.paper.customAttributes[c],"function")){var h=this.paper.customAttributes[c].apply(this,[][g](l[c]));for(var p in this.attrs[c]=l[c],h)h[a](p)&&(l[p]=h[p])}l.text&&"text"==this.type&&(this.node.string=l.text),Re(this,l),l.gradient&&({circle:1,ellipse:1}[a](this.type)||"r"!=v(l.gradient).charAt())&&Ee(this,l.gradient),(!Qe[a](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this},Fe.toFront=function(){return!this.removed&&this.Group.parentNode[u](this.Group),this.paper.top!=this&&ke(this,this.paper),this},Fe.toBack=function(){return this.removed||this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),_e(this,this.paper)),this},Fe.insertAfter=function(e){return this.removed||(e.constructor==St&&(e=e[e.length-1]),e.Group.nextSibling?e.Group.parentNode.insertBefore(this.Group,e.Group.nextSibling):e.Group.parentNode[u](this.Group),Te(this,e,this.paper)),this},Fe.insertBefore=function(e){return this.removed||(e.constructor==St&&(e=e[0]),e.Group.parentNode.insertBefore(this.Group,e.Group),Me(this,e,this.paper)),this},Fe.blur=function(e){var n=this.node.runtimeStyle,s=n.filter;s=s.replace(Ke,m),0!==+e?(this.attrs.blur=e,n.filter=s+b+U+".Blur(pixelradius="+(+e||1.5)+")",n.margin=t.format("-{0}px 0 0 -{0}px",B(+e||1.5))):(n.filter=s,n.margin=0,delete this.attrs.blur)},ze=function(e,t,n,s){var i=Ge("group"),r=Ge("oval");r.style;i.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",i.coordsize=Ze,i.coordorigin=e.coordorigin,i[u](r);var o=new Le(r,i,e);return o.type="circle",Re(o,{stroke:"#000",fill:"none"}),o.attrs.cx=t,o.attrs.cy=n,o.attrs.r=s,o.setBox({x:t-s,y:n-s,width:2*s,height:2*s}),e.canvas[u](i),o},qe=function(e,t,n,s,i,r){var o=et(t,n,s,i,r),a=e.path(o),l=a.attrs;return a.X=l.x=t,a.Y=l.y=n,a.W=l.width=s,a.H=l.height=i,l.r=r,l.path=o,a.type="rect",a},We=function(e,t,n,s,i){var r=Ge("group"),o=Ge("oval");o.style;r.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",r.coordsize=Ze,r.coordorigin=e.coordorigin,r[u](o);var a=new Le(o,r,e);return a.type="ellipse",Re(a,{stroke:"#000"}),a.attrs.cx=t,a.attrs.cy=n,a.attrs.rx=s,a.attrs.ry=i,a.setBox({x:t-s,y:n-i,width:2*s,height:2*i}),e.canvas[u](r),a},Be=function(e,t,n,s,i,r){var o=Ge("group"),a=Ge("image");o.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",o.coordsize=Ze,o.coordorigin=e.coordorigin,a.src=t,o[u](a);var l=new Le(a,o,e);return l.type="image",l.attrs.src=t,l.attrs.x=n,l.attrs.y=s,l.attrs.w=i,l.attrs.h=r,l.setBox({x:n,y:s,width:i,height:r}),e.canvas[u](o),l},Ve=function(e,n,s,i){var r=Ge("group"),o=Ge("shape"),a=o.style,l=Ge("path"),c=(l.style,Ge("textpath"));r.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",r.coordsize=Ze,r.coordorigin=e.coordorigin,l.v=t.format("m{0},{1}l{2},{1}",B(10*n),B(10*s),B(10*n)+1),l.textpathok=!0,a.width=e.width,a.height=e.height,c.string=v(i),c.on=!0,o[u](c),o[u](l),r[u](o);var h=new Le(c,r,e);return h.shape=o,h.textpath=l,h.type="text",h.attrs.text=i,h.attrs.x=n,h.attrs.y=s,h.attrs.w=1,h.attrs.h=1,Re(h,{font:$.font,stroke:"none",fill:"#000"}),h.setBox(),e.canvas[u](r),h},He=function(e,t){var n=this.canvas.style;return e==+e&&(e+="px"),t==+t&&(t+="px"),n.width=e,n.height=t,n.clip="rect(0 "+e+" "+t+" 0)",this},l.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!l.namespaces.rvml&&l.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),Ge=function(e){return l.createElement("<rvml:"+e+' class="rvml">')}}catch(_t){Ge=function(e){return l.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Ue=function(){var e=Oe[d](0,arguments),n=e.container,s=e.height,i=e.width,r=e.x,o=e.y;if(!n)throw new Error("VML container not found.");var a=new p,c=a.canvas=l.createElement("div"),h=c.style;return r=r||0,o=o||0,(i=i||512)==+i&&(i+="px"),(s=s||342)==+s&&(s+="px"),a.width=1e3,a.height=1e3,a.coordsize="10000 10000",a.coordorigin="0 0",a.span=l.createElement("span"),a.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",c[u](a.span),h.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",i,s),1==n?(l.body[u](c),h.left=r+"px",h.top=o+"px",h.position="absolute"):n.firstChild?n.insertBefore(c,n.firstChild):n[u](c),Ce.call(a,a,t.fn),a},n.clear=function(){this.canvas.innerHTML=m,this.span=l.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas[u](this.span),this.bottom=this.top=null},n.remove=function(){for(var e in this.canvas.parentNode.removeChild(this.canvas),this)this[e]=Ne(e);return!0}}var tt=navigator.userAgent.match(/Version\/(.*?)\s/);"Apple Computer, Inc."==navigator.vendor&&(tt&&tt[1]<4||"iP"==navigator.platform.slice(0,2))?n.safari=function(){var e=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});c.setTimeout((function(){e.remove()}))}:n.safari=function(){};for(var nt=function(){this.returnValue=!1},st=function(){return this.originalEvent.preventDefault()},it=function(){this.cancelBubble=!0},rt=function(){return this.originalEvent.stopPropagation()},ot=l.addEventListener?function(e,t,n,s){var i=f&&j[t]?j[t]:t,r=function(i){if(f&&j[a](t))for(var r=0,o=i.targetTouches&&i.targetTouches.length;r<o;r++)if(i.targetTouches[r].target==e){var l=i;(i=i.targetTouches[r]).originalEvent=l,i.preventDefault=st,i.stopPropagation=rt;break}return n.call(s,i)};return e.addEventListener(i,r,!1),function(){return e.removeEventListener(i,r,!1),!0}}:l.attachEvent?function(e,t,n,s){var i=function(e){return(e=e||c.event).preventDefault=e.preventDefault||nt,e.stopPropagation=e.stopPropagation||it,n.call(s,e)};return e.attachEvent("on"+t,i),function(){return e.detachEvent("on"+t,i),!0}}:void 0,at=[],lt=function(e){for(var t,n=e.clientX,s=e.clientY,i=l.documentElement.scrollTop||l.body.scrollTop,r=l.documentElement.scrollLeft||l.body.scrollLeft,o=at.length;o--;){if(t=at[o],f){for(var a,c=e.touches.length;c--;)if((a=e.touches[c]).identifier==t.el._drag.id){n=a.clientX,s=a.clientY,(e.originalEvent?e.originalEvent:e).preventDefault();break}}else e.preventDefault();n+=r,s+=i,t.move&&t.move.call(t.move_scope||t.el,n-t.el._drag.x,s-t.el._drag.y,n,s,e)}},ct=function(e){t.unmousemove(lt).unmouseup(ct);for(var n,s=at.length;s--;)(n=at[s]).el._drag={},n.end&&n.end.call(n.end_scope||n.start_scope||n.move_scope||n.el,e);at=[]},ht=y[O];ht--;)!function(e){t[e]=Le[o][e]=function(n,s){return t.is(n,"function")&&(this.events=this.events||[],this.events.push({name:e,f:n,unbind:ot(this.shape||this.node||l,e,n,s||this)})),this},t["un"+e]=Le[o]["un"+e]=function(t){for(var n=this.events,s=n[O];s--;)if(n[s].name==e&&n[s].f==t)return n[s].unbind(),n.splice(s,1),!n.length&&delete this.events,this;return this}}(y[ht]);function pt(){return this.x+b+this.y}Fe.hover=function(e,t,n,s){return this.mouseover(e,n).mouseout(t,s||n)},Fe.unhover=function(e,t){return this.unmouseover(e).unmouseout(t)},Fe.drag=function(e,n,s,i,r,o){return this._drag={},this.mousedown((function(a){(a.originalEvent||a).preventDefault();var c=l.documentElement.scrollTop||l.body.scrollTop,h=l.documentElement.scrollLeft||l.body.scrollLeft;this._drag.x=a.clientX+h,this._drag.y=a.clientY+c,this._drag.id=a.identifier,n&&n.call(r||i||this,a.clientX+h,a.clientY+c,a),!at.length&&t.mousemove(lt).mouseup(ct),at.push({el:this,move:e,end:s,move_scope:i,start_scope:r,end_scope:o})})),this},Fe.undrag=function(e,n,s){for(var i=at.length;i--;)at[i].el==this&&at[i].move==e&&at[i].end==s&&at.splice(i++,1);!at.length&&t.unmousemove(lt).unmouseup(ct)},n.circle=function(e,t,n){return ze(this,e||0,t||0,n||0)},n.rect=function(e,t,n,s,i){return qe(this,e||0,t||0,n||0,s||0,i||0)},n.ellipse=function(e,t,n,s){return We(this,e||0,t||0,n||0,s||0)},n.path=function(e){return e&&!t.is(e,I)&&!t.is(e[0],E)&&(e+=m),Ie(t.format[d](t,arguments),this)},n.image=function(e,t,n,s,i){return Be(this,e||"about:blank",t||0,n||0,s||0,i||0)},n.text=function(e,t,n){return Ve(this,e||0,t||0,v(n))},n.set=function(e){return arguments[O]>1&&(e=Array[o].splice.call(arguments,0,arguments[O])),new St(e)},n.setSize=He,n.top=n.bottom=null,n.raphael=t,Fe.resetScale=function(){if(this.removed)return this;this._.sx=1,this._.sy=1,this.attrs.scale="1 1"},Fe.scale=function(t,n,s,i){if(this.removed)return this;if(null==t&&null==n)return{x:this._.sx,y:this._.sy,toString:pt};!+(n=n||t)&&(n=t);var r,o,a=this.attrs;if(0!=t){var l=this.getBBox(),c=l.x+l.width/2,h=l.y+l.height/2,p=T(t/this._.sx),u=T(n/this._.sy);s=+s||0==s?s:c,i=+i||0==i?i:h;var d=this._.sx>0,f=this._.sy>0,v=~~(t/T(t)),x=~~(n/T(n)),y=p*v,j=u*x,C=this.node.style,S=s+T(c-s)*y*(c>s==d?1:-1),k=i+T(h-i)*j*(h>i==f?1:-1),_=t*v>n*x?u:p;switch(this.type){case"rect":case"image":var M=a.width*p,N=a.height*u;this.attr({height:N,r:a.r*_,width:M,x:S-M/2,y:k-N/2});break;case"circle":case"ellipse":this.attr({rx:a.rx*p,ry:a.ry*u,r:a.r*_,cx:S,cy:k});break;case"text":this.attr({x:S,y:k});break;case"path":for(var P=ge(a.path),I=!0,E=d?y:p,A=f?j:u,R=0,D=P[O];R<D;R++){var L=P[R],F=G.call(L[0]);if("M"!=F||!I)if(I=!1,"A"==F)L[P[R][O]-2]*=E,L[P[R][O]-1]*=A,L[1]*=p,L[2]*=u,L[5]=+(v+x?!!+L[5]:!+L[5]);else if("H"==F)for(var z=1,q=L[O];z<q;z++)L[z]*=E;else if("V"==F)for(z=1,q=L[O];z<q;z++)L[z]*=A;else for(z=1,q=L[O];z<q;z++)L[z]*=z%2?E:A}var W=ue(P);r=S-W.x-W.width/2,o=k-W.y-W.height/2,P[0][1]+=r,P[0][2]+=o,this.attr({path:P})}!(this.type in{text:1,image:1})||1==v&&1==x?this.transformations?(this.transformations[2]=m,e(this.node,"transform",this.transformations[w](b)),a.fx=0,a.fy=0):(this.node.filterMatrix=m,C.filter=(this.node.filterMatrix||m)+(this.node.filterOpacity||m)):this.transformations?(this.transformations[2]="scale("[g](v,",",x,")"),e(this.node,"transform",this.transformations[w](b)),r=-1==v?-a.x-(M||0):a.x,o=-1==x?-a.y-(N||0):a.y,this.attr({x:r,y:o}),a.fx=v-1,a.fy=x-1):(this.node.filterMatrix=U+".Matrix(M11="[g](v,", M12=0, M21=0, M22=",x,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),C.filter=(this.node.filterMatrix||m)+(this.node.filterOpacity||m)),a.scale=[t,n,s,i][w](b),this._.sx=t,this._.sy=n}return this},Fe.clone=function(){if(this.removed)return null;var e=this.attr();return delete e.scale,delete e.translation,this.paper[this.type]().attr(e)};var ut={},dt=function(e,n,s,i,r,o,a,l,c){if(e===s&&n===i&&r===a&&o==l){var h=a-e,p=l-n,u=Math.sqrt(h*h+p*p);if(null==c)return u;var d=c/u;return{start:{x:e,y:n},m:{x:e,y:n},n:{x:a,y:l},end:{x:a,y:l},x:e+d*h,y:n+d*p,alpha:90-180*S.atan(h/p)/N}}var g,f,m=0,b=100,v=[e,n,s,i,r,o,a,l].join(),x=ut[v];(!x&&(ut[v]=x={data:[]}),x.timer&&clearTimeout(x.timer),x.timer=setTimeout((function(){delete ut[v]}),2e3),null!=c)&&(b=10*~~dt(e,n,s,i,r,o,a,l));for(var y=0;y<b+1;y++){if(x.data[c]>y?f=x.data[y*b]:(f=t.findDotsAtSegment(e,n,s,i,r,o,a,l,y/b),x.data[y]=f),y&&(m+=M(M(g.x-f.x,2)+M(g.y-f.y,2),.5)),null!=c&&m>=c)return f;g=f}if(null==c)return m},gt=function(e,n){return function(s,i,r){for(var o,a,l,c,h,p="",u={},d=0,g=0,f=(s=je(s)).length;g<f;g++){if("M"==(l=s[g])[0])o=+l[1],a=+l[2];else{if(d+(c=dt(o,a,l[1],l[2],l[3],l[4],l[5],l[6]))>i){if(n&&!u.start){if(p+=["C",(h=dt(o,a,l[1],l[2],l[3],l[4],l[5],l[6],i-d)).start.x,h.start.y,h.m.x,h.m.y,h.x,h.y],r)return p;u.start=p,p=["M",h.x,h.y+"C",h.n.x,h.n.y,h.end.x,h.end.y,l[5],l[6]][w](),d+=c,o=+l[5],a=+l[6];continue}if(!e&&!n)return{x:(h=dt(o,a,l[1],l[2],l[3],l[4],l[5],l[6],i-d)).x,y:h.y,alpha:h.alpha}}d+=c,o=+l[5],a=+l[6]}p+=l}return u.end=p,(h=e?d:n?u:t.findDotsAtSegment(o,a,l[1],l[2],l[3],l[4],l[5],l[6],1)).alpha&&(h={x:h.x,y:h.y,alpha:h.alpha}),h}},ft=gt(1),mt=gt(),bt=gt(0,1);Fe.getTotalLength=function(){if("path"==this.type)return this.node.getTotalLength?this.node.getTotalLength():ft(this.attrs.path)},Fe.getPointAtLength=function(e){if("path"==this.type)return mt(this.attrs.path,e)},Fe.getSubpath=function(e,t){if("path"==this.type){if(T(this.getTotalLength()-t)<"1e-6")return bt(this.attrs.path,e).end;var n=bt(this.attrs.path,t,1);return e?bt(n,e).end:n}},t.easing_formulas={linear:function(e){return e},"<":function(e){return M(e,3)},">":function(e){return M(e-1,3)+1},"<>":function(e){return(e*=2)<1?M(e,3)/2:(M(e-=2,3)+2)/2},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},elastic:function(e){if(0==e||1==e)return e;return M(2,-10*e)*S.sin(2*N*(e-.075)/.3)+1},bounce:function(e){var t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375}};var vt=[],xt=function(){for(var e=+new Date,n=0;n<vt[O];n++){var s=vt[n];if(!s.stop&&!s.el.removed){var i,r=e-s.start,o=s.ms,l=s.easing,c=s.from,h=s.diff,p=s.to,u=s.t,d=s.el,g={};if(r<o){var f=l(r/o);for(var v in c)if(c[a](v)){switch(Y[v]){case"along":i=f*o*h[v],p.back&&(i=p.len-i);var x=mt(p[v],i);d.translate(h.sx-h.x||0,h.sy-h.y||0),h.x=x.x,h.y=x.y,d.translate(x.x-h.sx,x.y-h.sy),p.rot&&d.rotate(h.r+x.alpha,x.x,x.y);break;case P:i=+c[v]+f*o*h[v];break;case"colour":i="rgb("+[jt(B(c[v].r+f*o*h[v].r)),jt(B(c[v].g+f*o*h[v].g)),jt(B(c[v].b+f*o*h[v].b))][w](",")+")";break;case"path":i=[];for(var y=0,j=c[v][O];y<j;y++){i[y]=[c[v][y][0]];for(var C=1,S=c[v][y][O];C<S;C++)i[y][C]=+c[v][y][C]+f*o*h[v][y][C];i[y]=i[y][w](b)}i=i[w](b);break;case"csv":switch(v){case"translation":var k=f*o*h[v][0]-u.x,_=f*o*h[v][1]-u.y;u.x+=k,u.y+=_,i=k+b+_;break;case"rotation":i=+c[v][0]+f*o*h[v][0],c[v][1]&&(i+=","+c[v][1]+","+c[v][2]);break;case"scale":i=[+c[v][0]+f*o*h[v][0],+c[v][1]+f*o*h[v][1],2 in p[v]?p[v][2]:m,3 in p[v]?p[v][3]:m][w](b);break;case"clip-rect":for(i=[],y=4;y--;)i[y]=+c[v][y]+f*o*h[v][y]}break;default:var T=[].concat(c[v]);for(i=[],y=d.paper.customAttributes[v].length;y--;)i[y]=+T[y]+f*o*h[v][y]}g[v]=i}d.attr(g),d._run&&d._run.call(d)}else p.along&&(x=mt(p.along,p.len*!p.back),d.translate(h.sx-(h.x||0)+x.x-h.sx,h.sy-(h.y||0)+x.y-h.sy),p.rot&&d.rotate(h.r+x.alpha,x.x,x.y)),(u.x||u.y)&&d.translate(-u.x,-u.y),p.scale&&(p.scale+=m),d.attr(p),vt.splice(n--,1)}}t.svg&&d&&d.paper&&d.paper.safari(),vt[O]&&setTimeout(xt)},yt=function(e,n,s,i,r){var o=s-i;n.timeouts.push(setTimeout((function(){t.is(r,"function")&&r.call(n),n.animate(e,o,e.easing)}),i))},jt=function(e){return k(_(e,255),0)},wt=function(e,t){if(null==e)return{x:this._.tx,y:this._.ty,toString:pt};switch(this._.tx+=+e,this._.ty+=+t,this.type){case"circle":case"ellipse":this.attr({cx:+e+this.attrs.cx,cy:+t+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+e+this.attrs.x,y:+t+this.attrs.y});break;case"path":var n=ge(this.attrs.path);n[0][1]+=+e,n[0][2]+=+t,this.attr({path:n})}return this};function Ot(e){return function(n,s,i,r){var o={back:e};return t.is(i,"function")?r=i:o.rot=i,n&&n.constructor==Le&&(n=n.attrs.path),n&&(o.along=n),this.animate(o,s,r)}}function Ct(e,t,n,s,i,r){var o=3*t,a=3*(s-t)-o,l=1-o-a,c=3*n,h=3*(i-n)-c,p=1-c-h;function u(e){return((l*e+a)*e+o)*e}return function(e,t){var n=function(e,t){var n,s,i,r,c,h;for(i=e,h=0;h<8;h++){if(r=u(i)-e,T(r)<t)return i;if(T(c=(3*l*i+2*a)*i+o)<1e-6)break;i-=r/c}if(s=1,i=e,i<(n=0))return n;if(i>s)return s;for(;n<s;){if(r=u(i),T(r-e)<t)return i;e>r?n=i:s=i,i=(s-n)/2+n}return i}(e,t);return((p*n+h)*n+c)*n}(e,1/(200*r))}Fe.animateWith=function(e,t,n,s,i){for(var r=0,o=vt.length;r<o;r++)vt[r].el.id==e.id&&(t.start=vt[r].start);return this.animate(t,n,s,i)},Fe.animateAlong=Ot(),Fe.animateAlongBack=Ot(1),Fe.onAnimation=function(e){return this._run=e||0,this},Fe.animate=function(e,n,i,r){var o=this;if(o.timeouts=o.timeouts||[],!t.is(i,"function")&&i||(r=i||null),o.removed)return r&&r.call(o),o;var l={},c={},h=!1,p={};for(var u in e)if(e[a](u)&&(Y[a](u)||o.paper.customAttributes[a](u)))switch(h=!0,l[u]=o.attr(u),null==l[u]&&(l[u]=$[u]),c[u]=e[u],Y[u]){case"along":var d=ft(e[u]),g=mt(e[u],d*!!e.back),f=o.getBBox();p[u]=d/n,p.tx=f.x,p.ty=f.y,p.sx=g.x,p.sy=g.y,c.rot=e.rot,c.back=e.back,c.len=d,e.rot&&(p.r=V(o.rotate())||0);break;case P:p[u]=(c[u]-l[u])/n;break;case"colour":l[u]=t.getRGB(l[u]);var m=t.getRGB(c[u]);p[u]={r:(m.r-l[u].r)/n,g:(m.g-l[u].g)/n,b:(m.b-l[u].b)/n};break;case"path":var b=je(l[u],c[u]);l[u]=b[0];var y=b[1];p[u]=[];for(var j=0,w=l[u][O];j<w;j++){p[u][j]=[0];for(var C=1,S=l[u][j][O];C<S;C++)p[u][j][C]=(y[j][C]-l[u][j][C])/n}break;case"csv":var k=v(e[u])[x](s),_=v(l[u])[x](s);switch(u){case"translation":l[u]=[0,0],p[u]=[k[0]/n,k[1]/n];break;case"rotation":l[u]=_[1]==k[1]&&_[2]==k[2]?_:[0,k[1],k[2]],p[u]=[(k[0]-l[u][0])/n,0,0];break;case"scale":e[u]=k,l[u]=v(l[u])[x](s),p[u]=[(k[0]-l[u][0])/n,(k[1]-l[u][1])/n,0,0];break;case"clip-rect":for(l[u]=v(l[u])[x](s),p[u]=[],j=4;j--;)p[u][j]=(k[j]-l[u][j])/n}c[u]=k;break;default:for(k=[].concat(e[u]),_=[].concat(l[u]),p[u]=[],j=o.paper.customAttributes[u][O];j--;)p[u][j]=((k[j]||0)-(_[j]||0))/n}if(h){var T=t.easing_formulas[i];if(!T)if((T=v(i).match(W))&&5==T[O]){var M=T;T=function(e){return Ct(e,+M[1],+M[2],+M[3],+M[4],n)}}else T=function(e){return e};vt.push({start:e.start||+new Date,ms:n,easing:T,from:l,diff:p,to:c,el:o,t:{x:0,y:0}}),t.is(r,"function")&&(o._ac=setTimeout((function(){r.call(o)}),n)),1==vt[O]&&setTimeout(xt)}else{var N,I=[];for(var E in e)e[a](E)&&X.test(E)&&(u={value:e[E]},"from"==E&&(E=0),"to"==E&&(E=100),u.key=H(E,10),I.push(u));for(I.sort(se),I[0].key&&I.unshift({key:0,value:o.attrs}),j=0,w=I[O];j<w;j++)yt(I[j].value,o,n/100*I[j].key,n/100*(I[j-1]&&I[j-1].key||0),I[j-1]&&I[j-1].value.callback);(N=I[I[O]-1].value.callback)&&o.timeouts.push(setTimeout((function(){N.call(o)}),n))}return this},Fe.stop=function(){for(var e=0;e<vt.length;e++)vt[e].el.id==this.id&&vt.splice(e--,1);for(e=0,ii=this.timeouts&&this.timeouts.length;e<ii;e++)clearTimeout(this.timeouts[e]);return this.timeouts=[],clearTimeout(this._ac),delete this._ac,this},Fe.translate=function(e,t){return this.attr({translation:e+" "+t})},Fe[A]=function(){return"Rapha\xebl\u2019s object"},t.ae=vt;var St=function(e){if(this.items=[],this[O]=0,this.type="set",e)for(var t=0,n=e[O];t<n;t++)!e[t]||e[t].constructor!=Le&&e[t].constructor!=St||(this[this.items[O]]=this.items[this.items[O]]=e[t],this[O]++)};for(var kt in St[o][L]=function(){for(var e,t,n=0,s=arguments[O];n<s;n++)!(e=arguments[n])||e.constructor!=Le&&e.constructor!=St||(this[t=this.items[O]]=this.items[t]=e,this[O]++);return this},St[o].pop=function(){return delete this[this[O]--],this.items.pop()},Fe)Fe[a](kt)&&(St[o][kt]=function(e){return function(){for(var t=0,n=this.items[O];t<n;t++)this.items[t][e][d](this.items[t],arguments);return this}}(kt));St[o].attr=function(e,n){if(e&&t.is(e,E)&&t.is(e[0],"object"))for(var s=0,i=e[O];s<i;s++)this.items[s].attr(e[s]);else for(var r=0,o=this.items[O];r<o;r++)this.items[r].attr(e,n);return this},St[o].animate=function(e,n,s,i){(t.is(s,"function")||!s)&&(i=s||null);var r,o,a=this.items[O],l=a,c=this;for(i&&(o=function(){! --a&&i.call(c)}),s=t.is(s,I)?s:o,r=this.items[--l].animate(e,n,s,o);l--;)this.items[l]&&!this.items[l].removed&&this.items[l].animateWith(r,e,n,s,o);return this},St[o].insertAfter=function(e){for(var t=this.items[O];t--;)this.items[t].insertAfter(e);return this},St[o].getBBox=function(){for(var e=[],t=[],n=[],s=[],i=this.items[O];i--;){var r=this.items[i].getBBox();e[L](r.x),t[L](r.y),n[L](r.x+r.width),s[L](r.y+r.height)}return{x:e=_[d](0,e),y:t=_[d](0,t),width:k[d](0,n)-e,height:k[d](0,s)-t}},St[o].clone=function(e){e=new St;for(var t=0,n=this.items[O];t<n;t++)e[L](this.items[t].clone());return e},t.registerFont=function(e){if(!e.face)return e;this.fonts=this.fonts||{};var t={w:e.w,face:{},glyphs:{}},n=e.face["font-family"];for(var s in e.face)e.face[a](s)&&(t.face[s]=e.face[s]);if(this.fonts[n]?this.fonts[n][L](t):this.fonts[n]=[t],!e.svg)for(var i in t.face["units-per-em"]=H(e.face["units-per-em"],10),e.glyphs)if(e.glyphs[a](i)){var r=e.glyphs[i];if(t.glyphs[i]={w:r.w,k:{},d:r.d&&"M"+r.d[K](/[mlcxtrv]/g,(function(e){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[e]||"M"}))+"z"},r.k)for(var o in r.k)r[a](o)&&(t.glyphs[i].k[o]=r.k[o])}return e},n.getFont=function(e,n,s,i){if(i=i||"normal",s=s||"normal",n=+n||{normal:400,bold:700,lighter:300,bolder:800}[n]||400,t.fonts){var r,o=t.fonts[e];if(!o){var l=new RegExp("(^|\\s)"+e[K](/[^\w\d\s+!~.:_-]/g,m)+"(\\s|$)","i");for(var c in t.fonts)if(t.fonts[a](c)&&l.test(c)){o=t.fonts[c];break}}if(o)for(var h=0,p=o[O];h<p&&((r=o[h]).face["font-weight"]!=n||r.face["font-style"]!=s&&r.face["font-style"]||r.face["font-stretch"]!=i);h++);return r}},n.print=function(e,n,i,r,o,a,l){a=a||"middle",l=k(_(l||0,1),-1);var c,h=this.set(),p=v(i)[x](m),u=0;if(t.is(r,i)&&(r=this.getFont(r)),r){c=(o||16)/r.face["units-per-em"];for(var d=r.face.bbox.split(s),g=+d[0],f=+d[1]+("baseline"==a?d[3]-d[1]+ +r.face.descent:(d[3]-d[1])/2),b=0,y=p[O];b<y;b++){var j=b&&r.glyphs[p[b-1]]||{},w=r.glyphs[p[b]];u+=b?(j.w||r.w)+(j.k&&j.k[p[b]]||0)+r.w*l:0,w&&w.d&&h[L](this.path(w.d).attr({fill:"#000",stroke:"none",translation:[u,0]}))}h.scale(c,c,g,f).translate(e-g,n-f)}return h},t.format=function(e,n){var s=t.is(n,E)?[0][g](n):arguments;return e&&t.is(e,I)&&s[O]-1&&(e=e[K](r,(function(e,t){return null==s[++t]?m:s[t]}))),e||m},t.ninja=function(){return h.was?c.Raphael=h.is:delete c.Raphael,t},t.el=Fe,t.st=St[o],h.was?c.Raphael=t:Raphael=t}()},169:function(e,t){!function(e,t,n,s){var i="virtualMouseBindings",r="virtualTouchID",o="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),a="clientX clientY pageX pageY screenX screenY".split(" "),l=e.event.mouseHooks?e.event.mouseHooks.props:[],c=e.event.props.concat(l),h={},p=0,u=0,d=0,g=!1,f=[],m=!1,b=!1,v="addEventListener"in n,x=e(n),y=1,j=0;function w(e){for(;e&&"undefined"!==typeof e.originalEvent;)e=e.originalEvent;return e}function O(t){for(var n,s,r={};t;){for(s in n=e.data(t,i))n[s]&&(r[s]=r.hasVirtualBinding=!0);t=t.parentNode}return r}function C(){b=!0}function S(){b=!1}function k(){_(),p=setTimeout((function(){p=0,j=0,f.length=0,m=!1,C()}),e.vmouse.resetTimerDuration)}function _(){p&&(clearTimeout(p),p=0)}function T(t,n,r){var o;return(r&&r[t]||!r&&function(t,n){for(var s;t;){if((s=e.data(t,i))&&(!n||s[n]))return t;t=t.parentNode}return null}(n.target,t))&&(o=function(t,n){var i,r,o,l,h,p,u,d,g=t.type;if((t=e.Event(t)).type=n,i=t.originalEvent,r=e.event.props,g.search(/mouse/)>-1&&(r=c),i)for(u=r.length;u;)t[l=r[--u]]=i[l];if(g.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1),-1!==g.search(/^touch/)&&(g=(o=w(i)).touches,h=o.changedTouches,p=g&&g.length?g[0]:h&&h.length?h[0]:s))for(d=0,len=a.length;d<len;d++)t[l=a[d]]=p[l];return t}(n,t),e(n.target).trigger(o)),o}function M(t){var n=e.data(t.target,r);if(!m&&(!j||j!==n)){var s=T("v"+t.type,t);s&&(s.isDefaultPrevented()&&t.preventDefault(),s.isPropagationStopped()&&t.stopPropagation(),s.isImmediatePropagationStopped()&&t.stopImmediatePropagation())}}function N(t){var n,s,i=w(t).touches;if(i&&1===i.length&&(s=O(n=t.target)).hasVirtualBinding){j=y++,e.data(n,r,j),_(),S(),g=!1;var o=w(t).touches[0];u=o.pageX,d=o.pageY,T("vmouseover",t,s),T("vmousedown",t,s)}}function P(e){b||(g||T("vmousecancel",e,O(e.target)),g=!0,k())}function I(t){if(!b){var n=w(t).touches[0],s=g,i=e.vmouse.moveDistanceThreshold;g=g||Math.abs(n.pageX-u)>i||Math.abs(n.pageY-d)>i,flags=O(t.target),g&&!s&&T("vmousecancel",t,flags),T("vmousemove",t,flags),k()}}function E(e){if(!b){C();var t,n=O(e.target);if(T("vmouseup",e,n),!g){var s=T("vclick",e,n);s&&s.isDefaultPrevented()&&(t=w(e).changedTouches[0],f.push({touchID:j,x:t.clientX,y:t.clientY}),m=!0)}T("vmouseout",e,n),g=!1,k()}}function A(t){var n,s=e.data(t,i);if(s)for(n in s)if(s[n])return!0;return!1}function R(){}function D(t){var n=t.substr(1);return{setup:function(s,r){A(this)||e.data(this,i,{}),e.data(this,i)[t]=!0,h[t]=(h[t]||0)+1,1===h[t]&&x.bind(n,M),e(this).bind(n,R),v&&(h.touchstart=(h.touchstart||0)+1,1===h.touchstart&&x.bind("touchstart",N).bind("touchend",E).bind("touchmove",I).bind("scroll",P))},teardown:function(s,r){--h[t],h[t]||x.unbind(n,M),v&&(--h.touchstart,h.touchstart||x.unbind("touchstart",N).unbind("touchmove",I).unbind("touchend",E).unbind("scroll",P));var o=e(this),a=e.data(this,i);a&&(a[t]=!1),o.unbind(n,R),A(this)||o.removeData(i)}}}e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};for(var L=0;L<o.length;L++)e.event.special[o[L]]=D(o[L]);v&&n.addEventListener("click",(function(t){var n,s,i,o,a,l=f.length,c=t.target;if(l)for(n=t.clientX,s=t.clientY,threshold=e.vmouse.clickDistanceThreshold,i=c;i;){for(o=0;o<l;o++)if(a=f[o],i===c&&Math.abs(a.x-n)<threshold&&Math.abs(a.y-s)<threshold||e.data(i,r)===a.touchID)return t.preventDefault(),void t.stopPropagation();i=i.parentNode}}),!0)}(jQuery,window,document)},266:function(e,t,n){},267:function(e,t,n){"use strict";n.r(t);var s=n(5),i=n.n(s),r=n(59),o=n.n(r),a=n(4),l=n.n(a),c=n(1),h=n.n(c),p=n(18),u=n.n(p),d=n(21),g=n.n(d),f=n(39),m=n.n(f),b=n(9),v=n.n(b),x=n(2),y=function(e){return 1!=e},j={accents:y,af:y,ar:function(e){return 0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11&&e%100<=99?4:5},az:y,bg:y,bn:y,boxes:y,ca:y,cs:function(e){return 1==e?0:e>=2&&e<=4?1:2},da:y,de:y,el:y,empty:y,en:y,"en-pt":y,es:y,fa:function(e){return 0},"fa-af":function(e){return 0},fi:y,fr:function(e){return e>1},he:y,hi:y,hu:y,hy:y,id:function(e){return 0},it:y,ja:function(e){return 0},ko:function(e){return 0},lol:y,mn:y,ms:function(e){return 0},nb:y,nl:y,pl:function(e){return 1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},pt:y,"pt-pt":y,ro:function(e){return 1==e?0:0==e||e%100>0&&e%100<20?1:2},ru:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},"si-LK":y,sk:function(e){return 1==e?0:e>=2&&e<=4?1:2},sr:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},"sv-SE":y,sw:y,te:y,th:function(e){return 0},tr:function(e){return 0},uk:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},ur:y,vi:function(e){return 0},xh:y,"zh-hans":function(e){return 0},"zh-hant":function(e){return 0},zu:y},w=/%\(([\w_]+)\)s/g,O=function(e,t){t=t||{};for(var n,s=e.split(w),i={text_0:s[0]},r=1;r<s.length;r+=2){var o=s[r],a=t[o];void 0===a&&(a="%("+o+")s");for(var l=0;l+"_"+o in i;)l++;i[l+"_"+o]=a,i["text_"+(r+1)]=s[r+1]}return n=i,React.createElement(React.Fragment,null,Object.keys(n).map((e=>React.createElement(React.Fragment,{key:e},n[e]))))},C=function(e,t){return"object"===typeof e&&e.messages&&(e=e.messages[0]),t=t||{},e.replace(w,(function(e,n){var s=t[n];return void 0===s?e:s}))};var S=function(e,t){var n=(j[t]||j.en)(e);return!0===n?1:n||0},k=C;window.i18n={_:C,ngettext:function(e,t,n,s){var i,r;"object"===typeof e?(i=e.lang,r=e.messages,s=n,n=t):(i="en",r=[e,t]);var o=S(n,i),a="";return o<r.length&&(a=r[o]),(s=s||{}).num=s.num||n,C(a,s)},i18nDoNotTranslate:k,ngetpos:S};window.$_=function(e,t){return 2!==arguments.length||"string"!==typeof t?"<$_> must have exactly one child, which must be a string":O(t,e)},window.$i18nDoNotTranslate=function(e,t){return t};var T=n(76),M=n.n(T);window.createReactClass=u.a,window.PropTypes=g.a,window.ReactDOMtags={span:e=>h.a.createElement("span",e),input:e=>h.a.createElement("input",e)},window.jQuery=window.$=l.a,window.katex=m.a,window.MathQuill=M.a,window.classnames=v.a,window._=x.b,window.Raphael=void 0;const N=o.a;window.React=h.a,window.ReactDOM=i.a,window.underscore=window._,window.react=window.React,window["react-dom"]=window.ReactDOM,window.classnames=window.classNames,window.jquery=window.jQuery,window["react-addons-pure-render-mixin"]=N,window.icu={getDecimalFormatSymbols:function(){return{decimal_separator:".",grouping_separator:",",minus:"-"}}},window.KhanUtil={debugLog:function(){},localeToFixed:function(e,t){return e.toFixed(t)}},window.Exercises={localMode:!0,useKatex:!0,khanExercisesUrlBase:"../",getCurrentFramework:function(){return"khan-exercises"},PerseusBridge:{cleanupProblem:function(){return!1}}},window.Khan={Util:window.KhanUtil,error:function(){},query:{debug:""},imageBase:"/images/"};n(134),n(135),n(136),n(137);var P={exports:{}};P.exports;const I={type:"hint"},E=e=>({type:"array",elementShape:e}),A=E(I);P.exports={content:{type:"content"},hint:I,hints:A,tags:{type:"tags"},arrayOf:E,shape:e=>({type:"object",shape:e})};var R=P.exports;function D(e){if("content"===e.type)return PropTypes.shape({__type:PropTypes.oneOf(["content","item"]).isRequired,content:PropTypes.string,images:PropTypes.objectOf(PropTypes.any),widgets:PropTypes.objectOf(PropTypes.any)});if("hint"===e.type)return PropTypes.shape({__type:PropTypes.oneOf(["hint"]).isRequired,content:PropTypes.string,images:PropTypes.objectOf(PropTypes.any),widgets:PropTypes.objectOf(PropTypes.any),replace:PropTypes.bool});if("tags"===e.type)return PropTypes.arrayOf(PropTypes.string.isRequired);if("array"===e.type){const t=D(e.elementShape);return PropTypes.arrayOf(t.isRequired)}if("object"===e.type){const t=e.shape,n={};return Object.keys(t).forEach((e=>{n[e]=D(t[e]).isRequired})),PropTypes.shape(n)}throw new Error(`unexpected shape type ${e.type}`)}const L=/^web\+graphie\:/;function F(e){return L.test(e)}function z(e){const t="http:"===window.location.protocol?"http:":"https:";return e.replace(L,t)}function q(e){return z(e)+".svg"}function W(e){return z(e)+"-data.json"}const B=/\/(?=[^/]+$)/;function V(e){return F(e)?q(e):e}const H={};!function(e){var t=function(){var e=function(e,t,n,s){for(n=n||{},s=e.length;s--;n[e[s]]=t);return n},t=[1,7],n=[1,17],s=[1,13],i=[1,14],r=[1,15],o=[1,32],a=[1,22],l=[1,23],c=[1,24],h=[1,25],p=[1,26],u=[1,33],d=[1,27],g=[1,28],f=[1,29],m=[1,30],b=[1,20],v=[1,36],x=[1,37],y=[5,6,8,10,33,35,41,43,45],j=[1,39],w=[1,40],O=[5,6,8,10,12,14,16,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],C=[10,16,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],S=[5,6,8,10,12,14,16,18,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],k={trace:function(){},yy:{},symbols_:{error:2,equation:3,expression:4,SIGN:5,EOF:6,additive:7,"+":8,multiplicative:9,"-":10,triglog:11,"*":12,negative:13,"/":14,trig:15,TRIG:16,trigfunc:17,"^":18,TRIGINV:19,logbase:20,ln:21,log:22,_:23,subscriptable:24,power:25,primitive:26,variable:27,VAR:28,CONST:29,INT:30,FLOAT:31,"{":32,"}":33,"(":34,")":35,function:36,FUNC:37,invocation:38,sqrt:39,"[":40,"]":41,abs:42,"|":43,"LEFT|":44,"RIGHT|":45,FRAC:46,$accept:0,$end:1},terminals_:{2:"error",5:"SIGN",6:"EOF",8:"+",10:"-",12:"*",14:"/",16:"TRIG",18:"^",19:"TRIGINV",21:"ln",22:"log",23:"_",28:"VAR",29:"CONST",30:"INT",31:"FLOAT",32:"{",33:"}",34:"(",35:")",37:"FUNC",39:"sqrt",40:"[",41:"]",42:"abs",43:"|",44:"LEFT|",45:"RIGHT|",46:"FRAC"},productions_:[0,[3,4],[3,2],[3,1],[4,1],[7,3],[7,3],[7,1],[9,2],[9,3],[9,3],[9,1],[13,2],[13,1],[15,1],[17,1],[17,3],[17,1],[20,1],[20,1],[20,3],[11,2],[11,2],[11,1],[25,3],[25,1],[27,1],[24,3],[24,1],[24,1],[24,1],[24,1],[24,3],[24,3],[36,1],[38,4],[38,4],[38,7],[38,4],[38,3],[38,3],[38,4],[26,1],[26,1],[26,7]],performAction:function(e,t,n,s,i,r,o){var a=r.length-1;switch(i){case 1:return new s.Eq(r[a-3],r[a-2],r[a-1]);case 2:return r[a-1];case 3:return new s.Add([]);case 4:case 7:case 11:case 13:case 15:case 20:case 23:case 25:case 42:case 43:this.$=r[a];break;case 5:this.$=s.Add.createOrAppend(r[a-2],r[a]);break;case 6:this.$=s.Add.createOrAppend(r[a-2],s.Mul.handleNegative(r[a],"subtract"));break;case 8:this.$=s.Mul.fold(s.Mul.createOrAppend(r[a-1],r[a]));break;case 9:this.$=s.Mul.fold(s.Mul.createOrAppend(r[a-2],r[a]));break;case 10:this.$=s.Mul.fold(s.Mul.handleDivide(r[a-2],r[a]));break;case 12:this.$=s.Mul.handleNegative(r[a]);break;case 14:case 17:this.$=[e];break;case 16:this.$=r[a-2].concat(r[a]);break;case 18:this.$=s.Log.natural();break;case 19:this.$=s.Log.common();break;case 21:this.$=s.Trig.create(r[a-1],r[a]);break;case 22:this.$=s.Log.create(r[a-1],r[a]);break;case 24:this.$=new s.Pow(r[a-2],r[a]);break;case 26:case 34:this.$=e;break;case 27:this.$=new s.Var(r[a-2],r[a]);break;case 28:this.$=new s.Var(r[a]);break;case 29:this.$=new s.Const(e.toLowerCase());break;case 30:this.$=s.Int.create(Number(e));break;case 31:this.$=s.Float.create(Number(e));break;case 32:this.$=r[a-1].completeParse();break;case 33:this.$=r[a-1].completeParse().addHint("parens");break;case 35:case 36:this.$=s.Pow.sqrt(r[a-1]);break;case 37:this.$=new s.Pow.nthroot(r[a-1],r[a-4]);break;case 38:case 39:case 40:this.$=new s.Abs(r[a-1]);break;case 41:this.$=new s.Func(r[a-3],r[a-1]);break;case 44:this.$=s.Mul.handleDivide(r[a-4],r[a-1])}},table:[{3:1,4:2,6:[1,3],7:4,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{1:[3]},{5:[1,34],6:[1,35]},{1:[2,3]},e([5,6],[2,4],{8:v,10:x}),e(y,[2,7],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:j,14:w,16:n,19:s,21:i,22:r,28:o,29:a,30:l,31:c,32:h,34:p,37:u,39:d,42:g,44:m,46:b}),e(O,[2,11]),{10:t,11:8,13:41,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},e(O,[2,13]),{10:t,11:8,13:42,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{10:t,11:8,13:43,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},e(O,[2,23]),e(C,[2,15],{18:[1,44]}),e(C,[2,17]),e(C,[2,18]),e(C,[2,19],{23:[1,45]}),e(O,[2,25],{18:[1,46]}),e([10,16,18,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],[2,14]),e(S,[2,42]),e(S,[2,43]),{32:[1,47]},e(S,[2,28],{23:[1,48]}),e(S,[2,29]),e(S,[2,30]),e(S,[2,31]),{7:49,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:50,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{32:[1,52],34:[1,51],40:[1,53]},{34:[1,54]},{7:55,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:56,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{34:[1,57]},e([5,6,8,10,12,14,16,18,19,21,22,23,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],[2,26]),{34:[2,34]},{4:58,7:4,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{1:[2,2]},{9:59,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{9:60,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},e(O,[2,8]),{10:t,11:8,13:61,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{10:t,11:8,13:62,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},e(O,[2,12]),e(O,[2,21]),e(O,[2,22]),{10:t,11:8,13:63,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{24:64,27:21,28:o,29:a,30:l,31:c,32:h,34:p},{10:t,11:8,13:65,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:66,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{24:67,27:21,28:o,29:a,30:l,31:c,32:h,34:p},{8:v,10:x,33:[1,68]},{8:v,10:x,35:[1,69]},{7:70,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:71,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:72,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:73,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{8:v,10:x,43:[1,74]},{8:v,10:x,45:[1,75]},{7:76,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{6:[1,77]},e(y,[2,5],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:j,14:w,16:n,19:s,21:i,22:r,28:o,29:a,30:l,31:c,32:h,34:p,37:u,39:d,42:g,44:m,46:b}),e(y,[2,6],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:j,14:w,16:n,19:s,21:i,22:r,28:o,29:a,30:l,31:c,32:h,34:p,37:u,39:d,42:g,44:m,46:b}),e(O,[2,9]),e(O,[2,10]),e(C,[2,16]),e(C,[2,20]),e(O,[2,24]),{8:v,10:x,33:[1,78]},e(S,[2,27]),e(S,[2,32]),e(S,[2,33]),{8:v,10:x,35:[1,79]},{8:v,10:x,33:[1,80]},{8:v,10:x,41:[1,81]},{8:v,10:x,35:[1,82]},e(S,[2,39]),e(S,[2,40]),{8:v,10:x,35:[1,83]},{1:[2,1]},{32:[1,84]},e(S,[2,35]),e(S,[2,36]),{32:[1,85]},e(S,[2,38]),e(S,[2,41]),{7:86,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:87,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{8:v,10:x,33:[1,88]},{8:v,10:x,33:[1,89]},e(S,[2,44]),e(S,[2,37])],defaultActions:{3:[2,3],33:[2,34],35:[2,2],77:[2,1]},parseError:function(e,t){if(!t.recoverable)throw new Error(e);this.trace(e)},parse:function(e){var t=this,n=[0],s=[null],i=[],r=this.table,o="",a=0,l=0,c=0,h=i.slice.call(arguments,1),p=Object.create(this.lexer),u={yy:{}};for(var d in this.yy)Object.prototype.hasOwnProperty.call(this.yy,d)&&(u.yy[d]=this.yy[d]);p.setInput(e,u.yy),u.yy.lexer=p,u.yy.parser=this,"undefined"==typeof p.yylloc&&(p.yylloc={});var g=p.yylloc;i.push(g);var f=p.options&&p.options.ranges;function m(){var e;return"number"!==typeof(e=p.lex()||1)&&(e=t.symbols_[e]||e),e}"function"===typeof u.yy.parseError?this.parseError=u.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var b,v,x,y,j,w,O,C,S,k={};;){if(x=n[n.length-1],this.defaultActions[x]?y=this.defaultActions[x]:(null!==b&&"undefined"!=typeof b||(b=m()),y=r[x]&&r[x][b]),"undefined"===typeof y||!y.length||!y[0]){var _="";for(w in S=[],r[x])this.terminals_[w]&&w>2&&S.push("'"+this.terminals_[w]+"'");_=p.showPosition?"Parse error on line "+(a+1)+":\n"+p.showPosition()+"\nExpecting "+S.join(", ")+", got '"+(this.terminals_[b]||b)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==b?"end of input":"'"+(this.terminals_[b]||b)+"'"),this.parseError(_,{text:p.match,token:this.terminals_[b]||b,line:p.yylineno,loc:g,expected:S})}if(y[0]instanceof Array&&y.length>1)throw new Error("Parse Error: multiple actions possible at state: "+x+", token: "+b);switch(y[0]){case 1:n.push(b),s.push(p.yytext),i.push(p.yylloc),n.push(y[1]),b=null,v?(b=v,v=null):(l=p.yyleng,o=p.yytext,a=p.yylineno,g=p.yylloc,c>0&&c--);break;case 2:if(O=this.productions_[y[1]][1],k.$=s[s.length-O],k._$={first_line:i[i.length-(O||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(O||1)].first_column,last_column:i[i.length-1].last_column},f&&(k._$.range=[i[i.length-(O||1)].range[0],i[i.length-1].range[1]]),"undefined"!==typeof(j=this.performAction.apply(k,[o,l,a,u.yy,y[1],s,i].concat(h))))return j;O&&(n=n.slice(0,-1*O*2),s=s.slice(0,-1*O),i=i.slice(0,-1*O)),n.push(this.productions_[y[1]][0]),s.push(k.$),i.push(k._$),C=r[n[n.length-2]][n[n.length-1]],n.push(C);break;case 3:return!0}}return!0}},_=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var s=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===s.length?this.yylloc.first_column:0)+s[s.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,s,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(s=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var r in i)this[r]=i[r];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,n,s;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),r=0;r<i.length;r++)if((n=this._input.match(this.rules[i[r]]))&&(!t||n[0].length>t[0].length)){if(t=n,s=r,this.options.backtrack_lexer){if(!1!==(e=this.test_match(n,i[r])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,i[s]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0},performAction:function(e,t,n,s){switch(n){case 0:case 1:case 2:break;case 3:return"INT";case 4:return"FLOAT";case 5:case 15:return"^";case 6:case 7:case 8:case 9:return"*";case 10:case 11:return"/";case 12:case 13:return"-";case 14:return"+";case 16:case 18:return"(";case 17:case 19:return")";case 20:return"[";case 21:return"]";case 22:case 24:return"{";case 23:case 25:return"}";case 26:return"_";case 27:return"|";case 28:return"LEFT|";case 29:return"RIGHT|";case 30:return"!";case 31:return"SIGN";case 32:case 34:case 40:return t.yytext="<=","SIGN";case 33:case 35:case 41:return t.yytext=">=","SIGN";case 36:case 37:case 38:case 39:return t.yytext="<>","SIGN";case 42:case 43:return"FRAC";case 44:return"sqrt";case 45:return"abs";case 46:return"ln";case 47:return"log";case 48:case 49:case 50:case 51:return"TRIG";case 52:return t.yytext="sin","TRIG";case 53:return t.yytext="cos","TRIG";case 54:return t.yytext="tan","TRIG";case 55:return t.yytext="csc","TRIG";case 56:return t.yytext="sec","TRIG";case 57:return t.yytext="cot","TRIG";case 58:return t.yytext="arcsin","TRIG";case 59:return t.yytext="arccos","TRIG";case 60:return t.yytext="arctan","TRIG";case 61:return t.yytext="arccsc","TRIG";case 62:return t.yytext="arcsec","TRIG";case 63:return t.yytext="arccot","TRIG";case 64:case 65:return"TRIGINV";case 66:return t.yytext="sinh","TRIG";case 67:return t.yytext="cosh","TRIG";case 68:case 71:return t.yytext="tanh","TRIG";case 69:return t.yytext="csch","TRIG";case 70:return t.yytext="sech","TRIG";case 72:return"CONST";case 73:case 74:return t.yytext="pi","CONST";case 75:case 78:return"VAR";case 76:case 77:return t.yytext="theta","VAR";case 79:case 80:return t.yytext="phi","VAR";case 81:return e.symbolLexer(t.yytext);case 82:return"EOF";case 83:return"INVALID";case 84:console.log(t.yytext)}},rules:[/^(?:\s+)/,/^(?:\\space)/,/^(?:\\ )/,/^(?:[0-9]+\.?)/,/^(?:([0-9]+)?\.[0-9]+)/,/^(?:\*\*)/,/^(?:\*)/,/^(?:\\cdot|\xb7)/,/^(?:\\times|\xd7)/,/^(?:\\ast)/,/^(?:\/)/,/^(?:\\div|\xf7)/,/^(?:-)/,/^(?:\u2212)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\\left\()/,/^(?:\\right\))/,/^(?:\[)/,/^(?:\])/,/^(?:\{)/,/^(?:\})/,/^(?:\\left\{)/,/^(?:\\right\})/,/^(?:_)/,/^(?:\|)/,/^(?:\\left\|)/,/^(?:\\right\|)/,/^(?:\!)/,/^(?:<=|>=|<>|<|>|=)/,/^(?:\\le)/,/^(?:\\ge)/,/^(?:\\leq)/,/^(?:\\geq)/,/^(?:=\/=)/,/^(?:\\ne)/,/^(?:\\neq)/,/^(?:\u2260)/,/^(?:\u2264)/,/^(?:\u2265)/,/^(?:\\frac)/,/^(?:\\dfrac)/,/^(?:sqrt|\\sqrt)/,/^(?:abs|\\abs)/,/^(?:ln|\\ln)/,/^(?:log|\\log)/,/^(?:sin|cos|tan)/,/^(?:csc|sec|cot)/,/^(?:sinh|cosh|tanh)/,/^(?:csch|sech|coth)/,/^(?:\\sin)/,/^(?:\\cos)/,/^(?:\\tan)/,/^(?:\\csc)/,/^(?:\\sec)/,/^(?:\\cot)/,/^(?:\\arcsin)/,/^(?:\\arccos)/,/^(?:\\arctan)/,/^(?:\\arccsc)/,/^(?:\\arcsec)/,/^(?:\\arccot)/,/^(?:arcsin|arccos|arctan)/,/^(?:arccsc|arcsec|arccot)/,/^(?:\\sinh)/,/^(?:\\cosh)/,/^(?:\\tanh)/,/^(?:\\csch)/,/^(?:\\sech)/,/^(?:\\coth)/,/^(?:pi)/,/^(?:\u03c0)/,/^(?:\\pi)/,/^(?:theta)/,/^(?:\u03b8)/,/^(?:\\theta)/,/^(?:phi)/,/^(?:\u03c6)/,/^(?:\\phi)/,/^(?:[a-zA-Z])/,/^(?:$)/,/^(?:.)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0}}};return e}();function T(){this.yy={}}return k.lexer=_,T.prototype=k,k.Parser=T,new T}();e.parser=t}(H),function(e){var t=function(){var e=function(e,t,n,s){for(n=n||{},s=e.length;s--;n[e[s]]=t);return n},t=[1,11],n=[1,9],s=[8,17],i=[6,11],r=[6,11,13,17],o={trace:function(){},yy:{},symbols_:{error:2,unitvalue:3,magnitude:4,unit:5,EOF:6,float:7,POW:8,int:9,multatoms:10,DIV:11,expatom:12,MUL:13,atom:14,"^":15,nat:16,ATOM:17,FLOAT:18,NAT:19,NEG:20,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",8:"POW",11:"DIV",13:"MUL",15:"^",17:"ATOM",18:"FLOAT",19:"NAT",20:"NEG"},productions_:[0,[3,3],[3,2],[4,3],[4,1],[5,3],[5,1],[10,3],[10,2],[10,1],[12,3],[12,1],[14,1],[7,1],[7,1],[16,1],[9,2],[9,1]],performAction:function(e,t,n,s,i,r,o){var a=r.length-1;switch(i){case 1:return{type:"unitMagnitude",magnitude:r[a-2],unit:r[a-1]};case 2:return{type:"unitStandalone",unit:r[a-1]};case 3:this.$=r[a-2]+"e"+r[a];break;case 4:case 13:case 14:case 15:case 17:this.$=r[a];break;case 5:this.$={num:r[a-2],denom:r[a]};break;case 6:this.$={num:r[a],denom:null};break;case 7:this.$=[r[a-2]].concat(r[a]);break;case 8:this.$=[r[a-1]].concat(r[a]);break;case 9:this.$=[r[a]];break;case 10:this.$={name:r[a-2],pow:r[a]};break;case 11:this.$={name:r[a],pow:1};break;case 12:this.$=e;break;case 16:this.$="-"+r[a]}},table:[{3:1,4:2,5:3,7:4,10:5,12:8,14:10,16:7,17:t,18:[1,6],19:n},{1:[3]},{5:12,10:5,12:8,14:10,17:t},{6:[1,13]},{8:[1,14],17:[2,4]},{6:[2,6],11:[1,15]},e(s,[2,13]),e(s,[2,14]),e(i,[2,9],{12:8,14:10,10:17,13:[1,16],17:t}),e([6,8,11,13,17],[2,15]),e(r,[2,11],{15:[1,18]}),e([6,11,13,15,17],[2,12]),{6:[1,19]},{1:[2,2]},{9:20,19:[1,22],20:[1,21]},{10:23,12:8,14:10,17:t},{10:24,12:8,14:10,17:t},e(i,[2,8]),{16:25,19:n},{1:[2,1]},{17:[2,3]},{19:[1,26]},{17:[2,17]},{6:[2,5]},e(i,[2,7]),e(r,[2,10]),{17:[2,16]}],defaultActions:{13:[2,2],19:[2,1],20:[2,3],22:[2,17],23:[2,5],26:[2,16]},parseError:function(e,t){if(!t.recoverable)throw new Error(e);this.trace(e)},parse:function(e){var t=this,n=[0],s=[null],i=[],r=this.table,o="",a=0,l=0,c=0,h=i.slice.call(arguments,1),p=Object.create(this.lexer),u={yy:{}};for(var d in this.yy)Object.prototype.hasOwnProperty.call(this.yy,d)&&(u.yy[d]=this.yy[d]);p.setInput(e,u.yy),u.yy.lexer=p,u.yy.parser=this,"undefined"==typeof p.yylloc&&(p.yylloc={});var g=p.yylloc;i.push(g);var f=p.options&&p.options.ranges;function m(){var e;return"number"!==typeof(e=p.lex()||1)&&(e=t.symbols_[e]||e),e}"function"===typeof u.yy.parseError?this.parseError=u.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var b,v,x,y,j,w,O,C,S,k={};;){if(x=n[n.length-1],this.defaultActions[x]?y=this.defaultActions[x]:(null!==b&&"undefined"!=typeof b||(b=m()),y=r[x]&&r[x][b]),"undefined"===typeof y||!y.length||!y[0]){var _="";for(w in S=[],r[x])this.terminals_[w]&&w>2&&S.push("'"+this.terminals_[w]+"'");_=p.showPosition?"Parse error on line "+(a+1)+":\n"+p.showPosition()+"\nExpecting "+S.join(", ")+", got '"+(this.terminals_[b]||b)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==b?"end of input":"'"+(this.terminals_[b]||b)+"'"),this.parseError(_,{text:p.match,token:this.terminals_[b]||b,line:p.yylineno,loc:g,expected:S})}if(y[0]instanceof Array&&y.length>1)throw new Error("Parse Error: multiple actions possible at state: "+x+", token: "+b);switch(y[0]){case 1:n.push(b),s.push(p.yytext),i.push(p.yylloc),n.push(y[1]),b=null,v?(b=v,v=null):(l=p.yyleng,o=p.yytext,a=p.yylineno,g=p.yylloc,c>0&&c--);break;case 2:if(O=this.productions_[y[1]][1],k.$=s[s.length-O],k._$={first_line:i[i.length-(O||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(O||1)].first_column,last_column:i[i.length-1].last_column},f&&(k._$.range=[i[i.length-(O||1)].range[0],i[i.length-1].range[1]]),"undefined"!==typeof(j=this.performAction.apply(k,[o,l,a,u.yy,y[1],s,i].concat(h))))return j;O&&(n=n.slice(0,-1*O*2),s=s.slice(0,-1*O),i=i.slice(0,-1*O)),n.push(this.productions_[y[1]][0]),s.push(k.$),i.push(k._$),C=r[n[n.length-2]][n[n.length-1]],n.push(C);break;case 3:return!0}}return!0}},a=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var s=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===s.length?this.yylloc.first_column:0)+s[s.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,s,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(s=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var r in i)this[r]=i[r];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,n,s;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),r=0;r<i.length;r++)if((n=this._input.match(this.rules[i[r]]))&&(!t||n[0].length>t[0].length)){if(t=n,s=r,this.options.backtrack_lexer){if(!1!==(e=this.test_match(n,i[r])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,i[s]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,n,s){switch(n){case 0:return 11;case 1:return"(";case 2:return")";case 3:return 8;case 4:return 15;case 5:return 13;case 6:return 18;case 7:return 19;case 8:return 20;case 9:case 10:case 11:return 17;case 12:break;case 13:return 6}},rules:[/^(?:\/)/,/^(?:\()/,/^(?:\))/,/^(?:(\*|x|\u00d7|\u2219|\u22c5|\u00b7)\s*10\s*\^)/,/^(?:\^)/,/^(?:\*)/,/^(?:[0-9]+\.[0-9]+)/,/^(?:[0-9]+)/,/^(?:-)/,/^(?:\u00b0( ?)[cCfF])/,/^(?:fl\.? oz\.?)/,/^(?:[\u00b5]?([A-Za-z-]+|[\u2103\u2109\u212b]))/,/^(?:\s+)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return e}();function l(){this.yy={}}return o.lexer=a,l.prototype=o,o.Parser=l,new l}();e.unitParser=t}(H),function(e){var t=function(){throw new Error("Abstract method - must override for expr: "+this.print())},n=function(e){throw new Error(e)},s=function(e){return e!==e},i=function(e,t){var n=t-e;return Math.random()*n+e};function r(){}function o(){}function a(){this.terms=1===arguments.length?arguments[0]:_.toArray(arguments)}function l(){this.terms=1===arguments.length?arguments[0]:_.toArray(arguments)}function c(e,t){this.base=e,this.exp=t}function h(e,t){this.base=e,this.power=t}function p(e,t){this.type=e,this.arg=t}function u(e){this.arg=e}function d(e,t,n){this.left=e,this.type=t,this.right=n}function g(){}function f(e,t){this.symbol=e,this.arg=t}function m(e,t){this.symbol=e,this.subscript=t}function b(e){this.symbol=e}function v(){}function x(e,t){var n=e,s=t;s<0&&(n=-n,s=-s),this.n=n,this.d=s}function y(e){this.n=e}function j(e){this.n=e}_.extend(r.prototype,{func:t,args:t,construct:function(e){var t=new this.func;return this.func.apply(t,e),t},recurse:function(e){var t=Array.prototype.slice.call(arguments,1),n=_.map(this.args(),(function(n){return _.isString(n)?n:n[e].apply(n,t)}));return this.construct(n)},eval:t,codegen:t,compile:function(){var e=this.codegen();try{return new Function("vars","return "+e+";")}catch(t){throw new Error("Function did not compile: "+e)}},print:t,tex:t,asTex:function(e){e=e||{},_.defaults(e,{display:!0,dynamic:!0,times:!1});var t=this.tex();return e.display&&(t="\\displaystyle "+t),e.dynamic&&(t=(t=t.replace(/\(/g,"\\left(")).replace(/\)/g,"\\right)")),e.times&&(t=t.replace(/\\cdot/g,"\\times")),t},name:function(){return this.func.name?this.func.name:this.func.toString().match(/^function\s*([^\s(]+)/)[1]},repr:function(){return this.name()+"("+_.map(this.args(),(function(e){return _.isString(e)?e:e.repr()})).join(",")+")"},strip:function(){return this.recurse("strip")},normalize:function(){return this.recurse("normalize")},expand:function(){return this.recurse("expand")},factor:function(e){return this.recurse("factor",e)},collect:function(e){return this.recurse("collect",e)},equals:function(e){return this.normalize().print()===e.normalize().print()},simplify:function(e){e=_.extend({once:!1},e);var t=this.factor(e),n=t.collect(e);t.equals(n)&&(n=this.collect(e));var s=n.expand(e),i=s.collect(e);s.equals(i)&&(i=n.collect(e));var r=i;return e.once||this.equals(r)?r:r.simplify(e)},isSimplified:function(){return this.equals(this.simplify())},exprArgs:function(){return _.filter(this.args(),(function(e){return e instanceof r}))},getVars:function(e){return _.uniq(_.flatten(_.invoke(this.exprArgs(),"getVars",e))).sort()},getConsts:function(){return _.uniq(_.flatten(_.invoke(this.exprArgs(),"getConsts"))).sort()},getUnits:function(){return _.flatten(_.invoke(this.exprArgs(),"getUnits"))},is:function(e){return this instanceof e},has:function(e){return this instanceof e||_.any(this.exprArgs(),(function(t){return t.has(e)}))},raiseToThe:function(e){return new c(this,e)},isSubtract:function(){return!1},isDivide:function(){return!1},isRoot:function(){return!1},needsExplicitMul:function(){return this.args()[0].needsExplicitMul()},sameVars:function(e){var t=this.getVars(),n=e.getVars(),s=function(e,t){return!_.difference(e,t).length},i=function(e){return _.uniq(_.invoke(e,"toLowerCase")).sort()};return{equal:s(t,n),equalIgnoringCase:s(i(t),i(n))}},compare:function(e){if(e instanceof d)return!1;var t=_.union(this.getVars(!0),e.getVars(!0)),n=function(e,t){var n=function(e,t){return Math.abs(e)<1||Math.abs(t)<1?Math.abs(e-t):Math.abs(1-e/t)}(e,t);return e===t||s(e)&&s(t)||n<Math.pow(10,-9)};if(!t.length&&!this.has(O)&&!e.has(O))return n(this.eval(),e.eval());var r=this.collect(),o=e.collect(),a=this.getUnits(),l=e.getUnits();if(!_.isEqual(a,l))return!1;for(var c=0;c<12;c++){var h,p={},u=Math.pow(10,1+Math.floor(3*c/12)),g=c%2===0;if(_.each(t,(function(e){p[e]=g?i(-u,u):_.random(-u,u)})),r.has(f)||o.has(f)||r.has(O)||o.has(O)){var m=r.partialEval(p),b=o.partialEval(p);h=m.simplify().equals(b.simplify())}else{h=n(m=r.eval(p),b=o.eval(p))}if(!h)return!1}return!0},partialEval:function(e){return this instanceof O?this:this.has(f)?this instanceof f?new f(this.symbol,this.arg.partialEval(e)):this.recurse("partialEval",e):new j(this.eval(e).toFixed(9)).collect()},sameForm:function(e){return this.strip().equals(e.strip())},findGCD:function(e){return this.equals(e)?e:v.One},getDenominator:function(){return v.One},asMul:function(){return new l(v.One,this)},isPositive:t,isNegative:function(){return!1},asPositiveFactor:function(){return this.isPositive()?this:v.One},addHint:function(e){if(!e)return this;var t=this.construct(this.args());return t.hints=_.clone(this.hints),t.hints[e]=!0,t},hints:{parens:!1},asExpr:function(){return this},completeParse:function(){return this.recurse("completeParse")},abs:t,negate:function(){return new l(v.Neg,this)}}),o.prototype=new r,_.extend(o.prototype,{args:function(){return this.terms},normalize:function(){var e=_.sortBy(_.invoke(this.terms,"normalize"),(function(e){return e.print()}));return new this.func(e)},expand:function(){return this.recurse("expand").flatten()},partition:function(){var e=_.groupBy(this.terms,(function(e){return e instanceof v})),t=e[!0]||[],n=e[!1]||[];return[new this.func(t),new this.func(n)]},flatten:function(){var e=this,t=_.reject(this.terms,(function(t){return t.equals(e.identity)}));if(0===t.length)return e.identity;if(1===t.length)return t[0];var n=_.groupBy(t,(function(t){return t instanceof e.func})),s=n[!0]||[],i=(n[!1]||[]).concat(_.flatten(_.pluck(s,"terms"),!0));return new e.func(i)},identity:void 0,reduce:t,isPositive:function(){var e=_.invoke(this.terms,"collect");return _.all(_.invoke(e,"isPositive"))},replace:function(e,t){var n;n=e instanceof r?_.indexOf(this.terms,e):e;var s=[];_.isArray(t)?s=t:t&&(s=[t]);var i=this.terms.slice(0,n).concat(s).concat(this.terms.slice(n+1));return new this.func(i)},remove:function(e){return this.replace(e)},getDenominator:function(){return new l(_.invoke(this.terms,"getDenominator")).flatten()}}),a.prototype=new o,_.extend(a.prototype,{func:a,eval:function(e,t){return _.reduce(this.terms,(function(n,s){return n+s.eval(e,t)}),0)},codegen:function(){return _.map(this.terms,(function(e){return"("+e.codegen()+")"})).join(" + ")||"0"},print:function(){return _.invoke(this.terms,"print").join("+")},tex:function(){var e="";return _.each(this.terms,(function(t){!e||t.isSubtract()?e+=t.tex():e+="+"+t.tex()})),e},collect:function(e){var t=_.invoke(this.terms,"collect",e),n=[];_.each(t,(function(t){if(t instanceof l){var s=t.partition();n.push([s[1].flatten(),s[0].reduce(e)])}else t instanceof v?n.push([v.One,t]):n.push([t,v.One])}));var s=_.groupBy(n,(function(e){return e[0].normalize().print()})),i=_.compact(_.map(s,(function(t){var n=t[0][0];return new l(new a(_.zip.apply(_,t)[1]).reduce(e),n).collect(e)})));return new a(i).flatten()},factor:function(e){e=_.extend({keepNegative:!1},e);var t,n=_.invoke(this.terms,"collect");t=n[0]instanceof l?n[0].terms:[n[0]],_.each(_.rest(this.terms),(function(e){t=_.map(t,(function(t){return e.findGCD(t)}))})),!e.keepNegative&&this.isNegative()&&t.push(v.Neg),t=new l(t).flatten().collect();var s=_.map(n,(function(e){return l.handleDivide(e,t).simplify()}));return s=new a(s).flatten(),l.createOrAppend(t,s).flatten()},reduce:function(e){return _.reduce(this.terms,(function(t,n){return t.add(n,e)}),this.identity)},needsExplicitMul:function(){return!1},isNegative:function(){var e=_.invoke(this.terms,"collect");return _.all(_.invoke(e,"isNegative"))},negate:function(){return new a(_.invoke(this.terms,"negate"))}}),l.prototype=new o,_.extend(l.prototype,{func:l,eval:function(e,t){return _.reduce(this.terms,(function(n,s){return n*s.eval(e,t)}),1)},codegen:function(){return _.map(this.terms,(function(e){return"("+e.codegen()+")"})).join(" * ")||"0"},print:function(){return _.map(this.terms,(function(e){return e instanceof a?"("+e.print()+")":e.print()})).join("*")},getUnits:function(){var e=_.chain(this.terms).map((function(e){return e.getUnits()})).flatten().value();return e.sort((function(e,t){return e.unit<t.unit})),e},tex:function(){for(var e,t=" \\cdot ",n=_.groupBy(this.terms,(function(e){return e.isDivide()?"inverse":e instanceof v?"number":"other"})),s=n.inverse||[],i=n.number||[],r=n.other||[],o="",h=0;h<i.length;h++){if(i[h]instanceof x&&!(i[h]instanceof y)&&r.length>0&&s.length>0){var p=i.slice();p.splice(h,1);var u=p.concat(s).concat(r);return i[h].tex()+new l(u).tex()}}if(0===(i=_.compact(_.map(i,(function(e){var t=e instanceof x&&!(e instanceof y),n=!e.hints.fraction||s.length>0;if(t&&n){s.push(new c(new y(e.d),v.Div));var i=new y(e.n);return i.hints=e.hints,_.any(e.hints)?i:null}return e})))).length&&1===r.length)e=r[0].tex();else{var d="";_.each(i,(function(e){e.hints.subtract&&e.hints.entered?(o+="-",d+=(d?t:"")+e.abs().tex()):e instanceof y&&-1===e.n&&(e.hints.negate||e.hints.subtract)?o+="-":d+=(d?t:"")+e.tex()})),_.each(r,(function(e){e.needsExplicitMul()?d+=(d?t:"")+e.tex():d+=e instanceof a?"("+e.tex()+")":e.tex()})),e=d||"1"}if(s.length){var g=new l(_.invoke(s,"asDivide")).flatten().tex();return o+"\\frac{"+e+"}{"+g+"}"}return o+e},strip:function(){return new l(_.map(this.terms,(function(e){return e instanceof v?e.abs():e.strip()}))).flatten()},expand:function(){var e=function(e){return e instanceof a},t=function(e){return e instanceof c&&e.exp.isNegative()},n=this.recurse("expand").flatten(),s=_.any(n.terms,e),i=_.any(n.terms,(function(n){return t(n)&&e(n.base)}));if(!s&&!i)return n;var r=_.groupBy(n.terms,t),o=r[!1]||[],h=r[!0]||[];if(s){var p=_.groupBy(o,e),u=p[!0]||[],d=p[!1]||[],g=_.reduce(u,(function(e,t){return _.reduce(e,(function(e,n){return e.concat(_.map(t.terms,(function(e){return n.concat(e)})))}),[])}),[[]]);o=[new a(_.map(g,(function(e){return new l(d.concat(e)).flatten()})))]}i&&(h=[new c(new l(_.invoke(h,"getDenominator")).flatten().expand(),v.Div)]);return new l(o.concat(h)).flatten()},factor:function(e){var t=this.recurse("factor",e).flatten();if(!(t instanceof l))return t;var n=_.groupBy(t.terms,(function(e){return e instanceof x})),s=_.reduce(n[!0],(function(e,t){return{n:e.n*t.n,d:e.d*t.d}}),{n:1,d:1});return s=1===s.d?new y(s.n):new x(s.n,s.d),new l((n[!1]||[]).concat(s)).flatten()},collect:function(e){var t=this.recurse("collect",e).partition(),n=t[0].reduce(e);if(0===n.eval())return v.Zero;var s=t[1].flatten();if(!(s instanceof l))return new l(n,s).flatten();s=s.terms;var i=[];_.each(s,(function(e){e instanceof c?i.push([e.base,e.exp]):i.push([e,v.One])}));var r=_.groupBy(i,(function(e){return e[0].normalize().print()})),o=_.compact(_.map(r,(function(t){var n=t[0][0],s=new a(_.zip.apply(_,t)[1]).collect(e);return s instanceof v&&0===s.eval()?null:[n,s]}))),u=(i=_.groupBy(o,(function(e){return e[0]instanceof p&&e[0].isBasic()?"trig":e[0]instanceof h?"log":"expr"}))).trig||[],d=i.log||[],g=i.expr||[];if(u.length>1){var f=_.groupBy(u,(function(e){return e[0].arg.normalize().print()}));u=[],_.each(f,(function(t){var n=t[0][0].arg,s={sin:v.Zero,cos:v.Zero};_.each(t,(function(e){s[e[0].type]=e[1]})),l.handleNegative(s.sin).collect(e).equals(s.cos)&&(s=s.cos.isNegative()?{tan:s.sin}:{cot:s.cos}),_.each(s,(function(e,t){u.push([new p(t,n),e])}))}))}if(d.length>1){var m=_.groupBy(d,(function(e){return e[0].base.normalize().print()}));d=[],_.each(m,(function(t){2===t.length&&l.handleNegative(t[0][1]).collect(e).equals(t[1][1])?t[0][1].isNegative()?d.push([new h(t[0][0].power,t[1][0].power),t[1][1]]):d.push([new h(t[1][0].power,t[0][0].power),t[0][1]]):d=d.concat(t)}))}i=u.concat(d).concat(g);var b=_.map(i,(function(t){return new c(t[0],t[1]).collect(e)}));return new l([n].concat(b)).flatten()},isSubtract:function(){return _.any(this.terms,(function(e){return e instanceof v&&e.hints.subtract}))},factorIn:function(e){var t=this.partition()[0].terms,n=t.length&&_.all(t,(function(e){return e.n>0}));if(n){var s=t[0].negate();return s.hints=t[0].hints,this.replace(t[0],s.addHint(e))}return new l([v.negativeOne(e)].concat(this.terms))},factorOut:function(){var e=!1,t=_.compact(_.map(this.terms,(function(t,n,s){return!e&&t instanceof v&&t.hints.divide?(e=!0,-1!==t.n?t.negate():null):t})));return 1===t.length?t[0]:new l(t)},reduce:function(e){return _.reduce(this.terms,(function(t,n){return t.mul(n,e)}),this.identity)},findGCD:function(e){return new l(_.invoke(this.terms,"findGCD",e)).flatten()},asMul:function(){return this},asPositiveFactor:function(){return this.isPositive()?this:new l(_.invoke(this.collect().terms,"asPositiveFactor")).flatten()},isNegative:function(){return _.any(_.invoke(this.collect().terms,"isNegative"))},fold:function(){return l.fold(this)},negate:function(){var e=function(e){return e instanceof v};if(_.any(this.terms,e)){var t=_.find(this.terms,e);return this.replace(t,t.negate())}return new l([v.Neg].concat(this.terms))}}),_.each([a,l],(function(e){_.extend(e,{createOrAppend:function(t,n){return t instanceof e?new e(t.terms.concat(n)):new e(t,n)}})})),_.extend(l,{handleNegative:function(e,t){if(e instanceof v&&e.n>0){var n=e.negate();return n.hints=e.hints,n.addHint(t)}return e instanceof l?e.factorIn(t):new l(v.negativeOne(t),e)},handleDivide:function(e,t){if(t instanceof l){var n=l.handleDivide(e,t.terms[0]),s=new l(_.rest(t.terms)).flatten();return l.handleDivide(n,s)}var i=function(e){return e instanceof y};if(i(t)&&e instanceof l&&_.any(e.terms,i)){var r=e.terms.slice().reverse(),o=_.find(r,(function(e){return e instanceof x}));if(!i(o))return new l(e.terms.concat([new x(1,t.n).addHint("fraction")]));var a=new x(o.n,t.n);return a.hints=o.hints,o===r[0]&&(a=a.addHint("fraction")),o.n<0&&t.n<0?(a.d=-a.d,e.replace(o,[v.Neg,a])):e.replace(o,a)}var h=function(e,t){if(t instanceof y){if(e instanceof y)return e.n<0&&t.n<0?[v.Neg,new x(e.n,-t.n).addHint("fraction")]:[new x(e.n,t.n).addHint("fraction")];var n=new x(1,t.eval());return t.eval()<0?[e,n.addHint("negate")]:[e,n]}var s;if(t instanceof p&&t.exp){var i=t.exp;t.exp=void 0,t=new c(t,i)}return s=t instanceof c?new c(t.base,l.handleNegative(t.exp,"divide")):new c(t,v.Div),e instanceof y&&1===e.n?[s]:[e,s]};if(e instanceof l){var u=h(_.last(e.terms),t);return new l(_.initial(e.terms).concat(u))}return new l(u=h(e,t)).flatten()},fold:function(e){if(e instanceof l){var t=_.find(_.initial(e.terms),(function(e){return(e instanceof p||e instanceof h)&&e.hints.open})),n=_.indexOf(e.terms,t);if(t){var s,i=_.last(e.terms);if(!(t.hints.parens||i.hints.parens||i.has(p)||i.has(h)))return s=t instanceof p?p.create([t.type,t.exp],l.createOrAppend(t.arg,i).fold()):h.create(t.base,l.createOrAppend(t.power,i).fold()),0===n?s:new l(e.terms.slice(0,n).concat(s)).fold();t.hints.open=!1}var r=e.partition()[0].terms,o=function(e){return e.n>0},a=function(e){return-1===e.n&&e.hints.negate};if(r.length>1&&_.some(r,a)&&_.some(r,o)&&_.every(r,(function(e){return o(e)||a(e)}))){var c=_.indexOf(e.terms,_.find(e.terms,a)),u=_.indexOf(e.terms,_.find(e.terms,o));if(c<u)return e.replace(u,e.terms[u].negate()).remove(c)}}return e}}),c.prototype=new r,_.extend(c.prototype,{func:c,args:function(){return[this.base,this.exp]},eval:function(e,t){var n=this.base.eval(e,t),s=this.exp.eval(e,t);if(n<0){var i=this.exp.simplify();if(i instanceof j){var r=i.n,o=(r-r.toFixed()).toString().length-2,a=Math.pow(10,o);i=new x(r*a,a).simplify()}if(i instanceof x)if(Math.abs(i.d)%2===1)return(Math.abs(i.n)%2===1?-1:1)*Math.pow(-1*n,s)}return Math.pow(n,s)},getUnits:function(){return this.base.getUnits().map(function(e){return{unit:e.unit,pow:e.pow*this.exp.n}}.bind(this))},codegen:function(){return"Math.pow("+this.base.codegen()+", "+this.exp.codegen()+")"},print:function(){var e=this.base.print();return(this.base instanceof o||this.base instanceof c)&&(e="("+e+")"),e+"^("+this.exp.print()+")"},tex:function(){if(this.isDivide())return"\\frac{1}{"+this.asDivide().tex()+"}";if(this.isRoot())return 1!==this.exp.n&&n("Node marked with hint 'root' does not have exponent of form 1/x."),2===this.exp.d?"\\sqrt{"+this.base.tex()+"}":"\\sqrt["+this.exp.d+"]{"+this.base.tex()+"}";if(this.base instanceof p&&!this.base.isInverse()&&this.exp instanceof v&&this.exp.isSimple()&&this.exp.eval()>=0){var e=this.base.tex({split:!0});return e[0]+"^{"+this.exp.tex()+"}"+e[1]}var t=this.base.tex();return this.base instanceof o||this.base instanceof c||this.base instanceof v&&!this.base.isSimple()?t="("+t+")":(this.base instanceof p||this.base instanceof h)&&(t="["+t+"]"),t+"^{"+this.exp.tex()+"}"},needsExplicitMul:function(){return!this.isRoot()&&this.base.needsExplicitMul()},expand:function(){var e=this.recurse("expand");if(e.base instanceof l)return new l(_.map(e.base.terms,(function(t){return new c(t,e.exp)}))).expand();if(e.base instanceof a&&e.exp instanceof y&&e.exp.abs().eval()>1){for(var t=e.exp.eval()>0,n=e.exp.abs().eval(),s=function(e){return t?e:new c(e,v.Div)},i={1:e.base},r=2;r<=n;r*=2){var o=new l(i[r/2],i[r/2]);i[r]=o.expand().collect()}if(_.has(i,n))return s(i[n]);var h=_.map(n.toString(2).split(""),(function(e,t,n){return Number(e)*Math.pow(2,n.length-t-1)}));return h=_.without(h,0),s(o=new l(_.pick(i,h)).expand().collect())}return e.exp instanceof a?new l(_.map(e.exp.terms,(function(t){return new c(e.base,t).expand()}))).expand():e},factor:function(){var e=this.recurse("factor");return e.base instanceof l?new l(_.map(e.base.terms,(function(t){return t instanceof y&&e.exp.equals(v.Div)?new x(1,t.n):new c(t,e.exp)}))):e},collect:function(e){if(this.base instanceof c)return new c(this.base.base,i=l.createOrAppend(this.base.exp,this.exp)).collect(e);var t=this.recurse("collect",e),n=function(e){return e instanceof h&&e.base.equals(t.base)};if(t.exp instanceof v&&0===t.exp.eval())return v.One;if(t.exp instanceof v&&1===t.exp.eval())return t.base;if(n(t.exp))return t.exp.power;if(t.exp instanceof l&&_.any(t.exp.terms,n)){var s=_.find(t.exp.terms,n);return new c(s.power,i=t.exp.remove(s).flatten()).collect(e)}if(t.base instanceof v&&t.exp instanceof v){if(e&&e.preciseFloats){var i=t.exp.asRational(),r=t.base.getDecimalPlaces();if(new c(t.base,new x(1,i.d)).collect().getDecimalPlaces()>r){var o=new c(t.base,new y(i.n)).collect();return new c(o,new x(1,i.d))}}return t.base.raiseToThe(t.exp,e)}return t},isDivide:function(){var e=function(e){return e instanceof v&&e.hints.divide};return e(this.exp)||this.exp instanceof l&&_.any(this.exp.terms,e)},asDivide:function(){if(this.exp instanceof v){if(-1===this.exp.eval())return this.base;var e=this.exp.negate();return e.hints=_.clone(this.exp.hints),e.hints.divide=!1,new c(this.base,e)}if(this.exp instanceof l)return new c(this.base,this.exp.factorOut());n("called asDivide() on an Expr that wasn't a Num or Mul")},isRoot:function(){return this.exp instanceof x&&this.exp.hints.root},isSquaredTrig:function(){return this.base instanceof p&&!this.base.isInverse()&&this.exp instanceof v&&2===this.exp.eval()},getDenominator:function(){if(this.exp instanceof v&&-1===this.exp.eval())return l.createOrAppend(this.base,this.base.getDenominator()).flatten();if(this.exp.isNegative()){var e=new c(this.base,l.handleNegative(this.exp).collect());return l.createOrAppend(e,e.collect().getDenominator()).flatten()}return this.base instanceof v?new c(this.base.getDenominator(),this.exp).collect():v.One},findGCD:function(e){var t,n;if(e instanceof c?(t=e.base,n=e.exp):(t=e,n=v.One),this.base.equals(t)){if(this.exp.equals(n))return this;if(this.exp instanceof v&&n instanceof v)return new c(this.base,v.min(this.exp,n)).collect();if(this.exp instanceof v||n instanceof v)return v.One;var s=this.exp.asMul().partition(),i=n.asMul().partition();if(s[1].equals(i[1]))return new c(t,new l(v.min(s[0].reduce(),i[0].reduce()),s[1].flatten()).flatten()).collect()}return v.One},isPositive:function(){if(this.base.isPositive())return!0;var e=this.exp.simplify();return e instanceof y&&e.eval()%2===0},asPositiveFactor:function(){if(this.isPositive())return this;var e=this.exp.simplify();if(e instanceof y){var t=e.eval();if(t>2)return new c(this.base,new y(t-1));if(t<-2)return new c(this.base,new y(t+1))}return v.One}}),_.extend(c,{sqrt:function(e){return new c(e,v.Sqrt)},nthroot:function(e,t){return new c(e,l.fold(l.handleDivide(new y(1),t)).addHint("root"))}}),h.prototype=new r,_.extend(h.prototype,{func:h,args:function(){return[this.base,this.power]},eval:function(e,t){return Math.log(this.power.eval(e,t))/Math.log(this.base.eval(e,t))},codegen:function(){return"(Math.log("+this.power.codegen()+") / Math.log("+this.base.codegen()+"))"},print:function(){var e="("+this.power.print()+")";return this.isNatural()?"ln"+e:"log_("+this.base.print()+") "+e},tex:function(){var e="("+this.power.tex()+")";return this.isNatural()?"\\ln"+e:"\\log_{"+this.base.tex()+"}"+e},collect:function(e){var t=this.recurse("collect",e);return t.power instanceof v&&1===t.power.eval()?v.Zero:t.base.equals(t.power)?v.One:t.power instanceof c&&t.power.base.equals(t.base)?t.power.exp:t},expand:function(){var e=this.recurse("expand");return e.power instanceof l?new a(_.map(e.power.terms,(function(t){return new h(e.base,t).expand()}))):e.power instanceof c?new l(e.power.exp,new h(e.base,e.power.base).expand()).flatten():e.isNatural()?e:l.handleDivide(new h(b.e,e.power),new h(b.e,e.base))},hints:_.extend(h.prototype.hints,{open:!1}),isPositive:function(){var e=this.collect();return e.base instanceof v&&e.power instanceof v&&this.eval()>0},needsExplicitMul:function(){return!1},isNatural:function(){return this.base.equals(b.e)}}),_.extend(h,{natural:function(){return b.e},common:function(){return v.Ten},create:function(e,t){var n=new h(e,t);return t.hints.parens||(n=n.addHint("open")),n}}),p.prototype=new r,_.extend(p.prototype,{func:p,args:function(){return[this.type,this.arg]},functions:{sin:{eval:Math.sin,codegen:"Math.sin((",tex:"\\sin",expand:function(){return this}},cos:{eval:Math.cos,codegen:"Math.cos((",tex:"\\cos",expand:function(){return this}},tan:{eval:Math.tan,codegen:"Math.tan((",tex:"\\tan",expand:function(){return l.handleDivide(p.sin(this.arg),p.cos(this.arg))}},csc:{eval:function(e){return 1/Math.sin(e)},codegen:"(1/Math.sin(",tex:"\\csc",expand:function(){return l.handleDivide(v.One,p.sin(this.arg))}},sec:{eval:function(e){return 1/Math.cos(e)},codegen:"(1/Math.cos(",tex:"\\sec",expand:function(){return l.handleDivide(v.One,p.cos(this.arg))}},cot:{eval:function(e){return 1/Math.tan(e)},codegen:"(1/Math.tan(",tex:"\\cot",expand:function(){return l.handleDivide(p.cos(this.arg),p.sin(this.arg))}},arcsin:{eval:Math.asin,codegen:"Math.asin((",tex:"\\arcsin"},arccos:{eval:Math.acos,codegen:"Math.acos((",tex:"\\arccos"},arctan:{eval:Math.atan,codegen:"Math.atan((",tex:"\\arctan"},arccsc:{eval:function(e){return Math.asin(1/e)},codegen:"Math.asin(1/(",tex:"\\operatorname{arccsc}"},arcsec:{eval:function(e){return Math.acos(1/e)},codegen:"Math.acos(1/(",tex:"\\operatorname{arcsec}"},arccot:{eval:function(e){return Math.atan(1/e)},codegen:"Math.atan(1/(",tex:"\\operatorname{arccot}"},sinh:{eval:function(e){return(Math.exp(e)-Math.exp(-e))/2},codegen:function(e){return"((Math.exp("+e+") - Math.exp(-("+e+"))) / 2)"},tex:"\\sinh",expand:function(){return this}},cosh:{eval:function(e){return(Math.exp(e)+Math.exp(-e))/2},codegen:function(e){return"((Math.exp("+e+") + Math.exp(-("+e+"))) / 2)"},tex:"\\cosh",expand:function(){return this}},tanh:{eval:function(e){return(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e))},codegen:function(e){return"((Math.exp("+e+") - Math.exp(-("+e+"))) / (Math.exp("+e+") + Math.exp(-("+e+"))))"},tex:"\\tanh",expand:function(){return l.handleDivide(p.sinh(this.arg),p.cosh(this.arg))}},csch:{eval:function(e){return 2/(Math.exp(e)-Math.exp(-e))},codegen:function(e){return"(2 / (Math.exp("+e+") - Math.exp(-("+e+"))))"},tex:"\\csch",expand:function(){return l.handleDivide(v.One,p.sinh(this.arg))}},sech:{eval:function(e){return 2/(Math.exp(e)+Math.exp(-e))},codegen:function(e){return"(2 / (Math.exp("+e+") + Math.exp(-("+e+"))))"},tex:"\\sech",expand:function(){return l.handleDivide(v.One,p.cosh(this.arg))}},coth:{eval:function(e){return(Math.exp(e)+Math.exp(-e))/(Math.exp(e)-Math.exp(-e))},codegen:function(e){return"((Math.exp("+e+") + Math.exp(-("+e+"))) / (Math.exp("+e+") - Math.exp(-("+e+"))))"},tex:"\\coth",expand:function(){return l.handleDivide(p.cosh(this.arg),p.sinh(this.arg))}}},isEven:function(){return _.contains(["cos","sec"],this.type)},isInverse:function(){return 0===this.type.indexOf("arc")},isBasic:function(){return _.contains(["sin","cos"],this.type)},eval:function(e,t){return(0,this.functions[this.type].eval)(this.arg.eval(e,t))},codegen:function(){var e=this.functions[this.type].codegen;if("function"===typeof e)return e(this.arg.codegen());if("string"===typeof e)return e+this.arg.codegen()+"))";throw new Error("codegen not implemented for "+this.type)},print:function(){return this.type+"("+this.arg.print()+")"},tex:function(e){var t=this.functions[this.type].tex,n="("+this.arg.tex()+")";return e&&e.split?[t,n]:t+n},hints:_.extend(p.prototype.hints,{open:!1}),isPositive:function(){return this.collect().arg instanceof v&&this.eval()>0},completeParse:function(){if(this.exp){var e=new c(this,this.exp);return this.exp=void 0,e}return this},needsExplicitMul:function(){return!1},expand:function(){var e=this.recurse("expand");if(e.isInverse())return e;var t=e.functions[e.type].expand;return _.bind(t,e)()},collect:function(e){var t,n=this.recurse("collect",e);return!n.isInverse()&&n.arg.isNegative()?(t=n.arg instanceof v?n.arg.abs():l.handleDivide(n.arg,v.Neg).collect(e),n.isEven()?new p(n.type,t):new l(v.Neg,new p(n.type,t))):n}}),_.extend(p,{create:function(e,t){var n=e[0],s=e[1];s&&s.equals(v.Neg)&&(n="arc"+n,s=void 0);var i=new p(n,t);return t.hints.parens||(i=i.addHint("open")),s&&(i.exp=s),i},sin:function(e){return new p("sin",e)},cos:function(e){return new p("cos",e)},sinh:function(e){return new p("sinh",e)},cosh:function(e){return new p("cosh",e)}}),u.prototype=new r,_.extend(u.prototype,{func:u,args:function(){return[this.arg]},eval:function(e,t){return Math.abs(this.arg.eval(e,t))},codegen:function(){return"Math.abs("+this.arg.codegen()+")"},print:function(){return"abs("+this.arg.print()+")"},tex:function(){return"\\left|"+this.arg.tex()+"\\right|"},collect:function(e){var t=this.recurse("collect",e);if(t.arg.isPositive())return t.arg;if(t.arg instanceof v)return t.arg.abs();if(t.arg instanceof l){var n=_.groupBy(t.arg.terms,(function(e){return e.isPositive()?"positive":e instanceof v?"number":"other"})),s=n.positive.concat(_.invoke(n.number,"abs"));return n.other.length&&s.push(new u(new l(n.other).flatten())),new l(s).flatten()}return t},expand:function(){var e=this.recurse("expand");return e.arg instanceof l?new l(_.map(e.arg.terms,(function(e){return new u(e)}))):e},isPositive:function(){return!0}}),d.prototype=new r,_.extend(d.prototype,{func:d,args:function(){return[this.left,this.type,this.right]},needsExplicitMul:function(){return!1},print:function(){return this.left.print()+this.type+this.right.print()},signs:{"=":" = ","<":" < ",">":" > ","<>":" \\ne ","<=":" \\le ",">=":" \\ge "},tex:function(){return this.left.tex()+this.signs[this.type]+this.right.tex()},normalize:function(){var e=this.recurse("normalize");return _.contains([">",">="],e.type)?new d(e.right,e.type.replace(">","<"),e.left):e},asExpr:function(e){var t=function(e){return e instanceof v&&e.isSimple()&&0===e.eval()},n=[];this.left instanceof a?n=_.clone(this.left.terms):t(this.left)||(n=[this.left]),this.right instanceof a?n=n.concat(this.right.negate().terms):t(this.right)||n.push(this.right.negate());var s=!this.isEquality();n=_.invoke(n,"collect",{preciseFloats:!0});for(var i=0;i<n.length;i++){var r=n[i].getDenominator();s&&!r.isPositive()&&(r=r.asPositiveFactor()),r.equals(v.One)||(n=_.map(n,(function(e){return l.createOrAppend(e,r).simplify({once:!0,preciseFloats:!0})})))}var o=new a(n).flatten();return e?o:this.divideThrough(o)},divideThrough:function(e){var t=!this.isEquality(),n=e.simplify({once:!0}),s=n.factor({keepNegative:t});if(!(s instanceof l))return e;var i=s.terms,r=_.groupBy(i,(function(e){return e instanceof a})),o=r[!0]||[],h=r[!1]||[];if(o.length&&this.isEquality())return new l(o).flatten();var p=h;o.length||(p=_.reject(p,(function(e){return!!e.getVars().length}))),t&&(p=_.invoke(p,"asPositiveFactor")),p=_.reject(p,(function(e){return e.equals(v.One)})),p=_.map(p,(function(e){return new c(e,v.Div)}));var u=new l(i.concat(p)).collect();return u.equals(s)?n:u},isEquality:function(){return _.contains(["=","<>"],this.type)},compare:function(e){if(!(e instanceof d))return!1;var t=this.normalize(),n=e.normalize();if(t.type!==n.type)return!1;var s=t.divideThrough(t.asExpr(!0).collect()),i=n.divideThrough(n.asExpr(!0).collect());return t.isEquality()?s.compare(i)||s.compare(l.handleNegative(i)):s.compare(i)},sameForm:function(e){var t=this.normalize(),n=e.normalize(),s=t.left.sameForm(n.left)&&t.right.sameForm(n.right);return t.isEquality()?s||t.left.sameForm(n.right)&&t.right.sameForm(n.left):s},isSimplified:function(){var e=this.asExpr(!0),t=this.divideThrough(e).simplify();return e.equals(t)&&this.left.isSimplified()&&this.right.isSimplified()}}),_.extend(d.prototype,{solveLinearEquationForVariable:function(e){var t=this.asExpr();if(!t.is(a)||2!==t.terms.length)throw new Error("Can only handle linear equations of the form a + bx (= 0)");var n,s,i;return(i=t.terms[0]).has(m)&&_.contains(i.getVars(),e.symbol)?(n=l.handleNegative(t.terms[1]),s=l.handleDivide(t.terms[0],e)):(n=l.handleNegative(t.terms[0]),s=l.handleDivide(t.terms[1],e)),l.handleDivide(n,s).simplify()}}),g.prototype=new r,_.extend(g.prototype,{needsExplicitMul:function(){return!1},findGCD:function(e){return e instanceof g||e instanceof v?this.equals(e)?this:v.One:e.findGCD(this)}}),f.prototype=new g,_.extend(f.prototype,{func:f,args:function(){return[this.symbol,this.arg]},print:function(){return this.symbol+"("+this.arg.print()+")"},tex:function(){return this.symbol+"("+this.arg.tex()+")"},eval:function(t,n){var s=this.arg,i=t[this.symbol],r=_.extend(_.clone(t),{x:s.eval(t,n)}),o=e.parse(i,n);return o.parsed?o.expr.eval(r,n):o},codegen:function(){return'vars["'+this.symbol+'"]('+this.arg.codegen()+")"},getUnits:function(){return this.arg.getUnits()},getVars:function(e){return e?this.arg.getVars():_.union(this.arg.getVars(),[this.symbol]).sort()},getConsts:function(){return this.arg.getConsts()}}),m.prototype=new g,_.extend(m.prototype,{func:m,args:function(){return[this.symbol,this.subscript]},exprArgs:function(){return[]},recurse:function(){return this},print:function(){var e="";return this.subscript&&(e="_("+this.subscript.print()+")"),this.symbol+e},prettyPrint:function(){var e=this.subscript;return e&&(e instanceof v||e instanceof g)?this.symbol+"_"+e.print():this.print()},tex:function(){var e="";return this.subscript&&(e="_{"+this.subscript.tex()+"}"),(this.symbol.length>1?"\\":"")+this.symbol+e},repr:function(){return"Var("+this.print()+")"},eval:function(e,t){return e[this.prettyPrint()]},codegen:function(){return'vars["'+this.prettyPrint()+'"]'},getVars:function(){return[this.prettyPrint()]},isPositive:function(){return!1}}),b.prototype=new g,_.extend(b.prototype,{func:b,args:function(){return[this.symbol]},recurse:function(){return this},eval:function(e,t){return"pi"===this.symbol?Math.PI:"e"===this.symbol?Math.E:void 0},codegen:function(){return"pi"===this.symbol?"Math.PI":"e"===this.symbol?"Math.E":void 0},print:function(){return this.symbol},tex:function(){return"pi"===this.symbol?"\\pi ":"e"===this.symbol?"e":void 0},isPositive:function(){return this.eval()>0},abs:function(){return this.eval()>0?this:l.handleNegative(this)},getConsts:function(){return[this.print()]}}),b.e=new b("e"),b.pi=new b("pi"),v.prototype=new r,_.extend(v.prototype,{repr:function(){return this.print()},strip:function(){return this.abs()},recurse:function(){return this},codegen:function(){return this.print()},add:t,mul:t,negate:t,isSubtract:function(){return this.hints.subtract},abs:t,needsExplicitMul:function(){return!0},findGCD:t,isPositive:function(){return this.eval()>0},isNegative:function(){return this.eval()<0},asPositiveFactor:function(){return this.isPositive()?this:this.abs()},hints:_.extend(v.prototype.hints,{negate:!1,subtract:!1,divide:!1,root:!1,fraction:!1,entered:!1}),isSimple:t,getDecimalPlaces:function(){var e=(""+this.n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},asRational:t}),x.prototype=new v,_.extend(x.prototype,{func:x,args:function(){return[this.n,this.d]},eval:function(){return this.n/this.d},print:function(){return this.n.toString()+"/"+this.d.toString()},tex:function(){var e="\\frac{"+Math.abs(this.n).toString()+"}{"+this.d.toString()+"}";return this.n<0?"-"+e:e},add:function(e,t){return e instanceof x?new x(this.n*e.d+this.d*e.n,this.d*e.d).collect():e.add(this,t)},mul:function(e,t){return e instanceof x?new x(this.n*e.n,this.d*e.d).collect():e.mul(this,t)},collect:function(){var e=v.findGCD(this.n,this.d),t=this.n/e,n=this.d/e;return 1===n?new y(t):new x(t,n)},negate:function(){return new x(-this.n,this.d)},abs:function(){return new x(Math.abs(this.n),this.d)},findGCD:function(e){return e instanceof x?new x(v.findGCD(this.n*e.d,e.n*this.d),this.d*e.d).collect():e instanceof y?new x(v.findGCD(this.n,e.n),this.d):e.findGCD(this)},raiseToThe:function(e){if(e instanceof y){var t=e.eval()>0,n=e.abs().eval(),s=Math.pow(this.n,n),i=Math.pow(this.d,n);return t?new x(s,i).collect():new x(i,s).collect()}return new j(this.eval()).raiseToThe(e)},getDenominator:function(){return new y(this.d)},isSimple:function(){return!1},asRational:function(){return this}}),y.prototype=new x(0,1),_.extend(y.prototype,{func:y,args:function(){return[this.n]},print:function(){return this.n.toString()},tex:function(){return this.n.toString()},negate:function(){return new y(-this.n)},abs:function(){return new y(Math.abs(this.n))},isSimple:function(){return!0},findGCD:function(e){return e instanceof y?new y(v.findGCD(this.n,e.n)):e.findGCD(this)}}),_.extend(y,{create:function(e){return new y(e).addHint("entered")}}),j.prototype=new v,_.extend(j.prototype,{func:j,args:function(){return[this.n]},eval:function(){return this.n},print:function(){return this.n.toString()},tex:function(){return this.n.toString()},add:function(e,t){return t&&t.preciseFloats?j.toDecimalPlaces(this.n+e.eval(),Math.max(this.getDecimalPlaces(),e.getDecimalPlaces())):new j(this.n+e.eval()).collect()},mul:function(e,t){return t&&t.preciseFloats?j.toDecimalPlaces(this.n*e.eval(),this.getDecimalPlaces()+e.getDecimalPlaces()):new j(this.n*e.eval()).collect()},collect:function(){return this},negate:function(){return new j(-this.n)},abs:function(){return new j(Math.abs(this.n))},findGCD:function(e){return e instanceof v?new j(v.findGCD(this.eval(),e.eval())).collect():e.findGCD(this)},raiseToThe:function(e,t){return t&&t.preciseFloats&&e instanceof y&&e.n>1?j.toDecimalPlaces(new c(this,e).eval(),this.getDecimalPlaces()*e.n):new j(new c(this,e).eval()).collect()},asRational:function(){var e=this.n.toString().split(".");return 1===e.length?new x(this.n,1):new x(Number(e.join("")),Math.pow(10,e[1].length)).collect()},getDenominator:function(){return this.asRational().getDenominator()},isSimple:function(){return!0}}),_.extend(j,{create:function(e){return new j(e).addHint("entered")},toDecimalPlaces:function(e,t){return new j(+e.toFixed(Math.min(t,20))).collect()}}),_.extend(v,{negativeOne:function(e){return"subtract"===e?v.Sub:"divide"===e?v.Div:v.Neg},findGCD:function(e,t){var n;if(e=Math.abs(e),t=Math.abs(t),e!==Math.floor(e)||t!==Math.floor(t))return 1;for(;t;)n=e%t,e=t,t=n;return e},min:function(){return _.min(_.toArray(arguments),(function(e){return e.eval()}))},max:function(){return _.max(_.toArray(arguments),(function(e){return e.eval()}))}}),v.Neg=new y(-1).addHint("negate"),v.Sub=new y(-1).addHint("subtract"),v.Div=new y(-1).addHint("divide"),v.Sqrt=new x(1,2).addHint("root"),v.Zero=new y(0),v.One=new y(1),v.Ten=new y(10),a.prototype.identity=v.Zero,l.prototype.identity=v.One;var w=e.parser;function O(e){this.symbol=e}w.yy={Add:a,Mul:l,Pow:c,Log:h,Trig:p,Eq:d,Abs:u,Func:f,Const:b,Var:m,Int:y,Float:j,parseError:function(e,t){throw new Error(t.loc.first_column)},constants:["e"],symbolLexer:function(e){return _.contains(w.yy.constants,e)?"CONST":_.contains(w.yy.functions,e)?"FUNC":"VAR"}},e.parse=function(e,t){try{return t&&t.functions?w.yy.functions=_.without(t.functions,"i"):w.yy.functions=[],t&&t.decimal_separator&&(e=e.split(t.decimal_separator).join(".")),{parsed:!0,expr:w.parse(e).completeParse()}}catch(n){return{parsed:!1,error:n.message}}},O.prototype=new g;var C=function(e){if(_.has(S,e)||_.has(P,e))return new O(e);var t=Object.keys(k).find((function(t){return new RegExp("^"+t).test(e)}));if(t){var n=e.replace(new RegExp("^"+t),"");if(_.has(S,n)||P[n]&&P[n].prefixes===T)return new l(k[t],new O(n));throw new Error(n+" does not allow prefixes")}return new O(e)};e.unitParse=function(t){try{var n=e.unitParser.parse(t),s=[];n.unit.num.forEach((function(e){s.push(new c(C(e.name),new y(e.pow)))})),n.unit.denom.forEach((function(e){s.push(new c(C(e.name),new y(-1*e.pow)))}));var i=new l(s).flatten();return"unitMagnitude"===n.type?{parsed:!0,unit:i,expr:new l([new j(+n.magnitude)].concat(s)),coefficient:n.magnitude,type:n.type}:{parsed:!0,unit:i,type:n.type}}catch(r){return{parsed:!1,error:r.message}}},_.extend(O.prototype,{func:O,args:function(){return[this.symbol]},recurse:function(){return this},eval:function(e,t){return 1},getUnits:function(){return[{unit:this.symbol,pow:1}]},codegen:function(){return"1"},print:function(){return this.symbol},tex:function(){return this.symbol},collect:function(e){if(_.has(S,this.symbol))return this;if(_.has(P,this.symbol))return P[this.symbol].conversion;throw new Error("could not understand unit: "+this.symbol)}});var S={m:new O("m"),g:new O("g"),s:new O("s"),A:new O("A"),K:new O("K"),mol:new O("mol"),cd:new O("cd")},k={a:new c(new y(10),new y(-18)),f:new c(new y(10),new y(-15)),p:new c(new y(10),new y(-12)),n:new c(new y(10),new y(-9)),u:new c(new y(10),new y(-6)),m:new c(new y(10),new y(-3)),c:new c(new y(10),new y(-2)),d:new c(new y(10),new y(-1)),da:new y(10),h:new c(new y(10),new y(2)),k:new c(new y(10),new y(3)),M:new c(new y(10),new y(6)),G:new c(new y(10),new y(9)),T:new c(new y(10),new y(12)),P:new c(new y(10),new y(15)),E:new c(new y(10),new y(18)),hella:new c(new y(10),new y(27))},T={},M={},N=function(t,n){var s=t.split("|"),i=s[0].trim(),r=s[1].trim(),o=v.One;""!==i&&(o=e.parse(i).expr);var a=r.split("/"),h=[o];return a[0]&&a[0].split(" ").filter((function(e){return""!==e})).map((function(e){h.push(new O(e))})),a[1]&&a[1].split(" ").filter((function(e){return""!==e})).map((function(e){h.push(new c(new O(e),v.Div))})),{conversion:new l(h),prefixes:n}},P={Da:N("1.6605388628 x 10^-24 | g",T),u:N("| Da",M),meter:N("| m",M),meters:N("| m",M),in:N("254 / 10000 | m",M),ft:N("3048  / 10000 | m",M),yd:N("9144  / 10000 | m",M),mi:N("1609344 / 1000 | m",M),ly:N("9.4607 x 10^15 | m",M),nmi:N("1852 | m",M),"\xc5":N("10^-10 | m",M),pc:N("3.0857 x 10^16 | m",M),min:N("60 | s",M),hr:N("3600 | s",M),sec:N("| s",M),day:N("86400 | s",M),wk:N("604800 | s",M),fortnight:N("14 | day",M),shake:N("10^-8 | s",M),olympiad:N("126200000 | s",M),"\xb0C":N("1 | K",M),"\xb0F":N("5/9 | K",M),"\xb0R":N("5/9 | K",M),e:N("1.6021765314 x 10^-19 | C",M),c:N("299792458 | m / s",M),kn:N("514/1000 | m / s",M),kt:N("| kn",M),knot:N("| kn",M),J:N("| N m",T),BTU:N("1060 | J",M),cal:N("4184 / 1000 | J",T),eV:N("1.602176514 x 10^-19 | J",T),erg:N("10^\u22127 | J",T),W:N("| J / s",T),"H-e":N("80 | W",M),N:N("1000 | g m / s s",T),lb:N("4448221615 / 1000000000 | N",M),dyn:N("10^-5 | N",M),Pa:N("1 | N / m m m",T),bar:N("10^5 | Pa",T),"\u33d4":N("1/1000 | bar",M),"\u3374":N("| bar",M),atm:N("101325 | Pa",M),Torr:N("1/760 | atm",M),mmHg:N("| Torr",M),ha:N("10^4 | m m",M),b:N("10^\u221228 | m m",T),barn:N("| b",T),acre:N("4046.87 | m m",M),skilodge:N("10^-31 | m m",M),outhouse:N("10^-34 | m m",M),shed:N("10^-52 | m m",M),L:N("1/1000 | m m m",T),gal:N("3785/1000 | L",T),cup:N("1/16 | gal",M),qt:N("1/4 | gal",M),quart:N("| qt",M),p:N("1/8 | gal",M),pt:N("| p",M),pint:N("| p",M),"fl oz":N("1/8 | cup",M),"fl. oz.":N("1/8 | cup",M),tbsp:N("1/16 | cup",M),tsp:N("1/3 | tbsp",M),rev:N("2 pi | rad",M),deg:N("180 pi | rad",M),"\xb0":N("| deg",M),arcminute:N("1/60 | deg",M),arcsec:N("1/3600 | deg",M),Hu:N("1000 | dB",T),dozen:N("12 |",M),mol:N("6.0221412927 x 10^23 |",T),"%":N("1/100 |",M),percent:N("| %",M),ppm:N("1/1000000 |",M),V:N("1000 | g m m / s s C",T),C:N("| A s",T),ampere:N("| A",M),"\u03a9":N("| V / A",T),ohm:N("| \u03a9",M),F:N("| C / V",T),H:N("| ohm s",T),T:N("1000 | g / C s",T),Wb:N("1000 | g m m / C s",T),lm:N("pi x 10^4 | cd / m m",M),lx:N("| lm / m m",M),nit:N("| cd / m m",M),sb:N("10^4 | cd / m m",M),stilb:N("1 | sb",M),apostilb:N("1 / pi x 10^(-4) | sb",M),blondel:N("| apostilb",M),asb:N("| apostilb",M),la:N("| lm",M),Lb:N("| lm",M),sk:N("10^-7 | lm",M),skot:N("| sk",M),bril:N("10^-11 | lm",M),Hz:N("| / s",T)};e.Add=a,e.Mul=l,e.Pow=c,e.Log=h,e.Eq=d,e.Trig=p,e.Abs=u,e.Func=f,e.Var=m,e.Const=b,e.Unit=O,e.Rational=x,e.Int=y,e.Float=j,e.Zero=v.Zero,e.One=v.One}(H),function(e){e.compare=function(e,t,n){var s={form:!1,simplify:!1};n=void 0!==n?_.extend(s,n):s;var i=e.sameVars(t);if(!i.equal){var r=null;return i.equalIgnoringCase&&(r="Some of your variables are in the wrong case (upper vs. lower)."),{equal:!1,message:r}}return e.compare(t)?n.form&&!e.sameForm(t)?{equal:!1,message:"Your answer is not in the correct form."}:n.simplify&&!e.isSimplified()?{equal:!1,message:"Your answer is not fully expanded and simplified."}:{equal:!0,message:null}:{equal:!1,message:null}}}(H);var U=H,G=n(6),Y={exports:{}};Y.exports;x.b;const K=G.a.number,X={cleanMath:function(e){return"string"===typeof e?e.replace(/\+\s*-/g,"- ").replace(/-\s*-/g,"+ ").replace(/\^1/g,""):e},bound:function(e){return 0===e?e:e<0?-X.bound(-e):Math.max(1e-6,Math.min(e,1e20))},factorial:function(e){return e<=1?e:e*X.factorial(e-1)},getGCD:function(e,t){if(arguments.length>2){const t=[].slice.call(arguments,1);return X.getGCD(e,X.getGCD(...t))}{let n;for(e=Math.abs(e),t=Math.abs(t);t;)n=e%t,e=t,t=n;return e}},getLCM:function(e,t){if(arguments.length>2){const t=[].slice.call(arguments,1);return X.getLCM(e,X.getLCM(...t))}return Math.abs(e*t)/X.getGCD(e,t)},primes:[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97],isPrime:function(e){if(e<=1)return!1;if(e<101)return!!l.a.grep(X.primes,(function(t,n){return Math.abs(t-e)<=.5})).length;if(e<=1||e>2&&e%2===0)return!1;for(let t=3,n=Math.sqrt(e);t<=n;t+=2)if(e%t===0)return!1;return!0},getPrimeFactorization:function(e){if(1===e)return[];if(X.isPrime(e))return[e];const t=Math.sqrt(e);for(let n=2;n<=t;n++)if(e%n===0)return l.a.merge(X.getPrimeFactorization(n),X.getPrimeFactorization(e/n))},roundToNearest:function(e,t){return Math.round(t/e)*e},roundTo:function(e,t){const n=Math.pow(10,e).toFixed(5);return Math.round((t*n).toFixed(5))/n},toFixedApprox:function(e,t){const n=e.toFixed(t);return K.equal(+n,e)?n:"\\approx "+n},roundToApprox:function(e,t){const n=X.roundTo(t,e);return K.equal(n,e)?String(n):X.toFixedApprox(e,t)},toFraction:function(e,t){if(null==t&&(t=Math.pow(2,-46)),e<0||e>1){let n=e%1;n+=n<0?1:0;const s=X.toFraction(n,t);return s[0]+=Math.round(e-n)*s[1],s}if(Math.abs(Math.round(Number(e))-e)<=t)return[Math.round(e),1];{let n=0,s=1,i=1,r=1,o=1,a=2;for(;;){if(Math.abs(Number(o/a)-e)<=t)return[o,a];o/a<e?(n=o,s=a):(i=o,r=a),o=n+i,a=s+r}}},getNumericFormat:function(e){if((e=(e=l.a.trim(e)).replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1")).match(/^[+-]?\d+$/))return"integer";if(e.match(/^[+-]?\d+\s+\d+\s*\/\s*\d+$/))return"mixed";const t=e.match(/^[+-]?(\d+)\s*\/\s*(\d+)$/);return t?parseFloat(t[1])>parseFloat(t[2])?"improper":"proper":e.replace(/[,. ]/g,"").match(/^\d+$/)?"decimal":e.match(/(pi?|\u03c0|t(?:au)?|\u03c4|pau)/)?"pi":null},toNumericString:function(e,t){if(null==e)return"";if(0===e)return"0";if("percent"===t)return 100*e+"%";if("pi"===t){const t=K.toFraction(e/Math.PI),n=Math.abs(t[0]),s=t[1];if(K.isInteger(n)){return(e<0?"-":"")+(1===n?"":n)+"\u03c0"+(1===s?"":"/"+s)}}if(["proper","improper","mixed","fraction"].includes(t)){const n=K.toFraction(e),s=Math.abs(n[0]),i=n[1],r=e<0?"-":"";if(1===i)return r+s;if("mixed"===t){const e=s%i,t=(s-e)/i;return r+(t?t+" ":"")+e+"/"+i}return r+s+"/"+i}return String(e)}};Y.exports=X;var Z=Y.exports,J={exports:{}};J.exports;const Q=l.a,ee=x.b,te=Z,ne=Math.pow(2,-42),se={predicate:{defaultForms:"integer, proper, improper, mixed, decimal",createValidatorFunctional:function(e,t){let n;t=ee.extend({simplify:"required",ratio:!1,forms:se.predicate.defaultForms},t),n=ee.isArray(t.forms)?t.forms:t.forms.split(/\s*,\s*/),void 0===t.inexact&&(t.maxError=0),t.maxError=+t.maxError+ne,ee.contains(n,"percent")&&(n=ee.without(n,"percent"),n.push("percent"));const s=function(e){const n=(e=e.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").replace(/(^\s*)|(\s*$)/gi,"")).match(/^([+-]?\d+)\s*\/\s*([+-]?\d+)$/),s=parseInt(e,10);if(n){const e=parseFloat(n[1]),s=parseFloat(n[2]);return[{value:e/s,exact:s>0&&(t.ratio||"1"!==n[2])&&1===te.getGCD(e,s)}]}return isNaN(s)||""+s!==e?[]:[{value:s,exact:!0}]},i={integer:function(e){const t=i.decimal(e),n=i.decimal(e,1);return null!=t[0].value&&t[0].value===n[0].value||null!=t[1].value&&t[1].value===n[1].value?t:[]},proper:function(e){return Q.map(s(e),(function(e){return Math.abs(e.value)<1?[e]:[]}))},improper:function(e){return Q.map(s(e),(function(e){return Math.abs(e.value)>=1?[e]:[]}))},pi:function(e){let t,n=[];if(t=(e=e.replace(/\u2212/,"-")).match(/^([+-]?)\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))n=[{value:parseFloat(t[1]+"1"),exact:!0}];else if(t=e.match(/^([+-]?\s*\d+\s*(?:\/\s*[+-]?\s*\d+)?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))n=s(t[1]);else if(t=e.match(/^([+-]?)\s*(\d+)\s*([+-]?\d+)\s*\/\s*([+-]?\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i)){const e=parseFloat(t[1]+"1"),s=parseFloat(t[2]),i=parseFloat(t[3]),r=parseFloat(t[4]);n=[{value:e*(s+i/r),exact:i<r&&1===te.getGCD(i,r)}]}else if(t=e.match(/^([+-]?\s*\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\s*\d+))?$/i))n=s(t[1]+"/"+t[3]);else if(t=e.match(/^([+-]?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\d+))?$/i))n=s(t[1]+"1/"+t[3]);else if("0"===e)n=[{value:0,exact:!0}];else{if(!(t=e.match(/^(.+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))){n=ee.reduce(se.predicate.defaultForms.split(/\s*,\s*/),(function(t,n){return t.concat(i[n](e))}),[]);let t=!1;const s=parseFloat(e);if(isNaN(s)||s===parseInt(e))e.match(/\/\s*7/)&&(t=!0);else{const e=Math.PI/12,n=e*Math.round(s/e);Math.abs(s-n)<.01&&(t=!0)}return t&&ee.each(n,(function(e){e.piApprox=!0})),n}n=i.decimal(t[1])}let r=Math.PI;return e.match(/\\?tau|t|\u03c4/)&&(r=2*Math.PI),e.match(/pau/)&&(r=1.5*Math.PI),Q.each(n,(function(e,t){t.value*=r})),n},coefficient:function(e){let t=[];return""===(e=e.replace(/\u2212/,"-"))?t=[{value:1,exact:!0}]:"-"===e&&(t=[{value:-1,exact:!0}]),t},log:function(e){let t,n=[];return(t=(e=(e=e.replace(/\u2212/,"-")).replace(/[ \(\)]/g,"")).match(/^log\s*(\S+)\s*$/i))?n=i.decimal(t[1]):"0"===e&&(n=[{value:0,exact:!0}]),n},percent:function(e){e=Q.trim(e);let t=!1;e.indexOf("%")===e.length-1&&(e=Q.trim(e.substring(0,e.length-1)),t=!0);const n=i.decimal(e);return Q.each(n,(function(e,n){n.exact=t,n.value=n.value/100})),n},mixed:function(e){const t=e.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?)(\d+)\s+(\d+)\s*\/\s*(\d+)$/);if(t){const e=parseFloat(t[1]+"1"),n=parseFloat(t[2]),s=parseFloat(t[3]),i=parseFloat(t[4]);return[{value:e*(n+s/i),exact:s<i&&1===te.getGCD(s,i)}]}return[]},decimal:function(e,n){null==n&&(n=1e10);const s=function(e){const s=(e=Q.trim(e)).replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?(?:\d{1,3}(?:[, ]?\d{3})*\.?|\d{0,3}(?:[, ]?\d{3})*\.(?:\d{3}[, ]?)*\d{1,3}))$/),i=e.match(/^0[0,]*,/);if(s&&!i){let e=parseFloat(s[1].replace(/[, ]/g,""));return void 0===t.inexact&&(e=Math.round(e*n)/n),e}};return[{value:s(e),exact:!0},{value:function(e){return e=e.replace(/([\.,])/g,(function(e,t){return"."===t?",":"."})),s(e)}(e),exact:!0}]}};return function(s){const r=null!=t.fallback?""+t.fallback:"",o={empty:""===(s=Q.trim(s)||r),correct:!1,message:null,guess:s};if(Q.each(n,(function(n,r){const a=i[r](s);for(let s=0,i=a.length;s<i;s++){const n=a[s].value,i=a[s].exact,l=a[s].piApprox;if(e(n,t.maxError))return i||"optional"===t.simplify?(o.correct=!0,o.message=t.message||null,o.empty=!1):"percent"===r?(o.empty=!0,o.message=i18n._("Your answer is almost correct, but it is missing a <code>\\%</code> at the end.")):("enforced"!==t.simplify&&(o.empty=!0),o.message=i18n._("Your answer is almost correct, but it needs to be simplified.")),!1;l&&e(n,Math.abs(.001*n))&&(o.empty=!0,o.message=i18n._("Your answer is close, but you may have approximated pi. Enter your answer as a multiple of pi, like <code>12\\ \\text{pi}</code> or <code>2/3\\ \\text{pi}</code>"))}})),!1===o.correct){let e=!1;if(ee.each(i,(function(t){ee.any(t(s),(function(e){return null!=e.value&&!ee.isNaN(e.value)}))&&(e=!0)})),!e)return o.empty=!0,o.message=i18n._("We could not understand your answer. Please check your answer for extra text or symbols."),o}return o}}},number:{convertToPredicate:function(e,t){const n=parseFloat(Q.trim(e));return[function(e,t){return Math.abs(e-n)<t},Q.extend({},t,{type:"predicate"})]},createValidatorFunctional:function(e,t){return se.predicate.createValidatorFunctional(...se.number.convertToPredicate(e,t))}},expression:{parseSolution:function(e,t){let n=U.parse(e,t);if(!n.parsed)throw new Error("The provided solution ("+e+") didn't parse.");if(t.simplified&&!n.expr.isSimplified())throw new Error("The provided solution ("+e+") isn't fully expanded and simplified.");return n=n.expr,n},createValidatorFunctional:function(e,t){return function(n){const s={empty:!1,correct:!1,message:null,guess:n};if(!n)return s.empty=!0,s;const i=U.parse(n,t);if(!i.parsed)return s.empty=!0,s;"string"===typeof e&&(e=se.expression.parseSolution(e,t));const r=U.compare(i.expr,e,t);if(r.equal)s.correct=!0;else if(r.message)s.message=r.message;else{const i=U.parse(n.replace(/[xX]/g,"*"),t);if(i.parsed){const n=U.compare(i.expr,e,t);n.equal?(s.empty=!0,s.message="I'm a computer. I only understand multiplication if you use an asterisk (*) as the multiplication sign."):n.message&&(s.message=n.message+" Also, I'm a computer. I only understand multiplication if you use an asterisk (*) as the multiplication sign.")}}return s}}}};J.exports=se;var ie=J.exports;const re=x.b,oe=ie,ae=function(e,t,n){return re.isArray(e)?re.map(e,(function(e){return ae(e,t)})):t.call(n,e)},le={inputPathsEqual:(e,t)=>null==e||null==t?null==e===(null==t):e.length===t.length&&e.every(((e,n)=>t[n]===e)),nestedMap:ae,rWidgetParts:/^\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]$/,rWidgetRule:/^\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]/,rTypeFromWidgetId:/^([a-z-]+) ([0-9]+)$/,snowman:"\u2603",noScore:{type:"points",earned:0,total:0,message:null},seededRNG:function(e){var t=e;return function(){var e=t;return(t=268435455&(e=4294967295&(3042594569^(e=(e=4294967295&((e=(e=4294967295&(3345072700^(e=e+2127912214+(e<<12)&4294967295)^e>>>19))+374761393+(e<<5)&4294967295)+3550635116^e<<9))+4251993797+(e<<3)&4294967295)^e>>>16)))/268435456}},shuffle:function(e,t,n){var s,i=re.clone(e);if(!i.length||re.all(i,(function(e){return re.isEqual(e,i[0])})))return i;s=re.isFunction(t)?t:le.seededRNG(t);do{for(var r=i.length;r>0;r--){var o=Math.floor(s()*r),a=i[o];i[o]=i[r-1],i[r-1]=a}}while(n&&re.isEqual(e,i));return i},split:"x".split(/(.)/g).length?function(e,t){return e.split(t)}:function(e,t){for(var n,s=[],i=t.lastIndex=0;n=t.exec(e);)s.push(e.slice(i,n.index)),s.push.apply(s,n.slice(1)),i=n.index+n[0].length;return s.push(e.slice(i)),s},combineScores:function(e,t){var n;return"points"===e.type&&"points"===t.type?(n=e.message&&t.message&&e.message!==t.message?null:e.message||t.message,{type:"points",earned:e.earned+t.earned,total:e.total+t.total,message:n}):"points"===e.type&&"invalid"===t.type?t:"invalid"===e.type&&"points"===t.type?e:"invalid"===e.type&&"invalid"===t.type?{type:"invalid",message:n=e.message&&t.message&&e.message!==t.message?null:e.message||t.message}:void 0},keScoreFromPerseusScore:function(e,t,n){if("points"===e.type)return{empty:!1,correct:e.earned>=e.total,message:e.message,guess:t,state:n};if("invalid"===e.type)return{empty:!0,correct:!1,message:e.message,guess:t,state:n};throw new Error("Invalid score type: "+e.type)},firstNumericalParse:function(e){var t;return oe.predicate.createValidatorFunctional((function(e){return t=e,!0}),{simplify:"optional",inexact:!0,forms:"integer, proper, improper, pi, log, mixed, decimal"})(e),t},stringArrayOfSize:function(e){return re.times(e,(function(){return""}))},gridDimensionConfig:function(e,t,n,s){var i=le.scaleFromExtent(t,n);return{scale:i,tickStep:e/s,unityLabel:e*i>30}},getGridStep:function(e,t,n){return re.times(2,(function(s){var i=le.scaleFromExtent(e[s],n);return le.gridStepFromTickStep(t[s],i)}))},snapStepFromGridStep:function(e){return re.map(e,(function(e){return e/2}))},scaleFromExtent:function(e,t){return t/(e[1]-e[0])},tickStepFromExtent:function(e,t){var n=e[1]-e[0],s=(15<n&&n<=20?23:n>100||n<5?10:16)*(t/500);return le.tickStepFromNumTicks(n,s)},gridStepFromTickStep:function(e,t){var n=e*t,s=e,i=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),r=Math.floor(s/i);return n<25?e:n<50?5===r?e:e/2:1===r?e/2:2===r?e/4:5===r?e/5:void 0},tickStepFromNumTicks:function(e,t){var n=Math.pow(10,Math.floor(Math.log(e/t)/Math.LN10)),s=t/e*n;return s<=.15?n*=10:s<=.35?n*=5:s<=.75&&(n*=2),n},constrainedTickStepsFromTickSteps:function(e,t){const n=[];for(let s=0;s<2;s++){const i=t[s][1]-t[s][0],r=i/e[s];n[s]=r<=10?e[s]:r<=20?2*e[s]:le.tickStepFromNumTicks(i,10)}return n},DeprecationMixin:{componentWillMount:function(){var e={};re.each(this.deprecatedProps,(function(t,n){re.has(this.props,n)&&re.extend(e,t(this.props))}),this),re.isEmpty(e)||(re.extend(this.props,e),setTimeout(this.props.onChange,0,e))}},eq:function(e,t){return re.isNumber(e)&&re.isNumber(t)?Math.abs(e-t)<1e-9:e===t},deepEq:function(e,t){if(re.isArray(e)&&re.isArray(t)){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!le.deepEq(e[n],t[n]))return!1;return!0}return!re.isArray(e)&&!re.isArray(t)&&(re.isFunction(e)&&re.isFunction(t)?le.eq(e,t):!re.isFunction(e)&&!re.isFunction(t)&&(re.isObject(e)&&re.isObject(t)?e===t||re.all(e,(function(e,n){return le.deepEq(t[n],e)}))&&re.all(t,(function(t,n){return le.deepEq(e[n],t)})):!re.isObject(e)&&!re.isObject(t)&&le.eq(e,t)))},parseQueryString:function(e){e=e||window.location.search.substring(1);for(var t,n={},s=/\+/g,i=/([^&=]+)=?([^&]*)/g,r=function(e){return decodeURIComponent(e.replace(s," "))};t=i.exec(e);)n[r(t[1])]=r(t[2]);return n},updateQueryString:function(e,t,n){n=encodeURIComponent(n);var s=new RegExp("([?&])"+t+"=.*?(&|$)","i"),i=-1!==e.indexOf("?")?"&":"?";return e.match(s)?e.replace(s,"$1"+t+"="+n+"$2"):e+i+t+"="+n},strongEncodeURIComponent:function(e){return encodeURIComponent(e).replace(/['()!]/g,window.escape).replace(/\*/g,"%2A")},widgetShouldHighlight:function(e){if(!e)return!1;return!re.contains(["measurer","protractor"],e.type)},scoreIsEmpty:function(e){return"invalid"===e.type&&(!e.message||0===e.message.length)},touchHandlers:{pointerDown:!1,currentTouchIdentifier:null},resetTouchHandlers:function(){re.extend(le.touchHandlers,{pointerDown:!1,currentTouchIdentifier:null})},extractPointerLocation:function(e){var t;if(le.touchHandlers.pointerDown){if(null!=le.touchHandlers.currentTouchIdentifier)for(var n=e.changedTouches?e.changedTouches.length:0,s=0;s<n;s++)e.changedTouches[s].identifier===le.touchHandlers.currentTouchIdentifier&&(t=e.changedTouches[s]);else t=e;var i="touchend"===e.type||"touchcancel"===e.type;t&&i&&(le.touchHandlers.pointerDown=!1,le.touchHandlers.currentTouchIdentifier=null)}else le.touchHandlers.pointerDown=!0,e.changedTouches?(t=e.changedTouches[0],le.touchHandlers.currentTouchIdentifier=t.identifier):t=e;if(t)return{left:t.pageX,top:t.pageY}},captureScratchpadTouchStart:function(e){e.stopPropagation()},getImageSize:function(e,t){var n=new Image;n.onload=function(){0===n.width&&0===n.height?(document.body.appendChild(n),re.defer((function(){t(n.clientWidth,n.clientHeight),document.body.removeChild(n)}))):t(n.width,n.height)},n.src=V(e)},textarea:{getWordBeforeCursor:function(e){var t=e.value,n=e.selectionStart-1,s=Math.max(t.lastIndexOf("\n",n),t.lastIndexOf(" ",n))+1;return{string:t.substring(s,n+1),pos:{start:s,end:n}}},moveCursor:function(e,t){e.selectionStart=t,e.selectionEnd=t}}};le.random=le.seededRNG(4294967295&(new Date).getTime());var ce=le;class he{constructor(e,t,n){this.content=e,this.hint=t,this.tags=n,this.array=ue}setContentMapper(e){return new he(e,this.hint,this.tags)}setHintMapper(e){return new he(this.content,e,this.tags)}setTagsMapper(e){return new he(this.content,this.hint,e)}setArrayMapper(e){return new pe(this.content,this.hint,this.tags,e)}mapTree(e,t){return ge(e,t,[],this)}}class pe{constructor(e,t,n,s){this.content=e,this.hint=t,this.tags=n,this.array=s}setArrayMapper(e){return new pe(this.content,this.hint,this.tags,e)}mapTree(e,t){return ge(e,t,[],this)}}function ue(e){return e}function de(){return new he(ue,ue,ue)}function ge(e,t,n,s){if("content"===t.type){const i=e;return s.content(i,t,n)}if("hint"===t.type){const i=e;return s.hint(i,t,n)}if("tags"===t.type){const i=e;return s.tags(i,t,n)}if("array"===t.type){const i=e;if(!Array.isArray(i))throw new Error(`Invalid object of type "${typeof i}" found at path ${["<root>"].concat(n).join(".")}. Expected array.`);const r=t.elementShape,o=i.map(((e,t)=>ge(e,r,n.concat(t),s)));return s.array(o,i,t,n)}if("object"===t.type){const i=e;if(i&&"object"!==typeof i)throw new Error(`Invalid object of type "${typeof i}" found at path ${["<root>"].concat(n).join(".")}. Expected "object" type.`);const r=t.shape;if(!r)throw new Error(`Unexpected shape ${JSON.stringify(t)} at path ${["<root>"].concat(n).join(".")}.`);const o={};return Object.keys(r).forEach((e=>{if(!(e in i))throw new Error(`Key "${e}" is missing from shape at path ${["<root>"].concat(n).join(".")}.`);o[e]=ge(i[e],r[e],n.concat(e),s)})),o}throw new Error(`unexpected shape type ${t.type}`)}const fe=x.b,me=function(e,t){const n={};return fe.each(fe.keys(e),(function(s){n[s]=t(e[s],s)})),n},be=function(e,t){const n={};return fe.each(e,(function(e){n[e]=t(e)})),n};var ve={pluck:function(e,t){return fe.object(fe.map(e,(function(e,n){return[n,e[t]]})))},mapObject:me,mapObjectFromArray:be},xe=n(13),ye=n.n(xe);h.a,PropTypes.shape({contentType:PropTypes.string,highlightLint:PropTypes.bool,paths:PropTypes.arrayOf(PropTypes.string),stack:PropTypes.arrayOf(PropTypes.string)});const je={contentType:"",highlightLint:!1,paths:[],stack:[]};class we{static parse(e){return new Oe(e).parse()}match(e){throw new Error("Selector subclasses must implement match()")}toString(){return"Unknown selector class"}}class Oe{constructor(e){e=e.trim().replace(/\s+/g," "),this.tokens=e.match(Oe.TOKENS)||[],this.tokenIndex=0}nextToken(){return this.tokens[this.tokenIndex]||""}consume(){this.tokenIndex++}isIdentifier(){const e=this.tokens[this.tokenIndex][0];return e>="a"&&e<="z"||e>="A"&&e<="Z"}skipSpace(){for(;" "===this.nextToken();)this.consume()}parse(){const e=this.parseTreeSelector();let t=this.nextToken();if(!t)return e;const n=[e];for(;t;){if(","!==t)throw new Ce("Expected comma");this.consume(),n.push(this.parseTreeSelector()),t=this.nextToken()}return new Se(n)}parseTreeSelector(){this.skipSpace();let e=this.parseNodeSelector();for(;;){const t=this.nextToken();if(!t||","===t)break;if(" "===t)this.consume(),e=new Me(e,this.parseNodeSelector());else if(">"===t)this.consume(),e=new Ne(e,this.parseNodeSelector());else if("+"===t)this.consume(),e=new Pe(e,this.parseNodeSelector());else{if("~"!==t)throw new Ce("Unexpected token: "+t);this.consume(),e=new Ie(e,this.parseNodeSelector())}}return e}parseNodeSelector(){this.skipSpace();const e=this.nextToken();if("*"===e)return this.consume(),new ke;if(this.isIdentifier())return this.consume(),new _e(e);throw new Ce("Expected node type")}}Oe.TOKENS=/([a-zA-Z][\w-]*)|(\d+)|[^\s]|(\s(?=[a-zA-Z\*]))/g;class Ce extends Error{constructor(e){super(e)}}class Se extends we{constructor(e){super(),this.selectors=e}match(e){for(let t=0;t<this.selectors.length;t++){const n=this.selectors[t].match(e);if(n)return n}return null}toString(){let e="";for(let t=0;t<this.selectors.length;t++)e+=t>0?", ":"",e+=this.selectors[t].toString();return e}}class ke extends we{match(e){return[e.currentNode()]}toString(){return"*"}}class _e extends we{constructor(e){super(),this.type=e}match(e){const t=e.currentNode();return t.type===this.type?[t]:null}toString(){return this.type}}class Te extends we{constructor(e,t){super(),this.left=e,this.right=t}}class Me extends Te{constructor(e,t){super(e,t)}match(e){const t=this.right.match(e);if(t)for(e=e.clone();e.hasParent();){e.goToParent();const n=this.left.match(e);if(n)return n.concat(t)}return null}toString(){return this.left.toString()+" "+this.right.toString()}}class Ne extends Te{constructor(e,t){super(e,t)}match(e){const t=this.right.match(e);if(t&&e.hasParent()){(e=e.clone()).goToParent();const n=this.left.match(e);if(n)return n.concat(t)}return null}toString(){return this.left.toString()+" > "+this.right.toString()}}class Pe extends Te{constructor(e,t){super(e,t)}match(e){const t=this.right.match(e);if(t&&e.hasPreviousSibling()){(e=e.clone()).goToPreviousSibling();const n=this.left.match(e);if(n)return n.concat(t)}return null}toString(){return this.left.toString()+" + "+this.right.toString()}}class Ie extends Te{constructor(e,t){super(e,t)}match(e){const t=this.right.match(e);if(t)for(e=e.clone();e.hasPreviousSibling();){e.goToPreviousSibling();const n=this.left.match(e);if(n)return n.concat(t)}return null}toString(){return this.left.toString()+" ~ "+this.right.toString()}}class Ee{constructor(e,t,n,s,i,r){if(!n&&!s)throw new Error("Lint rules must have a selector or pattern");this.name=e||"unnamed rule",this.severity=t||Ee.Severity.BULK_WARNING,this.selector=n||Ee.DEFAULT_SELECTOR,this.pattern=s||null,"function"===typeof i?(this.lint=i,this.message=null):(this.lint=this._defaultLintFunction,this.message=i),this.applies=r||function(){return!0}}static makeRule(e){return new Ee(e.name,e.severity,e.selector?we.parse(e.selector):null,Ee.makePattern(e.pattern),e.lint||e.message,e.applies)}check(e,t,n,s){const i=this.selector.match(t);if(!i)return null;let r;if(r=this.pattern?n.match(this.pattern):Ee.FakePatternMatch(n,n,0),!r)return null;try{const e=this.lint(t,n,i,r,s);return e?"string"===typeof e?{rule:this.name,severity:this.severity,message:e,start:0,end:n.length}:{rule:this.name,severity:this.severity,message:e.message,start:e.start,end:e.end}:null}catch(o){return{rule:"lint-rule-failure",message:`Exception in rule ${this.name}: ${o.message}\nStack trace:\n${o.stack}`,start:0,end:n.length}}}_defaultLintFunction(e,t,n,s){return{message:this.message||"",start:s.index,end:s.index+s[0].length}}static makePattern(e){if(e){if(e instanceof RegExp)return e;if("/"===e[0]){const t=e.lastIndexOf("/"),n=e.substring(1,t),s=e.substring(t+1);return new RegExp(n,s)}return new RegExp(e)}return null}static FakePatternMatch(e,t,n){const s=[t];return s.index=n,s.input=e,s}}Ee.Severity={ERROR:1,WARNING:2,GUIDELINE:3,BULK_WARNING:4},Ee.DEFAULT_SELECTOR=we.parse("text");var Ae={exports:{}};Ae.exports;Ae.exports=Ee.makeRule({name:"image-widget",severity:Ee.Severity.BULK_WARNING,selector:"widget",lint:function(e,t,n,s,i){if("image"!==e.currentNode().widgetType)return;const r=i&&i.widgets&&i.widgets[e.currentNode().id];if(!r)return;const o=r.options.alt;return o?o.trim().length<8?`Images should have alt text:\nfor accessibility, all images should have descriptive alt text.\nThis image's alt text is only ${o.trim().length} characters long.`:r.options.caption&&r.options.caption.match(/[^\\]\$/)?"No math in image captions:\nDon't include math expressions in image captions.":void 0:'Images should have alt text:\nfor accessibility, all images should have a text description.\nAdd a description in the "Alt Text" box of the image widget.'}});var Re=Ae.exports,De={exports:{}};De.exports;De.exports=Ee.makeRule({name:"image-spaces-around-urls",severity:Ee.Severity.ERROR,selector:"image",lint:function(e,t,n,s,i){const r=n[0].target;if(i&&i.content){const e=i.content.indexOf(r);if(-1===e)return;if("("!==i.content[e-1]||")"!==i.content[e+r.length])return"Whitespace before or after image url:\nFor images, don't include any space or newlines after '(' or before ')'.\nWhitespace in image URLs causes translation difficulties."}}});var Le=De.exports,Fe={exports:{}};Fe.exports;Fe.exports=Ee.makeRule({name:"unbalanced-code-delimiters",severity:Ee.Severity.ERROR,pattern:/[`~]+/,message:"Unbalanced code delimiters:\ncode blocks should begin and end with the same type and number of delimiters"});var ze=Fe.exports,qe={exports:{}};qe.exports;qe.exports=Ee.makeRule({name:"math-without-dollars",severity:Ee.Severity.GUIDELINE,pattern:/\\\w+{[^}]*}|{|}/,message:"This looks like LaTeX:\ndid you mean to put it inside dollar signs?"});var We=qe.exports,Be={exports:{}};Be.exports;Be.exports=Ee.makeRule({name:"profanity",pattern:/\b(shit|piss|fuck|cunt|cocksucker|motherfucker|tits)\b/i,message:"Avoid profanity"});var Ve=Be.exports,He={exports:{}};He.exports;He.exports=Ee.makeRule({name:"widget-in-table",severity:Ee.Severity.BULK_WARNING,selector:"table widget",message:"Widget in table:\ndo not put widgets inside of tables."});var Ue=He.exports,Ge={exports:{}};Ge.exports;Ge.exports=Ee.makeRule({name:"unescaped-dollar",severity:Ee.Severity.ERROR,selector:"unescapedDollar",message:"Unescaped dollar sign:\nDollar signs must appear in pairs or be escaped as \\$"});var $e=Ge.exports,Ye={exports:{}};Ye.exports;Ye.exports=Ee.makeRule({name:"table-missing-cells",severity:Ee.Severity.WARNING,selector:"table",lint:function(e,t,n,s){const i=n[0],r=i.header.length,o=i.cells.map((e=>e.length));for(let a=0;a<o.length;a++)if(o[a]!==r)return`Table rows don't match header:\nThe table header has ${r} cells, but\nRow ${a+1} has ${o[a]} cells.`}});var Ke=Ye.exports,Xe={exports:{}};Xe.exports;Xe.exports=Ee.makeRule({name:"nested-lists",severity:Ee.Severity.WARNING,selector:"list list",message:"Nested lists:\nnested lists are hard to read on mobile devices;\ndo not use additional indentation."});var Ze=Xe.exports,Je={exports:{}};Je.exports;Je.exports=Ee.makeRule({name:"math-text-empty",severity:Ee.Severity.WARNING,selector:"math, blockMath",pattern:/\\text{\s*}/,message:"Empty \\text{} block in math expression"});var Qe=Je.exports,et={exports:{}};et.exports;et.exports=Ee.makeRule({name:"math-starts-with-space",severity:Ee.Severity.GUIDELINE,selector:"math, blockMath",pattern:/^\s*(~|\\qquad|\\quad|\\,|\\;|\\:|\\ |\\!|\\enspace|\\phantom)/,message:"Math starts with space:\nmath should not be indented. Do not begin math expressions with\nLaTeX space commands like ~, \\;, \\quad, or \\phantom"});var tt=et.exports,nt={exports:{}};nt.exports;nt.exports=Ee.makeRule({name:"math-nested",severity:Ee.Severity.ERROR,selector:"math, blockMath",pattern:/\\text{[^$}]*\$[^$}]*\$[^}]*}/,message:"Nested math:\nDon't nest math expressions inside \\text{} blocks"});var st=nt.exports,it={exports:{}};it.exports;it.exports=Ee.makeRule({name:"math-frac",severity:Ee.Severity.GUIDELINE,selector:"math, blockMath",pattern:/\\frac[ {]/,message:"Use \\dfrac instead of \\frac in your math expressions."});var rt=it.exports,ot={exports:{}};ot.exports;ot.exports=Ee.makeRule({name:"math-font-size",severity:Ee.Severity.GUIDELINE,selector:"math, blockMath",pattern:/\\(tiny|Tiny|small|large|Large|LARGE|huge|Huge|scriptsize|normalsize)\s*{/,message:"Math font size:\nDon't change the default font size with \\Large{} or similar commands"});var at=ot.exports,lt={exports:{}};lt.exports;lt.exports=Ee.makeRule({name:"math-empty",severity:Ee.Severity.WARNING,selector:"math, blockMath",pattern:/^$/,message:"Empty math: don't use $$ in your markdown."});var ct=lt.exports,ht={exports:{}};ht.exports;ht.exports=Ee.makeRule({name:"math-align-linebreaks",severity:Ee.Severity.WARNING,selector:"blockMath",pattern:/\\begin{align}.*[^\\](\\{2,3}[^\\]|\\{5,}).*\\end{align}/,message:"Use four backslashes between lines of an align block"});var pt=ht.exports,ut={exports:{}};ut.exports;ut.exports=Ee.makeRule({name:"math-align-extra-break",severity:Ee.Severity.WARNING,selector:"blockMath",pattern:/(\\{2,})\s*\\end{align}/,message:"Extra space at end of block:\nDon't end an align block with backslashes"});var dt=ut.exports,gt={exports:{}};gt.exports;gt.exports=Ee.makeRule({name:"math-adjacent",severity:Ee.Severity.WARNING,selector:"blockMath+blockMath",message:"Adjacent math blocks:\ncombine the blocks between \\begin{align} and \\end{align}"});var ft=gt.exports,mt={exports:{}};mt.exports;mt.exports=Ee.makeRule({name:"long-paragraph",severity:Ee.Severity.GUIDELINE,selector:"paragraph",pattern:/^.{501,}/,lint:function(e,t,n,s){return`Paragraph too long:\nThis paragraph is ${t.length} characters long.\nShorten it to 500 characters or fewer.`}});var bt=mt.exports,vt={exports:{}};vt.exports;vt.exports=Ee.makeRule({name:"link-click-here",severity:Ee.Severity.WARNING,selector:"link",pattern:/click here/i,message:'Inappropriate link text:\nDo not use the words "click here" in links.'});var xt=vt.exports,yt={exports:{}};yt.exports;yt.exports=Ee.makeRule({name:"image-in-table",severity:Ee.Severity.BULK_WARNING,selector:"table image",message:"Image in table:\ndo not put images inside of tables."});var jt=yt.exports,wt={exports:{}};wt.exports;wt.exports=Ee.makeRule({name:"image-alt-text",severity:Ee.Severity.BULK_WARNING,selector:"image",lint:function(e,t,n,s){const i=n[0];return i.alt&&i.alt.trim()?i.alt.length<8?`Images should have alt text:\nfor accessibility, all images should have descriptive alt text.\nThis image's alt text is only ${i.alt.length} characters long.`:void 0:"Images should have alt text:\nfor accessibility, all images should have alt text.\nSpecify alt text inside square brackets after the !."}});var Ot=wt.exports,Ct={exports:{}};Ct.exports;const St={and:!0,nor:!0,but:!0,the:!0,for:!0};Ct.exports=Ee.makeRule({name:"heading-title-case",severity:Ee.Severity.GUIDELINE,selector:"heading",pattern:/[^\s:]\s+[A-Z]+[a-z]/,locale:"en",lint:function(e,t,n,s){let i=t.trim().split(/\s+/);if(i.shift(),i=i.filter((e=>e.length>2&&!St.hasOwnProperty(e))),i.length>=3&&i.every((e=>function(e){const t=e[0];return t===t.toUpperCase()}(e))))return"Title-case heading:\nThis heading appears to be in title-case, but should be sentence-case.\nOnly capitalize the first letter and proper nouns."}});var kt=Ct.exports,_t={exports:{}};_t.exports;_t.exports=Ee.makeRule({name:"heading-sentence-case",severity:Ee.Severity.GUIDELINE,selector:"heading",pattern:/^\W*[a-z]/,message:"First letter is lowercase:\nthe first letter of a heading should be capitalized."});var Tt=_t.exports,Mt={exports:{}};Mt.exports;Mt.exports=Ee.makeRule({name:"heading-level-skip",severity:Ee.Severity.WARNING,selector:"heading ~ heading",lint:function(e,t,n,s){const i=n[1],r=n[0];if(i.level>r.level+1)return`Skipped heading level:\nthis heading is level ${i.level} but\nthe previous heading was level ${r.level}`}});var Nt=Mt.exports,Pt={exports:{}};Pt.exports;Pt.exports=Ee.makeRule({name:"heading-level-1",severity:Ee.Severity.WARNING,selector:"heading",lint:function(e,t,n,s){if(1===n[0].level)return"Don't use level-1 headings:\nBegin headings with two or more # characters."}});var It=Pt.exports,Et={exports:{}};Et.exports;Et.exports=Ee.makeRule({name:"extra-content-spacing",selector:"paragraph",pattern:/\s+$/,applies:function(e){return"article"===e.contentType},message:"No extra whitespace at the end of content blocks."});var At=Et.exports,Rt={exports:{}};Rt.exports;Rt.exports=Ee.makeRule({name:"double-spacing-after-terminal",severity:Ee.Severity.BULK_WARNING,selector:"paragraph",pattern:/[.!\?] {2}/i,message:"Use a single space after a sentence-ending period, or\nany other kind of terminal punctuation."});var Dt=Rt.exports,Lt={exports:{}};Lt.exports;Lt.exports=Ee.makeRule({name:"blockquoted-widget",severity:Ee.Severity.WARNING,selector:"blockQuote widget",message:"Blockquoted widget:\nwidgets should not be indented."});var Ft=Lt.exports,zt={exports:{}};zt.exports;zt.exports=Ee.makeRule({name:"blockquoted-math",severity:Ee.Severity.WARNING,selector:"blockQuote math, blockQuote blockMath",message:"Blockquoted math:\nmath should not be indented."});var qt=zt.exports;const Wt=/\/\/([^\/]+)/;function Bt(e){if(!e)return"";const t=e.match(Wt);return t?t[1]:""}var Vt={exports:{}};Vt.exports;Vt.exports=Ee.makeRule({name:"absolute-url",severity:Ee.Severity.GUIDELINE,selector:"link, image",lint:function(e,t,n,s){const i=Bt(n[0].target);if("khanacademy.org"===i||i.endsWith(".khanacademy.org"))return"Don't use absolute URLs:\nWhen linking to KA content or images, omit the\nhttps://www.khanacademy.org URL prefix.\nUse a relative URL beginning with / instead."}});var Ht=Vt.exports,Ut={exports:{}};Ut.exports;Ut.exports=[Ht,qt,Ft,Dt,At,It,Nt,Tt,kt,Ot,jt,xt,bt,ft,dt,pt,ct,at,rt,st,tt,Qe,Ze,Ke,$e,Ue,Ve,We,ze,Le,Re];var Gt=Ut.exports,$t=n(0),Yt={exports:{}};Yt.exports;h.a;Yt.exports=e=>{let{path:t,width:n,height:s,style:i={},title:r}=e;return Object($t.jsxs)("svg",{role:"img","aria-hidden":!r,style:{verticalAlign:"middle",...i},width:n/s+"em",height:"1em",viewBox:`0 0 ${n} ${s}`,children:[!!r&&Object($t.jsx)("title",{children:r}),Object($t.jsx)("path",{d:t,fill:"currentColor"})]})};var Kt=Yt.exports;const Xt="'Proxima Nova',sans-serif",Zt="'Proxima Nova Semibold',sans-serif",Jt="#71B307",Qt="#1C758A",en="#FFBABA",tn="#FFFFFF",nn="#F0F1F2",sn="#D6D8DA",rn="#BABEC2",on="#888D93",an="#21242c",ln="#F86700",cn="568px",hn="768px",pn="1024px",un="767px",dn="1023px",gn="1279px",fn="#F9F9F9",mn="#0084CE",bn="#009900",vn="#00CC00",xn="#990000",yn="#CC5252",jn=16,wn=-16,On=16,Cn=400,Sn=288,kn="#f86700",_n="#df5c00",Tn=rn,Mn=Jt;var Nn=n(3);h.a;const Pn=i.a,In=Kt,En={path:"M6 11a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm0-9a1 1 0 0 1 1 1v4a1 1 0 1 1-2 0V3a1 1 0 0 1 1-1z",height:12,width:12},An=createReactClass({displayName:"Lint",getInitialState:function(){return{tooltipAbove:!0}},componentDidMount:function(){this._positionTimeout=window.setTimeout(this.getPosition)},componentWillUnmount:function(){window.clearTimeout(this._positionTimeout)},getPosition:function(){const e=Pn.findDOMNode(this).getBoundingClientRect();this.setState({tooltipAbove:e.top>100})},renderLink:function(e){const t=this.state.tooltipAbove;let n,s,i;return 1===this.props.severity?(n=Rn.indicatorError,s="Error",i=Rn.publishBlockingError):2===this.props.severity?(n=Rn.indicatorWarning,s="Warning",i=Rn.warning):(n=Rn.indicatorGuideline,s="Recommendation",i=Rn.warning),Object($t.jsxs)("a",{href:"https://khanacademy.org/r/linter-rules#"+this.props.ruleName,target:"lint-help-window",className:Object(Nn.css)(e),children:[Object($t.jsx)("span",{className:Object(Nn.css)(Rn.indicator,n),children:1===this.props.severity&&Object($t.jsx)(In,{...En})}),Object($t.jsxs)("div",{className:Object(Nn.css)(Rn.tooltip,t&&Rn.tooltipAbove),children:[this.props.message.split("\n\n").map(((e,t)=>Object($t.jsxs)("p",{className:Object(Nn.css)(Rn.tooltipParagraph),children:[Object($t.jsxs)("span",{className:Object(Nn.css)(i),children:[s,":"," "]}),e]},t))),Object($t.jsx)("div",{className:Object(Nn.css)(Rn.tail,t&&Rn.tailAbove)})]})]})},render:function(){return this.props.insideTable?this.props.inline?Object($t.jsx)("span",{"data-lint-inside-table":"true",children:this.props.children}):Object($t.jsx)("div",{"data-lint-inside-table":"true",children:this.props.children}):this.props.inline?Object($t.jsxs)("span",{className:Object(Nn.css)(Rn.lintContainer),children:[this.renderLink(Rn.inlineHoverTarget),Object($t.jsx)("span",{children:this.props.children})]}):Object($t.jsxs)("div",{className:Object(Nn.css)(Rn.lintContainer),children:[this.renderLink(Rn.hoverTarget),Object($t.jsx)("div",{children:this.props.children})]})}}),Rn=Nn.StyleSheet.create({lintContainer:{position:"relative"},hoverTarget:{position:"absolute",top:0,right:-40,display:"block",width:24,height:24,":hover > span":{backgroundColor:_n},":hover div":{display:"block"},":hover ~ div":{outline:"1px solid "+kn},":hover ~ div div[data-lint-inside-table]":{outline:"1px solid "+kn},":hover ~ div span[data-lint-inside-table]":{backgroundColor:kn,color:tn}},inlineHoverTarget:{float:"right",position:"relative",marginRight:-40,display:"block",width:24,height:24,":hover > span":{backgroundColor:_n},":hover div":{display:"block"},":hover ~ span":{backgroundColor:kn,color:tn}},indicator:{alignItems:"center",borderRadius:4,color:"white",display:"flex",fontSize:12,height:8,justifyContent:"center",margin:8,width:8},indicatorError:{backgroundColor:"#be2612",borderRadius:8,height:16,width:16},indicatorWarning:{backgroundColor:"#f86700"},indicatorGuideline:{backgroundColor:"#ffbe26"},tooltip:{position:"absolute",right:-12,display:"none",zIndex:"1000",color:tn,backgroundColor:an,opacity:"0.9",fontFamily:Xt,fontSize:"12px",lineHeight:"15px",width:"320px",borderRadius:"4px"},tooltipAbove:{bottom:32},tail:{position:"absolute",top:-12,right:16,width:0,height:0,borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderBottom:"12px solid "+an},tailAbove:{bottom:-12,borderBottom:"none",borderTop:"12px solid "+an,top:"auto"},tooltipParagraph:{margin:12},warning:{color:kn,fontFamily:Zt},publishBlockingError:{color:"#be2612"}});var Dn=An,Ln=n(20),Fn=n(41),zn=n.n(Fn),qn={exports:{}},Wn=(qn.exports,x.b),Bn=zn.a,Vn=Ln.a,Hn=ce;const Un=Dn;var Gn=(e,t,n)=>{var s=e.length,i=0;if(n){if(t.inline)return null;for(;i<s&&" "===e[i];)i++}if(!(i<s&&"$"===e[i]))return null;for(var r=++i,o=0;i<s;){var a=e[i];if("\\"===a)i++;else{if(o<=0&&"$"===a){var l=i+1;if(n){var c=/^(?: *\n){2,}/.exec(e.slice(l));l=c?l+c[0].length:null}return l?[e.substring(0,l),e.substring(r,i)]:null}if("{"===a)o++;else if("}"===a)o--;else if("\n"===a&&"\n"===e[i-1])return null}i++}return null},$n=new RegExp("^\\|\\| +(.*) +\\|\\| *\\n("+Bn.defaultRules.nptable.match.regex.source.substring(1)+")"),Yn=Bn.blockRegex(/^(crwdns.*)\n\s*\n/),Kn=Wn.extend({},Bn.defaultRules,{columns:{order:-2,match:Bn.blockRegex(/^([\s\S]*\n\n)={5,}\n\n([\s\S]*)/),parse:(e,t,n)=>({col1:t(e[1],n),col2:t(e[2],n)}),react:(e,t,n)=>Object($t.jsxs)("div",{className:"perseus-two-columns",children:[Object($t.jsx)("div",{className:"perseus-column",children:Object($t.jsx)("div",{className:"perseus-column-content",children:t(e.col1,n)})}),Object($t.jsxs)("div",{className:"perseus-column",children:[Object($t.jsx)("div",{className:"sat-header-grafting-area"}),Object($t.jsxs)("div",{className:"perseus-column-content",children:[Object($t.jsx)("div",{className:"sat-skill-subscore-grafting-area"}),t(e.col2,n),Object($t.jsx)("div",{className:"sat-grafting-area"})]})]})]},n.key)},crowdinId:{order:-1,match:(e,t,n)=>t.isJipt?Yn(e,t,n):null,parse:(e,t,n)=>({id:e[1]}),react:(e,t,n)=>e.id},titledTable:{order:Bn.defaultRules.nptable.order-.5,match:Bn.blockRegex($n),parse:(e,t,n)=>{var s=Bn.parseInline(t,e[1],n),i=Wn.rest(e,2);return{title:s,table:Bn.defaultRules.nptable.parse(i,t,n)}},react:(e,t,n)=>{let s;if(e.table){const i=Bn.defaultRules.table.react(e.table,t,n),r=Object($t.jsx)("caption",{className:"perseus-table-title",children:t(e.title,n)},"caption");s=h.a.cloneElement(i,null,[r,...i.props.children])}else s="//invalid table//";return Object($t.jsx)("div",{className:"perseus-titled-table",children:s},n.key)}},widget:{order:Bn.defaultRules.link.order-.75,match:Bn.inlineRegex(Hn.rWidgetRule),parse:(e,t,n)=>({id:e[1],widgetType:e[2]}),react:(e,t,n)=>Object($t.jsxs)("em",{children:["[Widget: ",e.id,"]"]},n.key)},blockMath:{order:Bn.defaultRules.codeBlock.order+.5,match:(e,t)=>Gn(e,t,!0),parse:(e,t,n)=>({content:e[1]}),react:(e,t,n)=>Object($t.jsx)(Vn,{children:e.content},n.key)},math:{order:Bn.defaultRules.link.order-.25,match:(e,t)=>Gn(e,t,!1),parse:(e,t,n)=>({content:e[1]}),react:(e,t,n)=>Object($t.jsx)(Vn,{children:e.content},n.key)},unescapedDollar:{order:Bn.defaultRules.link.order-.24,match:Bn.inlineRegex(/^(?!\\)\$/),parse:(e,t,n)=>({}),react:(e,t,n)=>"$"},fence:Wn.extend({},Bn.defaultRules.fence,{parse:(e,t,n)=>{var s=Bn.defaultRules.fence.parse(e,t,n);return"alt"===s.lang?{type:"codeBlock",lang:"alt",content:t(s.content+"\n\n",n)}:s}}),link:Wn.extend({},Bn.defaultRules.link,{react:function(e,t,n){const s=Bn.defaultRules.link.react(e,t,n);let i=s.props.href;"undefined"!==typeof KA&&KA.isZeroRated&&(i=i.match(/https?:\/\/[^\/]*khanacademy.org/)?i.replace("khanacademy.org","zero.khanacademy.org"):"/zero/external-link?url="+encodeURIComponent(i));const r={...s.props,href:i};return n.baseElements&&n.baseElements.Link?n.baseElements.Link(r):h.a.cloneElement(s,r)}}),codeBlock:Wn.extend({},Bn.defaultRules.codeBlock,{react:(e,t,n)=>"alt"===e.lang?Object($t.jsx)("div",{className:"perseus-markdown-alt perseus-sr-only",children:t(e.content,n)},n.key):Bn.defaultRules.codeBlock.react(e,t,n)}),list:Wn.extend({},Bn.defaultRules.list,{match:(e,t,n)=>t.isJipt?null:Bn.defaultRules.list.match(e,t,n)}),lint:{order:1e3,match:e=>null,parse:(e,t,n)=>({}),react:(e,t,n)=>Object($t.jsx)(Un,{message:e.message,ruleName:e.ruleName,inline:Xn(e.content),insideTable:e.insideTable,severity:e.severity,children:t(e.content,n)})}});function Xn(e){return!!(e&&e.type&&Zn.hasOwnProperty(e.type))}const Zn={text:!0,math:!0,unescapedDollar:!0,link:!0,img:!0,strong:!0,u:!0,em:!0,del:!0,code:!0};var Jn=Bn.parserFor(Kn),Qn=(e,t)=>Jn(e+"\n\n",Wn.extend({inline:!1},t)),es=(e,t)=>{Wn.isArray(e)?Wn.each(e,(e=>es(e,t))):Wn.isObject(e)&&(t(e),"table"===e.type?(es(e.header,t),es(e.cells,t)):"list"===e.type?es(e.items,t):"titledTable"===e.type?es(e.table,t):"columns"===e.type?(es(e.col1,t),es(e.col2,t)):Wn.isArray(e.content)&&es(e.content,t))},ts=e=>{if(Wn.isArray(e))return Wn.flatten(Wn.map(e,ts));if(e.content&&Wn.isString(e.content))return-1!==e.type.toLowerCase().indexOf("code")?["",e.content,""]:[e.content.replace(/\s+/g," ")];var t=Wn.chain(e).values().flatten().filter((e=>null!=e&&Wn.has(e,"type"))).value();if(t.length){var n=ts(t);if("paragraph"===e.type&&n.length){n[0]=n[0].replace(/^\s+/,"");var s=n.length-1;n[s]=n[s].replace(/\s+$/,"")}return n}return[]};qn.exports={characterCount:e=>{var t=Qn(e);return ts(t).join("").length},traverseContent:es,parse:Qn,parseInline:(e,t)=>Jn(e,Wn.extend({inline:!0},t)),reactFor:Bn.reactFor,ruleOutput:Bn.ruleOutput(Kn,"react"),basicOutput:Bn.reactFor(Bn.ruleOutput(Kn,"react")),sanitizeUrl:Bn.sanitizeUrl};var ns=qn.exports;class ss{constructor(e){this.root=e}static isNode(e){return e&&"object"===typeof e&&"string"===typeof e.type}static isTextNode(e){return ss.isNode(e)&&"text"===e.type&&"string"===typeof e.content}traverse(e){this._traverse(this.root,new is(this.root),e)}_traverse(e,t,n){let s="";if(ss.isNode(e)){const i=e;t._containers.push(i),t._ancestors.push(i),"string"===typeof i.content&&(s=i.content);Object.keys(i).forEach((e=>{if("type"===e)return;const r=i[e];r&&"object"===typeof r&&(t._indexes.push(e),s+=this._traverse(r,t,n),t._indexes.pop())})),t._currentNode=t._ancestors.pop(),t._containers.pop(),n(i,t,s)}else if(Array.isArray(e)){const i=e;t._containers.push(i);let r=0;for(;r<i.length;)t._indexes.push(r),s+=this._traverse(i[r],t,n),r=t._indexes.pop()+1;t._containers.pop()}return s}}class is{constructor(e){this.root=e,this._currentNode=null,this._containers=new rs,this._indexes=new rs,this._ancestors=new rs}currentNode(){return this._currentNode||this.root}parent(){return this._ancestors.top()}ancestors(){return this._ancestors.values()}nextSibling(){const e=this._containers.top();if(!e||!Array.isArray(e))return null;const t=this._indexes.top();return e.length>t+1?e[t+1]:null}previousSibling(){const e=this._containers.top();if(!e||!Array.isArray(e))return null;const t=this._indexes.top();return t>0?e[t-1]:null}removeNextSibling(){const e=this._containers.top();if(e&&Array.isArray(e)){const t=this._indexes.top();if(e.length>t+1)return e.splice(t+1,1)[0]}return null}replace(){const e=this._containers.top();if(!e)throw new Error("Can't replace the root of the tree");const t=Array.isArray(e),n=e,s=this._indexes.top(),i=e,r=this._indexes.top();for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];t?(n.splice(s,1,...a),this._indexes.pop(),this._indexes.push(s+a.length-1)):0===a.length?delete i[r]:1===a.length?i[r]=a[0]:i[r]=a}hasPreviousSibling(){return Array.isArray(this._containers.top())&&this._indexes.top()>0}goToPreviousSibling(){if(!this.hasPreviousSibling())throw new Error("goToPreviousSibling(): node has no previous sibling");this._currentNode=this.previousSibling();const e=this._indexes.pop();this._indexes.push(e-1)}hasParent(){return 0!==this._ancestors.size()}goToParent(){if(!this.hasParent())throw new Error("goToParent(): node has no ancestor");for(this._currentNode=this._ancestors.pop();this._containers.size()&&this._containers.top()[this._indexes.top()]!==this._currentNode;)this._containers.pop(),this._indexes.pop()}clone(){const e=new is(this.root);return e._currentNode=this._currentNode,e._containers=this._containers.clone(),e._indexes=this._indexes.clone(),e._ancestors=this._ancestors.clone(),e}equals(e){return this.root===e.root&&this._currentNode===e._currentNode&&this._containers.equals(e._containers)&&this._indexes.equals(e._indexes)&&this._ancestors.equals(e._ancestors)}}class rs{constructor(e){this.stack=e?e.slice(0):[]}push(e){this.stack.push(e)}pop(){return this.stack.pop()}top(){return this.stack[this.stack.length-1]}values(){return this.stack.slice(0)}size(){return this.stack.length}toString(){return this.stack.toString()}clone(){return new rs(this.stack)}equals(e){if(!e||!e.stack||e.stack.length!==this.stack.length)return!1;for(let t=0;t<this.stack.length;t++)if(this.stack[t]!==e.stack[t])return!1;return!0}}var os={exports:{}};os.exports;const as=Gt.filter((e=>e.severity<Ee.Severity.BULK_WARNING));os.exports={runLinter:function(e,t,n,s){s=s||as;const i=[],r=new ss(e);r.traverse(((e,t,n)=>{if(ss.isTextNode(e)){let n=t.nextSibling();for(;ss.isTextNode(n);)e.content+=n.content,t.removeNextSibling(),n=t.nextSibling()}}));let o=[],a=!1;return r.traverse(((e,r,l)=>{const c=[],h=s.filter((e=>e.applies(t))),p=[...t.stack];p.push(e.type);const u={...t,stack:p.join(".")};if(h.forEach((t=>{const s=t.check(e,r,l,u);s&&((s.start||s.end)&&(s.target=l.substring(s.start,s.end)),i.push(s),n&&c.push(s))})),n&&("table"===e.type?(o.length&&c.push(...o),a=!1,o=[]):a||(a=r.ancestors().some((e=>"table"===e.type))),a&&c.length&&o.push(...c),c.length))if(c.sort(((e,t)=>e.severity-t.severity)),"text"!==e.type||c.length>1)r.replace({type:"lint",content:e,message:c.map((e=>e.message)).join("\n\n"),ruleName:c[0].rule,insideTable:a,severity:c[0].severity});else{const t=e.content,n=c[0],s=n.start||0,i=n.end||t.length,o=t.substring(0,s),l=t.substring(s,i),h=t.substring(i),p=[];o&&p.push({type:"text",content:o}),p.push({type:"lint",content:{type:"text",content:l},message:n.message,ruleName:n.rule,insideTable:a,severity:n.severity}),h&&p.push({type:"text",content:h}),r.replace(...p)}})),i},parse:ns.parse,pushContextStack:function(e,t){const n=e.stack||[];return{...e,stack:n.concat(t)}},rules:as};var ls=os.exports,cs={exports:{}};cs.exports;cs.exports=e=>e.replace(/\{align[*]?\}/g,"{aligned}").replace(/[\u00a0]/g," ");var hs=cs.exports,ps={exports:{}};ps.exports;ps.exports=class{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}then(e){return this.promise.then(e)}};var us=ps.exports,ds={exports:{}};ds.exports;h.a;const gs=i.a,fs=us,ms=createReactClass({displayName:"Zoomable",getDefaultProps(){const e=new fs;return e.resolve(),{animateHeight:!1,readyToMeasureDeferred:e,computeChildBounds:e=>{const t=e.firstElementChild;return{width:t.offsetWidth+1,height:t.offsetHeight+1}}}},getInitialState:()=>({visible:!1,marginBottomPx:0,zoomed:!0}),componentDidMount(){this._node=gs.findDOMNode(this),this.props.readyToMeasureDeferred.then((()=>{this.isMounted()&&(this.scaleChildToFit(!1),window.MutationObserver&&(this._observer=new MutationObserver((e=>{if(this.isMounted())for(const t of e)if(t.target!==this._node){this.scaleChildToFit(this.state.zoomed);break}})),this._observer.observe(this._node,{childList:!0,subtree:!0,attributes:!0})),window.addEventListener("resize",this.reset))}))},componentWillUnmount(){window.removeEventListener("resize",this.reset),this._observer&&this._observer.disconnect()},reset(){this.isMounted()&&this.state.visible&&(this._originalWidth=null,this.setState({visible:!1,compactHeight:null,expandedHeight:null,zoomed:!0},(()=>{this.scaleChildToFit(!1)})))},stopPropagationIfZoomed(e){this.state.zoomed||e.stopPropagation()},scaleChildToFit(e){const t={width:this._node.offsetWidth,height:this._node.offsetHeight},n=this.props.computeChildBounds(this._node,t),s=n.width,i=n.height;if(s>t.width){const n=t.width/s;this.setState({scale:n,zoomed:e,compactHeight:Math.ceil(n*i),expandedHeight:i}),setTimeout((()=>{this.isMounted()&&this.setState({visible:!0})}))}else this.setState({visible:!0})},handleClickIfZoomed(e){this.state.zoomed||(e.stopPropagation(),this.handleClick())},handleClick(){this.setState({zoomed:!this.state.zoomed})},render(){const{visible:e,scale:t,compactHeight:n,expandedHeight:s,zoomed:i}=this.state,{animateHeight:r}=this.props,o=r?"opacity transform height":"opacity transform",a=e?"":" translate(0, 8px)",l=i?`scale(1, 1) ${a}`:`scale(${t}, ${t}) ${a}`,c={display:"block",width:"100%",height:i?s:n,transform:l,WebkitTransform:l,msTransform:l,transformOrigin:"0 0",WebkitTransformOrigin:"0 0",msTransformOrigin:"0 0",opacity:e?1:0,WebkitTapHighlightColor:"transparent",...e?{transitionProperty:o,WebkitTransitionProperty:o,msTransitionProperty:o,transitionDuration:"0.3s",WebkitTransitionDuration:"0.3s",msTransitionDuration:"0.3s",transitionTimingFunction:"ease-out",WebkitTransitionTimingfunction:"ease-out",msTransitionTmingFunction:"ease-out"}:{}};return Object($t.jsx)("span",{onClick:this.handleClick,onClickCapture:this.handleClickIfZoomed,onTouchCancelCapture:this.stopPropagationIfZoomed,onTouchEndCapture:this.stopPropagationIfZoomed,onTouchStartCapture:this.stopPropagationIfZoomed,style:c,children:this.props.children})}});ds.exports=ms;var bs=ds.exports,vs={exports:{}};vs.exports;h.a;const xs=i.a,ys=x.b,js={};function ws(e){if(!js[e]){const t=$("<span>").text(e).appendTo("body");js[e]=t.width()+5,t.remove()}return js[e]}const Os=createReactClass({displayName:"TextListEditor",getDefaultProps:function(){return{options:[],layout:"horizontal"}},getInitialState:function(){return{items:this.props.options.concat("")}},componentWillReceiveProps:function(e){this.setState({items:e.options.concat("")})},render:function(){const e=["perseus-text-list-editor","perseus-clearfix","layout-"+this.props.layout].join(" "),t=ys.map(this.state.items,(function(e,t){return Object($t.jsx)("li",{children:Object($t.jsx)("input",{ref:"input_"+t,type:"text",value:e,onChange:this.onChange.bind(this,t),onKeyDown:this.onKeyDown.bind(this,t),style:{width:ws(e)}})},t)}),this);return Object($t.jsx)("ul",{className:e,children:t})},onChange:function(e,t){let n=ys.clone(this.state.items);n[e]=t.target.value,e===n.length-1&&(n=n.concat("")),this.setState({items:n}),this.props.onChange(ys.compact(n))},onKeyDown:function(e,t){const n=t.nativeEvent.keyCode;if(8===n&&""===this.state.items[e]){t.preventDefault();const n=ys.clone(this.state.items),s=0===e?0:e-1;e!==n.length-1||0!==e&&""===n[s]?(n.splice(e,1),this.setState({items:n},(function(){xs.findDOMNode(this.refs["input_"+s]).focus()}))):xs.findDOMNode(this.refs["input_"+s]).focus()}else if(8===n&&1===this.state.items[e].length&&e===this.state.items.length-2){t.preventDefault();const n=ys.clone(this.state.items);n.splice(e,1),this.setState({items:n}),this.props.onChange(ys.compact(n))}else if(13===n){t.preventDefault();const n=ys.clone(this.state.items),s=e+1;e===n.length-2?xs.findDOMNode(this.refs["input_"+s]).focus():(n.splice(s,0,""),this.setState({items:n},(function(){xs.findDOMNode(this.refs["input_"+s]).focus()})))}}});vs.exports=Os;var Cs=vs.exports,Ss={exports:{}};Ss.exports;h.a;const ks=Cs,_s=[],Ts=createReactClass({displayName:"StubTagEditor",getDefaultProps:function(){return{value:_s,showTitle:!0}},render:function(){return Object($t.jsxs)("div",{children:[this.props.showTitle&&Object($t.jsx)("div",{style:{fontSize:14},children:"Tags:"}),Object($t.jsx)(ks,{options:this.props.value||_s,layout:"vertical",onChange:this.props.onChange})]})}});Ss.exports=Ts;var Ms=Ss.exports;const Ns={propTypes:PropTypes.shape({isArticle:PropTypes.bool.isRequired,satStyling:PropTypes.bool.isRequired,onInputError:PropTypes.func.isRequired,onFocusChange:PropTypes.func.isRequired,staticRender:PropTypes.bool.isRequired,GroupMetadataEditor:PropTypes.func.isRequired,showAlignmentOptions:PropTypes.bool.isRequired,readOnly:PropTypes.bool.isRequired,answerableCallback:PropTypes.func,getAnotherHint:PropTypes.func,interactionCallback:PropTypes.func,groupAnnotator:PropTypes.func.isRequired,imagePlaceholder:PropTypes.node,widgetPlaceholder:PropTypes.node,baseElements:PropTypes.shape({Link:PropTypes.func}),imagePreloader:PropTypes.func,trackInteraction:PropTypes.func,customKeypad:PropTypes.bool,isMobile:PropTypes.bool,setDrawingAreaAvailable:PropTypes.func,useDraftEditor:PropTypes.bool,styling:PropTypes.shape({radioStyleVersion:PropTypes.oneOf(["intermediate","final"])}),hintProgressColor:PropTypes.string}).isRequired,defaults:{isArticle:!1,isMobile:!1,satStyling:!1,onInputError:function(){},onFocusChange:function(){},staticRender:!1,GroupMetadataEditor:Ms,showAlignmentOptions:!1,readOnly:!1,groupAnnotator:function(){return null},baseElements:{Link:e=>Object($t.jsx)("a",{...e})},setDrawingAreaAvailable:function(){},useDraftEditor:!1,styling:{radioStyleVersion:"final"}}},Ps={RENDERER:"perseus-renderer",TWO_COLUMN_RENDERER:"perseus-renderer-two-columns",RESPONSIVE_RENDERER:"perseus-renderer-responsive",INPUT:"perseus-input",FOCUSED:"perseus-focused",RADIO:{OPTION:"perseus-radio-option",SELECTED:"perseus-radio-selected",OPTION_CONTENT:"perseus-radio-option-content"},INTERACTIVE:"perseus-interactive",CORRECT:"perseus-correct",INCORRECT:"perseus-incorrect",UNANSWERED:"perseus-unanswered",MOBILE:"perseus-mobile"};var Is={Options:Ns,ClassNames:Ps},Es={exports:{}};Es.exports;h.a;const As=Is.Options,Rs={propTypes:{apiOptions:PropTypes.any},getDefaultProps:()=>({apiOptions:{}}),getApiOptions(){return{...As.defaults,...this.props.apiOptions}}};Es.exports=Rs;var Ds=Es.exports,Ls={exports:{}},Fs=(Ls.exports,x.b),zs="block",qs=["default"],Ws={},Bs={},Vs={register:function(e,t,n){Ws[e]=t,Bs[e]=n},registerMany:function(e){e.forEach((e=>{let[t,n]=e;t&&this.register(t.name,t,n)})),this.validateAlignments()},getWidget:function(e){return Fs.has(Ws,e)?Ws[e].getWidget?Ws[e].getWidget():Ws[e].widget:null},getEditor:function(e){return Fs.has(Bs,e)?Bs[e]:null},getTransform:function(e){return Fs.has(Ws,e)?Ws[e].transform||Fs.identity:null},getVersion:function(e){return Ws[e]?Ws[e].version||{major:0,minor:0}:null},getVersionVector:function(){var e={};return Fs.each(Fs.keys(Ws),(function(t){e[t]=Vs.getVersion(t)})),e},getPublicWidgets:function(){return Fs.pick(Ws,Fs.reject(Fs.keys(Ws),(function(e){return Ws[e].hidden})))},isAccessible:function(e){var t=Ws[e.type].accessible;return"function"===typeof t?t(e.options):!!t},getAllWidgetTypes:function(){return Fs.keys(Ws)},upgradeWidgetInfoToLatestVersion:function(e){var t=e.type;if(!Fs.isString(t))throw new Error("widget type must be a string, but was: "+t);var n=Ws[t];if(null==n)return e;var s=e.version||{major:0,minor:0},i=n.version||{major:0,minor:0};if(s.major>i.major||s.major===i.major&&s.minor>i.minor)return e;var r=Fs.clone(e.options)||{},o=n.propUpgrades||{};if(0!==Fs.keys(r).length)for(var a=s.major+1;a<=i.major;a++)o[a]?r=o[a](r):"undefined"!==typeof console&&console.warn&&console.warn("No upgrade found for widget `"+t+"` from major version `"+(a-1)+"` to major version `"+a+"` found. This is necessary to render this `"+t+"` correctly.");var l=Bs[t].defaultProps;r=Fs.extend({},l,r);var c=e.alignment;null!=c&&"default"!==c||(c=Vs.getSupportedAlignments(t)[0]);var h=e.static;return null==h&&(h=false),Fs.extend({},e,{version:i,graded:null==e.graded||e.graded,alignment:c,static:h,options:r})},getRendererPropsForWidgetInfo:function(e,t){var n=e.type,s=Ws[n];return null==s?e.options:(e.static?this.getStaticTransform(n)||Fs.identity:s.transform||Fs.identity)(e.options,t)},traverseChildWidgets:function(e,t){if(!t)throw new Error("traverseRenderer must be provided, but was not");if(!e||!e.type||!Ws[e.type])return e;var n=Ws[e.type],s=e.options;if(n.traverseChildWidgets&&s){var i=n.traverseChildWidgets(s,t);return Fs.extend({},e,{options:i})}return e},getSupportedAlignments:function(e){var t=Ws[e];return t&&t.supportedAlignments||qs},getDefaultAlignment:function(e){var t=Ws[e];return t&&(t.getDefaultAlignment?t.getDefaultAlignment():t.defaultAlignment)||zs},validAlignments:["block","inline-block","inline","float-left","float-right","full-width"],validateAlignments:function(){Fs.each(Ws,(function(e){if(e.defaultAlignment&&!Fs.contains(Vs.validAlignments,e.defaultAlignment))throw new Error("Widget '"+e.displayName+"' has an invalid defaultAlignment value: "+e.defaultAlignment);if(e.supportedAlignments){var t=Fs.difference(e.supportedAlignments,Vs.validAlignments);if(t.length)throw new Error("Widget '"+e.displayName+"' has an invalid value for supportedAlignments: "+t.join(" "))}}))},supportsStaticMode:function(e){var t=Ws[e];return t&&null!=t.staticTransform},getStaticTransform:function(e){var t=Ws[e];return t&&t.staticTransform},getTracking:function(e){var t=Ws[e];return t&&t.tracking||""},isLintable:function(e){var t=Ws[e];return t&&t.isLintable||false}};Ls.exports=Vs;var Hs=Ls.exports;h.a;const Us={SMALL:"small",MEDIUM:"medium",LARGE:"large",XLARGE:"xlarge"},Gs=(PropTypes.oneOf(Object.values(Us)),e=>e===Us.SMALL?[Sn,Sn]:[Cn,Cn]);var $s={exports:{}};$s.exports;const Ys=v.a,Ks=(h.a,i.a),Xs=Hs,Zs=createReactClass({displayName:"WidgetContainer",getDefaultProps:()=>({linterContext:je}),getInitialState:function(){return{sizeClass:Us.MEDIUM,widgetProps:this.props.initialProps}},componentDidMount(){if(this.state.widgetProps.apiOptions.isMobile){const t=Ks.findDOMNode(this).offsetWidth;this.setState({sizeClass:(e=t,e?e<=512?Us.SMALL:e<=688?Us.MEDIUM:Us.LARGE:Us.MEDIUM)})}var e},render:function(){let e=Ys({"perseus-widget-container":!0,"widget-highlight":this.props.shouldHighlight,"widget-nohighlight":!this.props.shouldHighlight});const t=this.props.type,n=Xs.getWidget(t);if(null==n)return Object($t.jsx)("div",{className:e});let s=this.state.widgetProps.alignment;"default"===s&&(s=Xs.getDefaultAlignment(t)),e+=" widget-"+s;const i=this.state.widgetProps.apiOptions,r=this.state.widgetProps.static||i.readOnly,o={width:"100%",height:"100%",position:"absolute",top:0,left:0,zIndex:"3"},a=this.props.linterContext;return Xs.isLintable(t)||(a.highlightLint=!1),Object($t.jsxs)("div",{className:e,style:r?{position:"relative",overflow:"visible"}:{},children:[Object($t.jsx)(n,{...this.state.widgetProps,linterContext:a,containerSizeClass:this.state.sizeClass,ref:"widget"}),r&&Object($t.jsx)("div",{style:o})]})},componentWillReceiveProps:function(e){if(this.props.type!==e.type)throw new Error("WidgetContainer can't change widget type; set a different key instead to recreate the container.")},shouldComponentUpdate:function(e,t){return this.props.shouldHighlight!==e.shouldHighlight||this.props.type!==e.type||this.state.widgetProps!==t.widgetProps||this.state.sizeClass!==t.sizeClass},getWidget:function(){return this.refs.widget},replaceWidgetProps:function(e){this.setState({widgetProps:e})}});$s.exports=Zs;var Js=$s.exports,Qs={},ei=Qs;function ti(e,t){const n=window.scrollX,s=window.scrollY,i=document.querySelector("meta[name=viewport]");i?i.setAttribute("content",e):$("head").append(`<meta name="viewport" content="${e}">`),document.body.style.opacity=.9999,setTimeout((()=>{document.body.style.opacity=1,window.scrollTo(n,s),t&&setTimeout(t,0)}),0)}function ni(){}function si(e,t){this._fullHeight=this._fullWidth=this._overlay=null,this._targetImage=e,this._enableMobilePinch=t,this._$body=$(document.body)}$.fn.emulateTransitionEnd=function(e){var t=!1,n=this;$(this).one("bsTransitionEnd",(function(){t=!0}));return setTimeout((function(){t||$(n).trigger($.support.transition.end)}),e),this},$((function(){$.support.transition=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]};return!1}(),$.support.transition&&($.event.special.bsTransitionEnd={bindType:$.support.transition.end,delegateType:$.support.transition.end,handle:function(e){if($(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})),ni.prototype._initialize=function(e){this._$document||(this._activeZoom=this._initialScrollPosition=this._initialTouchPosition=this._touchMoveListener=null,this._$document=$(document),this._$window=$(window),this._$body=$(document.body),this._boundClick=$.proxy(this._clickHandler,this),this._enableMobilePinch=e)},ni.prototype.handleZoomClick=function(e,t){this._initialize(t);var n=e.target;if(n&&"IMG"===n.tagName&&!this._$body.hasClass("zoom-overlay-open"))return e.metaKey||e.ctrlKey?window.open(e.target.src,"_blank"):void(!t&&n.width>=window.innerWidth-si.getOffset()||(this._activeZoomClose(!0),t?ti("width=device-width, initial-scale=1, minimum-scale=1",(()=>this._zoom(n))):this._zoom(n),t||(this._$window.on("scroll.zoom",$.proxy(this._scrollHandler,this)),this._$document.on("keyup.zoom",$.proxy(this._keyHandler,this)),this._$document.on("touchstart.zoom",$.proxy(this._touchStart,this))),document.addEventListener("click",this._boundClick,!0),e.stopPropagation()))},ni.prototype._zoom=function(e){this._activeZoom=new si(e,this._enableMobilePinch),this._activeZoom.zoomImage()},ni.prototype._activeZoomClose=function(e){this._activeZoom&&(e?(this._activeZoom.dispose(),this._disposeActiveZoom()):ti("width=device-width, initial-scale=1, minimum-scale=1,\n            maximum-scale=1",(()=>{this._activeZoom&&(this._activeZoom.close(),this._disposeActiveZoom())})))},ni.prototype._disposeActiveZoom=function(){this._$window.off(".zoom"),this._$document.off(".zoom"),document.removeEventListener("click",this._boundClick,!0),this._activeZoom=null},ni.prototype._scrollHandler=function(e){null===this._initialScrollPosition&&(this._initialScrollPosition=window.scrollY);var t=this._initialScrollPosition-window.scrollY;Math.abs(t)>=40&&this._activeZoomClose()},ni.prototype._keyHandler=function(e){27===e.keyCode&&this._activeZoomClose()},ni.prototype._clickHandler=function(e){e.stopPropagation(),e.preventDefault(),this._activeZoomClose()},ni.prototype._touchStart=function(e){this._initialTouchPosition=e.originalEvent.touches[0].pageY,$(e.target).on("touchmove.zoom",$.proxy(this._touchMove,this))},ni.prototype._touchMove=function(e){Math.abs(e.originalEvent.touches[0].pageY-this._initialTouchPosition)>10&&(this._activeZoomClose(),$(e.target).off("touchmove.zoom"))},si._OFFSET=80,si._MAX_WIDTH=2560,si._MAX_HEIGHT=4096,si.getOffset=function(e){return e?0:si._OFFSET},si.prototype.getOffset=function(){return si.getOffset(this._enableMobilePinch)},si.prototype.zoomImage=function(){var e=document.createElement("img"),t=$(e);e.onload=function(){this._fullHeight=Number(e.height),this._fullWidth=Number(e.width);var n=this._imageOffset=$(this._targetImage).offset(),s=this._left=n.left-$(window).scrollLeft(),i=this._top=n.top-$(window).scrollTop();t.css({left:s,top:i,width:this._targetImage.width,height:this._targetImage.height}),this._zoomOriginal()}.bind(this),e.src=this._targetImage.src,this.$zoomedImage=t},si.prototype._zoomOriginal=function(){this.$zoomedImage.addClass("zoom-img").attr("data-action","zoom-out"),$(this._targetImage).css("visibility","hidden"),this._backdrop=document.createElement("div"),this._backdrop.className="zoom-backdrop",document.body.appendChild(this._backdrop),this._overlay=document.createElement("div"),this._overlay.className="zoom-overlay",document.body.appendChild(this._overlay),this._overlay.appendChild(this.$zoomedImage[0]),this._calculateZoom(),this._triggerAnimation()},si.prototype._calculateZoom=function(){const e=this._fullWidth,t=this._fullHeight,n=window.innerHeight-this.getOffset(),s=window.innerWidth-this.getOffset(),i=e/this._targetImage.width,r=e/t,o=s/n;this._imgScaleFactor=e<s&&t<n?i:r<o?n/t*i:s/e*i},si.prototype._triggerAnimation=function(){var e=$(window).scrollTop()+window.innerHeight/2,t=$(window).scrollLeft()+window.innerWidth/2,n=this._imgScaleFactor,s=this._imageOffset.top+this._targetImage.height/2,i=this._imageOffset.left+this._targetImage.width/2;this._translateY=(e-s)/n,this._translateX=(t-i)/n,this._zoomedInTransformString=`\n        scale(${n})\n        translate3d(${this._translateX}px, ${this._translateY}px, 0)\n    `,this.$zoomedImage.css({transform:this._zoomedInTransformString}).addClass("zoom-transition").one($.support.transition.end,$.proxy(this._onZoomInFinish,this)).emulateTransitionEnd(300),this._$body.addClass("zoom-overlay-open")},si.prototype._onZoomInFinish=function(){const e=this._targetImage.height*this._imgScaleFactor,t=this._targetImage.width*this._imgScaleFactor;let n=0,s=0,i=0,r=0,o=0,a=0;t<window.innerWidth?(n="50%",i=-t/2):o=(t-window.innerWidth)/2,e<window.innerHeight?(s="50%",r=-e/2):a=(e-window.innerHeight)/2,this.$zoomedImage.css({height:e,left:n,marginLeft:i,marginTop:r,top:s,transform:"",width:t}).removeClass("zoom-transition"),$(this._overlay).scrollLeft(o).scrollTop(a)},si.prototype.close=function(){this._$body.removeClass("zoom-overlay-open").addClass("zoom-overlay-transitioning"),this.$zoomedImage.css({height:this._targetImage.height,left:this._left,marginLeft:0,marginTop:0,top:this._top,transform:this._zoomedInTransformString,width:this._targetImage.width}).removeClass("zoom-transition"),$(this._overlay).scrollLeft(0).scrollTop(0),setTimeout((()=>{this.$zoomedImage.css({transform:"scale(1)"}).addClass("zoom-transition").one($.support.transition.end,$.proxy(this.dispose,this)).emulateTransitionEnd(300)}),10)},si.prototype.dispose=function(){this.$zoomedImage&&this.$zoomedImage[0].parentNode&&(this.$zoomedImage.remove(),this.$zoomedImage=null,this._overlay.parentNode.removeChild(this._overlay),this._backdrop.parentNode.removeChild(this._backdrop),this._$body.removeClass("zoom-overlay-transitioning")),$(this._targetImage).css("visibility","visible")},ei.ZoomService=new ni;ei.ZoomService;var ii=Qs,ri={exports:{}};ri.exports;const oi=/\\+([ !#$%*,.:;\[\]\^_{|}]|[a-zA-Z]*)/g,ai=[" ","!","#","%","*",",",".",":",";","[","]","^","_","{","|","}","alpha","angle","approx","arccos","arcsin","arctan","arrow","bar","barwedge","begin","beta","bf","big","Big","bigg","Bigg","bigl","Bigl","bigr","Bigr","bigstar","bigtriangledown","bigtriangleup","binom","blacklozenge","blue","blueA","blueB","blueC","blueD","blueE","boldsymbol","Box","boxdot","boxed","bullet","cancel","cap","cdot","cdots","checkmark","chi","circ","circledcirc","clubsuit","colon","color","cong","cos","cot","csc","cup","curvearrowright","dagger","dbinom","ddots","delta","Delta","det","dfrac","diamond","diamondsuit","displaystyle","div","dot","dots","downarrow","Downarrow","ell","end","enspace","epsilon","equiv","eta","fbox","flat","footnotesize","frac","frown","gamma","Gamma","gcf","ge","geq","gg","goldB","goldC","goldD","goldE","gray","grayD","grayE","grayF","green","greenB","greenC","greenD","greenE","gt","hat","hbox","heartsuit","hline","hphantom","huge","Huge","iff","iiint","iint","implies","in","infty","int","intercal","it","kaBlue","kappa","kern","lambda","langle","large","Large","LARGE","lcm","ldots","le","left","leftarrow","leftrightarrow","Leftrightarrow","leftrightharpoons","leftroot","leq","lfloor","lg","lim","limits","llap","ln","log","longrightarrow","Longrightarrow","lozenge","lt","lvert","maroonB","maroonC","maroonD","maroonE","mathbb","mathbf","mathcal","mathop","mathrm","mathsf","max","mbox","mid","mp","mu","nabla","ne","nearrow","neq","ngeq","ngtr","nleq","nless","normalsize","not","nu","nx","odot","oint","omega","Omega","operatorname","oplus","orange","oslash","otimes","overbrace","overleftarrow","overleftrightarrow","overline","overrightarrow","overset","parallel","partial","perp","phantom","phi","Phi","pi","pink","pm","prime","propto","psi","Psi","purple","purpleA","purpleC","purpleD","purpleE","qquad","quad","raise","rangle","red","redA","redB","redC","redD","redE","rfloor","rho","right","rightarrow","Rightarrow","rightleftharpoons","rvert","scriptsize","scriptstyle","searrow","sec","setminus","sharp","sigma","Sigma","sim","simeq","sin","small","space","sqrt","square","stackrel","star","substack","sum","swarrow","tan","tan","tau","tealA","tealB","tealC","tealD","tealE","text","textbf","textit","textrm","tfrac","therefore","theta","Theta","tilde","times","tiny","to","triangle","triangleleft","triangleright","underbrace","underline","underset","uparrow","uproot","varphi","vdots","vec","veebar","vert","vphantom","widehat","xi","xrightarrow","Begin","End","inte","lamba","textb"].reduce((function(e,t){return e[t]=null,e}),{}),li={n:"\n",r:"\r",t:"\t","\\":"\\"},ci=function(e){let t=0;for(;t<e.length&&"\\"===e[t];)t++;if(0===t)return 2;if(t%2===0)return 3;{const n=e.substring(t);return"$"===n?1===t?4:1:ai.hasOwnProperty(n)?6:0}},hi=function(e){let t=0,n="";for(;t<e.length;){const s=e[t];if("\\"===s){if(t+=1,t===e.length)return null;const s=e[t];if(!li.hasOwnProperty(s))return null;n+=li[s]}else n+=s;t+=1}return n},pi=function(e){if(e.indexOf("\\")<0)return!1;let t,n=0,s=0,i=!1,r=!1;for(oi.lastIndex=0;null!==(t=oi.exec(e));){const e=t[0],o=hi(e);if(null===o)return!1;const a=ci(e);0===a&&(i=!0);const l=ci(o);0===l&&(r=!0),n+=a,s+=l}return i!==r?i:s>=n},ui=function(e){return pi(e)?hi(e):e};ri.exports={maybeUnescape:ui,maybeUnescapeAccordingToSource:function(e,t){return pi(e)?[hi(e),hi(t)]:[e,t]},shouldUnescape:pi};var di=ri.exports,gi={exports:{}};gi.exports;h.a;const fi="pending",mi="loading",bi="loaded",vi="failed",xi=createReactClass({displayName:"ImageLoader",getInitialState:function(e){return{status:this.props.src?mi:fi}},componentDidMount:function(){this.state.status===mi&&this.createLoader()},componentWillReceiveProps:function(e){this.props.src!==e.src&&this.setState({status:e.src?mi:fi})},componentDidUpdate:function(e,t){this.state.status!==mi||this.img||this.createLoader(),t.status!==this.state.status&&this.props.onUpdate()},componentWillUnmount:function(){this.destroyLoader()},createLoader:function(){this.destroyLoader(),this.img=new Image,this.img.onload=this.handleLoad,this.img.onerror=this.handleError,this.img.src=this.props.src},destroyLoader:function(){this.img&&(this.img.onload=null,this.img.onerror=null,this.img=null)},handleLoad:function(e){this.destroyLoader(),this.setState({status:bi}),this.props.onLoad&&this.props.onLoad(e)},handleError:function(e){this.destroyLoader(),this.setState({status:vi}),this.props.onError&&this.props.onError(e)},renderImg:function(){const{src:e,imgProps:t}=this.props,n={src:e};for(const s in t)t.hasOwnProperty(s)&&(n[s]=t[s]);return Object($t.jsx)("img",{...n})},render:function(){switch(this.state.status){case bi:return this.renderImg();case vi:if(this.props.children)return this.props.children;break;default:if(this.props.preloader)return this.props.preloader()}return null}});gi.exports=xi;var yi=gi.exports,ji={exports:{}};ji.exports;const wi=x.b,Oi=G.a.point;function Ci(e,t){return e+":"+t}const Si={_fireEvent:function(e,t,n){wi.invoke(e,"call",this,t,n)},_applyConstraints:function(e,t,n){let s=!1;return wi.reduce(this.state.constraints,((e,i)=>{if(!1===e)return!1;if(s)return e;const r=i.call(this,e,t,{onSkipRemaining:()=>{s=!0},...n});if(!1===r)return!1;if(Oi.is(r,2))return r;if(!0===r||null==r)return e;throw new Error("Constraint returned invalid result: "+r)}),e,this)},draw:function(){const e=this.cloneState();Si._fireEvent.call(this,this.state.draw,e,this.prevState),this.prevState=e},listen:function(e,t,n){this._listenerMap=this._listenerMap||{};const s=Ci(e,t),i=this._listenerMap[s]=this._listenerMap[s]||this.state[e].length;this.state[e][i]=n},unlisten:function(e,t){this._listenerMap=this._listenerMap||{};const n=Ci(e,t),s=this._listenerMap[n];if(void 0!==s){this.state[e].splice(s,1),delete this._listenerMap[n];const t=wi.keys(this._listenerMap);wi.each(t,(function(t){(function(e){return e.split(":")[0]})(t)===e&&this._listenerMap[t]>s&&this._listenerMap[t]--}),this)}}};ji.exports=Si;var ki=ji.exports;const _i=x.b,Ti=ki;let Mi=null;let Ni=null;const Pi={assert:function(e,t){if(!e)throw new Error("Assertion Error"+(t?": "+t:""))},createGettersFor:function(e,t){_i.each(_i.keys(t),(function(t){void 0===e.prototype[t]&&(e.prototype[t]=function(){return this.state[t]})}))},addMovableHelperMethodsTo:function(e){_i.each(Ti,(function(t,n){void 0===e.prototype[n]&&(e.prototype[n]=t)}))},arrayify:function(e){return null==e?[]:_i.isArray(e)?_i.filter(_i.flatten(e),_i.identity):[e]},normalizeOptions:function(e,t){const n=_i.clone(t);return _i.each(e,(function(e){const s=t[e];if(void 0!==s){const t=Pi.arrayify(s);n[e]=t}})),n},getPrefixedTransform:function(){return Mi=Mi||function(){const e=document.createElement("div");let t=null;return _i.each(["transform","msTransform","MozTransform","WebkitTransform","OTransform"],(function(n){"undefined"!==typeof e.style[n]&&(t=n)})),t}(),Mi},getCanUse3dTransform:function(){return null==Ni&&(Ni=function(){const e=document.createElement("div"),t=Pi.getPrefixedTransform();return e.style[t]="translateZ(0px)",!!e.style[t]}()),Ni}},Ii=Pi.getCanUse3dTransform;var Ei=Pi,Ai={exports:{}};Ai.exports;const Ri={BLUE:"#6495ED",ORANGE:"#FFA500",PINK:"#FF00AF",GREEN:"#28AE7B",PURPLE:"#9D38BD",RED:"#DF0030",GRAY:"gray",BLACK:"black",LIGHT_BLUE:"#9AB8ED",LIGHT_ORANGE:"#EDD19B",LIGHT_PINK:"#ED9BD3",LIGHT_GREEN:"#9BEDCE",LIGHT_PURPLE:"#DA9BED",LIGHT_RED:"#ED9AAC",LIGHT_GRAY:"#ED9B9B",LIGHT_BLACK:"#ED9B9B",GRAY10:"#D6D6D6",GRAY20:"#CDCDCD",GRAY30:"#B3B3B3",GRAY40:"#9A9A9A",GRAY50:"#808080",GRAY60:"#666666",GRAY70:"#4D4D4D",GRAY80:"#333333",GRAY90:"#1A1A1A",BLUE_A:"#CCFAFF",BLUE_B:"#80F6FF",BLUE_C:"#63D9EA",BLUE_D:"#11ACCD",BLUE_E:"#0C7F99",TEAL_A:"#94FFF5",TEAL_B:"#26EDD5",TEAL_C:"#01D1C1",TEAL_D:"#01A995",TEAL_E:"#208170",GREEN_A:"#B6FFB0",GREEN_B:"#8AF281",GREEN_C:"#74CF70",GREEN_D:"#1FAB54",GREEN_E:"#0D923F",GOLD_A:"#FFD0A9",GOLD_B:"#FFBB71",GOLD_C:"#FF9C39",GOLD_D:"#E07D10",GOLD_E:"#A75A05",RED_A:"#FCA9A9",RED_B:"#FF8482",RED_C:"#F9685D",RED_D:"#E84D39",RED_E:"#BC2612",MAROON_A:"#FFBDE0",MAROON_B:"#FF92C6",MAROON_C:"#ED5FA6",MAROON_D:"#CA337C",MAROON_E:"#9E034E",PURPLE_A:"#DDD7FF",PURPLE_B:"#C6B9FC",PURPLE_C:"#AA87FF",PURPLE_D:"#7854AB",PURPLE_E:"#543B78",MINT_A:"#F5F9E8",MINT_B:"#EDF2DF",MINT_C:"#E0E5CC",GRAY_A:"#F6F7F7",GRAY_B:"#F0F1F2",GRAY_C:"#E3E5E6",GRAY_D:"#D6D8DA",GRAY_E:"#BABEC2",GRAY_F:"#888D93",GRAY_G:"#626569",GRAY_H:"#3B3E40",GRAY_I:"#21242C",KA_BLUE:"#314453",KA_GREEN:"#71B307",_BACKGROUND:"#FDFDFD"};Ri.INTERACTING=Ri.KA_GREEN,Ri.INTERACTIVE=Ri.KA_GREEN,Ri.DYNAMIC=Ri.BLUE,Ai.exports=Ri;var Di=Ai.exports,Li={exports:{}};Li.exports;const Fi=x.b,zi=Ei,qi=ve,Wi=G.a.vector,Bi=Fi.extend({transform:function(e){const t=zi.getPrefixedTransform();this.wrapper.style[t]=e},toFront:function(){const e=this.wrapper.parentNode;e&&e.appendChild(this.wrapper)},toBack:function(){const e=this.wrapper.parentNode;e.firstChild!==this.wrapper&&e.insertBefore(this.wrapper,e.firstChild)},remove:function(){this.visibleShape.remove(),l()(this.wrapper).remove()},getMouseTarget:function(){return this.visibleShape[0]},moveTo:function(e){const t=Wi.subtract(this.graphie.scalePoint(e),this.graphie.scalePoint(this.initialPoint)),n=zi.getCanUse3dTransform(),s="translateX("+t[0]+"px) translateY("+t[1]+"px)"+(n?" translateZ(0)":"");this.transform(s)},hide:function(){this.visibleShape.hide()},show:function(){this.visibleShape.show()}},qi.mapObjectFromArray(["attr","animate"],(function(e){return function(){this.visibleShape[e](...arguments)}})));Li.exports=Bi;var Vi=Li.exports,Hi={exports:{}};Hi.exports;const Ui=x.b,Gi=Vi,$i={center:null,createPath:null,mouselayer:!1},Yi=function(e,t,n){n=Ui.extend({},$i,n),Ui.extend(this,e.fixedPath(t,n.center,n.createPath)),Ui.extend(this,{graphie:e,initialPoint:e.scalePoint(Ui.head(t))}),n.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper)};Ui.extend(Yi.prototype,Gi),Hi.exports=Yi;var Ki=Hi.exports,Xi={exports:{}};Xi.exports;const Zi=x.b,Ji=Ei,Qi=Vi,er=G.a.point,tr=G.a.vector,nr=Z,sr={thickness:2,mouselayer:!1},ir=function(e,t,n,s){s=Zi.extend({},sr,s);const i=[e.range[0][0],0],r=[e.range[0][1],0];Zi.extend(this,e.fixedLine(i,r,s.thickness)),this.visibleShape.attr(s.normalStyle),Zi.extend(this,{graphie:e,initialPoint:e.scalePoint(i),initialLength:er.distanceToPoint(e.scalePoint(i),e.scalePoint(r))}),s.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper),this.moveTo(t,n)};Zi.extend(ir.prototype,Qi,{getMouseTarget:function(){return this.wrapper},moveTo:function(e,t){const n=this.graphie.scalePoint(e),s=this.graphie.scalePoint(t),i=tr.polarDegFromCart(tr.subtract(s,n)),r=i[0],o=nr.bound(i[1]),a=tr.subtract(n,this.initialPoint),l=nr.bound(r/this.initialLength),c=Ji.getCanUse3dTransform(),h="translateX("+a[0]+"px) translateY("+a[1]+"px) "+(c?" translateZ(0)":"")+"rotate("+o+"deg) scaleX("+l+") scaleY(1)";this.transform(h)}}),Xi.exports=ir;var rr=Xi.exports,or={exports:{}};or.exports;const ar=x.b,lr=Vi,cr=Ei,hr=G.a.vector,pr={maxScale:1,mouselayer:!1,shadow:!1,disableMouseEventsOnWrapper:!1},ur=function(e,t,n,s){s=ar.extend({},pr,s);const i=e.fixedEllipse(t,n,s.maxScale,s.padding);if(ar.extend(this,i,{graphie:e,initialPoint:t}),s.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper),s.shadow){const e="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))",t=this.wrapper;t.style.webkitFilter=e,t.style.filter=e,this.moveTo=function(e){const t=hr.subtract(this.graphie.scalePoint(e),this.graphie.scalePoint(this.initialPoint)),n=cr.getCanUse3dTransform(),s="translateX("+Math.round(t[0])+"px) translateY("+Math.round(t[1])+"px)"+(n?" translateZ(0)":"");this.transform(s)}}s.disableMouseEventsOnWrapper&&(this.wrapper.style.pointerEvents="none",this.visibleShape.node.style.pointerEvents="auto")};ar.extend(ur.prototype,lr),or.exports=ur;var dr=or.exports,gr={exports:{}};gr.exports;const fr=Z;function mr(e,t){const n=l()(e).find("."+t);return 0===n.length?l()("<span>").addClass(t).appendTo(l()(e)):n}function br(e,t){let n=0;!function s(){e.scrollHeight>18||n>=10?t():(n++,setTimeout(s,100))}()}gr.exports={processMath:function(e,t,n,s){const i=l()(e);if(null==i.attr("data-math-formula")||n){const n=mr(i,"katex-holder"),o=mr(i,"mathjax-holder"),a=o.find("script[type='math/tex']")[0];if(null==t&&(i.attr("data-math-formula")?t=i.attr("data-math-formula"):a&&(t=a.text||a.textContent)),t=null!=t?t+"":"",t=fr.cleanMath(t),i.attr("data-math-formula",t),Exercises.useKatex)try{if(katex.render(t,n[0]),"mathjax"===i.attr("data-math-type")){const e=MathJax.Hub.getJaxFor(a);if(e){const t=e.SourceElement();t.previousSibling&&t.previousSibling.className&&e.Remove()}}return i.attr("data-math-type","katex"),void(s&&br(e,s))}catch(r){if(r.__proto__!==katex.ParseError.prototype)throw r}i.attr("data-math-type","mathjax"),a?"text"in a?a.text=t:a.textContent=t:o.append("<script type='math/tex'>"+t.replace(/<\//g,"< /")+"<\/script>"),"undefined"!==typeof MathJax&&(MathJax.Hub.Queue(["Reprocess",MathJax.Hub,o[0]]),MathJax.Hub.Queue((function(){KhanUtil.debugLog("MathJax done typesetting ("+t+")")})),s&&MathJax.Hub.Queue((function(){const t=MathJax.Callback((function(){}));return br(e,(function(){s(),t()})),t})))}},processAllMath:function(e,t){const n=l()(e);n.filter("code").add(n.find("code")).each((function(){const e=l()(this);let n=e.attr("data-math-formula");null==n&&(n=e.text(),e.empty()),KhanUtil.processMath(this,n,t)}))},cleanupMath:function(e){const t=l()(e);if(t.attr("data-math-formula")){if("undefined"!==typeof MathJax){const e=MathJax.Hub.getJaxFor(t.find("script")[0]);if(e){const t=e.SourceElement();t.previousSibling&&t.previousSibling.className&&e.Remove()}}t.text(t.attr("data-math-formula")),t.attr("data-math-formula",null),t.attr("data-math-type",null)}return e},retrieveMathFormula:function(e){return l()(e).attr("data-math-formula")}};var vr=gr.exports,xr=(n(168),{exports:{}});xr.exports;const yr=G.a.point,jr=G.a.vector,wr=x.b,Or=Z,Cr=vr.processMath,Sr=Di;function kr(e,t){return"number"===typeof e&&(e=[e,e]),t=t*Math.PI/180,[e[0]*Math.cos(t),e[1]*Math.sin(t)]}const _r={unscaledSvgPath:function(e){return!0===e[0]?"":l.a.map(e,(function(e,t){return!0===e?"z":(0===t?"M":"L")+e[0]+" "+e[1]})).join("")},getDistance:function(e,t){return yr.distanceToPoint(e,t)},coordDiff:function(e,t){return wr.map(t,(function(n,s){return t[s]-e[s]}))},snapCoord:function(e,t){return wr.map(e,(function(e,n){return Or.roundToNearest(t[n],e)}))},findAngle:function(e,t,n){if(void 0===n){const n=e[0]-t[0],s=e[1]-t[1];return n||s?(180+180*Math.atan2(-s,-n)/Math.PI+360)%360:0}return _r.findAngle(e,n)-_r.findAngle(t,n)},graphs:{}},Tr=_r.Graphie=function(){};wr.extend(Tr.prototype,{cartToPolar:function(e,t){const n=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2));let s=Math.atan2(e[1],e[0]);return s<0&&(s+=2*Math.PI),t||(s=180*s/Math.PI),[n,s]},polar:kr});const Mr={center:[-.5,-.5],above:[-.5,-1],"above right":[0,-1],right:[0,-.5],"below right":[0,0],below:[-.5,0],"below left":[-1,0],left:[-1,-.5],"above left":[-1,-1]},Nr={"stroke-width":null};_r.createGraphie=function(e){let t,n,s=40,i=40;l()(e).css("position","relative");const r=Raphael(e);l()(e).children("div").css("position","absolute");let o={"stroke-width":2,fill:"none"};const a=function(e){if("number"===typeof e)return a([e,e]);const t=e[0],n=e[1];return[t*s,n*i]},c=function e(r){if("number"===typeof r)return e([r,r]);const o=r[0],a=r[1];return[(o-t[0])*s,(n[1]-a)*i]},h=function(e){if("number"===typeof e)return h([e,e]);const r=e[0],o=e[1];return[r/s+t[0],n[1]-o/i]},p=function(e){return"number"===typeof e?p([e,e]):[e[0]/s,e[1]/i]},u=function(e,t){const n=l()(e),s=n.data("labelDirection");if(n.css("visibility",""),"number"===typeof s){const e=Math.cos(s),i=Math.sin(s),r=Math.min(t[0]/2/Math.abs(e),t[1]/2/Math.abs(i));n.css({marginLeft:-t[0]/2+e*r,marginTop:-t[1]/2-i*r})}else{const e=Mr[s||"center"];n.css({marginLeft:Math.round(t[0]*e[0]),marginTop:Math.round(t[1]*e[1])})}},d=function(e,t){return l.a.map(e,(function(e,n){if(!0===e)return"z";{const s=t?e:c(e);return(0===n?"M":"L")+Or.bound(s[0])+" "+Or.bound(s[1])}})).join("")},g=function(e,n,s){const i=function(t){return(e*t+n)*t+s};if(0===e){const e=wr.map(t,(function(e){return[e,i(e)]}));return d(e)}const r=-n/(2*e),o=r+Math.max(Math.abs(r-t[0]),Math.abs(r-t[1])),a=[r,i(r)],l=[o,i(o)],h=[a[0],a[1]-(l[1]-a[1])],p=Math.abs(a[0]-l[0]),u=[a[0]-p,l[1]],g=[a[0]+p,l[1]],f=wr.map([u,h,g],c),m=wr.map(wr.flatten(f),Or.bound);return"M"+m[0]+","+m[1]+" Q"+m[2]+","+m[3]+" "+m[4]+","+m[5]},f=function(e,n,s,i){const r=Math.abs(Math.PI/(2*n)),o=function(t){return e*Math.sin(n*t-s)+i},a=function(t){return e*n*Math.cos(s-n*t)},l=function(e,t){const n=e+r*t,s=n+r,i=[n,2*n/3+1*s/3,1*n/3+2*s/3,s],l=[o(n),o(n)+a(n)*(s-n)/3,o(s)-a(s)*(s-n)/3,o(s)];return wr.map(wr.zip(i,l),c)},h=t[1]-t[0],p=Math.ceil(h/r)+1;let u=s/n;const d=u-t[0];u-=r*Math.ceil(d/r);let g=l(u,0),f="M"+g[0][0]+","+g[0][1]+" C"+g[1][0]+","+g[1][1]+" "+g[2][0]+","+g[2][1]+" "+g[3][0]+","+g[3][1];for(let t=1;t<p;t++)g=l(u,t),f+=" C"+g[1][0]+","+g[1][1]+" "+g[2][0]+","+g[2][1]+" "+g[3][0]+","+g[3][1];return f};_r.svgPath=d;const m=function(e){const o={scale:function(e){"number"===typeof e&&(e=[e,e]),s=e[0],i=e[1],r.setSize((t[1]-t[0])*s,(n[1]-n[0])*i)},clipRect:function(e){const t=e[0],n=e[1];return t[1]+=n[1],{"clip-rect":c(t).concat(a(n)).join(" ")}},strokeWidth:function(e){return{"stroke-width":parseFloat(e)}},rx:function(e){return{rx:a([e,0])[0]}},ry:function(e){return{ry:a([0,e])[1]}},r:function(e){const t=a([e,e]);return{rx:t[0],ry:t[1]}}},h={};return l.a.each(e||{},(function(e,t){const n=o[e];if("function"===typeof n)l.a.extend(h,n(t));else{const n=e.replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase();h[n]=t}})),h},b=function e(t){const n=t.constructor.prototype;if(n===Raphael.el){if("path"===t.type&&"undefined"===typeof t.arrowheadsDrawn){const e=.6+.4*t.attr("stroke-width"),n=t.getTotalLength(),s=r.set(),i=r.path(x.isMobile?"M-4,4 C-4,4 -0.25,0 -0.25,0 C-0.25,0 -4,-4 -4,-4":"M-3 4 C-2.75 2.5 0 0.25 0.75 0C0 -0.25 -2.75 -2.5 -3 -4"),o=t.getPointAtLength(n-.4),a=t.getPointAtLength(n-.75*e),l=180*Math.atan2(o.y-a.y,o.x-a.x)/Math.PI,c=t.attr();delete c.path;let h=t.getSubpath(0,n-.75*e);return h=r.path(h).attr(c),h.arrowheadsDrawn=!0,t.remove(),i.rotate(l,x.isMobile?1e-5:.75,0).scale(e,e,.75,0).translate(a.x,a.y).attr(c).attr({"stroke-linejoin":"round","stroke-linecap":"round"}),i.arrowheadsDrawn=!0,s.push(h),s.push(i),s}}else if(n===Raphael.st)for(let s=0,i=t.items.length;s<i;s++)e(t.items[s]);return t},v={circle:function(e,t){return r.ellipse(...c(e).concat(a([t,t])))},rect:function(e,t,n,s){const i=c([e,t+s]),o=a([n,s]),l=r.rect(...i.concat(o));return x.isMobile&&(l.node.style.shapeRendering="crispEdges"),l},ellipse:function(e,t){return r.ellipse(...c(e).concat(a(t)))},fixedEllipse:function(e,t,n,s){const i=c(e),r=a(t),o=2*r[0]*n+s,h=2*r[1]*n+s,p=i[0]-o/2,u=i[1]-h/2,d=document.createElement("div");l()(d).css({position:"absolute",width:o+"px",height:h+"px",left:p+"px",top:u+"px"});return{wrapper:d,visibleShape:Raphael(d,o,h).ellipse(o/2,h/2,r[0],r[1])}},arc:function(e,t,n,s,i){n=(n%360+360)%360,s=(s%360+360)%360;const o=c(e),l=a(t),h=kr(t,n),p=kr(t,s),u=c([e[0]+h[0],e[1]+h[1]]),d=c([e[0]+p[0],e[1]+p[1]]),g=((s-n)%360+360)%360>180;return r.path("M"+u.join(" ")+"A"+l.join(" ")+" 0 "+(g?1:0)+" 0 "+d.join(" ")+(i?"L"+o.join(" ")+"z":""))},path:function(e){const t=r.path(d(e));return t.graphiePath=e,t},fixedPath:function(e,t,n){e=wr.map(e,c),t=t?c(t):null,n=n||d;const s=wr.min(wr.pluck(e,0)),i=wr.max(wr.pluck(e,0)),r=wr.min(wr.pluck(e,1)),o=wr.max(wr.pluck(e,1)),a=[4,4],h=[s,r];e=wr.map(e,(function(e){return jr.add(jr.subtract(e,h),jr.scale(a,.5))}));const p=i-s+a[0],u=o-r+a[1],g=h[0]-a[0]/2,f=h[1]-a[1]/2,m=document.createElement("div");l()(m).css({position:"absolute",width:p+"px",height:u+"px",left:g+"px",top:f+"px",transformOrigin:t?p/2+t[0]+"px "+(u/2+t[1])+"px":null});return{wrapper:m,visibleShape:Raphael(m,p,u).path(n(e))}},scaledPath:function(e){const t=r.path(d(e,!0));return t.graphiePath=e,t},line:function(e,t){const n=this.path([e,t]);return x.isMobile&&(n.node.style.shapeRendering="crispEdges"),n},parabola:function(e,t,n){return r.path(g(e,t,n))},fixedLine:function(e,t,n){const s=[n,n];e=c(e),t=c(t);const i=[Math.min(e[0],t[0]),Math.min(e[1],t[1])];e=jr.add(jr.subtract(e,i),jr.scale(s,.5)),t=jr.add(jr.subtract(t,i),jr.scale(s,.5));const r=i[0]-s[0]/2,o=i[1]-s[1]/2,a=Math.abs(e[0]-t[0])+s[0],h=Math.abs(e[1]-t[1])+s[1],p=document.createElement("div");l()(p).css({position:"absolute",width:a+"px",height:h+"px",left:r+"px",top:o+"px",transformOrigin:e[0]+"px "+e[1]+"px"});const u=Raphael(p,a,h),d="M"+e[0]+" "+e[1]+" L"+t[0]+" "+t[1],g=u.path(d);return g.graphiePath=[e,t],{wrapper:p,visibleShape:g}},sinusoid:function(e,t,n,s){return r.path(f(e,t,n,s))},grid:function(e,t){const n=o.step||[1,1],s=r.set();let i=n[0]*Math.ceil(e[0]/n[0]);for(;i<=e[1];i+=n[0])s.push(this.line([i,t[0]],[i,t[1]]));let a=n[1]*Math.ceil(t[0]/n[1]);for(;a<=t[1];a+=n[1])s.push(this.line([e[0],a],[e[1],a]));return s},label:function(t,n,s,i){i="undefined"===typeof i||i;const r=l()("<span>").addClass("graphie-label"),a=o["label-distance"];r.css(l.a.extend({},{position:"absolute",padding:(null!=a?a:7)+"px"})).data("labelDirection",s).appendTo(e),r.setPosition=function(e){const t=c(e);r.css({left:t[0],top:t[1]})},r.setPosition(t);const h=r[0];return r.processMath=function(e,t){Cr(h,e,t,(function(){const e=h.scrollWidth,t=h.scrollHeight;u(h,[e,t])}))},r.processText=function(e){r.html(e);const t=h.scrollWidth,n=h.scrollHeight;u(h,[t,n])},i?r.processMath(n,!1):r.processText(n),r},plotParametric:function(e,t,n,s){s=s||function(e){return[e,0]};const a=e=>Math.abs(e[1])>5e5?[e[0],Math.min(Math.max(e[1],-5e5),5e5)]:e,l=t=>a(e(t)),c=e=>a(s(e));o.strokeLinejoin||(o.strokeLinejoin="round"),o.strokeLinecap||(o.strokeLinecap="round");const h=t[0],p=t[1];let u=(p-h)/(o["plot-points"]||800);0===u&&(u=1);const d=r.set();let g=[],f=_r.coordDiff(l(h),c(h)),m=h;for(let r=h;r<=p;r+=u){const e=l(r),t=c(r),s=_r.coordDiff(e,t);if(s[1]<0!==f[1]<0&&Math.abs(s[1]-f[1])>2*i||isNaN(s[1])){if(n){g.push(e);for(let e=r-u;e>=m;e-=u)g.push(c(e));m=r}d.push(this.path(g)),g=[],n&&g.push(e)}else g.push(e);f=s}if(n)for(let i=p-u;i>=m;i-=u)g.push(c(i));return d.push(this.path(g)),d},plotPolar:function(e,t){const n=t[0],i=t[1];return o["plot-points"]||(o["plot-points"]=2*(i-n)*s),this.plotParametric((function(t){return kr(e(t),180*t/Math.PI)}),t)},plot:function(e,t,n,i,r){const a=t[0],l=t[1];if(o["plot-points"]||(o["plot-points"]=2*(l-a)*s),n){if(r)throw new Error("Can't shade area between functions with swapped axes.");return this.plotParametric((function(t){return[e(t),t]}),t,i)}if(r){if(i)return this.plotParametric((function(t){return[t,e(t)]}),t,i,(function(e){return[e,r(e)]}));throw new Error("fn2 should only be set when 'shade' is True.")}return this.plotParametric((function(t){return[t,e(t)]}),t,i)},plotPiecewise:function(e,t){const n=r.set(),s=this;return wr.times(e.length,(function(i){const r=e[i],o=t[i],a=s.plotParametric((function(e){return[e,r(e)]}),o);wr.each(a,(function(e){n.push(e)}))})),n},plotEndpointCircles:function(e){const t=r.set(),n=this;return wr.each(e,(function(e,s){t.push(n.circle(e,.15))})),t},plotAsymptotes:function(e,t){const n=t[0],s=t[1],a=(s-n)/(o["plot-points"]||800),l=r.set();let c=e(n);for(let r=n;r<=s;r+=a){const t=e(r);t<0!==c<0&&Math.abs(t-c)>2*i&&l.push(this.line([r,i],[r,-i])),c=t}return l}},x=new Tr;return wr.extend(x,{raphael:r,init:function(o){let a=o.scale||[40,40];if(a="number"===typeof a?[a,a]:a,s=a[0],i=a[1],null==o.range)return Khan.error("range should be specified in graph init");t=o.range[0],n=o.range[1];const c=(t[1]-t[0])*s,h=(n[1]-n[0])*i;return r.setSize(c,h),l()(e).css({width:c,height:h}),this.range=o.range,this.scale=a,this.dimensions=[c,h],this.xpixels=c,this.ypixels=h,this.isMobile=o.isMobile,this},style:function(e,t){const n=m(e);if("function"===typeof t){const e=o;o=l.a.extend({},o,n);const s=t.call(x);return o=e,s}l.a.extend(o,n)},scalePoint:c,scaleVector:a,unscalePoint:h,unscaleVector:p,svgPath:d,svgParabolaPath:g,svgSinusoidPath:f}),l.a.each(v,(function(e){x[e]=function(){const t=arguments[arguments.length-1],n=o;let s;if("object"!==typeof t||wr.isArray(t))o=l.a.extend({},o),s=v[e](...arguments);else{o={...o,...m(t)};const n=[].slice.call(arguments,0,arguments.length-1);s=v[e](...n)}const i=s.constructor.prototype;return i===Raphael.el||i===Raphael.st?(s.attr(o),o.arrows&&(s=b(s))):s instanceof l.a&&s.css({...o,...Nr}),o=n,s}})),x.graphInit=function(e){e=e||{},l.a.each(e,(function(t,n){t.match(/.*Opacity$/)||"range"===t||"number"!==typeof n||(e[t]=[n,n]),"range"!==t&&"gridRange"!==t||(n.constructor===Array?n[0].constructor!==Array&&(e[t]=[[-n[0],n[0]],[-n[1],n[1]]]):"number"===typeof n&&(e[t]=[[-n,n],[-n,n]]))}));const t=e.range||[[-10,10],[-10,10]],n=e.gridRange||e.range,s=e.scale||[20,20],i=null==e.grid||e.grid,r=e.gridOpacity||.1,o=e.gridStep||[1,1],a=null==e.axes||e.axes,c=e.axisArrows||"",h=e.axisOpacity||1,p=e.axisCenter||[Math.min(Math.max(t[0][0],0),t[0][1]),Math.min(Math.max(t[1][0],0),t[1][1])],u=null!=e.axisLabels&&e.axisLabels,d=null==e.ticks||e.ticks,g=e.tickStep||[2,2],f=e.tickLen||[5,5],m=e.tickOpacity||1,b=e.labels||e.labelStep||!1,v=e.labelStep||[1,1],x=e.labelOpacity||1;let y=e.unityLabels||!1;const j=e.labelFormat||function(e){return e};let w=e.xLabelFormat||j,O=e.yLabelFormat||j;const C=null==e.smartLabelPositioning||e.smartLabelPositioning,S=[[t[0][0]-(t[0][0]>0?1:0),t[0][1]+(t[0][1]<0?1:0)],[t[1][0]-(t[1][0]>0?1:0),t[1][1]+(t[1][1]<0?1:0)]];if(wr.isArray(y)||(y=[y,y]),C){const e=function(e){return function(t){return(e(t)+"").replace(/-(\d)/g,"\\llap{-}$1")}};w=e(w),O=e(O)}if(this.init({range:S,scale:s,isMobile:e.isMobile}),i&&this.grid(n[0],n[1],{stroke:e.isMobile?Sr.GRAY_C:"#000000",opacity:e.isMobile?1:r,step:o,strokeWidth:e.isMobile?1:2}),a&&("<->"===c||!0===c?this.style({stroke:e.isMobile?Sr.GRAY_G:"#000000",opacity:e.isMobile?1:h,strokeWidth:e.isMobile?1:2,arrows:"->"},(function(){t[1][0]<0&&t[1][1]>0&&(this.path([p,[n[0][0],p[1]]]),this.path([p,[n[0][1],p[1]]])),t[0][0]<0&&t[0][1]>0&&(this.path([p,[p[0],n[1][0]]]),this.path([p,[p[0],n[1][1]]]))})):"->"!==c&&""!==c||this.style({stroke:"#000000",opacity:h,strokeWidth:2,arrows:c},(function(){this.path([[n[0][0],p[1]],[n[0][1],p[1]]]),this.path([[p[0],n[1][0]],[p[0],n[1][1]]])})),u&&2===u.length&&(this.label([n[0][1],p[1]],u[0],"right"),this.label([p[0],n[1][1]],u[1],"above"))),d){const i=e.isMobile;this.style({stroke:e.isMobile?Sr.GRAY_G:"#000000",opacity:e.isMobile?1:m,strokeWidth:1},(function(){let e=o[0]*g[0],r=f[0]/s[1],a=n[0][0],l=n[0][1];if(t[1][0]<0&&t[1][1]>0){for(let t=e+p[0];t<=l;t+=e)(t<l||!c)&&this.line([t,-r+p[1]],[t,i?0:r+p[1]]);for(let t=-e+p[0];t>=a;t-=e)(t>a||!c)&&this.line([t,-r+p[1]],[t,i?0:r+p[1]])}if(e=o[1]*g[1],r=f[1]/s[0],a=n[1][0],l=n[1][1],t[0][0]<0&&t[0][1]>0){for(let t=e+p[1];t<=l;t+=e)(t<l||!c)&&this.line([-r+p[0],t],[i?0:r+p[0],t]);for(let t=-e+p[1];t>=a;t-=e)(t>a||!c)&&this.line([-r+p[0],t],[i?0:r+p[0],t])}}))}b&&this.style({stroke:e.isMobile?Sr.GRAY_G:"#000000",opacity:e.isMobile?1:x},(function(){let e=o[0]*g[0]*v[0],t=n[0][0],s=n[0][1];const i=p[0]<0?"above":"below",r=p[0]<0?"right":"left",a=0===p[0]&&0!==p[1],l=0!==p[0]&&0===p[1],h=0!==p[0]||0!==p[1],u=y[0]||h,d=y[1]||h;for(let n=(a?0:e)+p[0];n<=s;n+=e)(n<s||!c)&&this.label([n,p[1]],w(n),i);for(let n=-e*(u?1:2)+p[0];n>=t;n-=e)(n>t||!c)&&this.label([n,p[1]],w(n),i);e=o[1]*g[1]*v[1],t=n[1][0],s=n[1][1];for(let n=(l?0:e)+p[1];n<=s;n+=e)(n<s||!c)&&this.label([p[0],n],O(n),r);for(let n=-e*(d?1:2)+p[1];n>=t;n-=e)(n>t||!c)&&this.label([p[0],n],O(n),r)}))},x},xr.exports=_r;var Pr=xr.exports,Ir=(n(169),{exports:{}});Ir.exports;const Er=x.b,Ar=Pr,Rr=G.a.vector,Dr=G.a.point,Lr=G.a.line,Fr=dr,zr=rr,qr=Ki,Wr=Z,Br=Di;function Vr(e){return Er.reduce(e,(function(e,t){return e+t}),0)}function Hr(){const e=Er.toArray(arguments),t=Er.zip(...e);return Er.map(t,Vr)}function Ur(e){return Er.map(e,(function(e){return-1*e}))}function Gr(e){const t=11.374597405497571;return 58.919514629750836*Math.exp(-.037587715462826674*e)+t}function $r(e,t){return[e*Math.cos(t),e*Math.sin(t)*-1]}function Yr(e,t){return $r(e,t*Math.PI/180)}let Kr=!1;const Xr={bogusShape:{animate:function(){},attr:function(){},remove:function(){}}};function Zr(e,t){this.set=e.raphael.set(),this.cx=t[0],this.cy=t[1];const n=this,s=e.unscaleVector(180.5)[0],i=e.scalePoint([this.cx-s,this.cy+s-e.unscaleVector(10.5)[1]]),r=e.mouselayer.image("https://ka-perseus-graphie.s3.amazonaws.com/e9d032f2ab8b95979f674fbfa67056442ba1ff6a.png",i[0],i[1],360,180);this.set.push(r),r.node.addEventListener("touchstart",(function(e){e.preventDefault()}),{passive:!1});const o=function(n,i){const r=e.scaleVector(s);r[0]-=16,r[1]-=16;const o=e.scalePoint(t);return Math.sin((n+90)*Math.PI/180)*(r[0]+i)+o[0]+","+(Math.cos((n+90)*Math.PI/180)*(r[1]+i)+o[1])},a=e.raphael.path(" M"+o(180,6)+" L"+o(180,2)+" L"+o(183,10)+" L"+o(180,18)+" L"+o(180,14)+" A"+(e.scaleVector(s)[0]+10)+","+(e.scaleVector(s)[1]+10)+",0,0,1,"+o(170,14)+" L"+o(170,18)+" L"+o(167,10)+" L"+o(170,2)+" L"+o(170,6)+" A"+(e.scaleVector(s)[0]+10)+","+(e.scaleVector(s)[1]+10)+",0,0,0,"+o(180,6)+" Z").attr({stroke:null,fill:Br.INTERACTIVE});this.set.push(a),this.centerPoint=e.addMovablePoint({coord:t,visible:!1}),this.rotateHandle=e.addMovablePoint({bounded:!1,coord:[Math.sin(275*Math.PI/180)*s+this.cx,Math.cos(275*Math.PI/180)*s+this.cy],onMove:function(e,t){const s=180*Math.atan2(n.centerPoint.coord[1]-t,n.centerPoint.coord[0]-e)/Math.PI;n.rotate(-s-5,!0)}}),this.rotateHandle.constraints.fixedDistance.dist=s,this.rotateHandle.constraints.fixedDistance.point=this.centerPoint,this.rotateHandle.visibleShape.remove(),this.rotateHandle.mouseTarget.attr({scale:2});let c=!1,h=!1;const p=function(){return h||c},u=l()(this.rotateHandle.mouseTarget.getMouseTarget());u.bind("vmousedown",(function(e){c=!0,u.css("cursor","-webkit-grabbing"),u.css("cursor","grabbing"),a.animate({scale:1.5,fill:Br.INTERACTING},50),l()(document).bind("vmouseup.rotateHandle",(function(e){c=!1,u.css("cursor","-webkit-grab"),u.css("cursor","grab"),p()||a.animate({scale:1,fill:Br.INTERACTIVE},50),l()(document).unbind("vmouseup.rotateHandle")}))})),u.bind("vmouseover",(function(e){h=!0,a.animate({scale:1.5,fill:Br.INTERACTING},50)})),u.bind("vmouseout",(function(e){h=!1,p()||a.animate({scale:1,fill:Br.INTERACTIVE},50)}));const d=l.a.map(this.set,(function(e){return e.node}));return this.makeTranslatable=function(){l()(d).css("cursor","move"),u.css("cursor","-webkit-grab"),u.css("cursor","grab"),l()(d).bind("vmousedown",(function(t){t.preventDefault();let s=t.pageX-l()(e.raphael.canvas.parentNode).offset().left,i=t.pageY-l()(e.raphael.canvas.parentNode).offset().top;l()(document).bind("vmousemove.protractor",(function(t){let r=t.pageX-l()(e.raphael.canvas.parentNode).offset().left,o=t.pageY-l()(e.raphael.canvas.parentNode).offset().top;r=Math.max(10,Math.min(e.xpixels-10,r)),o=Math.max(10,Math.min(e.ypixels-10,o));const a=r-s,c=o-i;l.a.each(n.set.items,(function(){this.translate(a,c)})),n.centerPoint.setCoord([n.centerPoint.coord[0]+a/e.scale[0],n.centerPoint.coord[1]-c/e.scale[1]]),n.rotateHandle.setCoord([n.rotateHandle.coord[0]+a/e.scale[0],n.rotateHandle.coord[1]-c/e.scale[1]]),s=r,i=o})),l()(document).one("vmouseup",(function(e){l()(document).unbind("vmousemove.protractor")}))}))},this.rotation=0,this.rotate=function(t,n){const s=e.scalePoint(this.centerPoint.coord);return n&&(this.rotation=0),this.set.rotate(this.rotation+t,s[0],s[1]),this.rotation=this.rotation+t,this},this.moveTo=function(t,s){const i=e.scalePoint(n.centerPoint.coord),r=e.scalePoint([t,s]),o=2*Ar.getDistance(i,r);l()({x:i[0],y:i[1]}).animate({x:r[0],y:r[1]},{duration:o,step:function(t,s){let i=0,r=0;"x"===s.prop?i=t-e.scalePoint(n.centerPoint.coord)[0]:"y"===s.prop&&(r=t-e.scalePoint(n.centerPoint.coord)[1]),l.a.each(n.set.items,(function(){this.translate(i,r)})),n.centerPoint.setCoord([n.centerPoint.coord[0]+i/e.scale[0],n.centerPoint.coord[1]-r/e.scale[1]]),n.rotateHandle.setCoord([n.rotateHandle.coord[0]+i/e.scale[0],n.rotateHandle.coord[1]-r/e.scale[1]])}})},this.rotateTo=function(e){Math.abs(this.rotation-e)>180&&(this.rotation+=360);const t=5*Math.abs(this.rotation-e);l()({0:this.rotation}).animate({0:e},{duration:t,step:function(e,t){n.rotate(e,!0),n.rotateHandle.setCoord([Math.sin((e+275)*Math.PI/180)*s+n.centerPoint.coord[0],Math.cos((e+275)*Math.PI/180)*s+n.centerPoint.coord[1]])}})},this.remove=function(){this.set.remove()},this.makeTranslatable(),this}function Jr(e,t){Er.defaults(t,{center:[0,0],pixelsPerUnit:40,ticksPerUnit:10,units:10,label:"",style:{fill:null,stroke:Br.GRAY}});const n=Er.extend({},t.style,{strokeWidth:1}),s=Er.extend({},t.style,{strokeWidth:2}),i=t.units*t.pixelsPerUnit,r=e.unscalePoint(Rr.subtract(e.scalePoint(t.center),Rr.scale([i,-50],.5))),o=t.pixelsPerUnit/e.scale[0],a=50/e.scale[0],c=Rr.add(r,[t.units*o,a]);let h;if(10===t.ticksPerUnit)h={10:1,5:.55,1:.35};else{const e=[1,.6,.45,.3];h={};for(let n=t.ticksPerUnit;n>=1;n/=2)h[n]=1*(e.shift()||.2)}const p=Er.keys(h).sort((function(e,t){return t-e}));const u=r[0],d=r[1],g=c[0],f=c[1],m=t.units*t.ticksPerUnit+1,b=e.raphael.set(),v=1/e.scale[0];b.push(e.line([u-v,d],[g+v,d],s)),b.push(e.line([u-v,f],[g+v,f],s)),Er.times(m,(function(i){const r=i/t.ticksPerUnit,l=u+r*o,c=function(e){for(let t=0;t<p.length;t++){const n=p[t];if(e%n===0)return h[n]}}(i)*a,g=0===i||i===m-1?s:n;if(b.push(e.line([l,d],[l,d+c],g)),r%1===0){const n=e.scalePoint([l,f]);let s,i;0===r?(s=t.label,i={mm:13,cm:11,m:8,km:11,in:8,ft:8,yd:10,mi:10}[s]||3*s.toString().length):(s=r,i=-3*(r.toString().length+1));const o=e.raphael.text(n[0]+i,n[1]+10,s);o.attr({"font-family":"KaTeX_Main","font-size":"12px",color:"#444"}),b.push(o)}}));const x=e.mouselayer.path(Ar.svgPath([r,[u,f],c,[g,d],!0]));x.attr({fill:"#000",opacity:0,stroke:"#000","stroke-width":2}),b.push(x),x.node.addEventListener("touchstart",(function(e){e.preventDefault()}),{passive:!1});const y=l.a.map(b,(function(e){return e.node}));l()(y).css("cursor","move"),l()(y).bind("vmousedown",(function(t){t.preventDefault();let n=t.pageX-l()(e.raphael.canvas.parentNode).offset().left,s=t.pageY-l()(e.raphael.canvas.parentNode).offset().top;l()(document).bind("vmousemove.ruler",(function(t){let i=t.pageX-l()(e.raphael.canvas.parentNode).offset().left,r=t.pageY-l()(e.raphael.canvas.parentNode).offset().top;i=Math.max(10,Math.min(e.xpixels-10,i)),r=Math.max(10,Math.min(e.ypixels-10,r));const o=i-n,a=r-s;b.translate(o,a),j.setCoord([j.coord[0]+o/e.scale[0],j.coord[1]-a/e.scale[1]]),w.setCoord([w.coord[0]+o/e.scale[0],w.coord[1]-a/e.scale[1]]),n=i,s=r})),l()(document).one("vmouseup",(function(e){l()(document).unbind("vmousemove.ruler")}))}));const j=e.addMovablePoint({coord:r,normalStyle:{fill:Br.INTERACTIVE,"fill-opacity":0,stroke:Br.INTERACTIVE},highlightStyle:{fill:Br.INTERACTING,"fill-opacity":.1,stroke:Br.INTERACTING},pointSize:6,onMove:function(t,n){const s=w.coord[1]-n,i=w.coord[0]-t,r=180*Math.atan2(s,i)/Math.PI,o=Rr.scale(Rr.add([t,n],w.coord),.5),a=e.scalePoint(o),l=Rr.scale(Rr.add(j.coord,w.coord),.5),c=e.scalePoint(l),h=Rr.subtract(a,c);b.rotate(-r,c[0],c[1]),b.translate(h[0],h[1])}}),w=e.addMovablePoint({coord:[g,d],normalStyle:{fill:Br.INTERACTIVE,"fill-opacity":0,stroke:Br.INTERACTIVE},highlightStyle:{fill:Br.INTERACTING,"fill-opacity":.1,stroke:Br.INTERACTING},pointSize:6,onMove:function(t,n){const s=n-j.coord[1],i=t-j.coord[0],r=180*Math.atan2(s,i)/Math.PI,o=Rr.scale(Rr.add([t,n],j.coord),.5),a=e.scalePoint(o),l=Rr.scale(Rr.add(j.coord,w.coord),.5),c=e.scalePoint(l),h=Rr.subtract(a,c);b.rotate(-r,c[0],c[1]),b.translate(h[0],h[1])}});return j.constraints.fixedDistance.dist=i/e.scale[0],j.constraints.fixedDistance.point=w,w.constraints.fixedDistance.dist=i/e.scale[0],w.constraints.fixedDistance.point=j,this.remove=function(){b.remove(),j.remove(),w.remove()},this}function Qr(e,t){if(this.graphie=e,Er.extend(this,t),Er.defaults(this,{normalStyle:{stroke:Br.INTERACTIVE,"stroke-width":2,fill:Br.INTERACTIVE},highlightStyle:{stroke:Br.INTERACTING,"stroke-width":2,fill:Br.INTERACTING},labelStyle:{stroke:Br.DYNAMIC,"stroke-width":1,color:Br.DYNAMIC},angleStyle:{stroke:Br.DYNAMIC,"stroke-width":1,color:Br.DYNAMIC},allowReflex:!0}),!this.points||3!==this.points.length)throw new Error("MovableAngle requires 3 points");this.points=Er.map(t.points,(function(t){return Er.isArray(t)?e.addMovablePoint({coord:t,visible:!1,constraints:{fixed:!0},normalStyle:this.normalStyle}):t}),this),this.coords=Er.pluck(this.points,"coord"),null==this.reflex&&(this.allowReflex?this.reflex=this._getClockwiseAngle(this.coords)>180:this.reflex=!1),this.rays=Er.map([0,2],(function(t){return e.addMovableLineSegment({pointA:this.points[1],pointZ:this.points[t],fixed:!0,extendRay:!0})}),this),this.temp=[],this.labeledAngle=e.label([0,0],"","center",this.labelStyle),this.fixed||(this.addMoveHandlers(),this.addHighlightHandlers()),this.update()}Er.extend(Ar.Graphie.prototype,{addMouseLayer:function(e){const t=this;e=Er.extend({allowScratchpad:!1,setDrawingAreaAvailable:function(){}},e);if(t.mouselayer=Raphael(t.raphael.canvas.parentNode,t.xpixels,t.ypixels),l()(t.mouselayer.canvas).css("z-index",2),e.onClick||e.onMouseDown||e.onMouseMove||e.onMouseOver||e.onMouseOut){const n=t.mouselayer.rect(0,0,t.xpixels,t.ypixels).attr({fill:"#000",opacity:0});let s=!1;l()(t.mouselayer.canvas).on("vmousedown",(function(i){i.target===n[0]&&(e.onMouseDown&&e.onMouseDown(t.getMouseCoord(i)),s=!0,e.onMouseMove&&l()(document).bind("vmousemove.mouseLayer",(function(n){s&&(n.preventDefault(),e.onMouseMove(t.getMouseCoord(n)))})),l()(document).bind("vmouseup.mouseLayer",(function(n){l()(document).unbind(".mouseLayer"),s&&e.onClick&&e.onClick(t.getMouseCoord(n)),s=!1})))})),e.onMouseOver&&l()(t.mouselayer.canvas).on("vmouseover",(function(n){e.onMouseOver(t.getMouseCoord(n))})),e.onMouseOut&&l()(t.mouselayer.canvas).on("vmouseout",(function(n){e.onMouseOut(t.getMouseCoord(n))}))}e.allowScratchpad||e.setDrawingAreaAvailable(!1),t._mouselayerWrapper=document.createElement("div"),l()(t._mouselayerWrapper).css({position:"absolute",left:0,top:0,zIndex:2}),t._visiblelayerWrapper=document.createElement("div"),l()(t._visiblelayerWrapper).css({position:"absolute",left:0,top:0});const n=t.raphael.canvas.parentNode;n.appendChild(t._visiblelayerWrapper),n.appendChild(t._mouselayerWrapper),t.addToMouseLayerWrapper=function(e){this._mouselayerWrapper.appendChild(e)},t.addToVisibleLayerWrapper=function(e){this._visiblelayerWrapper.appendChild(e)}},getMousePx:function(e){return[e.pageX-l()(this.raphael.canvas.parentNode).offset().left,e.pageY-l()(this.raphael.canvas.parentNode).offset().top]},getMouseCoord:function(e){return this.unscalePoint(this.getMousePx(e))},labelAngle:function(e){const t=this;Er.defaults(e,{point1:[0,0],vertex:[0,0],point3:[0,0],label:null,numArcs:1,showRightAngleMarker:!0,pushOut:0,clockwise:!1,style:{}});let n=void 0===e.text?"":e.text;const s=e.vertex,i=t.scalePoint(s);let r,o;e.clockwise?(r=e.point1,o=e.point3):(r=e.point3,o=e.point1);const a=Ar.findAngle(r,s),l=Ar.findAngle(o,s),c=(l+360-a)%360,h=(a+c/2)%360;let p=5*e.pushOut+Gr(c);const u=[];if(Math.abs(c-90)<1e-9&&e.showRightAngleMarker){const n=Hr(i,Yr(p,a)),s=Hr(i,Yr(p,l));p*=Math.SQRT2;const r=Hr(i,Yr(p,h));Er.each([n,s],(function(n){u.push(t.scaledPath([n,r],e.style))}))}else Er.times(e.numArcs,(function(n){u.push(t.arc(s,t.unscaleVector(p),a,l,e.style)),p+=3}));if(n){const s=n.match(/\$deg(\d)?/);if(s){const e=s[1]||1;n=n.replace(s[0],Wr.toFixedApprox(c,e)+"^{\\circ}")}const r=Hr(i,Yr(p+15,h)),o=t.unscalePoint(r);e.label?(e.label.setPosition(o),e.label.processMath(n,!0)):t.label(o,n,"center",e.style)}return u},labelSide:function(e){const t=this;let n,s;Er.defaults(e,{point1:[0,0],point2:[0,0],label:null,text:"",numTicks:0,numArrows:0,clockwise:!1,style:{}}),e.clockwise?(n=e.point1,s=e.point2):(n=e.point2,s=e.point1);const i=[(n[0]+s[0])/2,(n[1]+s[1])/2],r=t.scalePoint(i),o=Math.atan2(s[1]-n[1],s[0]-n[0]),a=o+Math.PI/2,l=[];let c=0;if(e.numTicks){const n=e.numTicks,s=5,i=5,h=Er.extend({},e.style,{strokeWidth:2});Er.times(n,(function(e){const c=$r(s*(e-(n-1)/2),o),p=$r(i,a),u=[Hr(r,c,p),Hr(r,c,Ur(p))];l.push(t.scaledPath(u,h))})),c+=s*(n-1)+15}if(e.numArrows){const i=e.numArrows,a=[n,s].sort((function(e,t){return e[1]===t[1]?e[0]-t[0]:e[1]-t[1]}))[0],h=t.scalePoint(a),p=Er.extend({},e.style,{arrows:"->",strokeWidth:2}),u=5;Er.times(i,(function(e){let s=$r(c+u*e,o);a!==n&&(s=Ur(s));const i=Hr(r,s);l.push(t.scaledPath([h,i],p))}))}let h=e.text;if(h){const i=h.match(/\$len(\d)?/);if(i){const e=Ar.getDistance(n,s),t=i[1]||1;h=h.replace(i[0],Wr.toFixedApprox(e,t))}const o=$r(20,a),l=Hr(r,o),c=t.unscalePoint(l);e.label?(e.label.setPosition(c),e.label.processMath(h,!0)):t.label(c,h,"center",e.style)}return l},labelVertex:function(e){const t=this;if(Er.defaults(e,{point1:null,vertex:[0,0],point3:null,label:null,text:"",clockwise:!1,style:{}}),!e.text)return;const n=e.vertex,s=t.scalePoint(n);let i,r;e.clockwise?(i=e.point1,r=e.point3):(i=e.point3,r=e.point1);let o,a=135;if(i&&r){const e=Ar.findAngle(i,n);a=(Ar.findAngle(r,n)+360-e)%360,o=(e+a/2+180)%360}else if(i){o=Ar.findAngle(n,i)+90}else if(r){o=Ar.findAngle(r,n)+90}else o=135;const l=Hr(s,Yr(10+Gr(360-a),o)),c=t.unscalePoint(l);e.label?(e.label.setPosition(c),e.label.processMath(e.text,!0)):t.label(c,e.text,"center",e.style)},addMovablePoint:function(e){const t=l.a.extend(!0,{graph:this,coord:[0,0],snapX:0,snapY:0,pointSize:4,highlight:!1,dragging:!1,visible:!0,bounded:!0,constraints:{fixed:!1,constrainX:!1,constrainY:!1,fixedAngle:{},fixedDistance:{}},lineStarts:[],lineEnds:[],polygonVertices:[],normalStyle:{},highlightStyle:{fill:Br.INTERACTING,stroke:Br.INTERACTING},labelStyle:{color:Br.INTERACTIVE},vertexLabel:"",mouseTarget:null},e),n=t.constraints.fixed?Br.DYNAMIC:Br.INTERACTIVE;t.normalStyle=Er.extend({},{fill:n,stroke:n},e.normalStyle),void 0!==e.coordX&&(t.coord[0]=e.coordX),void 0!==e.coordY&&(t.coord[1]=e.coordY);const s=t.graph,i=function(e){t.visible&&t.bounded&&!t.constraints.fixed&&(e=s.constrainToBounds(e,10));let n=e[0],i=e[1];if(0!==t.snapX&&(n=Math.round(n/t.snapX)*t.snapX),0!==t.snapY&&(i=Math.round(i/t.snapY)*t.snapY),t.constraints.fixedDistance.snapPoints){const r=s.scalePoint(e);let o=r[0],a=r[1];const l=2*Math.PI/t.constraints.fixedDistance.snapPoints,c=t.constraints.fixedDistance.dist,h=t.constraints.fixedDistance.point,p=(h[0]-s.range[0][0])*s.scale[0],u=(-h[1]+s.range[1][1])*s.scale[1];let d=o-p,g=-a+u,f=Math.atan(g/d);d<0&&(f+=Math.PI),f=Math.round(f/l)*l,d=c*Math.cos(f),g=c*Math.sin(f),o=d+p,a=-g+u,n=Wr.roundTo(5,o/s.scale[0]+s.range[0][0]),i=Wr.roundTo(5,s.range[1][1]-a/s.scale[1])}return t.applyConstraint([n,i])};t.applyConstraint=function(e,n,s){let i=e.slice();const r={};if(s?l.a.extend(r,{fixed:!1,constrainX:!1,constrainY:!1,fixedAngle:{},fixedDistance:{}},n):l.a.extend(r,this.constraints,n),r.constrainX)i=[this.coord[0],e[1]];else if(r.constrainY)i=[e[0],this.coord[1]];else if("number"===typeof r.fixedAngle.angle&&"number"===typeof r.fixedDistance.dist){const e=r.fixedAngle.vertex.coord||r.fixedAngle.vertex,t=r.fixedAngle.ref.coord||r.fixedAngle.ref,n=r.fixedDistance.point.coord||r.fixedDistance.point,s=(r.fixedAngle.angle+Ar.findAngle(t,e))*Math.PI/180,o=r.fixedDistance.dist;i[0]=o*Math.cos(s)+n[0],i[1]=o*Math.sin(s)+n[1]}else if("number"===typeof r.fixedAngle.angle){const t=r.fixedAngle.vertex.coord||r.fixedAngle.vertex,n=r.fixedAngle.ref.coord||r.fixedAngle.ref,s=(r.fixedAngle.angle+Ar.findAngle(n,t))*Math.PI/180,o=Ar.findAngle(e,t)*Math.PI/180;let a=Ar.getDistance(e,t)*Math.cos(s-o);a=a<1?1:a,i[0]=a*Math.cos(s)+t[0],i[1]=a*Math.sin(s)+t[1]}else if("number"===typeof r.fixedDistance.dist){const t=r.fixedDistance.point.coord||r.fixedDistance.point;let n=Ar.findAngle(e,t);const s=r.fixedDistance.dist;n=n*Math.PI/180,i[0]=s*Math.cos(n)+t[0],i[1]=s*Math.sin(n)+t[1]}else r.fixed&&(i=t.coord);return i},t.coord=i(t.coord);if(t.visible&&s.style(t.normalStyle,(function(){const e=[t.pointSize/s.scale[0],t.pointSize/s.scale[1]],n={maxScale:2,padding:2};t.visibleShape=new Fr(s,t.coord,e,n),t.visibleShape.attr(Er.omit(t.normalStyle,"scale")),t.visibleShape.toFront()})),t.normalStyle.scale=1,t.highlightStyle.scale=2,t.vertexLabel&&(t.labeledVertex=this.label([0,0],"","center",t.labelStyle)),t.drawLabel=function(){t.vertexLabel&&t.graph.labelVertex({vertex:t.coord,label:t.labeledVertex,text:t.vertexLabel,style:t.labelStyle})},t.drawLabel(),t.grab=function(e){e=e||[0,0],l()(document).bind("vmousemove.point vmouseup.point",(function(n){n.preventDefault(),t.dragging=!0,Kr=!0;let r=Rr.add(s.getMouseCoord(n),e);r=i(r);let o,a,c=r[0],h=r[1];if("vmousemove"===n.type){let e=!0;if(Er.isFunction(t.onMove)){const n=t.onMove(c,h);!1===n&&(e=!1),Er.isArray(n)&&(c=n[0],h=n[1])}if(o=(c-s.range[0][0])*s.scale[0],a=(-h+s.range[1][1])*s.scale[1],e){const e=s.unscalePoint([o,a]);t.visibleShape.moveTo(e),t.mouseTarget.moveTo(e),t.coord=[c,h],t.updateLineEnds(),l()(t).trigger("move")}t.drawLabel()}else if("vmouseup"===n.type){if(l()(document).unbind(".point"),t.dragging=!1,Kr=!1,Er.isFunction(t.onMoveEnd)){const e=t.onMoveEnd(c,h);if(Er.isArray(e)){c=e[0],h=e[1],o=(c-s.range[0][0])*s.scale[0],a=(-h+s.range[1][1])*s.scale[1];const n=s.unscalePoint([o,a]);t.visibleShape.moveTo(n),t.mouseTarget.moveTo(n),t.coord=[c,h]}}t.highlight||(t.visibleShape.animate(t.normalStyle,50),t.onUnhighlight&&t.onUnhighlight())}}))},t.visible&&!t.constraints.fixed){if(!t.mouseTarget){const e=s.unscaleVector(16),n={mouselayer:!0,padding:0,disableMouseEventsOnWrapper:!0};t.mouseTarget=new Fr(s,t.coord,e,n),t.mouseTarget.attr({fill:"#000",opacity:0})}const e=l()(t.mouseTarget.getMouseTarget());e.css("cursor","move"),e.bind("vmousedown vmouseover vmouseout",(function(e){if("vmouseover"===e.type)t.highlight=!0,Kr||(t.visibleShape.animate(t.highlightStyle,50),t.onHighlight&&t.onHighlight());else if("vmouseout"===e.type)t.highlight=!1,t.dragging||Kr||(t.visibleShape.animate(t.normalStyle,50),t.onUnhighlight&&t.onUnhighlight());else if("vmousedown"===e.type&&(1===e.which||0===e.which)){e.preventDefault();const n=t.coord,i=s.getMouseCoord(e),r=!("ontouchstart"in window)?[0,0]:Rr.subtract(n,i);t.grab(r)}}))}return t.moveTo=function(e,n,s){const i=5*Ar.getDistance(this.graph.scalePoint([e,n]),this.graph.scalePoint(this.coord)),r=s&&function(e){t.coord=e,t.updateLineEnds()};this.visibleShape.animateTo([e,n],i,r),this.mouseTarget.animateTo([e,n],i,r),this.coord=[e,n],Er.isFunction(this.onMove)&&this.onMove(e,n)},t.updateLineEnds=function(){l()(this.lineStarts).each((function(){this.coordA=t.coord,this.transform()})),l()(this.lineEnds).each((function(){this.coordZ=t.coord,this.transform()})),l()(this.polygonVertices).each((function(){this.transform()}))},t.setCoord=function(e){this.visible&&(this.visibleShape.moveTo(e),null!=this.mouseTarget&&this.mouseTarget.moveTo(e)),this.coord=e.slice()},t.setCoordConstrained=function(e){this.setCoord(i(e))},t.toBack=function(){this.visible&&(null!=this.mouseTarget&&this.mouseTarget.toBack(),this.visibleShape.toBack())},t.toFront=function(){this.visible&&(null!=this.mouseTarget&&this.mouseTarget.toFront(),this.visibleShape.toFront())},t.remove=function(){this.visibleShape&&this.visibleShape.remove(),this.mouseTarget&&this.mouseTarget.remove(),this.labeledVertex&&this.labeledVertex.remove()},t},addMovableLineSegment:function(e){const t=l.a.extend({graph:this,coordA:[0,0],coordZ:[1,1],snapX:0,snapY:0,fixed:!1,ticks:0,normalStyle:{},highlightStyle:{stroke:Br.INTERACTING,"stroke-width":6},labelStyle:{stroke:Br.INTERACTIVE,color:Br.INTERACTIVE},highlight:!1,dragging:!1,tick:[],extendLine:!1,extendRay:!1,constraints:{fixed:!1,constrainX:!1,constrainY:!1},sideLabel:"",vertexLabels:[],numArrows:0,numTicks:0,movePointsWithLine:!1},e),n=t.fixed?Br.DYNAMIC:Br.INTERACTIVE;t.normalStyle=Er.extend({},{"stroke-width":2,stroke:n},e.normalStyle),t.arrowStyle=Er.extend({},t.normalStyle,{color:t.normalStyle.stroke}),void 0!==e.pointA?(t.coordA=e.pointA.coord,t.pointA.lineStarts.push(t)):void 0!==e.coordA&&(t.coordA=e.coordA.slice()),void 0!==e.pointZ?(t.coordZ=e.pointZ.coord,t.pointZ.lineEnds.push(t)):void 0!==e.coordA&&(t.coordA=t.coordA.slice());const s=t.graph;s.style(t.normalStyle);for(let r=0;r<t.ticks;++r)t.tick[r]=Xr.bogusShape;let i=Ar.unscaledSvgPath([[0,0],[1,0]]);for(let r=0;r<t.ticks;++r){const e=.5-(t.ticks-1+2*r)/s.scale[0];i+=Ar.unscaledSvgPath([[e,-7],[e,7]])}if(e={thickness:Math.max(t.normalStyle["stroke-width"],t.highlightStyle["stroke-width"])},t.visibleLine=new zr(s,[0,0],[1,0],e),t.visibleLine.attr(t.normalStyle),!t.fixed){const e={thickness:30,mouselayer:!0};t.mouseTarget=new zr(s,[0,0],[1,0],e),t.mouseTarget.attr({fill:"#000",opacity:0})}if(t.transform=function(e){e&&("object"===typeof this.pointA&&(this.coordA=this.pointA.coord),"object"===typeof this.pointZ&&(this.coordZ=this.pointZ.coord));const n=function(e,n,s){const i=(e=t.graph).range[0][1]-e.range[0][0]+(e.range[1][1]-e.range[1][0]),r=e.unscaleVector(Rr.cartFromPolarDeg([1,s])),o=Rr.scale(Rr.normalize(r),i),a=Rr.add(n,o),l=Rr.polarDegFromCart(r)[1];return e.constrainToBoundsOnAngle(a,4,l*Math.PI/180)},i=function(e){const t=e.graph.scalePoint(e.coordA),n=e.graph.scalePoint(e.coordZ);return Rr.polarDegFromCart(Rr.subtract(n,t))[1]}(this);let r=this.coordA,o=this.coordZ;this.extendLine?(r=n(s,r,360-i),o=n(s,o,(540-i)%360)):this.extendRay&&(o=n(s,r,360-i));const a=[this.visibleLine];this.fixed||a.push(this.mouseTarget),Er.each(a,(function(e){e.moveTo(r,o)}));const l=function(e,t){const s=[.75,0];let i=[[-3,4],[-2.75,2.5],[0,.25],s,[0,-.25],[-2.75,-2.5],[-3,-4]];i=Er.map(i,(function(e){const t=Rr.subtract(e,s),n=Rr.scale(t,1.4);return Rr.add(s,n)}));const r=Er.map(i,e.unscalePoint),o={center:e.unscalePoint(s),createPath:function(e){let t="M"+e[0][0]+" "+e[0][1];for(let n=1;n<e.length;n+=3)t+="C"+e[n][0]+" "+e[n][1]+" "+e[n+1][0]+" "+e[n+1][1]+" "+e[n+2][0]+" "+e[n+2][1];return t}},a=new qr(e,r,o);return a.attr(Er.extend({"stroke-linejoin":"round","stroke-linecap":"round","stroke-dasharray":""},t)),a.toCoordAtAngle=function(t,i){const r=e.scalePoint(n(e,t,i)),o=Ii();a.transform("translateX("+(r[0]+1.4*s[0])+"px) translateY("+(r[1]+1.4*s[1])+"px) "+(o?"translateZ(0) ":"")+"rotate("+(360-Wr.bound(i))+"deg)")},a};null==this._arrows&&(this._arrows=[],this.extendLine?(this._arrows.push(l(s,this.normalStyle)),this._arrows.push(l(s,this.normalStyle))):this.extendRay&&this._arrows.push(l(s,this.normalStyle)));const c=[this.coordA,this.coordZ],h=[360-i,(540-i)%360];Er.each(this._arrows,(function(e,t){e.toCoordAtAngle(c[t],h[t])})),Er.invoke(this.temp,"remove"),this.temp=[];const p=this.coordA[0]<this.coordZ[0]||this.coordA[0]===this.coordZ[0]&&this.coordA[1]>this.coordZ[1];this.sideLabel&&this.temp.push(this.graph.labelSide({point1:this.coordA,point2:this.coordZ,label:this.labeledSide,text:this.sideLabel,numArrows:this.numArrows,numTicks:this.numTicks,clockwise:p,style:this.labelStyle})),this.vertexLabels.length&&(this.graph.labelVertex({vertex:this.coordA,point3:this.coordZ,label:this.labeledVertices[0],text:this.vertexLabels[0],clockwise:p,style:this.labelStyle}),this.graph.labelVertex({point1:this.coordA,vertex:this.coordZ,label:this.labeledVertices[1],text:this.vertexLabels[1],clockwise:p,style:this.labelStyle})),this.temp=Er.flatten(this.temp)},t.toBack=function(){t.fixed||t.mouseTarget.toBack(),t.visibleLine.toBack()},t.toFront=function(){t.fixed||t.mouseTarget.toFront(),t.visibleLine.toFront()},t.remove=function(){t.fixed||t.mouseTarget.remove(),t.visibleLine.remove(),t.labeledSide&&t.labeledSide.remove(),t.labeledVertices&&Er.invoke(t.labeledVertices,"remove"),t._arrows&&Er.invoke(t._arrows,"remove"),t.temp.length&&Er.invoke(t.temp,"remove")},t.hide=function(){t.visibleLine.hide(),t.temp.length&&Er.invoke(t.temp,"hide"),t._arrows&&Er.invoke(t._arrows,"hide")},t.show=function(){t.visibleLine.show(),t.temp.length&&Er.invoke(t.temp,"show"),t._arrows&&Er.invoke(t._arrows,"show")},t.sideLabel&&(t.labeledSide=this.label([0,0],"","center",t.labelStyle)),t.vertexLabels.length&&(t.labeledVertices=Er.map(t.vertexLabels,(function(e){return this.label([0,0],"","center",t.labelStyle)}),this)),!t.fixed&&!t.constraints.fixed){const e=l()(t.mouseTarget.getMouseTarget());e.css("cursor","move"),e.bind("vmousedown vmouseover vmouseout",(function(e){if("vmouseover"===e.type)Kr||(t.highlight=!0,t.visibleLine.animate(t.highlightStyle,50),t.arrowStyle=Er.extend({},t.arrowStyle,{color:t.highlightStyle.stroke,stroke:t.highlightStyle.stroke}),t.transform());else if("vmouseout"===e.type)t.highlight=!1,t.dragging||(t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=Er.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke}),t.transform());else if("vmousedown"===e.type&&(1===e.which||0===e.which)){e.preventDefault();let n=(e.pageX-l()(s.raphael.canvas.parentNode).offset().left)/s.scale[0]+s.range[0][0],i=s.range[1][1]-(e.pageY-l()(s.raphael.canvas.parentNode).offset().top)/s.scale[1];t.snapX>0&&(n=Math.round(n/t.snapX)*t.snapX),t.snapY>0&&(i=Math.round(i/t.snapY)*t.snapY);const r=[t.coordA[0]-n,t.coordA[1]-i],o=[t.coordZ[0]-n,t.coordZ[1]-i],a=-Math.min(s.scaleVector(r)[0],s.scaleVector(o)[0]),c=Math.max(s.scaleVector(r)[0],s.scaleVector(o)[0]),h=Math.max(s.scaleVector(r)[1],s.scaleVector(o)[1]),p=-Math.min(s.scaleVector(r)[1],s.scaleVector(o)[1]);l()(document).bind("vmousemove.lineSegment vmouseup.lineSegment",(function(e){e.preventDefault(),t.dragging=!0,Kr=!0;let n=e.pageX-l()(s.raphael.canvas.parentNode).offset().left,i=e.pageY-l()(s.raphael.canvas.parentNode).offset().top;n=Math.max(a+10,Math.min(s.xpixels-10-c,n)),i=Math.max(h+10,Math.min(s.ypixels-10-p,i));let u=n/s.scale[0]+s.range[0][0],d=s.range[1][1]-i/s.scale[1];if(t.snapX>0&&(u=Math.round(u/t.snapX)*t.snapX),t.snapY>0&&(d=Math.round(d/t.snapY)*t.snapY),"vmousemove"===e.type){t.constraints.constrainX&&(u=t.coordA[0]-r[0]),t.constraints.constrainY&&(d=t.coordA[1]-r[1]);const e=u+r[0]-t.coordA[0],n=d+r[1]-t.coordA[1];t.coordA=[u+r[0],d+r[1]],t.coordZ=[u+o[0],d+o[1]],t.transform(),t.movePointsWithLine&&("object"===typeof t.pointA&&t.pointA.setCoord([t.pointA.coord[0]+e,t.pointA.coord[1]+n]),"object"===typeof t.pointZ&&t.pointZ.setCoord([t.pointZ.coord[0]+e,t.pointZ.coord[1]+n])),Er.isFunction(t.onMove)&&t.onMove(e,n)}else"vmouseup"===e.type&&(l()(document).unbind(".lineSegment"),t.dragging=!1,Kr=!1,t.highlight||(t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=Er.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke}),t.transform()),Er.isFunction(t.onMoveEnd)&&t.onMoveEnd());l()(t).trigger("move")}))}}))}return void 0!==t.pointA&&t.pointA.toFront(),void 0!==t.pointZ&&t.pointZ.toFront(),t.transform(),t},addMovablePolygon:function(e){const t=this,n=l.a.extend({snapX:0,snapY:0,fixed:!1,constrainToGraph:!0,normalStyle:{},highlightStyle:{stroke:Br.INTERACTING,"stroke-width":2,fill:Br.INTERACTING,"fill-opacity":.05},pointHighlightStyle:{fill:Br.INTERACTING,stroke:Br.INTERACTING},labelStyle:{stroke:Br.DYNAMIC,"stroke-width":1,color:Br.DYNAMIC},angleLabels:[],showRightAngleMarkers:[],sideLabels:[],vertexLabels:[],numArcs:[],numArrows:[],numTicks:[],updateOnPointMove:!0,closed:!0},Er.omit(e,"points")),s=n.fixed?Br.DYNAMIC:Br.INTERACTIVE;n.normalStyle=Er.extend({"stroke-width":2,"fill-opacity":0,fill:s,stroke:s},e.normalStyle),n.points=e.points;const i=function(e){return!Er.isArray(e)};if(n.update=function(){const e=n.points.length;n.coords=Er.map(n.points,(function(e,t){return i(e)?e.coord:e})),n.left=Er.min(Er.pluck(n.coords,0)),n.right=Er.max(Er.pluck(n.coords,0)),n.top=Er.max(Er.pluck(n.coords,1)),n.bottom=Er.min(Er.pluck(n.coords,1));let s=Er.map(n.coords,(function(e){return t.scalePoint(e)}));n.closed?s.push(!0):s=s.concat(Er.clone(s).reverse()),n.path=Ar.unscaledSvgPath(s),Er.invoke(n.temp,"remove"),n.temp=[];const r=function(e){const t=Er.zip(e,e.slice(1).concat(e.slice(0,1)));return Vr(Er.map(t,(function(e){const t=e[0],n=e[1];return(n[0]-t[0])*(n[1]+t[1])})))>0}(n.coords);(n.angleLabels.length||n.showRightAngleMarkers.length)&&Er.each(n.labeledAngles,(function(s,i){n.temp.push(t.labelAngle({point1:n.coords[(i-1+e)%e],vertex:n.coords[i],point3:n.coords[(i+1)%e],label:s,text:n.angleLabels[i],showRightAngleMarker:n.showRightAngleMarkers[i],numArcs:n.numArcs[i],clockwise:r,style:n.labelStyle}))})),n.sideLabels.length&&Er.each(n.labeledSides,(function(s,i){n.temp.push(t.labelSide({point1:n.coords[i],point2:n.coords[(i+1)%e],label:s,text:n.sideLabels[i],numArrows:n.numArrows[i],numTicks:n.numTicks[i],clockwise:r,style:n.labelStyle}))})),n.vertexLabels.length&&Er.each(n.labeledVertices,(function(s,i){t.labelVertex({point1:n.coords[(i-1+e)%e],vertex:n.coords[i],point3:n.coords[(i+1)%e],label:s,text:n.vertexLabels[i],clockwise:r,style:n.labelStyle})})),n.temp=Er.flatten(n.temp)},n.transform=function(){n.update(),n.visibleShape.attr({path:n.path}),n.fixed||n.mouseTarget.attr({path:n.path})},n.remove=function(){n.visibleShape.remove(),n.fixed||n.mouseTarget.remove(),n.labeledAngles&&Er.invoke(n.labeledAngles,"remove"),n.labeledSides&&Er.invoke(n.labeledSides,"remove"),n.labeledVertices&&Er.invoke(n.labeledVertices,"remove"),n.temp.length&&Er.invoke(n.temp,"remove")},n.toBack=function(){n.fixed||n.mouseTarget.toBack(),n.visibleShape.toBack()},n.toFront=function(){n.fixed||n.mouseTarget.toFront(),n.visibleShape.toFront()},n.updateOnPointMove&&Er.each(Er.filter(n.points,i),(function(e){e.polygonVertices.push(n)})),n.coords=new Array(n.points.length),n.angleLabels.length){const e=Math.max(n.angleLabels.length,n.showRightAngleMarkers.length);n.labeledAngles=Er.times(e,(function(){return this.label([0,0],"","center",n.labelStyle)}),this)}return n.sideLabels.length&&(n.labeledSides=Er.map(n.sideLabels,(function(e){return this.label([0,0],"","center",n.labelStyle)}),this)),n.vertexLabels.length&&(n.labeledVertices=Er.map(n.vertexLabels,(function(e){return this.label([0,0],"","center",n.labelStyle)}),this)),n.update(),n.visibleShape=t.raphael.path(n.path),n.visibleShape.attr(n.normalStyle),n.fixed||(n.mouseTarget=t.mouselayer.path(n.path),n.mouseTarget.attr({fill:"#000",opacity:0,cursor:"move"}),l()(n.mouseTarget[0]).bind("vmousedown vmouseover vmouseout",(function(e){if("vmouseover"===e.type)Kr&&!n.dragging||(n.highlight=!0,n.visibleShape.animate(n.highlightStyle,50),Er.each(Er.filter(n.points,i),(function(e){e.visibleShape.animate(n.pointHighlightStyle,50)})));else if("vmouseout"===e.type){if(n.highlight=!1,!n.dragging){n.visibleShape.animate(n.normalStyle,50);const e=Er.filter(n.points,i);Er.any(Er.pluck(e,"dragging"))||Er.each(e,(function(e){e.visibleShape.animate(e.normalStyle,50)}))}}else if("vmousedown"===e.type&&(1===e.which||0===e.which)){e.preventDefault(),Er.each(Er.filter(n.points,i),(function(e){e.dragging=!0}));let s=(e.pageX-l()(t.raphael.canvas.parentNode).offset().left)/t.scale[0]+t.range[0][0],r=t.range[1][1]-(e.pageY-l()(t.raphael.canvas.parentNode).offset().top)/t.scale[1];n.snapX>0&&(s=Math.round(s/n.snapX)*n.snapX),n.snapY>0&&(r=Math.round(r/n.snapY)*n.snapY);let o=s,a=r;const c=n.coords.slice(),h=(s-n.left)*t.scale[0],p=(n.right-s)*t.scale[0],u=(n.top-r)*t.scale[1],d=(r-n.bottom)*t.scale[1];l()(document).bind("vmousemove.polygon vmouseup.polygon",(function(e){e.preventDefault(),n.dragging=!0,Kr=!0;let g=e.pageX-l()(t.raphael.canvas.parentNode).offset().left,f=e.pageY-l()(t.raphael.canvas.parentNode).offset().top;n.constrainToGraph&&(g=Math.max(h+10,Math.min(t.xpixels-10-p,g)),f=Math.max(u+10,Math.min(t.ypixels-10-d,f)));let m=g/t.scale[0]+t.range[0][0],b=t.range[1][1]-f/t.scale[1];if(n.snapX>0&&(m=Math.round(m/n.snapX)*n.snapX),n.snapY>0&&(b=Math.round(b/n.snapY)*n.snapY),"vmousemove"===e.type){let e=m-s,t=b-r,h=!0;if(Er.isFunction(n.onMove)){const i=n.onMove(e,t);!1===i?h=!1:Er.isArray(i)&&(e=i[0],t=i[1],m=s+e,b=r+t)}const p=function(n){return[c[n][0]+e,c[n][1]+t]};h&&(Er.each(n.points,(function(e,t){i(e)?e.setCoord(p(t)):n.points[t]=p(t)})),n.transform(),l()(n).trigger("move"),o=m,a=b)}else if("vmouseup"===e.type){l()(document).unbind(".polygon");const e=Er.filter(n.points,i);Er.each(e,(function(e){e.dragging=!1})),n.dragging=!1,Kr=!1,n.highlight||(n.visibleShape.animate(n.normalStyle,50),Er.each(e,(function(e){e.visibleShape.animate(e.normalStyle,50)}))),Er.isFunction(n.onMoveEnd)&&n.onMoveEnd(o-s,a-r)}}))}}))),Er.invoke(Er.filter(n.points,i),"toFront"),n},constrainToBounds:function(e,t){const n=this.unscalePoint([t,this.ypixels-t]),s=this.unscalePoint([this.xpixels-t,t]);return[Math.max(n[0],Math.min(s[0],e[0])),Math.max(n[1],Math.min(s[1],e[1]))]},constrainToBoundsOnAngle:function(e,t,n){const s=this.unscalePoint([t,this.ypixels-t]),i=this.unscalePoint([this.xpixels-t,t]);let r=e.slice();return r[0]<s[0]?r=[s[0],r[1]+(s[0]-r[0])*Math.tan(n)]:r[0]>i[0]&&(r=[i[0],r[1]-(r[0]-i[0])*Math.tan(n)]),r[1]<s[1]?r=[r[0]+(s[1]-r[1])/Math.tan(n),s[1]]:r[1]>i[1]&&(r=[r[0]-(r[1]-i[1])/Math.tan(n),i[1]]),r},addMovableAngle:function(e){return new Qr(this,e)},addCircleGraph:function(e){const t=this,n=l.a.extend({center:[0,0],radius:2,snapX:.5,snapY:.5,snapRadius:.5,minRadius:1,centerConstraints:{},centerNormalStyle:{},centerHighlightStyle:{stroke:Br.INTERACTING,fill:Br.INTERACTING},circleNormalStyle:{stroke:Br.INTERACTIVE,"fill-opacity":0},circleHighlightStyle:{stroke:Br.INTERACTING,fill:Br.INTERACTING,"fill-opacity":.05}},e),s=n.centerConstraints.fixed?Br.DYNAMIC:Br.INTERACTIVE,i=e?e.centerNormalStyle:null;n.centerNormalStyle=Er.extend({},{fill:s,stroke:s},i),n.centerPoint=t.addMovablePoint({graph:t,coord:n.center,normalStyle:n.centerNormalStyle,snapX:n.snapX,snapY:n.snapY,constraints:n.centerConstraints}),n.circ=t.circle(n.center,n.radius,n.circleNormalStyle),n.perim=t.mouselayer.circle(t.scalePoint(n.center)[0],t.scalePoint(n.center)[1],t.scaleVector(n.radius)[0]).attr({"stroke-width":20,opacity:.002}),n.centerConstraints.fixed||l()(n.centerPoint.mouseTarget.getMouseTarget()).on("vmouseover vmouseout",(function(e){n.centerPoint.highlight||n.centerPoint.dragging?n.circ.animate(n.circleHighlightStyle,50):n.circ.animate(n.circleNormalStyle,50)})),n.toFront=function(){n.circ.toFront(),n.perim.toFront(),n.centerPoint.visibleShape.toFront(),n.centerConstraints.fixed||n.centerPoint.mouseTarget.toFront()},n.centerPoint.onMove=function(e,s){n.toFront(),n.circ.attr({cx:t.scalePoint(e)[0],cy:t.scalePoint(s)[1]}),n.perim.attr({cx:t.scalePoint(e)[0],cy:t.scalePoint(s)[1]}),n.onMove&&n.onMove(e,s)},l()(n.centerPoint).on("move",(function(){n.center=this.coord,l()(n).trigger("move")})),n.setCenter=function(e,t){n.centerPoint.setCoord([e,t]),n.centerPoint.onMove(e,t),n.center=[e,t]},n.setRadius=function(e){n.radius=e,n.perim.attr({r:t.scaleVector(e)[0]}),n.circ.attr({rx:t.scaleVector(e)[0],ry:t.scaleVector(e)[1]})},n.remove=function(){n.centerPoint.remove(),n.circ.remove(),n.perim.remove()};const r=[[-1*Math.PI,-.875*Math.PI,"ew-resize"],[-.875*Math.PI,-.625*Math.PI,"nesw-resize"],[-.625*Math.PI,-.375*Math.PI,"ns-resize"],[-.375*Math.PI,-.125*Math.PI,"nwse-resize"],[-.125*Math.PI,.125*Math.PI,"ew-resize"],[.125*Math.PI,.375*Math.PI,"nesw-resize"],[.375*Math.PI,.625*Math.PI,"ns-resize"],[.625*Math.PI,.875*Math.PI,"nwse-resize"],[.875*Math.PI,1*Math.PI,"ew-resize"]];return l()(n.perim.node).on("vmousemove",(e=>{let[t,s]=this.getMouseCoord(e);t-=n.center[0],s-=n.center[1];const i=Math.atan2(s,t);r.forEach((function(e){const[t,s,r]=e;i>=t&&i<s&&l()(n.perim.node).css("cursor",r)}))})),l()(n.perim.node).css("cursor","nesw-resize"),n.perim.node.addEventListener("touchstart",(function(e){e.preventDefault()}),{passive:!1}),l()(n.perim.node).on("vmouseover vmouseout vmousedown",(function(e){if("vmouseover"===e.type)n.highlight=!0,Kr||(n.circ.animate(n.circleHighlightStyle,50),n.centerPoint.visibleShape.animate(n.centerHighlightStyle,50));else if("vmouseout"===e.type)n.highlight=!1,n.dragging||n.centerPoint.dragging||(n.circ.animate(n.circleNormalStyle,50),n.centerPoint.visibleShape.animate(n.centerNormalStyle,50));else if("vmousedown"===e.type&&(1===e.which||0===e.which)){e.preventDefault(),n.toFront();const s=n.radius;l()(document).on("vmousemove vmouseup",(function(e){if(e.preventDefault(),n.dragging=!0,Kr=!0,"vmousemove"===e.type){const s=t.constrainToBounds(t.getMouseCoord(e),10);let i=Ar.getDistance(n.centerPoint.coord,s);i=Math.max(n.minRadius,Math.round(i/n.snapRadius)*n.snapRadius);const r=n.radius;let o=!0;if(n.onResize){const e=n.onResize(i,r);Er.isNumber(e)?i=e:!1===e&&(o=!1)}o&&(n.setRadius(i),l()(n).trigger("move"))}else"vmouseup"===e.type&&(l()(document).off("vmousemove vmouseup"),n.dragging=!1,Kr=!1,n.onResizeEnd&&n.onResizeEnd(n.radius,s))}))}})),n},addRotateHandle:function(e){const t=this;let n=e.center;const s=e.radius,i=e.lengthAngle||30,r=e.hideArrow||!1,o=e.mouseTarget,a=Er.uniqueId("rotateHandle");Er.isArray(n)&&(n={coord:n});const c=t.addMovablePoint({coord:Dr.addVector(n.coord,Rr.cartFromPolarDeg(s,e.angleDeg||0)),constraints:{fixedDistance:{dist:s,point:n}},mouseTarget:o});n.toFront();let h,p=n.coord,u=c.coord,d=u,g=!1,f=!1;const m=function(s){if(r)return;const o=Rr.subtract(s,n.coord),a=Rr.polarDegFromCart(o)[1];h&&h.remove(),h=function(e,t,n,s,i,r,o){const a=function(s,i){const o=n+i,a=Rr.cartFromPolarDeg([o,r+s]),l=Rr.add(t,a),c=e.scalePoint(l);return c[0]+","+c[1]},l=e.scaleVector(n-s),c=e.scaleVector(n+s);return e.raphael.path(" M"+a(i,-s)+" L"+a(i,-3*s)+" L"+a(2*i,0)+" L"+a(i,3*s)+" L"+a(i,s)+" A"+c[0]+","+c[1]+",0,0,1,"+a(-i,s)+" L"+a(-i,3*s)+" L"+a(-2*i,0)+" L"+a(-i,-3*s)+" L"+a(-i,-s)+" A"+l[0]+","+l[1]+",0,0,0,"+a(i,-s)+" Z").attr({stroke:null,fill:o?Br.INTERACTING:Br.INTERACTIVE})}(t,n.coord,e.radius,g||f?e.hoverWidth/2:e.width/2,i,a,g||f)};l()(n).on("move."+a,(function(){const e=Rr.subtract(n.coord,p);c.setCoord(Rr.add(c.coord,e)),m(c.coord),p=n.coord,c.constraints.fixedDistance.point=n,u=c.coord})),c.onMove=function(t,s){g||(d=u,g=!0);let i=[t,s];if(e.onMove){const t=Rr.polarDegFromCart(Rr.subtract(u,n.coord)),s=Rr.polarDegFromCart(Rr.subtract(i,n.coord)),r=t[1],o=s[1];let a=e.onMove(o,r);null!=a&&!0!==a&&(!1===a&&(a=r),i=Rr.add(n.coord,Rr.cartFromPolarDeg([t[0],a])))}return m(i),u=i,i},c.onMoveEnd=function(){if(g=!1,m(c.coord),e.onMoveEnd){const t=Rr.polarDegFromCart(Rr.subtract(d,n.coord)),s=Rr.polarDegFromCart(Rr.subtract(c.coord,n.coord));e.onMoveEnd(s[1],t[1])}},c.visibleShape.remove(),o||c.mouseTarget.attr({scale:2});const b=l()(c.mouseTarget.getMouseTarget());b.bind("vmouseover",(function(e){f=!0,m(c.coord)})),b.bind("vmouseout",(function(e){f=!1,m(c.coord)})),m(c.coord);const v=c.remove;return c.remove=function(){v.call(c),h&&h.remove(),l()(n).off("move."+a)},c.update=function(){m(c.coord)},c},addReflectButton:function(e){const t=this,n=e.line,s=t.addMovablePoint({constraints:e.constraints,coord:Lr.midpoint([n.pointA.coord,n.pointZ.coord]),snapX:t.snap[0],snapY:t.snap[1],onMove:function(e,t){return!1},onMoveEnd:function(t,n){e.onMoveEnd&&e.onMoveEnd.call(this,t,n)}});let i,r=!1,o=!1;const a=function(){return r},c=Er.map([0,1],(function(t){const n=t?e.highlightStyle:e.normalStyle;return Er.map([0,1],(function(e){return Er.defaults({"fill-opacity":e},n)}))})),h=function(e){return o&&(e=!e),c[+a()][+e]},p=function(n,s){i&&i.remove(),i=function(e,t,n,s,i,r,o){Dr.equal(n[0],n[1])&&(n=[n[0],Dr.addVector(n[0],[1,1])]);const a=Rr.normalize(Rr.subtract(n[1],n[0])),l=Rr.scale(a,s/2),c=Rr.scale(a,i),h=Rr.rotateDeg(c,90),p=Rr.rotateDeg(c,-90),u=Rr.negate(l),d=Rr.rotateDeg(l,90),g=Rr.rotateDeg(l,-90),f=Dr.addVectors(t,h),m=Dr.addVectors(t,p),b=Dr.addVectors(t,h,l,d),v=Dr.addVectors(t,h,u,d),x=Dr.addVectors(t,p,l,g),y=Dr.addVectors(t,p,u,g),j=e.path([f,b,v,!0],r),w=e.path([m,x,y,!0],o);return{remove:function(){j.remove(),w.remove()}}}(t,n,s,a()?1.5*e.size:e.size,a()?.125*e.size:.25,h(0),h(1))},u=function(e,t){e=e||n.pointA.coord,t=t||n.pointZ.coord;const i=Lr.midpoint([e,t]);s.setCoord(i),p(i,[e,t])};l()(n).on("move",Er.bind(u,s,null,null));const d=l()(s.mouseTarget.getMouseTarget());d.on("vclick",(function(){!1!==e.onClick()&&(o=!o,p(s.coord,[n.pointA.coord,n.pointZ.coord]))})),n.pointA.toFront(),n.pointZ.toFront(),s.visibleShape.remove();const g=t.scaleVector(e.size)[0]/20;s.mouseTarget.attr({scale:1.5*g}),d.css("cursor","pointer"),d.bind("vmouseover",(function(e){r=!0,p(s.coord,[n.pointA.coord,n.pointZ.coord])})),d.bind("vmouseout",(function(e){r=!1,p(s.coord,[n.pointA.coord,n.pointZ.coord])}));const f=s.remove;return s.remove=function(){i.remove(),f.call(s)},s.update=u,s.isFlipped=function(){return o},u(),s},protractor:function(e){return new Zr(this,e)},ruler:function(e){return new Jr(this,e||{})},addPoints:Hr}),Er.extend(Qr.prototype,{points:[],snapDegrees:0,snapOffsetDeg:0,angleLabel:"",numArcs:1,pushOut:0,fixed:!1,addMoveHandlers:function(){const e=this.graphie;function t(t,n){return Ar.getDistance(e.scalePoint(t),e.scalePoint(n))<30}const n=this.points;n[1].onMove=function(s,i){const r=n[1].coord,o=[s,i],a=Hr(o,Ur(r));let l=!0;const c={};return Er.each([0,2],(function(s){let i=Hr(n[s].coord,a),r=Ar.findAngle(o,i);r*=Math.PI/180,i=e.constrainToBoundsOnAngle(i,10,r),c[s]=i,t(o,i)&&(l=!1)})),l&&Er.each(c,(function(e,t){n[t].setCoord(e)})),l};const s=this.snapDegrees,i=this.snapOffsetDeg;Er.each([0,2],(function(r){n[r].onMove=function(r,o){const a=[r,o],l=n[1].coord;if(t(l,a))return!1;if(s){let t=Ar.findAngle(a,l);t=Math.round((t-i)/s)*s+i;const n=Ar.getDistance(a,l);return Hr(l,e.polar(n,t))}return!0}})),l()(n).on("move",function(){this.update(),l()(this).trigger("move")}.bind(this))},addHighlightHandlers:function(){const e=this.points[1];e.onHighlight=function(){Er.each(this.points,(function(e){e.visibleShape.animate(this.highlightStyle,50)}),this),Er.each(this.rays,(function(e){e.visibleLine.animate(this.highlightStyle,50),e.arrowStyle=Er.extend({},e.arrowStyle,{color:this.highlightStyle.stroke,stroke:this.highlightStyle.stroke})}),this),this.angleStyle=Er.extend({},this.angleStyle,{color:this.highlightStyle.stroke,stroke:this.highlightStyle.stroke}),this.update()}.bind(this),e.onUnhighlight=function(){Er.each(this.points,(function(e){e.visibleShape.animate(this.normalStyle,50)}),this),Er.each(this.rays,(function(e){e.visibleLine.animate(e.normalStyle,50),e.arrowStyle=Er.extend({},e.arrowStyle,{color:e.normalStyle.stroke,stroke:e.normalStyle.stroke})}),this),this.angleStyle=Er.extend({},this.angleStyle,{color:Br.DYNAMIC,stroke:Br.DYNAMIC}),this.update()}.bind(this)},_getClockwiseAngle:function(e){return Ar.findAngle(e[2],e[0],e[1])+0},isReflex:function(){return this.reflex},isClockwise:function(){return this._getClockwiseAngle(this.coords)>180===this.reflex},getClockwiseCoords:function(){return this.isClockwise()?Er.clone(this.coords):Er.clone(this.coords).reverse()},update:function(e){const t=this.coords;this.coords=Er.pluck(this.points,"coord"),Er.invoke(this.points,"updateLineEnds");const n=this._getClockwiseAngle(t),s=this._getClockwiseAngle(this.coords),i=n>180,r=s>180;this.allowReflex&&(null==e&&(e=i!==r&&Math.abs(s-n)<180),e&&(this.reflex=!this.reflex)),Er.invoke(this.temp,"remove"),this.temp=this.graphie.labelAngle({point1:this.coords[0],vertex:this.coords[1],point3:this.coords[2],label:this.labeledAngle,text:this.angleLabel,numArcs:this.numArcs,pushOut:this.pushOut,clockwise:this.reflex===r,style:this.angleStyle})},remove:function(){Er.invoke(this.rays,"remove"),Er.invoke(this.temp,"remove"),this.labeledAngle.remove()}}),Ir.exports=Xr;Ir.exports;var eo={exports:{}};eo.exports;const to=Pr;eo.exports=to;var no=eo.exports,so={exports:{}};so.exports;const io=x.b,ro=G.a.point,oo=G.a.vector;function ao(e){const t=io.zip(e,e.slice(1).concat(e.slice(0,1))),n=io.map(t,(function(e){const t=e[0],n=e[1];return(n[0]-t[0])*(n[1]+t[1])}));return s=n,io.reduce(s,(function(e,t){return e+t}),0)>0;var s}const lo={constrain:function(){this.constrain()},pointsToFront:function(e){io.invoke(e.points,"toFront")}};lo.standard=[lo.constrain,lo.pointsToFront];const co={draw:function(){this.draw()}};co.standard=[co.draw];const ho={basic:function(e,t){const n=this.graphie,s=this.path(e);this.state.visibleShape||(this.state.visibleShape=n.raphael.path(s),this.state.visibleShape.attr(this.normalStyle())),e.normalStyle===t.normalStyle||io.isEqual(e.normalStyle,t.normalStyle)||this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.attr({path:s}),this.mouseTarget()&&this.mouseTarget().attr({path:s})},labels:function(e,t){const n=this.graphie,s=this,i=io.invoke(e.points,"coord"),r=ao(i),o=i.length;null!=s.state._labelCache&&io.invoke(s.state._labelCache,"remove"),s.state._labelCache=[],(e.angleLabels.length||e.showRightAngleMarkers.length)&&(null==s.state._labeledAngles&&(s.state._labeledAngles=io.times(Math.max(e.angleLabels.length,e.showRightAngleMarkers.length),(function(){return n.label([0,0],"","center",e.labelStyle)}))),io.each(s.state._labeledAngles,(function(t,a){s.state._labelCache.push(n.labelAngle({point1:i[(a-1+o)%o],vertex:i[a],point3:i[(a+1)%o],label:t,text:e.angleLabels[a],showRightAngleMarker:e.showRightAngleMarkers[a],numArcs:e.numArcs[a],clockwise:r,style:e.labelStyle}))}))),e.sideLabels.length&&(null==s.state._labeledSides&&(s.state._labeledSides=io.map(e.sideLabels,(function(t){return n.label([0,0],"","center",e.labelStyle)}))),io.each(s.state._labeledSides,(function(t,a){s.state._labelCache.push(n.labelSide({point1:i[a],point2:i[(a+1)%o],label:t,text:e.sideLabels[a],numArrows:e.numArrows[a],numTicks:e.numTicks[a],clockwise:r,style:e.labelStyle}))}))),e.vertexLabels.length&&(null==s.state._labeledVertices&&(s.state._labeledVertices=io.map(e.vertexLabels,(function(t){return n.label([0,0],"","center",e.labelStyle)}))),io.each(s.state._labeledVertices,(function(t,a){s.state._labelCache.push(n.labelVertex({point1:i[(a-1+o)%o],vertex:i[a],point3:i[(a+1)%o],label:t,text:e.vertexLabels[a],clockwise:r,style:e.labelStyle}))}))),s.state._labelCache=io.flatten(s.state._labelCache)},highlight:function(e,t){e.isHovering&&!t.isHovering?e.visibleShape.animate(this.highlightStyle(),50):!e.isHovering&&t.isHovering&&e.visibleShape.animate(this.normalStyle(),50)}};ho.standard=[ho.basic,ho.labels,ho.highlight];const po={basic:function(){this.state.visibleShape&&this.state.visibleShape.remove()},labels:function(){const e=[this.state._labeledSides,this.state._labeledVertices,this.state._labeledAngles,this.state._labelCache];io.each(e,(function(e){null!=e&&e.length&&io.invoke(e,"remove")}))}};po.standard=[po.basic,po.labels];const uo={fixed:function(){return function(){return!1}},snap:function(e){return function(t){return null===e||(e=e||this.graphie.snap,ro.roundTo(t,e))}},bound:function(e,t,n){return void 0===n&&(n=void 0===e?10:0),function(e,s){const i=this.graphie,r=oo.subtract(e,s),o=o||i.range;void 0===t&&(t=i.snap);let a=i.unscalePoint([n,i.ypixels-n]),l=i.unscalePoint([i.xpixels-n,n]);t&&(a=ro.ceilTo(a,t),l=ro.floorTo(l,t));const c=io.map(this.coords(),(function(e,t){const n=oo.subtract(l,e);return[oo.subtract(a,e),n]})),h=io.reduce(c,(function(e,t){const n=t[0],s=t[1];return[Math.max(n[0],Math.min(s[0],e[0])),Math.max(n[1],Math.min(s[1],e[1]))]}),r);return oo.add(s,h)}},standard:null},go={updatePoints:function(e,t){const n=oo.subtract(e,t);io.each(this.state.points,(function(e){e.setCoord(oo.add(e.coord(),n))}))},standard:null};so.exports={add:lo,modify:co,draw:ho,remove:po,onMoveStart:{standard:null},constraints:uo,onMove:go,onMoveEnd:{standard:null},onClick:{standard:null}};var fo=so.exports,mo={exports:{}};mo.exports;const bo=G.a.vector,vo=x.b,xo=fo,yo=Ei,jo=ve,wo=yo.assert,Oo=yo.normalizeOptions,Co=Di,So=no,ko=vo.keys(xo),_o={points:null,angleLabels:[],showRightAngleMarkers:[],sideLabels:[],vertexLabels:[],numArcs:[],numArrows:[],numTicks:[],closed:!0,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,labelStyle:null},To={added:!1,hasMoved:!1,visibleShape:null,mouseTarget:null},Mo=function(e,t,n){wo(null!=e),wo(null!=n),vo.extend(this,{graphie:e,movable:t,state:{id:vo.uniqueId("movablePolygon")}}),this.modify(vo.extend({},To,n))};vo.extend(Mo,xo),yo.createGettersFor(Mo,vo.extend({},_o,To)),yo.addMovableHelperMethodsTo(Mo),vo.extend(Mo.prototype,{cloneState:function(){return vo.extend(this.movable.cloneState(),this.state)},_createDefaultState:function(){return vo.extend({id:this.state.id},Oo(ko,jo.pluck(xo,"standard")),_o)},modify:function(e){this.update(vo.extend(this._createDefaultState(),e))},update:function(e){const t=this,n=t.graphie,s=vo.extend(t.state,Oo(ko,e)),i=s.static?Co.DYNAMIC:Co.INTERACTIVE;s.normalStyle=vo.extend({},s.normalStyle,{"stroke-width":2,"fill-opacity":0,fill:i,stroke:i},e.normalStyle),s.highlightStyle=vo.extend({},{stroke:Co.INTERACTING,"stroke-width":2,fill:Co.INTERACTING,"fill-opacity":.05},s.highlightStyle),s.labelStyle=vo.extend({},{stroke:Co.DYNAMIC,"stroke-width":1,color:Co.DYNAMIC},s.labelStyle),s.static||s.mouseTarget||(s.mouseTarget=n.mouselayer.path(this.path()),s.mouseTarget.attr({fill:"#000",opacity:0,cursor:"move"})),t.movable.modify(vo.extend({},s,{modify:null,draw:t.draw.bind(t),remove:null,onMoveStart:function(){t._initialRefCoord=t.coord(0),t._prevRefCoord=t._initialRefCoord,t._totalDelta=[0,0],t._fireEvent(t.state.onMoveStart,t.coord(0),t.coord(0))},onMove:function(e,n){const s=bo.subtract(e,n);t._totalDelta=bo.add(t._totalDelta,s);let i=bo.add(t._initialRefCoord,t._totalDelta);i=t._applyConstraints(i,t._prevRefCoord),!1!==i&&(t._fireEvent(t.state.onMove,i,t._prevRefCoord),t._prevRefCoord=i)},onMoveEnd:function(){t._fireEvent(t.state.onMoveEnd,t._prevRefCoord,t._initialRefCoord)}})),vo.invoke(s.points,"listen","onMove",s.id,t.draw.bind(t)),s.added||(t.prevState={},t._fireEvent(s.add,t.cloneState(),t.prevState),s.added=!0,t.prevState=t.cloneState()),t._fireEvent(s.modify,t.cloneState(),t.prevState)},path:function(e){const t=this.graphie;e=e||this.state;let n=vo.map(e.points,(function(e){return t.scalePoint(e.coord())}));return e.closed?n.push(!0):n=n.concat(vo.clone(n).reverse()),So.unscaledSvgPath(n)},coords:function(){return vo.invoke(this.state.points,"coord")},point:function(e){return this.state.points[e]},coord:function(e){return this.point(e).coord()},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.state.points&&vo.invoke(this.state.points,"unlisten","onMove",this.state.id),this.movable&&this.movable.remove(),this.state.mouseTarget=null},constrain:function(){if(null==this.points||0===this.points.length)return;const e=this.coord(0),t=this._applyConstraints(e,e);!1!==t&&this._fireEvent(this.state.onMove,t,e)},normalStyle:function(){return vo.clone(this.state.normalStyle)},highlightStyle:function(){return vo.clone(this.state.highlightStyle)},toBack:function(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()},toFront:function(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()},isHovering:function(){return this.movable.isHovering()},isDragging:function(){return this.movable.isDragging()},mouseTarget:function(){return this.movable.mouseTarget()}}),mo.exports=Mo;var No=mo.exports,Po={exports:{}};Po.exports;const Io=x.b,Eo=rr,Ao=Ki,Ro=G.a.vector,Do=G.a.point,Lo=Z,Fo=function(e){const t=e.graphie.scalePoint(e.coord(0)),n=e.graphie.scalePoint(e.coord(1));return Ro.polarDegFromCart(Ro.subtract(n,t))[1]},zo=function(e,t,n){const s=e.range[0][1]-e.range[0][0]+(e.range[1][1]-e.range[1][0]),i=e.unscaleVector(Ro.cartFromPolarDeg([1,n])),r=Ro.scale(Ro.normalize(i),s),o=Ro.add(t,r),a=Ro.polarDegFromCart(i)[1];return e.constrainToBoundsOnAngle(o,4,a*Math.PI/180)},qo=function(e,t){const n=[.75,0];let s=[[-3,4],[-2.75,2.5],[0,.25],n,[0,-.25],[-2.75,-2.5],[-3,-4]];s=Io.map(s,(function(e){const t=Ro.subtract(e,n),s=Ro.scale(t,1.4);return Ro.add(n,s)}));const i=Io.map(s,e.unscalePoint),r={center:e.unscalePoint(n),createPath:function(e){let t="M"+e[0][0]+" "+e[0][1];for(let n=1;n<e.length;n+=3)t+="C"+e[n][0]+" "+e[n][1]+" "+e[n+1][0]+" "+e[n+1][1]+" "+e[n+2][0]+" "+e[n+2][1];return t}},o=new Ao(e,i,r);return o.attr(Io.extend({"stroke-linejoin":"round","stroke-linecap":"round","stroke-dasharray":""},t)),o.toCoordAtAngle=function(t,s){const i=e.scalePoint(zo(e,t,s));o.transform("translateX("+(i[0]+1.4*n[0])+"px) translateY("+(i[1]+1.4*n[1])+"px) translateZ(0) rotate("+(360-Lo.bound(s))+"deg)")},o},Wo={draw:function(){this.draw()},pointsToFront:function(e){Io.invoke(e.points,"toFront")}};Wo.standard=[Wo.draw,Wo.pointsToFront];const Bo={draw:function(){this.draw()}};Bo.standard=[Bo.draw];const Vo={basic:function(e){const t=this.graphie;let n=this.coord(0),s=this.coord(1);if(!this.state.visibleShape){const e={thickness:10};this.state.visibleShape=new Eo(t,n,s,e),this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.toFront(),this.mouseTarget()&&this.mouseTarget().toFront()}const i=Fo(this);e.extendLine?(n=zo(t,n,360-i),s=zo(t,s,(540-i)%360)):e.extendRay&&(s=zo(t,s,360-i));const r=[this.state.visibleShape];this.mouseTarget()&&r.push(this.mouseTarget()),Io.each(r,(function(e){e.moveTo(n,s)}))},arrows:function(e){null==this._arrows&&(this._arrows=[],e.extendLine?(this._arrows.push(qo(this.graphie,this.normalStyle())),this._arrows.push(qo(this.graphie,this.normalStyle()))):e.extendRay&&this._arrows.push(qo(this.graphie,this.normalStyle())));const t=Fo(this),n=[360-t,(540-t)%360];Io.each(this._arrows,(function(e,t){e.toCoordAtAngle(this.coord(t),n[t])}),this)},highlight:function(e,t){e.isHovering&&!t.isHovering?e.visibleShape.animate(e.highlightStyle,50):!e.isHovering&&t.isHovering&&e.visibleShape.animate(e.normalStyle,50)}};Vo.standard=[Vo.basic,Vo.arrows,Vo.highlight];const Ho={basic:function(){this.state.visibleShape&&this.state.visibleShape.remove()},arrows:function(){null!=this._arrows&&Io.invoke(this._arrows,"remove"),this._arrows=null}};Ho.standard=[Ho.basic,Ho.arrows];const Uo={fixed:function(){return function(){return!1}},snap:function(e){return function(t,n){if(null===e)return!0;let s=Ro.subtract(t,n);return e=e||this.graphie.snap,s=Do.roundTo(s,e),Ro.add(n,s)}},bound:function(e,t,n){return void 0===n&&(n=void 0===e?10:0),function(e,s){const i=this.graphie,r=Ro.subtract(e,s),o=o||i.range;void 0===t&&(t=i.snap);let a=i.unscalePoint([n,i.ypixels-n]),l=i.unscalePoint([i.xpixels-n,n]);t&&(a=Do.ceilTo(a,t),l=Do.floorTo(l,t));const c=Io.map(this.coords(),(function(e,t){const n=Ro.subtract(l,e);return[Ro.subtract(a,e),n]})),h=Io.reduce(c,(function(e,t){const n=t[0],s=t[1];return[Math.max(n[0],Math.min(s[0],e[0])),Math.max(n[1],Math.min(s[1],e[1]))]}),r);return Ro.add(s,h)}},standard:null},Go={updatePoints:function(e,t){const n=Ro.subtract(e,t);Io.each(this.state.points,(function(e){e.setCoord(Ro.add(e.coord(),n))}))},standard:null};Po.exports={add:Wo,modify:Bo,draw:Vo,remove:Ho,onMoveStart:{standard:null},constraints:Uo,onMove:Go,onMoveEnd:{standard:null}};var $o=Po.exports,Yo={exports:{}};Yo.exports;const Ko=x.b,Xo=$o,Zo=rr,Jo=Ei,Qo=ve,ea=Jo.assert,ta=Jo.normalizeOptions,na=G.a.vector,sa=Di,ia=["add","draw","remove","onMoveStart","constraints","onMove","onMoveEnd"],ra={points:null,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,extendLine:!1,extendRay:!1},oa={visibleShape:null,mouseTarget:null},aa=function(e,t,n){ea(null!=e),ea(null!=n),Ko.extend(this,{graphie:e,movable:t,state:{id:Ko.uniqueId("movableLine")}}),this.modify(Ko.extend({},oa,n))};Ko.extend(aa,Xo),Jo.createGettersFor(aa,Ko.extend({},ra,oa)),Jo.addMovableHelperMethodsTo(aa),Ko.extend(aa.prototype,{cloneState:function(){return Ko.extend(this.movable.cloneState(),{coords:this.coords()},this.state)},_createDefaultState:function(){return Ko.extend({id:this.state.id},ta(ia,Qo.pluck(Xo,"standard")),ra)},modify:function(e){this.update(Ko.extend(this._createDefaultState(),e))},update:function(e){const t=this,n=this.graphie,s=t.state=Ko.extend(t.state,ta(ia,e)),i=s.static?sa.DYNAMIC:sa.INTERACTIVE;if(s.normalStyle=Ko.extend({stroke:i,"stroke-width":2},s.normalStyle),s.highlightStyle=Ko.extend({stroke:sa.INTERACTING,"stroke-width":3},s.highlightStyle),!s.static&&!s.mouseTarget){const e={thickness:30,mouselayer:!0};s.mouseTarget=new Zo(n,this.coord(0),this.coord(1),e),s.mouseTarget.attr({fill:"#000",opacity:0})}s.static&&s.mouseTarget&&(s.mouseTarget.remove(),s.mouseTarget=null),t.movable.modify(Ko.extend({},s,{mouseTarget:s.mouseTarget,add:null,modify:null,draw:t.draw.bind(t),remove:null,onMoveStart:function(){t._initialRefCoord=t.coord(0),t._prevRefCoord=t._initialRefCoord,t._totalDelta=[0,0],t._fireEvent(t.state.onMoveStart,t.coord(0),t.coord(0))},onMove:function(e,n){const s=na.subtract(e,n);t._totalDelta=na.add(t._totalDelta,s);let i=na.add(t._initialRefCoord,t._totalDelta);i=t._applyConstraints(i,t._prevRefCoord),!1!==i&&(t._fireEvent(t.state.onMove,i,t._prevRefCoord),t._prevRefCoord=i)},onMoveEnd:function(){t._fireEvent(t.state.onMoveEnd,t._prevRefCoord,t._initialRefCoord)}})),s.added||(t.prevState={},t._fireEvent(s.add,t.cloneState(),t.prevState),s.added=!0,Ko.invoke(s.points,"listen","onMove",s.id,t.draw.bind(t)),t.prevState=t.cloneState()),t._fireEvent(s.modify,t.cloneState(),t.prevState)},coords:function(){return Ko.invoke(this.state.points,"coord")},point:function(e){return this.state.points[e]},coord:function(e){return this.point(e).coord()},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.points&&Ko.invoke(this.points,"unlisten","onMove",this.state.id),this.movable&&this.movable.remove()},toBack:function(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()},toFront:function(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()},isHovering:function(){return this.movable.isHovering()},isDragging:function(){return this.movable.isDragging()},mouseTarget:function(){return this.movable.mouseTarget()}}),Yo.exports=aa;var la=Yo.exports;const ca={path:"M8.70710678,12.2928932 C8.31658249,11.9023689 7.68341751,11.9023689 7.29289322,12.2928932 C6.90236893,12.6834175 6.90236893,13.3165825 7.29289322,13.7071068 L9.82842712,16.2426407 C10.2207367,16.6349502 10.8574274,16.6328935 11.2471942,16.2380576 L16.7116603,10.7025237 C17.0996535,10.3094846 17.0955629,9.67633279 16.7025237,9.28833966 C16.3094846,8.90034653 15.6763328,8.90443714 15.2883397,9.29747629 L10.5309507,14.1167372 L8.70710678,12.2928932 Z",width:24,height:24},ha={path:"M99.669 13.048q0 3.36-2.352 5.712l-41.664 41.664q-2.408 2.408-5.88 2.408t-5.712-2.408l-41.664-41.664q-2.408-2.24-2.408-5.712t2.408-5.88l4.76-4.816q2.52-2.352 5.88-2.352t5.656 2.352l31.136 31.136 31.08-31.136q2.352-2.352 5.712-2.352t5.88 2.352l4.816 4.816q2.352 2.52 2.352 5.88z",width:100,height:63.034},pa={path:"M62.808 49.728q0 3.36-2.352 5.88l-41.72 41.664q-2.352 2.408-5.768 2.408t-5.768-2.408l-4.872-4.76q-2.352-2.52-2.352-5.88t2.352-5.712l31.08-31.136-31.08-31.024q-2.352-2.52-2.352-5.88t2.352-5.712l4.872-4.76q2.296-2.408 5.768-2.408t5.768 2.408l41.72 41.664q2.352 2.296 2.352 5.656z",width:63.034,height:100},ua={path:"M100.035 50.046q.057 13.623-6.669 25.137t-18.24 18.183-25.08 6.669-25.137-6.726q-11.514-6.726-18.183-18.183-6.726-11.571-6.726-25.137t6.726-25.08 18.24-18.24 25.08-6.669q13.566 0 25.08 6.726 11.514 6.669 18.24 18.183t6.669 25.137z",width:100,height:100},da={path:"M50.046 83.676q1.767 0 2.907-1.14l29.526-29.526q1.197-1.197 1.197-2.907t-1.197-2.964l-5.928-5.928q-1.197-1.14-2.964-1.14t-2.907 1.14l-12.312 12.312l0-32.661q0-1.71-1.254-2.964t-2.907-1.254l-8.322 0q-1.71 0-2.964 1.254t-1.254 2.964l0 32.661l-12.312-12.312q-1.197-1.254-2.907-1.254t-2.907 1.254l-5.928 5.928q-1.197 1.197-1.197 2.964t1.197 2.907l29.469 29.526q1.197 1.14 2.964 1.14zm49.989-33.63q.057 13.623-6.669 25.137t-18.24 18.183-25.08 6.669-25.137-6.726q-11.514-6.726-18.183-18.183-6.726-11.571-6.726-25.137t6.726-25.08 18.24-18.24 25.08-6.669q13.566 0 25.08 6.726 11.514 6.669 18.24 18.183t6.669 25.137z",width:100,height:100},ga={path:"M54.207 83.391q1.653 0 2.907-1.254t1.254-2.907l0-32.718l12.312 12.312q1.254 1.254 2.964 1.254t2.907-1.254l5.928-5.928q1.197-1.197 1.14-2.964 0-1.767-1.14-2.907l-29.526-29.526q-1.197-1.14-2.907-1.14t-2.964 1.14l-29.469 29.526q-1.197 1.254-1.197 2.964t1.197 2.907l5.928 5.928q1.197 1.197 2.907 1.197t2.907-1.197l12.312-12.312l0 32.718q0 1.653 1.254 2.907t2.964 1.254l8.322 0zm45.828-33.345q.057 13.623-6.669 25.137t-18.24 18.183-25.08 6.669-25.137-6.726q-11.514-6.726-18.183-18.183-6.726-11.571-6.726-25.137t6.726-25.08 18.24-18.24 25.08-6.669q13.566 0 25.08 6.726 11.514 6.669 18.24 18.183t6.669 25.137z",width:100,height:100},fa={path:"M50.046 8.322q-8.493 0-16.188 3.306-15.561 6.669-22.173 22.23-3.363 7.695-3.363 16.188t3.306 16.188 8.949 13.281q5.586 5.586 13.281 8.892t16.188 3.306 16.188-3.306 13.281-8.892 8.892-13.281 3.306-16.188-3.306-16.188-8.892-13.281-13.281-8.949q-7.695-3.306-16.188-3.306zm0 91.713q-13.623 0-25.137-6.726t-18.183-18.183q-6.726-11.571-6.726-25.137t6.726-25.08 18.24-18.24 25.08-6.669q13.566 0 25.08 6.726 11.514 6.669 18.24 18.183t6.726 25.137-6.726 25.137-18.24 18.126q-11.514 6.726-25.08 6.726z",width:100,height:99.944},ma={path:"M94.208 52.119l0-43.746q0-.69-.506-1.15t-1.196-.506l-84.088 0q-.69 0-1.196.506t-.506 1.15l0 43.746q0 .69.506 1.196t1.196.506l84.088 0q.69 0 1.196-.506t.506-1.196zm6.716-43.746l0 57.224q0 3.45-2.484 5.934t-5.934 2.484l-28.566 0q0 3.128 2.53 7.774.828 1.61.828 2.622t-1.012 2.07q-1.012 1.012-2.346.966l-26.91 0q-1.38 0-2.392-1.012t-1.012-2.024q0-1.058 1.656-4.14t1.748-6.256l-28.612 0q-3.45 0-5.934-2.484t-2.484-5.934l0-57.224q0-3.45 2.484-5.934t5.934-2.438l84.088 0q3.45 0 5.98 2.438 2.438 2.484 2.438 5.934z",width:100,height:86.648},ba={path:"M9 9.8c0 .5.7 1.7 1.5 2.8 1.5 1.9 1.5 1.9 3 0C15.7 9.7 15.4 9 12 9c-1.6 0-3 .4-3 .8z",width:24,height:24},va={path:"M58.368 81.225l0-12.369q0-.912-.57-1.539t-1.425-.627l-12.54 0q-.855-.057-1.482.627t-.684 1.539l0 12.369q-.057.855.627 1.482t1.539.684l12.54 0q.855 0 1.425-.627t.57-1.539zm1.026-62.871q0-1.596-2.223-1.71l-14.307 0q-2.109 0-2.223 1.71l1.14 40.47q0 .627.627 1.14t1.539.456l12.084 0q.912-.057 1.539-.513t.684-1.083zm-9.348-18.354q13.566 0 25.08 6.726 11.514 6.669 18.24 18.183t6.726 25.137-6.726 25.137-18.24 18.183-25.08 6.669-25.137-6.726q-11.514-6.726-18.183-18.183-6.726-11.571-6.726-25.137t6.726-25.08 18.24-18.24 25.08-6.669z",width:100,height:99.944},xa={path:"M1152 896q0-106-75-181t-181-75-181 75-75 181 75 181 181 75 181-75 75-181zm512-109v222q0 12-8 23t-20 13l-185 28q-19 54-39 91 35 50 107 138 10 12 10 25t-9 23q-27 37-99 108t-94 71q-12 0-26-9l-138-108q-44 23-91 38-16 136-29 186-7 28-36 28h-222q-14 0-24.5-8.5t-11.5-21.5l-28-184q-49-16-90-37l-141 107q-10 9-25 9-14 0-25-11-126-114-165-168-7-10-7-23 0-12 8-23 15-21 51-66.5t54-70.5q-27-50-41-99l-183-27q-13-2-21-12.5t-8-23.5v-222q0-12 8-23t19-13l186-28q14-46 39-92-40-57-107-138-10-12-10-24 0-10 9-23 26-36 98.5-107.5t94.5-71.5q13 0 26 10l138 107q44-23 91-38 16-136 29-186 7-28 36-28h222q14 0 24.5 8.5t11.5 21.5l28 184q49 16 90 37l142-107q9-9 24-9 13 0 25 10 129 119 165 170 7 8 7 22 0 12-8 23-15 21-51 66.5t-54 70.5q26 50 41 98l183 28q13 2 21 12.5t8 23.5z",width:1792,height:1792},ya={path:"M36.04 89.557q0-2.584-1.836-4.42t-4.42-1.836-4.352 1.836q-1.836 1.836-1.836 4.42t1.836 4.352 4.42 1.836q2.652-.068 4.42-1.836t1.768-4.352zm16.184-12.444l0-54.74q0-1.088-.748-1.768t-1.768-.68l-39.78 0q-1.088 0-1.768.748t-.68 1.7l0 54.74q0 1.02.748 1.768t1.7.68l39.78 0q1.02-.068 1.768-.748t.748-1.7zm-14.892-65.892q0-1.224-1.292-1.292l-12.444 0q-1.224.068-1.224 1.292t1.224 1.224l12.444 0q1.292 0 1.292-1.224zm22.372-1.292l0 79.628q0 3.944-2.992 6.936t-7.004 2.992l-39.78 0q-4.012 0-7.004-2.924-2.924-2.924-2.924-7.004l0-79.628q0-4.012 2.924-6.936t7.004-2.992l39.78 0q4.012-.068 7.004 2.924t2.992 7.004z",width:60.013,height:100},ja={path:"M37.964 76.048q-2.576 0-4.368-1.792l-31.864-31.864q-1.792-1.792-1.792-4.368t1.792-4.368l8.736-8.68q1.792-1.792 4.368-1.792t4.312 1.792l18.816 18.872 42-42.056q1.792-1.792 4.368-1.792t4.312 1.792l8.736 8.736q1.792 1.792 1.792 4.368t-1.792 4.312l-55.048 55.048q-1.792 1.792-4.368 1.792z",width:100,height:76.637},wa={path:"M99.758 43.09l0 13.578q0 2.852-1.984 4.836t-4.836 1.984l-29.45 0l0 29.45q0 2.852-1.984 4.836t-4.836 1.984l-13.578 0q-2.852 0-4.836-1.984t-1.984-4.836l0-29.45l-29.45 0q-2.852 0-4.836-1.984t-1.984-4.836l0-13.578q0-2.852 1.984-4.836t4.836-1.984l29.45 0l0-29.45q0-2.852 1.984-4.836t4.836-1.984l13.578 0q2.852 0 4.836 1.984t1.984 4.836l0 29.45l29.45 0q2.852 0 4.836 1.984t1.984 4.836z",width:100,height:100},Oa={path:"M100.464 80.808q0 3.404-2.368 5.772l-11.47 11.544q-2.368 2.368-5.772 2.368t-5.698-2.368l-24.864-24.864-24.864 24.864q-2.368 2.368-5.772 2.368t-5.772-2.368l-11.47-11.544q-2.368-2.368-2.368-5.772t2.368-5.698l24.864-24.864-24.864-24.864q-2.368-2.368-2.368-5.772t2.368-5.772l11.47-11.47q2.368-2.368 5.772-2.368t5.772 2.368l24.864 24.864 24.864-24.864q2.294-2.368 5.698-2.368t5.772 2.368l11.47 11.47q2.368 2.368 2.368 5.772t-2.368 5.772l-24.864 24.864 24.864 24.864q2.368 2.294 2.368 5.698z",width:100,height:100},Ca={path:"M15.1052249,9.55978547 L22.0028147,9.55978545 C23.6568673,9.55978545 23.9349557,10.3753626 22.6181351,11.3858845 L16.9943688,15.7015366 L19.2518801,22.8294455 C19.7526645,24.4106317 19.0984455,24.8825885 17.769353,23.8673293 L12.0490577,19.4977438 L6.5116497,23.8422153 C5.20921411,24.8640642 4.53299569,24.4067544 5.00266927,22.8160582 L7.10332364,15.7015366 L1.42794544,11.3634306 C0.110226041,10.3562014 0.383967283,9.54239221 2.0409646,9.54574013 L8.9924676,9.55978547 L11.1485117,2.72669438 C11.6458693,1.15043244 12.4548928,1.15900049 12.9494787,2.72669438 L15.1052249,9.55978547 Z",width:24,height:24},Sa={path:"M3.74890556,17.9799506 C2.19251241,16.1970909 1.10103636,13.4971457 1.13090903,11.1491783 C1.17160478,7.95052637 4.01704076,0.865059407 11.7028044,0.865059407 C19.388568,0.865059407 22.3026521,7.35203035 22.3026521,11.5879453 C22.3026521,15.8238603 19.386629,20.5574509 13.6832464,21.7131548 L13.6757539,17.3722171 C17.0812986,16.2190517 18.331158,14.1944123 18.3311578,11.5879451 C18.3311574,8.16554692 15.6664205,5.03476549 11.7028048,5.20494205 C7.73918903,5.37511861 5.59244567,8.66930079 5.59244567,11.1491783 C5.59244567,12.9090077 6.11128139,14.1753512 6.93640437,15.3053215 L8.14052356,14.2949456 C8.98559348,13.5858477 9.6994861,13.9070448 9.73489556,15.0076413 L9.91284941,20.5388014 C9.94832683,21.6415103 9.09967118,22.3514475 8.02194403,22.1254594 L2.60571602,20.9897332 C1.5259204,20.7633114 1.34338662,19.9984207 2.18070755,19.295825 L3.74890556,17.9799506 Z",width:23,height:23},ka={path:"M45.322 90.706q0-1.86-1.302-3.224-1.364-1.364-3.224-1.364t-3.224 1.364-1.302 3.224q0 1.86 1.364 3.224 1.302 1.364 3.162 1.302 1.86.062 3.224-1.302t1.302-3.224zm27.218-11.346l0-68.014q0-.93-.682-1.612t-1.55-.682l-58.962 0q-.93 0-1.612.682t-.682 1.612l0 68.014q0 .93.682 1.612t1.612.62l58.962 0q.992-.062 1.612-.682t.62-1.55zm9.114-68.014l0 77.066q0 4.65-3.348 7.998t-7.998 3.348l-58.962 0q-4.65 0-7.998-3.348t-3.348-7.998l0-77.066q0-4.65 3.348-7.998t7.998-3.348l58.962 0q4.65 0 7.998 3.348t3.348 7.998z",width:81.852,height:100},_a={path:"M31.293 37.506q2.052 0 2.052 2.109l0 37.506q0 1.995-2.052 2.109l-4.218 0q-.912-.057-1.482-.627t-.57-1.482l0-37.506q0-2.109 2.052-2.109l4.218 0zm18.753 2.109l0 37.506q0 .912-.57 1.482t-1.539.627l-4.161 0q-1.995 0-2.109-2.109l0-37.506q.057-.912.627-1.482t1.482-.627l4.161 0q.969.057 1.539.627t.57 1.482zm14.592-2.109q2.052 0 2.052 2.109l0 37.506q0 1.995-2.052 2.109l-4.161 0q-.969-.057-1.539-.627t-.57-1.482l0-37.506q0-2.109 2.109-2.109l4.161 0zm10.431 49.248l0-61.731l-58.368 0l0 61.731q.057 2.679.969 3.819t1.083 1.14l54.207 0q.171 0 1.14-1.083t.969-3.876zm-43.776-70.11l29.184 0l-3.135-7.581q-.456-.57-1.14-.741l-20.634 0q-.627.114-1.083.741zm-31.293 2.109q0-1.995 2.109-2.109l20.121 0l4.56-10.83q.969-2.394 3.477-4.104 2.565-1.71 5.187-1.71l20.805 0q2.622 0 5.187 1.71t3.477 4.104l4.56 10.83l20.178 0q.912.057 1.482.627t.57 1.482l0 4.161q0 1.995-2.052 2.109l-6.27 0l0 61.731q0 5.415-3.078 9.348t-7.353 3.933l-54.207 0q-4.275 0-7.353-3.819t-3.078-9.177l0-62.016l-6.213 0q-.969 0-1.539-.57t-.57-1.539l0-4.161z",width:91.681,height:100},Ta={path:"M10,6.6C10,7.2,9.8,8,9.3,9.1c0,0,0,0.1-0.1,0.1S9.2,9.3,9.2,9.4c0,0,0,0.1-0.1,0.1C9,9.6,9,9.6,8.9,9.6 c-0.1,0-0.1,0-0.1-0.1c0,0,0-0.1,0-0.1c0,0,0-0.1,0-0.1s0-0.1,0-0.1c0-0.3,0-0.5,0-0.7c0-0.4,0-0.7-0.1-1C8.6,7.1,8.5,6.9,8.4,6.7S8.2,6.3,8,6.1C7.8,5.9,7.6,5.8,7.4,5.7S6.9,5.5,6.7,5.5S6.1,5.4,5.8,5.4c-0.3,0-0.6,0-1,0H3.6v1.4c0,0.1,0,0.2-0.1,0.3C3.4,7.1,3.3,7.1,3.2,7.1C3.1,7.1,3,7.1,3,7L0.1,4.1C0,4.1,0,4,0,3.9s0-0.2,0.1-0.3L3,0.8C3,0.7,3.1,0.7,3.2,0.7c0.1,0,0.2,0,0.3,0.1C3.5,0.9,3.6,0.9,3.6,1v1.4h1.2c2.6,0,4.3,0.7,4.9,2.2C9.9,5.2,10,5.8,10,6.6z",width:10,height:10},Ma={path:"M8,13 L16,13 C16.5522847,13 17,12.5522847 17,12 C17,11.4477153 16.5522847,11 16,11 L8,11 C7.44771525,11 7,11.4477153 7,12 C7,12.5522847 7.44771525,13 8,13 Z",width:24,height:24};var Na={exports:{}};Na.exports;const Pa=x.b,Ia=dr,Ea=G.a.point,Aa={constrain:function(){this.constrain()}};Aa.standard=[Aa.constrain];const Ra={draw:function(){this.draw()}};Ra.standard=[Ra.draw];const Da={basic:function(e,t){const n=this.graphie;if(!this.state.visibleShape){const t=[this.pointSize()/n.scale[0],this.pointSize()/n.scale[1]],s={maxScale:Math.max(this.highlightStyle().scale,this.normalStyle().scale),padding:10,shadow:e.shadow};this.state.visibleShape=new Ia(n,this.coord(),t,s),this.state.visibleShape.attr(Pa.omit(this.normalStyle(),"scale")),this.state.visibleShape.toFront(),this.mouseTarget()&&this.mouseTarget().toFront()}e.normalStyle===t.normalStyle||Pa.isEqual(e.normalStyle,t.normalStyle)||this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.moveTo(this.coord()),this.mouseTarget()&&this.mouseTarget().moveTo(this.coord())},highlight:function(e,t){e.isHovering&&!t.isHovering?e.visibleShape.animate(this.highlightStyle(),50):!e.isHovering&&t.isHovering&&e.visibleShape.animate(this.normalStyle(),50)}};Da.standard=[Da.basic,Da.highlight];const La={basic:function(){this.state.visibleShape&&(this.state.visibleShape.remove(),this.state.visibleShape=null)}};La.standard=La.basic;const Fa={fixed:function(){return function(){return!1}},snap:function(e){return function(t){return null===e||(e=e||this.graphie.snap,Ea.roundTo(t,e))}},bound:function(e,t,n){return void 0===n&&(n=void 0===e?10:0),function(s,i,r){const o=this.graphie;e=e||o.range,void 0===t&&(t=o.snap);let a=o.unscalePoint([n,o.ypixels-n]),l=o.unscalePoint([o.xpixels-n,n]);if(t&&(a=Ea.ceilTo(a,t),l=Ea.floorTo(l,t)),r&&r.onOutOfBounds)return(s[0]>l[0]||s[0]<a[0]||s[1]>l[1]||s[1]<a[1])&&(r.onSkipRemaining(),r.onOutOfBounds()),s;return[Math.max(a[0],Math.min(l[0],s[0])),Math.max(a[1],Math.min(l[1],s[1]))]}},standard:null};Na.exports={add:Aa,modify:Ra,draw:Da,remove:La,onMoveStart:{standard:null},constraints:Fa,onMove:{standard:null},onMoveEnd:{standard:null},onClick:{standard:null}};var za=Na.exports,qa={exports:{}};qa.exports;const Wa=x.b,Ba=za,Va=dr,Ha=Ei,Ua=ve,Ga=Ha.assert,$a=Ha.normalizeOptions,Ya=G.a.point,Ka=G.a.vector,Xa=Di,Za=vr.processMath,Ja=(h.a,i.a),Qa=Kt,el=Wa.keys(Ba),tl={coord:[0,0],pointSize:4,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,shadow:!1,tooltip:!1},nl={added:!1,hasMoved:!1,visibleShape:null,outOfBounds:!1,mouseTarget:null,touchOffset:null},sl=[],il=function(e,t,n){Wa.extend(this,{graphie:e,movable:t,state:{id:Wa.uniqueId("movablePoint")}}),this.modify(Wa.extend({},nl,n))};Wa.extend(il,Ba),Ha.createGettersFor(il,Wa.extend({},tl,nl)),Ha.addMovableHelperMethodsTo(il),Wa.extend(il.prototype,{cloneState:function(){return Wa.extend(this.movable.cloneState(),this.state)},_createDefaultState:function(){return Wa.extend({id:this.state.id},$a(el,Ua.pluck(Ba,"standard")),tl)},modify:function(e){this.update(Wa.extend(this._createDefaultState(),e))},_showTooltip:function(e){this._tooltip||(this._tooltip=document.createElement("div"),this._tooltip.className="tooltip-content",this.state.visibleShape.wrapper.className="tooltip",this.state.visibleShape.wrapper.appendChild(this._tooltip),sl.push((()=>{this.state.added&&this._hideTooltip()}))),this._tooltip.firstChild&&this._tooltip.removeChild(this._tooltip.firstChild),this.state.visibleShape.wrapper.className="tooltip visible",this._tooltip.appendChild(document.createElement("span")),"string"===typeof e?Za(this._tooltip.firstChild,e,!1):"function"===typeof e?e(this._tooltip.firstChild):this._tooltip.firstChild.appendChild(e)},_hideTooltip:function(){this._tooltip&&(this.state.visibleShape.wrapper.className="tooltip")},update:function(e){const t=this,n=t.graphie,s=Wa.extend(t.state,$a(el,e));Ga(Ya.is(s.coord));const i=s.static?Xa.DYNAMIC:Xa.INTERACTIVE;if(s.normalStyle=Wa.extend({fill:i,stroke:i,scale:1},s.normalStyle),s.highlightStyle=Wa.extend({fill:Xa.INTERACTING,stroke:Xa.INTERACTING,scale:2},s.highlightStyle),!s.static&&!s.mouseTarget){const e=t.state.coord,i=n.unscaleVector(24),r={mouselayer:!0,padding:0};s.mouseTarget=new Va(n,e,i,r),s.mouseTarget.attr({fill:"#000",opacity:0})}const r=()=>{this._showTooltip((e=>{Ja.render(Object($t.jsx)("span",{style:{fontSize:"2em"},children:Object($t.jsx)(Qa,{..._a,style:{position:"static",color:Xa.INTERACTIVE,marginLeft:9,marginRight:9}})}),e)}))};let o=s.coord;t.movable.modify(Wa.extend({},s,{add:null,modify:null,draw:t.draw.bind(t),remove:null,onMoveStart:e=>{if(s.hasMoved=!1,o=s.coord,null==s.touchOffset){const t=!("ontouchstart"in window);s.touchOffset=t?[0,0]:Ka.subtract(o,e)}const n=s.visibleShape.wrapper;if(s.shadow){const e="none";n.style.webkitFilter=e,n.style.filter=e}if(s.showHairlines&&s.showHairlines(s.coord),sl.forEach((e=>e())),s.tooltip&&(s.xOnlyTooltip?this._showTooltip(`${s.coord[0]}`):this._showTooltip(`(${s.coord[0]}, ${s.coord[1]})`),s.shadow)){const e=n.getElementsByClassName("tooltip-content")[0],t="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))";e.style.webkitFilter=t,e.style.filter=t}t._fireEvent(s.onMoveStart,o,o),t.draw()},onMove:(e,n)=>{const i=Ka.add(e,s.touchOffset);t.moveTo(i),s.showHairlines&&(this.state.outOfBounds?s.hideHairlines():s.showHairlines(s.coord)),s.tooltip&&(this.state.outOfBounds||(s.xOnlyTooltip?this._showTooltip(`${s.coord[0]}`):this._showTooltip(`(${s.coord[0]}, ${s.coord[1]})`))),s.onRemove&&this.state.outOfBounds&&r()},onMoveEnd:()=>{t.isHovering()&&!s.hasMoved&&t._fireEvent(s.onClick,s.coord,o);const e=s.visibleShape.wrapper;if(s.shadow){const t="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))";e.style.webkitFilter=t,e.style.filter=t}if(s.hideHairlines&&s.hideHairlines(),s.hasMoved)this._hideTooltip();else if(s.onRemove){r();const t=e.getElementsByClassName("tooltip-content")[0];t.style.webkitFilter="none",t.style.filter="none",this._tooltip.firstChild.addEventListener("touchstart",(e=>{e.stopPropagation()}),!0),this._tooltip.firstChild.addEventListener("touchend",(e=>{s.onRemove(),e.stopPropagation()}),!0)}else s.tooltip&&this._hideTooltip();s.outOfBounds&&s.onRemove(),t._fireEvent(s.onMoveEnd,s.coord,o),s.hasMoved=!1,s.touchOffset=null,t.draw()}})),s.added||(t.prevState={},t._fireEvent(s.add,t.cloneState(),t.prevState),s.added=!0,t.prevState=t.cloneState()),t._fireEvent(s.modify,t.cloneState(),t.prevState)},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.movable&&this.movable.remove(),this.state.mouseTarget=null},constrain:function(){const e=this._applyConstraints(this.coord(),this.coord());return Ya.is(e)&&this.setCoord(e),!1!==e},setCoord:function(e){Ga(Ya.is(e,2)),this.state.coord=Wa.clone(e),this.draw()},setCoordConstrained:function(e){Ga(Ya.is(e,2));const t=this._applyConstraints(e,this.coord());!1!==t&&(this.state.coord=Wa.clone(t),this.draw())},moveTo:function(e){const t=this.state;this.state.outOfBounds=!1;const n=this._applyConstraints(e,t.coord,t.onRemove?{onOutOfBounds:()=>{this.state.outOfBounds=!0}}:{});if(!1!==n&&(Ya.is(n)&&(e=n),!Ya.equal(e,t.coord))){const n=t.coord;t.coord=e,t.hasMoved=!0,this._fireEvent(t.onMove,t.coord,n),this.draw()}},normalStyle:function(){return Wa.clone(this.state.normalStyle)},highlightStyle:function(){return Wa.clone(this.state.highlightStyle)},toBack:function(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()},toFront:function(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()},isHovering:function(){return this.movable.isHovering()},isDragging:function(){return this.movable.isDragging()},mouseTarget:function(){return this.movable.mouseTarget()},grab:function(e){this.state.touchOffset=[0,0],this.movable.grab(e),this.moveTo(e)}}),qa.exports=il;var rl=qa.exports,ol={exports:{}};ol.exports;const al=x.b,ll=Ei,cl=ll.normalizeOptions,hl=ll.assert,pl=G.a.point,ul=["add","modify","draw","remove","onMoveStart","onMove","onMoveEnd","onClick"],dl={cursor:null},gl={added:!1,isHovering:!1,isMouseOver:!1,isDragging:!1,mouseTarget:null},fl=function(e,t){al.extend(this,{graphie:e,state:{id:al.uniqueId("movable")}}),this.modify(al.extend({},gl,t))};ll.createGettersFor(fl,al.extend({},dl,gl)),ll.addMovableHelperMethodsTo(fl),al.extend(fl.prototype,{cloneState:function(){return al.clone(this.state)},_createDefaultState:function(){return al.extend({id:this.state.id,add:[],modify:[],draw:[],remove:[],onMoveStart:[],onMove:[],onMoveEnd:[],onClick:[]},dl)},modify:function(e){this.update(al.extend({},this._createDefaultState(),e))},grab:function(e){hl(pl.is(e));const t=this,n=t.graphie,s=t.state;s.isHovering=!0,s.isDragging=!0,n.isDragging=!0;const i=e;let r=i;t._fireEvent(s.onMoveStart,i,i);const o=function(e){e.preventDefault();const i=n.getMouseCoord(e);t._fireEvent(s.onMove,i,r),t.draw(),r=i},a=function(e){l()(document).unbind("vmousemove",o),l()(document).unbind("vmouseup",a),s.isHovering&&t._fireEvent(s.onClick,r,i),s.isHovering=t.state.isMouseOver,s.isDragging=!1,n.isDragging=!1,t._fireEvent(s.onMoveEnd,r,i),t.draw()};l()(document).bind("vmousemove",o),l()(document).bind("vmouseup",a)},update:function(e){const t=this,n=t.graphie,s=t.cloneState(),i=al.extend(t.state,cl(ul,e));if(i.mouseTarget&&!s.mouseTarget){let e;e=i.mouseTarget.getMouseTarget?l()(i.mouseTarget.getMouseTarget()):l()(i.mouseTarget[0]);!("ontouchstart"in window)&&(e.on("vmouseover",(function(){i.isMouseOver=!0,n.isDragging||(i.isHovering=!0),t.state.added&&t.draw()})),e.on("vmouseout",(function(){i.isMouseOver=!1,i.isDragging||(i.isHovering=!1),t.state.added&&t.draw()}))),e[0].addEventListener("touchstart",(function(e){e.preventDefault()}),{passive:!1}),e.on("vmousedown",(function(e){if(0!==e.which&&1!==e.which)return;e.preventDefault();const s=n.getMouseCoord(e);t.grab(s)}))}if(i.mouseTarget&&void 0!==i.cursor){let e;e=i.mouseTarget.getMouseTarget?l()(i.mouseTarget.getMouseTarget()):l()(i.mouseTarget[0]),e.css("cursor",i.cursor||"")}i.added||(t._fireEvent(i.modify,t.cloneState(),{}),i.added=!0,t.prevState=t.cloneState()),t._fireEvent(i.modify,t.cloneState(),t.prevState)},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.state.mouseTarget&&(l()(this.state.mouseTarget).off(),this.state.mouseTarget.remove(),this.state.mouseTarget=null)},toBack:function(){this.state.mouseTarget&&this.state.mouseTarget.toBack()},toFront:function(){this.state.mouseTarget&&this.state.mouseTarget.toFront()}}),ol.exports=fl;var ml=ol.exports,bl={exports:{}};bl.exports;const vl=ml,xl=rl,yl=la,jl=No,wl=Di,Ol={MovablePoint:xl,addMovablePoint:function(e,t){const n=new vl(e,{});return new xl(e,n,t)},MovableLine:yl,addMovableLine:function(e,t){const n=new vl(e,{});return new yl(e,n,t)},MovablePolygon:jl,addMovablePolygon:function(e,t){const n=new vl(e,{});return new jl(e,n,t)},addMaybeMobileMovablePoint:function(e,t){const n=e.props.apiOptions.isMobile,s=n?{stroke:"#ffffff","stroke-width":3,fill:wl.INTERACTIVE}:{stroke:wl.INTERACTIVE,fill:wl.INTERACTIVE},i=Object.assign(s,t.normalStyle),r=Object.assign(n?{...s,"stroke-width":0,scale:.75}:{},t.highlightStyle),o=Object.assign({normalStyle:i,highlightStyle:r,shadow:n,tooltip:n&&e.props.showTooltips,showHairlines:e.showHairlines,hideHairlines:e.hideHairlines},n?{pointSize:7}:{});return Ol.addMovablePoint(e.graphie,Object.assign(t,o))}};bl.exports=Ol;var Cl=bl.exports,Sl={exports:{}};Sl.exports;const kl=ce,_l=kl.nestedMap,Tl=kl.deepEq,Ml=x.b;function Nl(e){Ml.extend(this,e)}const Pl=function(){throw new Error("Abstract method! Must be implemented by Graphie Movable"+this.constructor.displayName)};Ml.extend(Nl.prototype,{movableProps:[],add:Pl,modify:Pl,remove:Pl,toFront:function(){}});const Il=function(e){const t=function(e){if(!(this instanceof t))throw new Error("Use createElement or JSX with graphie movables");return this.props=function(e,t){return Ml.extend({},e,{children:Ml.filter(Ml.flatten(t),Ml.identity)})}(e,e.children||[]),this};return e.displayName=e.displayName||Ml.uniqueId("GraphieClass"),t.displayName=e.displayName,t.prototype=new Nl(e),t.prototype.constructor=t,t};Sl.exports={GraphieMovable:Nl,createClass:Il,createSimpleClass:function(e){return Il({displayName:e.name||Ml.uniqueId("GraphieSimpleClass"),movableProps:["children"],add:function(t){this._elements=e(t,this.props),this._prevProps=this.props},modify:function(e){if(!Tl(this.props,this._prevProps))return this.remove(),this.add(e),this._prevProps=this.props,"reordered"},remove:function(){_l(this._elements,(e=>{e&&e.remove()})),this._elements=null,this._prevProps=null},toFront:function(){_l(this._elements,(e=>{Ml.isFunction(e.toFront)&&e.toFront()}))}})}};var El=Sl.exports,Al={exports:{}};Al.exports;const Rl=x.b,Dl=El,Ll=Cl,Fl=Di,zl=Dl.createClass({displayName:"MovablePoint",movableProps:["children"],_getProps:function(){if(this.props.isMobile){const e=this.props.isMobile,t=e?{stroke:"#ffffff","stroke-width":3,fill:Fl.INTERACTIVE}:{stroke:Fl.INTERACTIVE,fill:Fl.INTERACTIVE},n=e?Object.assign(t,this.props.mobileStyleOverride||{}):Object.assign(t,this.props.normalStyle),s=e?{...t,"stroke-width":0,scale:.75}:this.props.highlightStyle,i=Object.assign({normalStyle:n,highlightStyle:s,shadow:e,tooltip:e&&this.props.showTooltips},e?{pointSize:7}:{});return Object.assign(this.props,i)}return this.props},add:function(e){this.point=Ll.addMovablePoint(e,this._getProps())},modify:function(){this.point.modify(this._getProps())},remove:function(){this.point.remove()},toFront:function(){this.point.toFront()},grab:function(e){this.point.grab(e)}});Rl.extend(zl,Ll.MovablePoint);const ql=Dl.createClass({displayName:"MovableLine",movableProps:["children"],add:function(e){const t=Rl.pluck(this.props.children,"point"),n=Rl.extend({},this.props,{points:t});this.line=Ll.addMovableLine(e,n)},modify:function(){const e=Rl.pluck(this.props.children,"point"),t=Rl.extend({},this.props,{points:e});this.line.modify(t)},remove:function(){this.line.remove()},toFront:function(){this.line.toFront()}});Rl.extend(ql,Ll.MovableLine);const Wl=Dl.createSimpleClass(((e,t)=>{let n=t.coord;return t.unscaled&&(n=e.unscalePoint(n)),e.label(n,t.text,t.direction,t.tex,t.style)})),Bl=Dl.createClass({displayName:"Line",movableProps:["children"],add:function(e){const t=this.props;this.graphie=e,this.line=this.graphie.line(t.start,t.end,t.style)},modify:function(){const e=this.props,t=this.graphie.svgPath([e.start,e.end]);this.line.attr(Rl.extend({},e.style,{path:t}))},remove:function(){this.line.remove()},toFront:function(){this.line.toFront()}}),Vl=Dl.createClass({displayName:"Parabola",movableProps:["children"],add:function(e){const t=this.props;this.graphie=e,this.parabola=this.graphie.parabola(t.a,t.b,t.c,t.style)},modify:function(){const e=this.props,t=this.graphie.svgParabolaPath(e.a,e.b,e.c);this.parabola.attr(Rl.extend({},e.style,{path:t}))},remove:function(){this.parabola.remove()},toFront:function(){this.parabola.toFront()}}),Hl=Dl.createClass({displayName:"Sinusoid",movableProps:["children"],add:function(e){const t=this.props;this.graphie=e,this.sinusoid=this.graphie.sinusoid(t.a,t.b,t.c,t.d,t.style)},modify:function(){const e=this.props,t=this.graphie.svgSinusoidPath(e.a,e.b,e.c,e.d);this.sinusoid.attr(Rl.extend({},e.style,{path:t}))},remove:function(){this.sinusoid.remove()},toFront:function(){this.sinusoid.toFront()}}),Ul=Dl.createSimpleClass(((e,t)=>e.plot(t.fn,t.range,t.style))),Gl=Dl.createSimpleClass(((e,t)=>e.plotParametric(t.fn,t.range,t.style))),$l=Dl.createSimpleClass(((e,t)=>e.ellipse(t.coord,e.unscaleVector([4,4]),{fill:t.color||Fl.BLACK,stroke:t.color||Fl.BLACK}))),Yl=Dl.createClass({displayName:"Path",movableProps:["children"],add:function(e){const t=this.props;this.graphie=e,this.path=this.graphie.path(t.coords,t.style)},modify:function(){const e=this.props,t=this.graphie.svgPath(e.coords);this.path.attr({path:t})},remove:function(){this.path.remove()},toFront:function(){this.path.toFront()}}),Kl=Dl.createSimpleClass(((e,t)=>{let n=t.center,s=t.radius;return t.unscaled&&(n=e.unscalePoint(n),s=e.unscaleVector(s)),e.arc(n,s,t.startAngle,t.endAngle,t.sector,t.style)})),Xl=Dl.createSimpleClass(((e,t)=>e.circle(t.center,t.radius,t.style))),Zl=Dl.createSimpleClass(((e,t)=>e.rect(t.x,t.y,t.width,t.height,t.style)));Al.exports={Arc:Kl,Circle:Xl,Label:Wl,Line:Bl,MovableLine:ql,MovablePoint:zl,Parabola:Vl,Path:Yl,Plot:Ul,PlotParametric:Gl,Point:$l,Sinusoid:Hl,Rect:Zl};var Jl=Al.exports,Ql={exports:{}};Ql.exports;h.a;const ec=i.a,tc=x.b,nc=El,sc=Jl,ic=nc.GraphieMovable,rc=ce.deepEq,oc=ce.nestedMap,ac=Ei.assert,lc=no.createGraphie,cc=createReactClass({displayName:"Graphie",getDefaultProps:function(){return{range:[[-10,10],[-10,10]],options:{},responsive:!1,addMouseLayer:!0}},componentDidMount:function(){this._setupGraphie(),this._updateMovables()},shouldComponentUpdate:function(e){return!rc(this.props,e)},componentDidUpdate:function(e){this.props.setup!==e.setup&&window.console&&window.console.warn&&window.console.warn("<Graphie> was given a new setup function. This is a bad idea; please refactor your code to give the same setup function reference to <Graphie> on every render."),rc(this.props.options,e.options)&&rc(this.props.box,e.box)&&rc(this.props.range,e.range)||this._setupGraphie(),this._updateMovables()},getGraphie:function(){return this._graphie},_range:function(){return tc.map(this.props.range,(e=>e[0]>=e[1]?[-10,10]:e))},_box:function(){return tc.map(this.props.box,(e=>e>0?e:340))},_scale:function(){const e=this._box(),t=this._range();return tc.map(e,((e,n)=>e/(t[n][1]-t[n][0])))},_setupGraphie:function(){this._removeMovables();const e=ec.findDOMNode(this.refs.graphieDiv);l()(e).empty();const t=this._graphie=lc(e);t.init({range:this._range(),scale:this._scale(),isMobile:this.props.isMobile}),this.props.addMouseLayer&&t.addMouseLayer({onClick:this.props.onClick,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,onMouseMove:this.props.onMouseMove,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable}),t.snap=this.props.options.snapStep||[1,1],this.props.responsive&&(l()(e).css({width:"100%",height:"100%"}),t.raphael.setSize("100%","100%")),this.props.setup(t,tc.extend({range:this._range(),scale:this._scale()},this.props.options))},_removeMovables:function(){tc.invoke(this._movables,"remove"),this._movables={}},_renderMovables:function(e,t){const n=t.graphie,s=t.oldMovables,i=t.newMovables,r=e=>{tc.each(e.movableProps,(n=>{e.props[n]=this._renderMovables(e.props[n],t)}))};let o=!1;return oc(e,(e=>{if(!e)return t.nextKey++,e;const a=new e.type(e.props);ac(a instanceof ic,"All children of a Graphie component must be Graphie movables");const l=e.key,c=null==l?"_no_id_"+t.nextKey:l;t.nextKey++;const h=e.ref;r(a);const p=s[c];if(p)if(a.constructor===p.constructor){p.props=a.props;"reordered"===p.modify(n)&&(o=!0),i[c]=p}else null==l&&"undefined"!==typeof console&&console.warn&&console.warn("Replacing a <Graphie> child with a child of a different type. Please add keys to your <Graphie> children"),p.remove(),a.add(n),o=!0,i[c]=a;else a.add(n),o=!0,i[c]=a;return o&&i[c].toFront(),h&&(this.movables[h]=i[c]),i[c]}))},_updateMovables:function(){const e=this._graphie,t=this._movables,n={};this._movables=n,this.movables={},this._renderMovables(this.props.children,{nextKey:1,graphie:e,oldMovables:t,newMovables:n}),tc.each(t,((e,t)=>{n[t]||e.remove()}))},render:function(){return Object($t.jsx)("div",{className:"graphie-container",children:Object($t.jsx)("div",{className:"graphie",ref:"graphieDiv"})})}});tc.extend(cc,nc),tc.extend(cc,sc),Ql.exports=cc;var hc=Ql.exports,pc={exports:{}};pc.exports;const uc=v.a,dc=(h.a,createReactClass({displayName:"FixedToResponsive",getDefaultProps:function(){return{className:"",constrainHeight:!1,allowFullBleed:!1}},getInitialState:function(){return{viewportHeight:null,viewportWidth:null}},componentDidMount:function(){window.innerHeight<480?setTimeout(this._cacheViewportSize,800):this._cacheViewportSize()},_cacheViewportSize:function(){this.isMounted()&&this.setState({viewportHeight:Math.max(480,window.innerHeight),viewportWidth:window.innerWidth})},render:function(){const e=this.props.width/this.props.height,t=Object($t.jsx)("div",{style:{paddingBottom:100*(1/e).toFixed(4)+"%"}});let{width:n,height:s}=this.props;if(this.props.constrainHeight&&this.state.viewportHeight){const t=2/3*this.state.viewportHeight;this.props.height>=t&&(s=t,n=t*e)}const i={maxWidth:n,maxHeight:s},r=uc("fixed-to-responsive",this.props.className),o=Object($t.jsxs)("div",{className:r,style:i,children:[t,this.props.children]});return this.props.allowFullBleed&&this.state.viewportWidth&&n>=this.state.viewportWidth?Object($t.jsx)("div",{style:{marginLeft:wn,marginRight:wn},children:o}):o}}));pc.exports=dc;var gc=pc.exports,fc={exports:{}};fc.exports;const mc=v.a,bc=(h.a,l.a),vc=x.b,xc=gc,yc=hc,jc=yi,wc=ce,Oc=ii,Cc={},Sc=/\/([^/]+)$/;function kc(e){return/\.(jpg|jpeg)$/i.test(e)}function _c(){return"undefined"!==typeof KA&&"en"!==KA.language}function Tc(){return"undefined"!==typeof KA&&"en-pt"===KA.language}const Mc=[];function Nc(){return ReactDOMtags.span({style:{background:"url(/images/spinner.gif) no-repeat",backgroundPosition:"center",width:"100%",height:"100%",position:"absolute",minWidth:"20px"}})}Tc()&&(KA.jipt_dom_insert_checks||(KA.jipt_dom_insert_checks=[]),KA.jipt_dom_insert_checks.push((function(e,t,n){const s=bc(t).data("jipt-label-index");if(t&&"undefined"!==typeof s){const{label:t,useMath:n}=Mc[s];if(t.text(""),e=ui(e),n){const n=/^\$(.*)\$$/,s=e.match(n),i=s?s[1]:"\\color{red}{\\text{Invalid Math}}";t.processMath(i,!0)}else t.processText(e);return!1}return e})));const Pc=createReactClass({displayName:"SvgImage",statics:{getRealImageUrl:V},getDefaultProps:function(){return{constrainHeight:!1,onUpdate:()=>{},responsive:!0,src:"",scale:1,zoomToFullSizeOnMobile:!1}},getInitialState:function(){return{imageLoaded:!1,imageDimensions:null,dataLoaded:!1,labelDataIsLocalized:!1,labels:[],range:[[0,0],[0,0]]}},componentDidMount:function(){F(this.props.src)&&this.loadResources()},componentWillReceiveProps:function(e){this.props.src!==e.src&&this.setState({imageLoaded:!1,dataLoaded:!1})},shouldComponentUpdate:function(e,t){if(!vc.isEqual(this.props,e))return!0;if(!F(e.src))return!1;return this.isLoadedInState(this.state)!==this.isLoadedInState(t)},componentDidUpdate:function(){F(this.props.src)&&!this.isLoadedInState(this.state)&&this.loadResources()},isLoadedInState:function(e){return e.imageLoaded&&e.dataLoaded},loadResources:function(){const e=function(e){const t=e.match(Sc);return t&&t[1]}(this.props.src);if(Cc[e])if(Cc[e].loaded){const{data:t,localized:n}=Cc[e];this.onDataLoaded(t,n)}else Cc[e].dataCallbacks.push(this.onDataLoaded);else{const t={loaded:!1,dataCallbacks:[this.onDataLoaded],data:null,localized:_c()};Cc[e]=t;const n=(n,s)=>{!function(e,t){t={callbackName:"callback",success:bc.noop,error:bc.noop,...t};const n=document.createElement("script");function s(){document.head.removeChild(n),delete window[t.callbackName]}n.setAttribute("async",""),n.setAttribute("src",e),window[t.callbackName]=function(){s(),t.success.apply(null,arguments)},n.addEventListener("error",(function(){s(),t.error.apply(null,arguments)})),document.head.appendChild(n)}(n,{callbackName:"svgData"+e,success:e=>{t.data=e,t.loaded=!0,vc.each(t.dataCallbacks,(e=>{e(t.data,t.localized)}))},error:s})};_c()?n(function(e){if("undefined"!==typeof KA){const[t,n]=z(e).split(B);return`${t}/${KA.language}/${n}-data.json`}return W(e)}(this.props.src),((e,s,i)=>{t.localized=!1,n(W(this.props.src),((e,t,n)=>{console.error("Data load failed:",W(this.props.src),n)}))})):n(W(this.props.src),((e,t,n)=>{console.error("Data load failed:",W(this.props.src),n)}))}},onDataLoaded:function(e,t){this.isMounted()&&e.labels&&e.range&&this.setState({dataLoaded:!0,labelDataIsLocalized:t,labels:e.labels,range:e.range})},sizeProvided:function(){return null!=this.props.width&&null!=this.props.height},onImageLoad:function(){this.sizeProvided()?this.setState({imageLoaded:!0}):wc.getImageSize(this.props.src,((e,t)=>{this.isMounted()&&this.setState({imageLoaded:!0,imageDimensions:[e,t]})}))},setupGraphie:function(e,t){vc.map(t.labels,(t=>{if(Tc()&&this.state.labelDataIsLocalized){const n=e.label(t.coordinates,t.content,t.alignment,!1);bc(n).data("jipt-label-index",Mc.length),Mc.push({label:n,useMath:t.typesetAsMath})}else if(t.coordinates){const n=e.label(t.coordinates,t.content,t.alignment,t.typesetAsMath,{"font-size":100*this.props.scale+"%"}),s=n[0].style;let i=this._tryGetPixels(s.top),r=this._tryGetPixels(s.left);if(null===i||null===r){const e=n.position();i=e.top,r=e.left}const o=this.props.height*this.props.scale,a=this.props.width*this.props.scale;n.css({top:i/o*100+"%",left:r/a*100+"%"}),vc.each(t.style,((e,t)=>{n.css(t,e)}))}}))},_tryGetPixels:function(e){return(e=e||"").endsWith("px")&&parseFloat(e)||null},_handleZoomClick:function(e){(bc(e.target).width()<this.props.width||this.props.zoomToFullSizeOnMobile)&&Oc.ZoomService.handleZoomClick(e,this.props.zoomToFullSizeOnMobile),this.props.trackInteraction&&this.props.trackInteraction()},render:function(){const e=this.props.src,t={alt:this.props.alt,title:this.props.title},n=this.props.width&&this.props.width*this.props.scale,s=this.props.height&&this.props.height*this.props.scale,i={width:n,height:s},r=this.props.responsive&&!(!n||!s);let o;this.props.extraGraphie&&this.props.extraGraphie.labels.length&&(o=Object($t.jsx)(yc,{box:this.props.extraGraphie.box,range:this.props.extraGraphie.range,options:{labels:this.props.extraGraphie.labels},responsive:!0,addMouseLayer:!1,setup:this.setupGraphie}));const a=void 0===this.props.preloader?Nc:this.props.preloader,l=a?()=>a(i):null;if(!F(e)){if(r){const i=mc({zoomable:n>700,"svg-image":!0});return t.onClick=this._handleZoomClick,Object($t.jsxs)(xc,{className:i,width:n,height:s,constrainHeight:this.props.constrainHeight,allowFullBleed:this.props.allowFullBleed&&kc(e),children:[Object($t.jsx)(jc,{src:e,imgProps:t,preloader:l,onUpdate:this.props.onUpdate}),o]})}return t.style=i,Object($t.jsx)(jc,{src:e,preloader:l,imgProps:t,onUpdate:this.props.onUpdate})}const c=q(e);let h;if(this.isLoadedInState(this.state)){let e;e=this.sizeProvided()?[n,s]:[this.state.imageDimensions[0]*this.props.scale,this.state.imageDimensions[1]*this.props.scale];const t=[40*this.props.scale,40*this.props.scale];h=Object($t.jsx)(yc,{ref:"graphie",box:e,scale:t,range:this.state.range,options:vc.pick(this.state,"labels"),responsive:r,addMouseLayer:!1,setup:this.setupGraphie})}return r?Object($t.jsxs)(xc,{className:"svg-image",width:n,height:s,constrainHeight:this.props.constrainHeight,children:[Object($t.jsx)(jc,{src:c,onLoad:this.onImageLoad,onUpdate:this.props.onUpdate,preloader:l,imgProps:t}),h,o]}):(t.style=i,Object($t.jsxs)("div",{className:"unresponsive-svg-image",style:i,children:[Object($t.jsx)(jc,{src:c,onLoad:this.onImageLoad,onUpdate:this.props.onUpdate,preloader:l,imgProps:t}),h]}))}});fc.exports=Pc;var Ic=fc.exports,Ec={exports:{}},Ac=(Ec.exports,h.a,createReactClass({displayName:"QuestionParagraph",render:function(){var e=this.props.className?"paragraph "+this.props.className:"paragraph";return Object($t.jsx)("div",{className:e,"data-perseus-component-index":this.props.translationIndex,"data-perseus-paragraph-index":this.props.paragraphIndex,children:this.props.children})}}));Ec.exports=Ac;var Rc=Ec.exports,Dc={exports:{}};Dc.exports;const Lc=zn.a,Fc={fence:{match:Lc.defaultRules.fence.match,order:1,parse:(e,t,n)=>e[3]},paragraph:{match:Lc.defaultRules.paragraph.match,order:2,parse:(e,t,n)=>e[1]}},zc=Lc.parserFor(Fc);Dc.exports={parseToArray:e=>{const t=e.replace(/^\n\s*\n/,"")+"\n\n";return zc(t,{inline:!1})},joinFromArray:e=>e.join("\n\n")};var qc=Dc.exports;class Wc{constructor(){this.previousContent=null,this.runLinter=Object(x.a)(((e,t)=>{"undefined"!==typeof KA&&e!==this.previousContent&&(this.previousContent=e,""!==e?fetch("/api/internal/translate/lint_poentry?preview=1&lang=en",{headers:{"Content-Type":"application/json"},body:JSON.stringify({msgid:e,msgstr:e,format:"perseus_text",filename:""}),method:"POST"}).then((e=>e.status>=400?{status:"error",message:"Could not run i18n linter."}:e.json()),(e=>({status:"error",message:"Could not run i18n linter."}))).then((e=>{"error"===e.status?t(["Some part of this text makes it untranslatable. The specific message from the i18n linter was: "+e.message.replace(/\n/g," ")]):t([])})):t([]))}),1e3)}applyLintErrors(e,t){if(t.length){const n=t.join("\n\n");e.unshift({content:{type:"text",content:""},insideTable:!1,message:n,ruleName:"legacy-error",severity:Ee.Severity.ERROR,type:"lint"})}}destroy(){this.runLinter=null,this.previousContent=null}}var Bc=l.a,Vc=(h.a,i.a),Hc=x.b,Uc=v.a,Gc=qc,$c=ns,Yc=Rc,Kc=Ic,Xc=Ln.a,Zc=Js,Jc=Hs,Qc=ce,eh=Ds,th=Is.ClassNames,nh=bs,sh=us,ih=hs;const rh=ls;var oh={exports:{}};oh.exports;const{keypadElementPropType:ah}=ye.a.propTypes;var lh=/\S/,ch=/(web\+graphie|https):\/\/[^\s]*/;const hh=()=>{};"undefined"!==typeof KA&&"en-pt"===KA.language&&(window.PerseusTranslationComponents=[],KA.jipt_dom_insert_checks||(KA.jipt_dom_insert_checks=[]),KA.jipt_dom_insert_checks.push((function(e,t,n){var s=Bc(t),i=s.data("perseus-component-index"),r=s.data("perseus-paragraph-index");if(t&&"undefined"!==typeof i){var o=window.PerseusTranslationComponents[i];return!!o&&(e=ui(e),o.replaceJiptContent(e,r),!1)}return e})));var ph=["content","problemNum","widgets"],uh=function(e,t,n,s){e?(this._tracked=!1,this.trackApi=e,this.widgetType=t,this.widgetID=n,this.setting=s,this.track=this._track.bind(this)):this.track=this._noop};uh.prototype._track=function(e){this._tracked&&!this.setting||(this._tracked=!0,this.trackApi({type:this.widgetType,id:this.widgetID,...e}))},uh.prototype._noop=function(){};var dh=createReactClass({displayName:"Renderer",getDefaultProps:function(){return{content:"",widgets:{},images:{},ignoreMissingWidgets:!0,highlightedWidgets:[],questionCompleted:!1,onRender:hh,onInteractWithWidget:function(){},findExternalWidgets:()=>[],alwaysUpdate:!1,reviewMode:!1,serializedState:null,onSerializedStateUpdated:()=>{},linterContext:je}},getInitialState:function(){return Hc.extend({jiptContent:null,notGorgon:new Wc,notGorgonLintErrors:[]},this._getInitialWidgetState())},componentDidMount:function(){this.handleRender({}),this._currentFocus=null,this._rootNode=Vc.findDOMNode(this),this._isMounted=!0,this.props.serializedState&&this.restoreSerializedState(this.props.serializedState),this.props.linterContext.highlightLint&&this.state.notGorgon.runLinter(this.props.content,this.handleNotGorgonLintErrors)},componentWillReceiveProps:function(e){Hc.isEqual(Hc.pick(this.props,ph),Hc.pick(e,ph))||this.setState(this._getInitialWidgetState(e))},shouldComponentUpdate:function(e,t){if(this.props.alwaysUpdate)return!0;var n=!Hc.isEqual(this.state,t);return!Hc.isEqual(this.props,e)||n},componentWillUpdate:function(e,t){var n=this.shouldRenderJiptPlaceholder(this.props,this.state),s=this.shouldRenderJiptPlaceholder(e,t),i=this.getContent(this.props,this.state),r=this.getContent(e,t),o=this.props.highlightedWidgets,a=e.highlightedWidgets;this.reuseMarkdown=!n&&!s&&i===r&&Hc.isEqual(this.state.notGorgonLintErrors,t.notGorgonLintErrors)&&(!this.props.linterContext.highlightLint||Hc.isEqual(this.props.widgets,e.widgets))&&this.props.linterContext.highlightLint===e.linterContext.highlightLint&&o===a},componentDidUpdate:function(e,t){this.handleRender(e),Hc.each(this.widgetIds,(e=>{this.refs["container:"+e].replaceWidgetProps(this.getWidgetProps(e))})),this.props.serializedState&&!Hc.isEqual(this.props.serializedState,this.getSerializedState())&&this.restoreSerializedState(this.props.serializedState),this.props.linterContext.highlightLint&&this.state.notGorgon.runLinter(this.props.content,this.handleNotGorgonLintErrors)},componentWillUnmount:function(){this.widgetIds=[],null!=this.translationIndex&&(window.PerseusTranslationComponents[this.translationIndex]=null),this.state.notGorgon.destroy(),this._isMounted=!1},getApiOptions(){return eh.getApiOptions.call(this)},_getInitialWidgetState:function(e){e=e||this.props;var t=this._getAllWidgetsInfo(e);return{widgetInfo:t,widgetProps:this._getAllWidgetsStartProps(t,e)}},_getAllWidgetsInfo:function(e){return e=e||this.props,me(e.widgets,((e,t)=>{if(!e.type||!e.alignment){var n={};e.type||(n.type=t.split(" ")[0]),e.alignment||(n.alignment="default"),e=Hc.extend({},e,n)}return Jc.upgradeWidgetInfoToLatestVersion(e)}))},_getAllWidgetsStartProps:function(e,t){return me(e,(e=>Jc.getRendererPropsForWidgetInfo(e,t.problemNum)))},_getDefaultWidgetInfo:function(e){var t=Qc.rTypeFromWidgetId.exec(e);return null==t?{}:{type:t[1],graded:!0,options:{}}},_getWidgetInfo:function(e){return this.state.widgetInfo[e]||this._getDefaultWidgetInfo(e)},renderWidget:function(e,t,n){var s=this.state.widgetInfo[t];if(s&&"full-width"===s.alignment&&(n.foundFullWidth=!0),s||this.props.ignoreMissingWidgets){var i=s&&s.type||e,r=Hc.contains(this.props.highlightedWidgets,t);return Object($t.jsx)(Zc,{ref:"container:"+t,type:i,initialProps:this.getWidgetProps(t),shouldHighlight:r,linterContext:rh.pushContextStack(this.props.linterContext,"widget")},"container:"+t)}return null},getWidgetProps:function(e){var t=this;const n=this.getApiOptions(),s=this.state.widgetProps[e]||{};let i=null;const r=this.state.widgetInfo[e];this.props.reviewMode&&r&&(i=r.options),this._interactionTrackers||(this._interactionTrackers={});let o=this._interactionTrackers[e];return o||(o=this._interactionTrackers[e]=new uh(n.trackInteraction,r&&r.type,e,Jc.getTracking(r&&r.type))),{...s,ref:e,widgetId:e,alignment:r&&r.alignment,static:r&&r.static,problemNum:this.props.problemNum,apiOptions:this.getApiOptions(this.props),keypadElement:this.props.keypadElement,questionCompleted:this.props.questionCompleted,onFocus:Hc.partial(this._onWidgetFocus,e),onBlur:Hc.partial(this._onWidgetBlur,e),findWidgets:this.findWidgets,reviewModeRubric:i,onChange:function(n,s){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t._setWidgetProps(e,n,s,i)},trackInteraction:o.track}},getSerializedState:function(e){return me(e||this.state.widgetProps,((e,t)=>{var n=this.getWidgetInstance(t);return n&&n.getSerializedState?n.getSerializedState():e}))},restoreSerializedState:function(e,t){var n=Hc.keys(e),s=Hc.keys(this.state.widgetProps);if(n.length===s.length&&Hc.intersection(n,s).length===n.length){var i=1,r=()=>{--i,t&&0===i&&t()};this.setState({widgetProps:me(e,((e,t)=>{var n=this.getWidgetInstance(t);if(n&&n.restoreSerializedState){++i;var s=n.restoreSerializedState(e,r);return Hc.extend({},this.state.widgetProps[t],s)}return e}))},r)}else console.error("Refusing to restore bad serialized state:",e,"Current props:",this.state.widgetProps)},showRationalesForCurrentlySelectedChoices(){Object.keys(this.props.widgets).forEach((e=>{const t=this.getWidgetInstance(e);t&&t.showRationalesForCurrentlySelectedChoices&&t.showRationalesForCurrentlySelectedChoices(this._getWidgetInfo(e).options)}))},deselectIncorrectSelectedChoices(){Object.keys(this.props.widgets).forEach((e=>{const t=this.getWidgetInstance(e);t&&t.deselectIncorrectSelectedChoices&&t.deselectIncorrectSelectedChoices()}))},findInternalWidgets:function(e){var t;if("string"===typeof e)if(-1!==e.indexOf(" ")){var n=e;t=(e,t)=>e===n}else{var s=e;t=(e,t)=>t.type===s}else t=e;return this.widgetIds.filter((e=>{var n=this._getWidgetInfo(e),s=this.getWidgetInstance(e);return t(e,n,s)})).map(this.getWidgetInstance)},findWidgets:function(e){return[...this.findInternalWidgets(e),...this.props.findExternalWidgets(e)]},getWidgetInstance:function(e){var t=this.refs["container:"+e];return t?t.getWidget():null},_onWidgetFocus:function(e,t){if(void 0===t)t=[];else if(!Hc.isArray(t))throw new Error("widget props.onFocus focusPath must be an Array, but was"+JSON.stringify(t));this._setCurrentFocus([e].concat(t))},_onWidgetBlur:function(e,t){var n=this._currentFocus,s=[e].concat(t);Hc.isEqual(s,n)&&Hc.defer((()=>{Hc.isEqual(this._currentFocus,n)&&this._setCurrentFocus(null)}))},getContent:function(e,t){return t.jiptContent||e.content},shouldRenderJiptPlaceholder:function(e,t){return"undefined"!==typeof KA&&"en-pt"===KA.language&&null==t.jiptContent&&-1!==e.content.indexOf("crwdns")},replaceJiptContent:function(e,t){if(null==t)this.setState({jiptContent:e});else{/^\s*(`{3,}|~{3,})\s*(\S+)?\s*\n([\s\S]+?)\s*\1\s*$/.test(e)||(/\S\n\s*\n\S/.test(e)?e="$\\large{\\red{\\text{Please translate each paragraph to a single paragraph.}}}$":/^\s*$/.test(e)&&(e="$\\large{\\red{\\text{Translated paragraph is currently empty}}}$"));var n=this.getContent(this.props,this.state),s=Gc.parseToArray(n);s[t]=e,this.setState({jiptContent:Gc.joinFromArray(s)})}},outputMarkdown:function(e,t){if(Hc.isArray(e)){for(var n=t.key,s=[],i=!1,r=0;r<e.length;r++){t.key=r,t.paragraphIndex=r;var o=this.outputMarkdown(e[r],t),a="string"===typeof o;a&&i?s[s.length-1]+=o:s.push(o),i=a}return t.key=n,s}this._foundTextNodes=!1,t.foundFullWidth=!1;var l,c=this.outputNested(e,t);return l=null!=this.translationIndex?null:Uc({"perseus-paragraph-centered":!this._foundTextNodes,"perseus-paragraph-full-width":t.foundFullWidth&&1===e.content.length}),Object($t.jsx)(Yc,{className:l,translationIndex:this.translationIndex,paragraphIndex:t.paragraphIndex,children:c},t.key)},outputNested:function(e,t){if(Hc.isArray(e)){for(var n=t.key,s=[],i=!1,r=0;r<e.length;r++){t.key=r;var o=this.outputNested(e[r],t),a="string"===typeof o;a&&i?s[s.length-1]+=o:s.push(o),i=a}return t.key=n,s}return this.outputNode(e,this.outputNested,t)},outputNode:function(e,t,n){var s=this.getApiOptions(),i=s.imagePlaceholder;if("widget"===e.type){var r=s.widgetPlaceholder;return r||(this._foundTextNodes=!0,Hc.contains(this.widgetIds,e.id)?Object($t.jsxs)("span",{className:"renderer-widget-error",children:["Widget [[","\u2603"," ",e.id,"]] already exists."]},n.key):(this.widgetIds.push(e.id),this.renderWidget(e.widgetType,e.id,n)))}if("blockMath"===e.type){const t=new sh,i=e=>{if(this.props.onRender&&this.props.onRender(e),s.isMobile&&e){const n=e.querySelector(".katex"),s=e.querySelector('script[type="math/tex"]')||e.querySelector(".MathJax");if(n)t.resolve();else{if(!s)throw new Error("No math present in Renderer");t.resolve()}}},r=Object($t.jsx)(Xc,{onRender:i,onResourceLoaded:i,children:ih(e.content)}),o={overflowX:"auto",overflowY:"hidden",paddingTop:10,paddingBottom:10,marginTop:-10,marginBottom:-10};if(s.isMobile){const e=16,s={marginLeft:-e,marginRight:-e},i={paddingLeft:e,paddingRight:e},a=(e,t)=>{const n=e.querySelector(".katex-html")||e.querySelector(".MathJax"),s={width:n.offsetWidth,height:n.offsetHeight};return{width:Math.max(t.width,s.width),height:Math.max(t.height,s.height)}};return Object($t.jsx)("div",{className:"perseus-block-math",style:s,children:Object($t.jsx)("div",{className:"perseus-block-math-inner",style:{...o,...i},children:Object($t.jsx)(nh,{readyToMeasureDeferred:t,computeChildBounds:a,children:r})})},n.key)}return Object($t.jsx)("div",{className:"perseus-block-math",children:Object($t.jsx)("div",{className:"perseus-block-math-inner",style:o,children:r})},n.key)}if("math"===e.type){const t=e.content.replace(/\{align[*]?\}/g,"{aligned}");return Object($t.jsxs)("span",{style:{whiteSpace:"nowrap"},children:[Object($t.jsx)("span",{}),Object($t.jsx)(Xc,{onRender:this.props.onRender,onResourceLoaded:this.props.onRender,children:t}),Object($t.jsx)("span",{})]},n.key)}if("image"===e.type){if(i)return i;var o=Hc.has(this.props.images,e.target)?this.props.images[e.target]:null,a=!n.inTable;return Object($t.jsx)(Kc,{src:$c.sanitizeUrl(e.target),alt:e.alt,title:e.title,responsive:a,onUpdate:this.props.onRender,zoomToFullSizeOnMobile:s.isMobile&&s.isArticle,...o},n.key)}if("columns"===e.type)return this._isTwoColumn=!0,$c.ruleOutput(e,t,n);if("text"===e.type)return lh.test(e.content)&&(this._foundTextNodes=!0),i&&ch.test(e.content)?i:e.content;if("table"===e.type||"titledTable"===e.type){n.inTable=!0;const i=$c.ruleOutput(e,t,n);if(n.inTable=!1,!s.isMobile)return i;const r=16,o={marginLeft:-r,marginRight:-r},a={paddingLeft:0,paddingRight:0},l=Object($t.jsx)("div",{style:{...a,overflowX:"auto"},children:Object($t.jsx)(nh,{animateHeight:!0,children:i})});return Object($t.jsx)("div",{style:o,children:l})}return $c.ruleOutput(e,t,n)},handleRender:function(e){const t=this.props.onRender,n=e.onRender;if(t!==hh||n!==hh){const e=Bc(Vc.findDOMNode(this)).find("img");n!==hh&&e.off("load",n),t!==hh&&e.on("load",t)}t()},_setCurrentFocus:function(e){const t=this.getApiOptions();if(s=e,i=this._currentFocus,!(null===s||null===i?s===i:Hc.every(s,((e,t)=>Hc.isEqual(e,i[t]))))){var n=this._currentFocus;n&&this.blurPath(n),this._currentFocus=e,null!=t.onFocusChange&&t.onFocusChange(this._currentFocus,n)}var s,i},focus:function(){for(var e,t,n,s=0;s<this.widgetIds.length;s++){var i=this.widgetIds[s],r=this.getWidgetInstance(i),o=r&&r.focus&&r.focus();if(o){e=i,t=o;break}}if(e)return n=Hc.isObject(t)?[e].concat(t.path||[]):[e],this._setCurrentFocus(n),!0},getDOMNodeForPath:function(e){var t=Hc.first(e),n=Hc.rest(e),s=this.getWidgetInstance(t),i=s.getDOMNodeForPath;return i?i(n):0===n.length?Vc.findDOMNode(s):void 0},getGrammarTypeForPath:function(e){var t=Hc.first(e),n=Hc.rest(e);return this.getWidgetInstance(t).getGrammarTypeForPath(n)},getInputPaths:function(){var e=[];return Hc.each(this.widgetIds,(t=>{var n=this.getWidgetInstance(t);if(n.getInputPaths){var s=n.getInputPaths();Hc.each(s,(n=>{var s=[t].concat(n);e.push(s)}))}})),e},focusPath:function(e){if(!Hc.isEqual(this._currentFocus,e)){this._currentFocus&&this.blurPath(this._currentFocus);var t=Hc.first(e),n=Hc.rest(e),s=this.getWidgetInstance(t).focusInputPath;s&&s(n)}},blurPath:function(e){if(Hc.isEqual(this._currentFocus,e)){var t=Hc.first(e),n=Hc.rest(e);if(this.getWidgetInstance(t)){var s=this.getWidgetInstance(t).blurInputPath;s&&s(n)}}},blur:function(){this._currentFocus&&this.blurPath(this._currentFocus)},serialize:function(){var e={};return Hc.each(this.state.widgetInfo,(function(t,n){var s=this.getWidgetInstance(n).serialize();Hc.isEmpty(s)||(e[n]=s)}),this),e},emptyWidgets:function(){return Hc.filter(this.widgetIds,(e=>{var t=this._getWidgetInfo(e),n=this.getWidgetInstance(e).simpleValidate(t.options,null);return Qc.scoreIsEmpty(n)}))},_setWidgetProps:function(e,t,n,s){this.setState((n=>{const i={...n.widgetProps,[e]:{...n.widgetProps[e],...t}};return s||this.props.onSerializedStateUpdated(this.getSerializedState(i)),{widgetProps:i}}),(()=>{var t=n&&n();s||this.props.onInteractWithWidget(e),!1!==t&&this._setCurrentFocus([e])}))},setInputValue:function(e,t,n){var s=Hc.first(e),i=Hc.rest(e);this.getWidgetInstance(s).setInputValue(i,t,n)},getUserInput:function(){return Hc.map(this.widgetIds,(e=>this.getWidgetInstance(e).getUserInput()))},getWidgetIds:function(){return this.widgetIds},getAllWidgetIds:function(){return Hc.map(this.getWidgetIds(),(e=>{var t="group";return e.substring(0,5)===t&&this.getWidgetInstance(e)?{id:e,children:this.getWidgetInstance(e).getRenderer().getAllWidgetIds()}:{id:e,children:[]}}))},getUserInputForWidgets:function(){return be(this.widgetIds,(e=>this.getWidgetInstance(e).getUserInput()))},scoreWidgets:function(){var e=this.state.widgetInfo,t=this.getApiOptions().onInputError||function(){},n=Hc.filter(this.widgetIds,(t=>{var n=e[t];return null==n.graded||n.graded})),s={};return Hc.each(n,(n=>{var i=e[n],r=this.getWidgetInstance(n);r&&(s[n]=r.simpleValidate(i.options,t))})),s},score:function(){return Hc.reduce(this.scoreWidgets(),Qc.combineScores,Qc.noScore)},guessAndScore:function(){return[this.getUserInput(),this.score()]},examples:function(){var e=this.widgetIds,t=Hc.compact(Hc.map(e,(function(e){return e.examples?e.examples():null})));return t.length&&Hc.all(t,(function(e){return Hc.isEqual(t[0],e)}))?t[0]:null},handleNotGorgonLintErrors:function(e){this._isMounted&&this.setState({notGorgonLintErrors:e})},render:function(){const e=this.getApiOptions();if(this.reuseMarkdown)return this.lastRenderedMarkdown;var t=this.getContent(this.props,this.state);if(this.widgetIds=[],this.shouldRenderJiptPlaceholder(this.props,this.state)&&(this.translationIndex||(this.translationIndex=window.PerseusTranslationComponents.push(this)-1),!e.isArticle))return Object($t.jsx)("div",{"data-perseus-component-index":this.translationIndex,children:t});this._isTwoColumn=!1;var n=$c.parse(t,{isJipt:null!=this.translationIndex});if(this.props.linterContext.highlightLint){const e={content:this.props.content,widgets:this.props.widgets,...this.props.linterContext};rh.runLinter(n,e,!0),this.state.notGorgon.applyLintErrors(n,[...this.state.notGorgonLintErrors,...this.props.legacyPerseusLint||[]])}var s=this.outputMarkdown(n,{baseElements:e.baseElements});const i=Uc({[th.RENDERER]:!0,[th.RESPONSIVE_RENDERER]:!0,[th.TWO_COLUMN_RENDERER]:this._isTwoColumn});return this.lastRenderedMarkdown=Object($t.jsx)("div",{className:i,children:s}),this.lastRenderedMarkdown}});oh.exports=dh;var gh=oh.exports,fh={exports:{}};fh.exports;fh.exports={xs:"@media screen and (max-width: 567px)",sm:`@media screen and (min-width: ${cn}) and (max-width: ${un})`,md:`@media screen and (min-width: ${hn}) and (max-width: ${dn})`,lg:`@media screen and (min-width: ${pn}) and (max-width: ${gn})`,xl:"@media screen and (min-width: 1280px)",smOrSmaller:`@media screen and (max-width: ${un})`,mdOrSmaller:`@media screen and (max-width: ${dn})`,lgOrSmaller:`@media screen and (max-width: ${gn})`,smOrLarger:`@media screen and (min-width: ${cn})`,mdOrLarger:`@media screen and (min-width: ${hn})`,lgOrLarger:`@media screen and (min-width: ${pn})`};var mh=fh.exports,bh={exports:{}};bh.exports;const vh=mh;bh.exports=Nn.StyleSheet.create({perseusInteractive:{zIndex:"3",position:"relative"},aboveScratchpad:{position:"relative",zIndex:"2"},blankBackground:{backgroundColor:"#FDFDFD"},perseusSrOnly:{border:0,clip:"rect(0,0,0,0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",width:1},responsiveLabel:{[vh.smOrSmaller]:{fontSize:14,lineHeight:1.3},[vh.md]:{fontSize:17,lineHeight:1.4},[vh.lgOrLarger]:{fontSize:20,lineHeight:1.4}},responsiveInput:{display:"inline-block",WebkitAppearance:"none",appearance:"none","::-ms-check":{display:"none"},backgroundColor:"#fff",border:"2px solid #fff",boxShadow:`0 0px 0px 1px ${Tn}`,outline:"none",boxSizing:"border-box",flexShrink:0,marginBottom:1,marginLeft:1,marginRight:1,marginTop:1,height:22,width:22},responsiveRadioInput:{borderRadius:"50%",":checked":{backgroundColor:Mn,border:"none",borderRadius:"50%",boxShadow:`inset 0px 0px 0px 2px white, 0 0px 0px 2px ${Mn}`,marginTop:2,marginBottom:2,marginLeft:2,marginRight:2,height:20,width:20}},responsiveRadioInputActive:{backgroundColor:"#fff",border:"2px solid #fff",borderRadius:"50%",boxShadow:`0 0px 0px 2px ${Mn}`,marginTop:2,marginBottom:2,marginLeft:2,marginRight:2,height:20,width:20,":checked":{backgroundColor:"#fff"}},disableTextSelection:{userSelect:"none"}});var xh=bh.exports,yh={exports:{}};yh.exports;h.a;const jh=v.a,wh=window.i18n,Oh=gh,Ch=mh,Sh=ls,kh=createReactClass({displayName:"HintRenderer",getDefaultProps:()=>({linterContext:je}),getSerializedState:function(){return this.refs.renderer.getSerializedState()},restoreSerializedState:function(e,t){this.refs.renderer.restoreSerializedState(e,t)},render:function(){const{apiOptions:e,className:t,hint:n,lastHint:s,lastRendered:i,pos:r,totalHints:o}=this.props,{isMobile:a}=e,l=jh(!a&&"perseus-hint-renderer",a&&Object(Nn.css)(_h.newHint),a&&i&&Object(Nn.css)(_h.lastRenderedNewHint),s&&"last-hint",i&&"last-rendered",t),c={...e,customKeypad:!1,staticRender:!1};return Object($t.jsxs)("div",{className:l,tabIndex:"-1",children:[!e.isMobile&&Object($t.jsx)("span",{className:"perseus-sr-only",children:wh._("Hint #%(pos)s",{pos:r+1})}),!e.isMobile&&!e.satStyling&&o&&null!=r&&Object($t.jsx)("span",{className:"perseus-hint-label",style:{display:"block",color:e.hintProgressColor},children:`${r+1} / ${o}`}),Object($t.jsx)(Oh,{ref:"renderer",widgets:n.widgets,content:n.content||"",images:n.images,apiOptions:c,findExternalWidgets:this.props.findExternalWidgets,linterContext:Sh.pushContextStack(this.props.linterContext,"hint")})]})}}),_h=Nn.StyleSheet.create({newHint:{marginBottom:24,borderLeftColor:"#F6F7F7",borderLeftStyle:"solid",borderLeftWidth:4,[Ch.lgOrSmaller]:{paddingLeft:On},[Ch.smOrSmaller]:{paddingLeft:0},":focus":{outline:"none"}},lastRenderedNewHint:{marginBottom:0,borderLeftColor:Jt}});yh.exports=kh;var Th=yh.exports,Mh={exports:{}};Mh.exports;h.a;const Nh=i.a,Ph=v.a,Ih=x.b,Eh=window.i18n,Ah=Th,Rh=Ic,Dh=Ds,Lh=mh,Fh=xh,zh=ls,qh=createReactClass({displayName:"HintsRenderer",getDefaultProps:function(){return{linterContext:je}},componentDidMount:function(){this._cacheHintImages()},componentDidUpdate:function(e,t){if(Ih.isEqual(e.hints,this.props.hints)&&e.hintsVisible===this.props.hintsVisible||this._cacheHintImages(),e.hintsVisible<this.props.hintsVisible){const e=this.props.hintsVisible-1;Nh.findDOMNode(this.refs["hintRenderer"+e]).focus()}},_hintsVisible:function(){return null==this.props.hintsVisible||-1===this.props.hintsVisible?this.props.hints.length:this.props.hintsVisible},_cacheImagesInHint:function(e){Ih.each(e.images,((e,t)=>{(new Image).src=Rh.getRealImageUrl(t)}))},_cacheHintImages:function(){this._hintsVisible()>0?Ih.each(this.props.hints,this._cacheImagesInHint):this.props.hints.length>0&&this._cacheImagesInHint(this.props.hints[0])},getApiOptions(){return Dh.getApiOptions.call(this)},getSerializedState:function(){return Ih.times(this._hintsVisible(),(e=>this.refs["hintRenderer"+e].getSerializedState()))},restoreSerializedState:function(e,t){let n=1;const s=()=>{--n,t&&0===n&&t()};Ih.each(e,((e,t)=>{const i=this.refs["hintRenderer"+t];i&&(++n,i.restoreSerializedState(e,s))})),s()},render:function(){const e=this.getApiOptions(),t=this._hintsVisible(),n=[];this.props.hints.slice(0,t).forEach(((s,i)=>{const r=i===this.props.hints.length-1&&!/\*\*/.test(s.content),o=i===t-1,a=Object($t.jsx)(Ah,{lastHint:r,lastRendered:o,hint:s,pos:i,totalHints:this.props.hints.length,ref:"hintRenderer"+i,apiOptions:e,findExternalWidgets:this.props.findExternalWidgets,linterContext:zh.pushContextStack(this.props.linterContext,"hints["+i+"]")},"hintRenderer"+i);s.replace&&n.length>0?n[n.length-1]=a:n.push(a)}));const s=e.getAnotherHint&&t>0&&t<this.props.hints.length,i=`(${t}/${this.props.hints.length})`,r=Ph(this.props.className,e.isMobile&&t>0&&Object(Nn.css)(Wh.mobileHintStylesHintsRenderer));return Object($t.jsxs)("div",{className:r,children:[e.isMobile&&t>0&&Object($t.jsx)("div",{className:Object(Nn.css)(Wh.mobileHintStylesHintTitle,Fh.responsiveLabel),children:Eh._("Hints")}),n,s&&Object($t.jsxs)("button",{rel:"button",className:Object(Nn.css)(Wh.linkButton,Wh.getAnotherHintButton,e.isMobile&&Wh.mobileHintStylesGetAnotherHintButton),onClick:t=>{t.preventDefault(),t.stopPropagation(),e.getAnotherHint()},children:[Object($t.jsx)("span",{className:Object(Nn.css)(Wh.plusText,e.isMobile&&Wh.mobileHintStylesPlusText),children:"+"}),Object($t.jsxs)("span",{className:Object(Nn.css)(Wh.getAnotherHintText),children:[Eh._("Get another hint")," ",i]})]})]})}}),Wh=Nn.StyleSheet.create({rendererMargins:{marginTop:On},linkButton:{cursor:"pointer",border:"none",backgroundColor:"transparent",fontSize:"100%",fontFamily:"inherit",fontWeight:"bold",color:Jt,padding:0,position:"relative"},plusText:{fontSize:20,position:"absolute",top:-3,left:0},getAnotherHintText:{marginLeft:16},mobileHintStylesHintsRenderer:{marginTop:64,border:`solid ${sn}`,borderWidth:"1px 0 0 0",position:"relative",":before":{content:'""',display:"table",clear:"both"},":after":{content:'""',display:"table",clear:"both"}},mobileHintStylesHintTitle:{fontFamily:"inherit",fontStyle:"normal",fontWeight:"bold",color:an,paddingTop:On,paddingBottom:24,[Lh.lgOrSmaller]:{paddingLeft:0},[Lh.smOrSmaller]:{paddingLeft:20}},getAnotherHintButton:{marginTop:24},mobileHintStylesGetAnotherHintButton:{[Lh.lgOrSmaller]:{paddingLeft:0},[Lh.smOrSmaller]:{paddingLeft:20}},mobileHintStylesPlusText:{[Lh.lgOrSmaller]:{left:0},[Lh.smOrSmaller]:{left:20}}});Mh.exports=qh;var Bh=Mh.exports;const Vh=R;function Hh(e){if("content"===e.type)return{__type:"content",content:"",images:{},widgets:{}};if("hint"===e.type)return{__type:"hint",replace:!1,content:"",images:{},widgets:{}};if("tags"===e.type)return[];if("array"===e.type)return[];if("object"===e.type){const t=e.shape,n={};return Object.keys(t).forEach((e=>{n[e]=Hh(t[e])})),n}throw new Error(`unexpected shape type ${e.type}`)}function Uh(e){return Zh(Hh(e))}function Gh(e,t,n){const s=Xh(e);de().setContentMapper(n).mapTree(s,t)}function $h(e,t,n){const s=Xh(e);de().setHintMapper(n).mapTree(s,t)}function Yh(e){return Kh(Xh(e))}function Kh(e){if(Array.isArray(e))return e.length?"string"===typeof e[0]?Vh.tags:Vh.arrayOf(Kh(e[0])):Vh.arrayOf(Vh.content);if("object"!==typeof e||"content"!==e.__type&&"item"!==e.__type){if("object"===typeof e&&"hint"===e.__type)return Vh.hint;if("object"===typeof e){const t={};return Object.keys(e).forEach((n=>{t[n]=Kh(e[n])})),Vh.shape(t)}throw new Error(`unexpected multi-item node ${JSON.stringify(e)}`)}return Vh.content}function Xh(e){return e._multi}function Zh(e){return{_multi:e}}var Jh=function(e){return e===Object(e)},Qh=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];if(n)for(var s in n)e[s]=n[s]}return e},ep=function(e){return Jh(e)?Array.isArray(e)?e.slice():Qh(e):e},tp={get:function(e,t){return e[t]},set:function(e,t,n){var s=e.splice();return s[t]=n,s},mod:function(e,t,n){var s=e.slice();return s[t]=n(e[t]),s},del:function(e,t){var n=e.slice();return n.splice(t,1),n}},np={get:function(e,t){return e[t]},set:function(e,t,n){var s=ep(e);return s[t]=n,s},mod:function(e,t,n){var s=ep(e);return s[t]=n(e[t]),s},del:function(e,t){var n=ep(e);return delete n[t],n}},sp={get:function(e,t){return e[t]},set:function(e,t,n){var s=e.splice();return s[t]=n,s},mod:function(e,t,n){var s=e.splice();return s[t]=n(e[t]),s},del:function(e,t){var n=e.slice();return n.splice(t),n}},ip=function(e){return Array.isArray(e)?tp:Jh(e)?np:"string"===typeof e?sp:void 0},rp=function(e){if(e instanceof rp)return e;if(!(this instanceof rp))return new rp(e);var t=ip(e);this._wrapped=t.thaw?t.thaw(e):e};rp.prototype.freeze=function(){var e=this._wrapped,t=ip(e);return t.freeze?t.freeze(e):e},rp.prototype.zoom=function(e){return void 0===this._zoomStack&&(this._zoomStack=[]),this._zoomStack.push({zoom:e,wrapped:this._wrapped}),this._wrapped=rp(this._wrapped).get(e),this},rp.prototype.deZoom=function(){var e=this._zoomStack.pop();return this._wrapped=rp(e.wrapped).set(e.zoom,this._wrapped).freeze(),this},rp.prototype.get=function(e){for(var t=this._wrapped,n=0;n<e.length;n++)t=ip(t).get(t,e[n]);return t},rp.prototype.mod=function(e,t){var n=this._wrapped,s=ep(n),i=ip(n);if(0===e.length)this._wrapped=t(this._wrapped);else if(1===e.length)this._wrapped=i.mod(s,e[0],t);else{var r=e[0],o=e.slice(1);s[r]=rp(n[r]).mod(o,t).freeze(),this._wrapped=s}return this},rp.prototype.merge=function(e,t){return this._wrapped=rp(this._wrapped).mod(e,(function(e){return Qh(e,t)})).freeze(),this},rp.prototype.del=function(e){var t=this._wrapped,n=ip(t);if(1===e.length)this._wrapped=n.del(t,e[0]);else{var s=e[0],i=e.slice(1),r=ep(t);r[s]=rp(t[s]).del(i).freeze(),this._wrapped=r}return this},rp.prototype.set=function(e,t){return this.mod(e,(function(){return t}))};var op=rp,ap={exports:{}};ap.exports;const lp=op,cp=h.a,hp=Bh,pp=gh,up=ce;class dp extends cp.Component{constructor(e){super(e),this._handleSerializedStateUpdated=(e,t)=>{const{onSerializedStateUpdated:n}=this.props;if(n){const s=this._getSerializedState(this.props.serializedState);n(lp(s).set(e,t).freeze())}},this.rendererDataTreeMapper=de().setContentMapper(((e,t,n)=>this._makeContentRendererData(e,n))).setHintMapper((e=>this._makeHintRendererData(e))).setTagsMapper((e=>null)),this.getRenderersMapper=de().setContentMapper((e=>e.makeRenderer())).setHintMapper((e=>e.makeRenderer())).setArrayMapper(this._annotateRendererArray.bind(this)),this.state=this._tryMakeRendererState(this.props)}componentWillReceiveProps(e){e.item!==this.props.item&&this.setState(this._tryMakeRendererState(e))}_tryMakeRendererState(e){try{return{rendererDataTree:this._makeRendererDataTree(e.item,e.shape),renderError:null}}catch(t){return console.error(t),{rendererDataTree:null,renderError:t}}}_getRendererProps(){const{item:e,children:t,shape:n,...s}=this.props;return s}_makeContentRendererData(e,t){const n={ref:null,makeRenderer:null},s=e=>n.ref=e,i=e=>this._findWidgets(n,e),r=e=>this._handleSerializedStateUpdated(t,e);return n.makeRenderer=()=>Object($t.jsx)(pp,{...this._getRendererProps(),...e,ref:s,findExternalWidgets:i,serializedState:this.props.serializedState?lp(this.props.serializedState).get(t):null,onSerializedStateUpdated:r}),n}_makeHintRendererData(e){const t=e=>this._findWidgets({},e);return{hint:e,findExternalWidgets:t,ref:null,makeRenderer:()=>Object($t.jsx)(hp,{...this._getRendererProps(),findExternalWidgets:t,hints:[e]})}}_makeRendererDataTree(e,t){const n=Xh(e);return this.rendererDataTreeMapper.mapTree(n,t)}_findWidgets(e,t){const n=[];return this._mapRenderers((s=>{e!==s&&s.ref&&n.push(...s.ref.findInternalWidgets(t))})),n}_mapRenderers(e){const{rendererDataTree:t}=this.state;if(!t)return null;return de().setContentMapper(e).setHintMapper(e).mapTree(t,this.props.shape)}_scoreFromRef(e){if(!e)return null;const[t,n]=e.guessAndScore();let s;return e.getSerializedState&&(s=e.getSerializedState()),up.keScoreFromPerseusScore(n,t,s)}getScores(){return this._mapRenderers((e=>this._scoreFromRef(e.ref)))}score(){const e=[],t=[],n=this._mapRenderers((n=>n.ref?(n.ref.getSerializedState&&t.push(n.ref.getSerializedState()),e.push(n.ref.score()),n.ref.getUserInput()):null)),s=e.reduce(up.combineScores);return up.keScoreFromPerseusScore(s,n,t)}_getSerializedState(e){return this._mapRenderers(((t,n,s)=>t.ref?t.ref.getSerializedState():e?lp(e).get(s):null))}restoreSerializedState(e,t){let n=0;const s=()=>{n--,t&&0===n&&t()};this._mapRenderers(((t,i,r)=>{if(!t.ref)return;const o=lp(e).get(r);o&&(n++,t.ref.restoreSerializedState(o,s))}))}_annotateRendererArray(e,t,n){if("hint"===n.elementShape.type){const n=t;(e=[...e]).firstN=e=>Object($t.jsx)(hp,{...this._getRendererProps(),findExternalWidgets:n[0]?n[0].findExternalWidgets:void 0,hints:n.map((e=>e.hint)),hintsVisible:e})}return e}_getRenderers(){return this.getRenderersMapper.mapTree(this.state.rendererDataTree,this.props.shape)}render(){return this.state.renderError?Object($t.jsxs)("div",{className:Object(Nn.css)(gp.error),children:["Error rendering: ",String(this.state.renderError)]}):this.props.children({renderers:this._getRenderers()})}}const gp=Nn.StyleSheet.create({error:{color:"red"}});ap.exports=dp;const fp=ap.exports,mp=R;var bp={MultiRenderer:fp,shapes:mp,buildPropTypeForShape:function(e){return PropTypes.oneOfType([PropTypes.shape({_multi:D(e)}),PropTypes.oneOf([null,void 0])])},buildEmptyItemForShape:Uh,findContentNodesInItem:Gh,findHintNodesInItem:$h,inferItemShape:Yh},vp={exports:{}};vp.exports;h.a;const xp=i.a,{Keypad:yp}=ye.a.components,jp={propTypes:{apiOptions:PropTypes.shape({customKeypad:PropTypes.bool}),keypadStyle:PropTypes.any},getInitialState:()=>({keypadElement:null}),componentDidMount(){this.props.apiOptions&&this.props.apiOptions.customKeypad&&(this._keypadContainer=document.createElement("div"),document.body.appendChild(this._keypadContainer),xp.render(Object($t.jsx)(yp,{onElementMounted:e=>{this.setState({keypadElement:e})},onDismiss:()=>{this.blur&&this.blur()},style:this.props.keypadStyle}),this._keypadContainer))},componentWillUnmount(){this._keypadContainer&&(xp.unmountComponentAtNode(this._keypadContainer),this._keypadContainer.parentNode&&this._keypadContainer.parentNode.removeChild(this._keypadContainer),this._keypadContainer=null)},keypadElement(){return this.state.keypadElement}};vp.exports=jp;var wp=vp.exports,Op={exports:{}};Op.exports;h.a;const Cp=i.a,Sp=x.b,kp=Is.Options,_p=Bh,Tp=wp,Mp=gh,Np=ce,Pp=createReactClass({displayName:"ItemRenderer",getDefaultProps:function(){return{apiOptions:{}}},getInitialState:function(){return{...Tp.getInitialState(),questionCompleted:!1,questionHighlightedWidgets:[]}},componentDidMount:function(){Tp.componentDidMount.call(this),this._currentFocus=null},componentWillReceiveProps:function(e){this.setState({questionHighlightedWidgets:[]})},componentDidUpdate:function(){if(this.props.apiOptions.answerableCallback){const e=0===this.questionRenderer.emptyWidgets().length;this.props.apiOptions.answerableCallback(e)}},componentWillUnmount(){Tp.componentWillUnmount.call(this)},keypadElement(){return Tp.keypadElement.call(this)},_handleFocusChange:function(e,t){null!=e?this._setCurrentFocus(e):this._onRendererBlur(t)},_setCurrentFocus:function(e){const t=this.keypadElement(),n=this._currentFocus;this._currentFocus=e;const s=this.getInputPaths(),i=this._currentFocus&&s.some((e=>Np.inputPathsEqual(e,this._currentFocus)));null!=this.props.apiOptions.onFocusChange&&this.props.apiOptions.onFocusChange(this._currentFocus,n,i&&t&&Cp.findDOMNode(t)),t&&(i?t.activate():t.dismiss())},_onRendererBlur:function(e){const t=this._currentFocus;Sp.isEqual(e,t)&&Sp.defer((()=>{Sp.isEqual(this._currentFocus,t)&&this._setCurrentFocus(null)}))},_setWidgetProps:function(e,t,n){this.questionRenderer._setWidgetProps(e,t,n)},_handleAPICall:function(e,t){const n=Sp.rest(arguments);return this.questionRenderer[e](...n)},setInputValue:function(e,t,n){return this._handleAPICall("setInputValue",e,t,n)},focusPath:function(e){return this._handleAPICall("focusPath",e)},blurPath:function(e){return this._handleAPICall("blurPath",e)},getDOMNodeForPath:function(e){return this._handleAPICall("getDOMNodeForPath",e)},getGrammarTypeForPath:function(e){return this._handleAPICall("getGrammarTypeForPath",e)},getInputPaths:function(){return this.questionRenderer.getInputPaths()},handleInteractWithWidget:function(e){const t=Sp.difference(this.state.questionHighlightedWidgets,[e]);this.setState({questionCompleted:!1,questionHighlightedWidgets:t}),this.props.apiOptions.interactionCallback&&this.props.apiOptions.interactionCallback()},focus:function(){return this.questionRenderer.focus()},blur:function(){this._currentFocus&&this.blurPath(this._currentFocus)},getNumHints:function(){return this.props.item.hints.length},scoreInput:function(){const e=this.questionRenderer.guessAndScore(),t=e[0],n=e[1],s=[t,[]],i=Np.keScoreFromPerseusScore(n,s,this.questionRenderer.getSerializedState()),r=this.questionRenderer.emptyWidgets();return this.setState({questionCompleted:i.correct,questionHighlightedWidgets:r}),i},getWidgetIds:function(){return this.questionRenderer.getWidgetIds()},scoreWidgets:function(){const e=this.questionRenderer.scoreWidgets(),t=this.questionRenderer.getUserInputForWidgets(),n=this.questionRenderer.getSerializedState();return me(e,((e,s)=>Np.keScoreFromPerseusScore(e,t[s],n)))},getSerializedState:function(){return{question:this.questionRenderer.getSerializedState(),hints:this.hintsRenderer.getSerializedState()}},restoreSerializedState:function(e,t){let n=2;const s=()=>{--n,t&&0===n&&t()};this.questionRenderer.restoreSerializedState(e.question,s),this.hintsRenderer.restoreSerializedState(e.hints,s)},showRationalesForCurrentlySelectedChoices(){this.questionRenderer.showRationalesForCurrentlySelectedChoices()},deselectIncorrectSelectedChoices(){this.questionRenderer.deselectIncorrectSelectedChoices()},render:function(){const e={...kp.defaults,...this.props.apiOptions,onFocusChange:this._handleFocusChange},t=Object($t.jsx)(Mp,{keypadElement:this.keypadElement(),problemNum:this.props.problemNum,onInteractWithWidget:this.handleInteractWithWidget,highlightedWidgets:this.state.questionHighlightedWidgets,apiOptions:e,questionCompleted:this.state.questionCompleted,reviewMode:this.props.reviewMode,ref:e=>this.questionRenderer=e,...this.props.item.question}),n=Object($t.jsx)(_p,{hints:this.props.item.hints,hintsVisible:this.props.hintsVisible,apiOptions:e,ref:e=>this.hintsRenderer=e});return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:t}),Object($t.jsx)("div",{className:!e.isMobile&&Object(Nn.css)(Ip.hintsContainer),children:n})]})}}),Ip=Nn.StyleSheet.create({hintsContainer:{marginLeft:50}});Op.exports=Pp;var Ep=Op.exports,Ap={exports:{}};Ap.exports;h.a;const Rp=i.a,Dp=x.b,Lp=Is.Options,Fp=Bh,zp=gh,qp=wp,Wp=ce,Bp=ls,Vp=createReactClass({displayName:"ItemRenderer",getDefaultProps:function(){return{apiOptions:{},controlPeripherals:!0,hintsAreaSelector:"#hintsarea",initialHintsVisible:0,workAreaSelector:"#workarea",reviewMode:!1,linterContext:je}},getInitialState:function(){return{...qp.getInitialState(),hintsVisible:this.props.initialHintsVisible,questionCompleted:!1,questionHighlightedWidgets:[]}},componentDidMount:function(){qp.componentDidMount.call(this),this.props.controlPeripherals&&this.props.apiOptions.setDrawingAreaAvailable&&this.props.apiOptions.setDrawingAreaAvailable(!0),this._currentFocus=null,this.update()},componentWillReceiveProps:function(e){this.setState({questionHighlightedWidgets:[]})},componentDidUpdate:function(){this.update()},componentWillUnmount:function(){if(qp.componentWillUnmount.call(this),Rp.unmountComponentAtNode(document.querySelector(this.props.workAreaSelector)),Rp.unmountComponentAtNode(document.querySelector(this.props.hintsAreaSelector)),this.props.controlPeripherals){var e=this.props.item.answerArea||{};e.calculator&&$("#calculator").hide(),e.periodicTable&&$(".periodic-table-info-box").hide(),e.zTable&&$(".z-table-info-box").hide(),e.tTable&&$(".t-table-info-box").hide(),e.chi2Table&&$(".chi2-table-info-box").hide()}},keypadElement(){return qp.keypadElement.call(this)},update:function(){const e={...Lp.defaults,...this.props.apiOptions,onFocusChange:this._handleFocusChange};this.questionRenderer=Rp.render(Object($t.jsx)(zp,{keypadElement:this.keypadElement(),problemNum:this.props.problemNum,onInteractWithWidget:this.handleInteractWithWidget,highlightedWidgets:this.state.questionHighlightedWidgets,apiOptions:e,questionCompleted:this.state.questionCompleted,reviewMode:this.props.reviewMode,savedState:this.props.savedState,linterContext:Bp.pushContextStack(this.props.linterContext,"question"),...this.props.item.question,legacyPerseusLint:this.props.legacyPerseusLint}),document.querySelector(this.props.workAreaSelector)),this.hintsRenderer=Rp.render(Object($t.jsx)(Fp,{hints:this.props.item.hints,hintsVisible:this.state.hintsVisible,apiOptions:e,linterContext:Bp.pushContextStack(this.props.linterContext,"hints")}),document.querySelector(this.props.hintsAreaSelector));var t=this.props.item.answerArea||{};if(this.props.controlPeripherals?($("#calculator").toggle(t.calculator||!1),$(".periodic-table-info-box").toggle(t.periodicTable||!1),$(".z-table-info-box").toggle(t.zTable||!1),$(".t-table-info-box").toggle(t.tTable||!1),$(".chi2-table-info-box").toggle(t.chi2Table||!1)):(t.calculator&&this.props.onShowCalculator&&this.props.onShowCalculator(),t.periodicTable&&this.props.onShowPeriodicTable&&this.props.onShowPeriodicTable(),t.zTable&&this.props.onShowZTable&&this.props.onShowZTable(),t.tTable&&this.props.onShowTTable&&this.props.onShowTTable(),t.chi2Table&&this.props.onShowChi2Table&&this.props.onShowChi2Table()),e.answerableCallback){const t=0===this.questionRenderer.emptyWidgets().length;e.answerableCallback(t)}},_handleFocusChange:function(e,t){null!=e?this._setCurrentFocus(e):this._onRendererBlur(t)},_setCurrentFocus:function(e){const t=this.keypadElement(),n=this._currentFocus;this._currentFocus=e;const s=this.getInputPaths(),i=this._currentFocus&&s.some((e=>Wp.inputPathsEqual(e,this._currentFocus)));null!=this.props.apiOptions.onFocusChange&&this.props.apiOptions.onFocusChange(this._currentFocus,n,i&&t&&Rp.findDOMNode(t)),t&&(i?t.activate():t.dismiss())},_onRendererBlur:function(e){var t=this._currentFocus;Wp.inputPathsEqual(e,t)&&setTimeout((()=>{Wp.inputPathsEqual(this._currentFocus,t)&&this._setCurrentFocus(null)}))},_setWidgetProps:function(e,t,n){this.questionRenderer._setWidgetProps(e,t,n)},_handleAPICall:function(e,t){var n=Dp.rest(arguments),s=this.questionRenderer;return s[e].apply(s,n)},setInputValue:function(e,t,n){return this._handleAPICall("setInputValue",e,t,n)},focusPath:function(e){return this._handleAPICall("focusPath",e)},blurPath:function(e){return this._handleAPICall("blurPath",e)},getDOMNodeForPath:function(e){return this._handleAPICall("getDOMNodeForPath",e)},getGrammarTypeForPath:function(e){return this._handleAPICall("getGrammarTypeForPath",e)},getInputPaths:function(){return this.questionRenderer.getInputPaths()},handleInteractWithWidget:function(e){var t=Dp.difference(this.state.questionHighlightedWidgets,[e]);this.setState({questionCompleted:!1,questionHighlightedWidgets:t}),this.props.apiOptions.interactionCallback&&this.props.apiOptions.interactionCallback()},focus:function(){return this.questionRenderer.focus()},blur:function(){this._currentFocus&&this.blurPath(this._currentFocus)},showHint:function(){this.state.hintsVisible<this.getNumHints()&&this.setState({hintsVisible:this.state.hintsVisible+1})},getNumHints:function(){return this.props.item.hints.length},scoreInput:function(){var e=this.questionRenderer.guessAndScore(),t=e[0],n=e[1],s=[t,[]],i=Wp.keScoreFromPerseusScore(n,s,this.questionRenderer.getSerializedState()),r=this.questionRenderer.emptyWidgets();return this.setState({questionCompleted:i.correct,questionHighlightedWidgets:r}),i},getWidgetIds:function(){return this.questionRenderer.getWidgetIds()},scoreWidgets:function(){var e=this.questionRenderer.scoreWidgets(),t=this.questionRenderer.getUserInputForWidgets(),n=this.questionRenderer.getSerializedState();return me(e,((e,s)=>Wp.keScoreFromPerseusScore(e,t[s],n)))},getSerializedState:function(){return{question:this.questionRenderer.getSerializedState(),hints:this.hintsRenderer.getSerializedState()}},restoreSerializedState:function(e,t){var n=2,s=()=>{--n,t&&0===n&&t()};this.questionRenderer.restoreSerializedState(e.question,s),this.hintsRenderer.restoreSerializedState(e.hints,s)},showRationalesForCurrentlySelectedChoices(){this.questionRenderer.showRationalesForCurrentlySelectedChoices()},deselectIncorrectSelectedChoices(){this.questionRenderer.deselectIncorrectSelectedChoices()},render:function(){return Object($t.jsx)("div",{})}});Ap.exports=Vp;var Hp=Ap.exports;const Up=Nn.StyleSheet.create({hintsContainer:{marginLeft:50},checkAnswerButton:{padding:10,color:"white",fontSize:14,borderRadius:5,display:"inline-grid",gridTemplateColumns:"1fr",gridTemplateRows:"1fr"},checkAnswerText:{gridArea:"1 / 1 / 2 / 2"}}),Gp=createReactClass({displayName:"QuestionRenderer",getDefaultProps:function(){return{apiOptions:{},initialHintsVisible:0,problemNum:0,reviewMode:!1,onAnswer:()=>{},onHint:()=>{},showSubmitButton:!0,showHintButton:!0}},getInitialState:function(){return{...wp.getInitialState(),hintsVisible:this.props.initialHintsVisible,answerState:"unanswered",questionHighlightedWidgets:[]}},componentDidMount:function(){wp.componentDidMount.call(this),this._currentFocus=null},componentWillReceiveProps:function(e){this.setState({questionHighlightedWidgets:[]})},componentDidUpdate:function(){if(this.props.apiOptions.answerableCallback){const e=0===this.questionRenderer.emptyWidgets().length;this.props.apiOptions.answerableCallback(e)}},componentWillUnmount(){wp.componentWillUnmount.call(this)},keypadElement(){return wp.keypadElement.call(this)},_handleFocusChange:function(e,t){null!=e?this._setCurrentFocus(e):this._onRendererBlur(t)},_setCurrentFocus:function(e){const t=this.keypadElement(),n=this._currentFocus;this._currentFocus=e;const s=this.getInputPaths(),r=this._currentFocus&&s.some((e=>ce.inputPathsEqual(e,this._currentFocus)));null!=this.props.apiOptions.onFocusChange&&this.props.apiOptions.onFocusChange(this._currentFocus,n,r&&t&&i.a.findDOMNode(t)),t&&(r?t.activate():t.dismiss())},_onRendererBlur:function(e){const t=this._currentFocus;x.b.isEqual(e,t)&&x.b.defer((()=>{x.b.isEqual(this._currentFocus,t)&&this._setCurrentFocus(null)}))},_setWidgetProps:function(e,t,n){this.questionRenderer._setWidgetProps(e,t,n)},_handleAPICall:function(e,t){const n=x.b.rest(arguments);return this.questionRenderer[e](...n)},setInputValue:function(e,t,n){return this._handleAPICall("setInputValue",e,t,n)},focusPath:function(e){return this._handleAPICall("focusPath",e)},blurPath:function(e){return this._handleAPICall("blurPath",e)},getDOMNodeForPath:function(e){return this._handleAPICall("getDOMNodeForPath",e)},getGrammarTypeForPath:function(e){return this._handleAPICall("getGrammarTypeForPath",e)},getInputPaths:function(){return this.questionRenderer.getInputPaths()},handleInteractWithWidget:function(e){const t=x.b.difference(this.state.questionHighlightedWidgets,[e]);this.setState({answerState:"unanswered",questionHighlightedWidgets:t}),this.props.apiOptions.interactionCallback&&this.props.apiOptions.interactionCallback()},focus:function(){return this.questionRenderer.focus()},blur:function(){this._currentFocus&&this.blurPath(this._currentFocus)},showHint:function(){this.state.hintsVisible<this.getNumHints()&&(this.props.onHint(this.state.hintsVisible+1,this.getNumHints()),this.setState({hintsVisible:this.state.hintsVisible+1}))},getNumHints:function(){return this.props.item.hints.length},scoreInput:function(){const[e,t]=this.questionRenderer.guessAndScore(),n="points"===t.type&&t.earned>=t.total,s=this.questionRenderer.emptyWidgets();return this.setState({answerState:n?"correct":"incorrect",questionHighlightedWidgets:s}),[e,t]},checkAnswer:function(e){e.preventDefault();const[t,n]=this.scoreInput();this.props.onAnswer(t,n)},getWidgetIds:function(){return this.questionRenderer.getWidgetIds()},scoreWidgets:function(){const e=this.questionRenderer.scoreWidgets(),t=this.questionRenderer.getUserInputForWidgets(),n=this.questionRenderer.getSerializedState();return me(e,((e,s)=>ce.keScoreFromPerseusScore(e,t[s],n)))},getSerializedState:function(){return{question:this.questionRenderer.getSerializedState(),hints:this.hintsRenderer.getSerializedState()}},restoreSerializedState:function(e,t){let n=2;const s=()=>{--n,t&&0===n&&t()};this.questionRenderer.restoreSerializedState(e.question,s),this.hintsRenderer.restoreSerializedState(e.hints,s)},showRationalesForCurrentlySelectedChoices(){this.questionRenderer.showRationalesForCurrentlySelectedChoices()},deselectIncorrectSelectedChoices(){this.questionRenderer.deselectIncorrectSelectedChoices()},render:function(){const e={...Ns.defaults,...this.props.apiOptions,onFocusChange:this._handleFocusChange},t=Object($t.jsx)(gh,{keypadElement:this.keypadElement(),problemNum:this.props.problemNum,onInteractWithWidget:this.handleInteractWithWidget,highlightedWidgets:this.state.questionHighlightedWidgets,apiOptions:e,questionCompleted:"correct"===this.state.answerState,reviewMode:this.props.reviewMode,ref:e=>this.questionRenderer=e,...this.props.item.question}),n=Object($t.jsx)(Bh,{hints:this.props.item.hints,hintsVisible:this.state.hintsVisible,apiOptions:e,ref:e=>this.hintsRenderer=e}),s=this.state.hintsVisible>=this.getNumHints(),i=this.props.showSubmitButton,r=this.props.showHintButton;return console.log("showHintButton ",r),console.log("showSubmitButton ",i),Object($t.jsxs)("form",{className:"framework-perseus",onSubmit:this.checkAnswer,children:[Object($t.jsx)("div",{children:t}),Object($t.jsxs)("div",{style:{paddingTop:10,paddingBottom:10},children:[i&&Object($t.jsxs)("button",{type:"submit",className:"check-answer-button "+Object(Nn.css)(Up.checkAnswerButton),style:{backgroundColor:"incorrect"===this.state.answerState?"orange":colorLtbBlue},disabled:"correct"===this.state.answerState,children:[Object($t.jsx)("span",{className:Object(Nn.css)(Up.checkAnswerText),style:{visibility:"correct"===this.state.answerState?"visible":"hidden"},children:"\ud83c\udf1f Yes! You got it!"}),Object($t.jsx)("span",{className:Object(Nn.css)(Up.checkAnswerText),style:{visibility:"incorrect"===this.state.answerState?"visible":"hidden"},children:"Try again"}),Object($t.jsx)("span",{className:Object(Nn.css)(Up.checkAnswerText),style:{visibility:"unanswered"===this.state.answerState?"visible":"hidden"},children:"Check answer"})]}),Object($t.jsx)("div",{style:{display:"inline-block",width:10}}),r&&Object($t.jsx)("button",{type:"button",style:{padding:10,backgroundColor:s?"darkgray":"orange",color:"white",fontSize:14,borderRadius:5},disabled:s,onClick:this.showHint,children:s?"We're out of hints!":"I'd like a hint!"})]}),r&&Object($t.jsx)("div",{className:!e.isMobile&&Object(Nn.css)(Up.hintsContainer),children:n})]})}});var $p=Gp,Yp={exports:{}};Yp.exports;h.a;const Kp=i.a,Xp=v.a,Zp=ce,Jp=Is.Options,Qp=Is.ClassNames,eu=gh,tu=wp,nu=ls,su=createReactClass({displayName:"ArticleRenderer",getDefaultProps:()=>({apiOptions:{},useNewStyles:!1,linterContext:je}),getInitialState:()=>tu.getInitialState(),componentDidMount(){tu.componentDidMount.call(this),this._currentFocus=null},shouldComponentUpdate(e,t){return e!==this.props||t!==this.state},componentWillUnmount(){tu.componentWillUnmount.call(this)},keypadElement(){return tu.keypadElement.call(this)},_handleFocusChange(e,t){e?this._setCurrentFocus(e):this._onRendererBlur(t)},_setCurrentFocus(e){const t=this.keypadElement(),n=this._currentFocus;this._currentFocus=e;let s=!1;if(this._currentFocus){const[e,...t]=this._currentFocus;s=this.refs[e].getInputPaths().some((e=>Zp.inputPathsEqual(e,t)))}null!=this.props.apiOptions.onFocusChange&&this.props.apiOptions.onFocusChange(this._currentFocus,n,s&&t&&Kp.findDOMNode(t)),t&&(s?t.activate():t.dismiss())},_onRendererBlur(e){const t=this._currentFocus;Zp.inputPathsEqual(e,t)&&setTimeout((()=>{Zp.inputPathsEqual(this._currentFocus,t)&&this._setCurrentFocus(null)}))},blur(){if(this._currentFocus){const[e,...t]=this._currentFocus;this.refs[e].blurPath(t)}},_sections(){return Array.isArray(this.props.json)?this.props.json:[this.props.json]},render(){const e={...Jp.defaults,...this.props.apiOptions,isArticle:!0},t=Xp({"framework-perseus":!0,"perseus-article":!0,"bibliotron-article":this.props.useNewStyles,[Qp.MOBILE]:e.isMobile}),n=this._sections().map(((t,n)=>{const s=`section-${n}`;return Object($t.jsx)("div",{className:"clearfix",children:Object(c.createElement)(eu,{...t,ref:s,key:n,key_:n,keypadElement:this.keypadElement(),apiOptions:{...e,onFocusChange:(e,t)=>{this._handleFocusChange(e&&[s].concat(e),t&&[s].concat(t))}},linterContext:nu.pushContextStack(this.props.linterContext,"article"),legacyPerseusLint:this.props.legacyPerseusLint})},n)}));return Object($t.jsx)("div",{className:t,children:n})}});Yp.exports=su;var iu=Yp.exports,ru={exports:{}};ru.exports;ru.exports=["key","ref","containerSizeClass","widgetId","onChange","problemNum","apiOptions","questionCompleted","findWidgets","onRemove","id","onBlur","onFocus","trackInteraction","keypadElement"];var ou=ru.exports,au={exports:{}},lu=(au.exports,x.b),cu=ou,hu={serialize:function(){return lu.omit(this.props,cu)}};au.exports=hu;var pu=au.exports;const uu=function(e,t,n){const s=x.b.omit(e.props,ou),i=x.b.extend(s,t);e.props.onChange(i,n)},du=function(e,t,n,s){if(void 0===n)return x.b.partial(du,e,t);{const i={};i[t]=n,uu(e,i,s)}},gu=function(e,t,n){if(x.b.isObject(e)&&void 0===n)return uu(this,e,n=t);if(x.b.isString(e))return du(this,e,t,n);throw new Error("Invalid types sent to this.change(): "+x.b.toArray(arguments).join()+'\nUsage:\n  this.change({propName: 5}, callback);\n  this.change("propName", 5, callback);\n  this.change("propName")')},fu={onChange:g.a.func.isRequired};g.a.func.isRequired;var mu={change:gu,propTypes:fu},bu={exports:{}},vu=(bu.exports,h.a,mu),xu=pu,yu=createReactClass({displayName:"TextArea",render:function(){return Object($t.jsx)("textarea",{ref:"input",value:this.props.value||"",onChange:this.changeValue})},focus:function(){return this.refs.input.focus(),!0},changeValue:function(e){this.props.onChange(e.target.value)}}),ju=createReactClass({displayName:"SimpleMarkdownTesterEditor",getDefaultProps:function(){return{value:""}},render:function(){return Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[Object($t.jsx)("div",{children:"Simple markdown contents:"}),Object($t.jsx)("div",{children:Object($t.jsx)(yu,{value:this.props.value,onChange:this.change("value"),ref:"input"})})]})})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vu.change.apply(this,t)},focus:function(){return this.refs.input.focus(),!0},serialize(){return xu.serialize.call(this)}});bu.exports=ju;bu.exports;var wu={exports:{}},Ou=(wu.exports,h.a,x.b),Cu=mu,Su=ns,ku=Su.parse,_u=Su.basicOutput,Tu=createReactClass({displayName:"SimpleMarkdownTester",getDefaultProps:function(){return{value:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Cu.change.apply(this,t)},toJSON:function(){return{}},render:function(){var e=ku(this.props.value),t=_u(e);return Object($t.jsx)("div",{children:t})},focus:function(){return this.refs.input.focus(),!0},simpleValidate:function(e){return Tu.validate(this.toJSON(),e)}});Ou.extend(Tu,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),wu.exports={name:"simple-markdown-tester",displayName:"Simple Markdown Tester",hidden:!0,widget:Tu,transform:Ou.identity};wu.exports;var Mu={exports:{}},Nu=(Mu.exports,h.a,mu),Pu=pu,Iu=createReactClass({displayName:"ExampleWidgetEditor",getDefaultProps:function(){return{correct:""}},handleAnswerChange:function(e){this.change({correct:e.target.value})},render:function(){return Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Correct answer:",Object($t.jsx)("input",{value:this.props.correct,onChange:this.handleAnswerChange,ref:"input"})]})})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Nu.change.apply(this,t)},focus:function(){return this.refs.input.focus(),!0},serialize(){return Pu.serialize.call(this)}});Mu.exports=Iu;Mu.exports;var Eu={exports:{}},Au=(Eu.exports,h.a,mu),Ru=x.b,Du=createReactClass({displayName:"TextInput",render:function(){return Object($t.jsx)("input",{ref:"input",value:this.props.value||"",onChange:this.changeValue})},focus:function(){return this.refs.input.focus(),!0},changeValue:function(e){this.props.onChange(e.target.value)}}),Lu=createReactClass({displayName:"ExampleWidget",getDefaultProps:function(){return{value:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Au.change.apply(this,t)},render:function(){return Object($t.jsx)(Du,{ref:"input",value:this.props.value,onChange:this.change("value")})},getUserInput:function(){return this.props.value},focus:function(){return this.refs.input.focus(),!0},simpleValidate:function(e){return Lu.validate(this.getUserInput(),e)}});Ru.extend(Lu,{validate:function(e,t){return""===e?{type:"invalid",message:"It looks like you haven't answered all of the question yet."}:e===t.correct?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}}),Eu.exports={name:"example-widget",displayName:"Example Widget",defaultAlignment:"inline-block",hidden:!0,widget:Lu};Eu.exports;var Fu={exports:{}},zu=(Fu.exports,ou);const qu=x.b;var Wu={getUserInput:function(){return qu.omit(this.props,zu)}};Fu.exports=Wu;var Bu=Fu.exports,Vu={exports:{}},Hu=(Vu.exports,h.a,x.b),Uu=ce,Gu=mu,$u=Bu,Yu=hc,Ku=Yu.MovablePoint,Xu=(G.a.number,G.a.point),Zu=createReactClass({displayName:"ExampleGraphieWidget",getDefaultProps:function(){return{coord:null,graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],valid:!0,backgroundImage:null,markings:"grid",showProtractor:!1}}},getUserInput:function(){return $u.getUserInput.call(this)},render:function(){return Object($t.jsx)(Yu,{ref:"graphie",box:this.props.graph.box,range:this.props.graph.range,options:this.props.graph,setup:this.setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,children:Object($t.jsx)(Ku,{pointSize:5,coord:this.props.coord||[0,0],constraints:[Ku.constraints.snap(),Ku.constraints.bound()],onMove:this.movePoint})})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Gu.change.apply(this,t)},movePoint:function(e){this.change({coord:e})},_getGridConfig:function(e){return Hu.map(e.step,(function(t,n){return Uu.gridDimensionConfig(t,e.range[n],e.box[n],e.gridStep[n])}))},setupGraphie:function(e,t){var n=this._getGridConfig(t);e.graphInit({range:t.range,scale:Hu.pluck(n,"scale"),axisArrows:"<->",labelFormat:function(e){return"\\small{"+e+"}"},gridStep:t.gridStep,tickStep:Hu.pluck(n,"tickStep"),labelStep:1,unityLabels:Hu.pluck(n,"unityLabel")}),e.label([0,t.range[1][1]],t.labels[1],"above")},simpleValidate:function(e){return Zu.validate(this.getUserInput(),e)}});Hu.extend(Zu,{validate:function(e,t){return null==e.coord?{type:"invalid",message:null}:Xu.equal(e.coord,t.correct)?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}}),Vu.exports={name:"example-graphie-widget",displayName:"Example Graphie Widget",hidden:!0,widget:Zu};var Ju=Vu.exports,Qu={exports:{}},ed=(Qu.exports,h.a,mu),td=pu,nd=Ju.widget,sd=createReactClass({displayName:"ExampleGraphieWidgetEditor",getDefaultProps:function(){return{correct:[4,4],graph:{box:[340,340],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],valid:!0,backgroundImage:null,markings:"grid",showProtractor:!1}}},render:function(){return Object($t.jsx)("div",{children:Object($t.jsx)(nd,{graph:this.props.graph,coord:this.props.correct,onChange:this.handleChange,apiOptions:this.props.apiOptions})})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ed.change.apply(this,t)},handleChange:function(e){e.coord&&this.change({correct:e.coord})},serialize(){return td.serialize.call(this)}});Qu.exports=sd;Qu.exports;var id=n(29),rd=n(122),od={exports:{}};od.exports;h.a;const ad=rd.a,ld=createReactClass({displayName:"InfoTip",getInitialState:function(){return{didMount:!1}},componentDidMount:function(){this.setState({didMount:!0})},render:function(){return this.state.didMount?Object($t.jsx)(ad,{...this.props}):Object($t.jsx)("div",{})}});od.exports=ld;var cd=od.exports,hd={exports:{}};hd.exports;h.a,x.b;const pd=mu,ud=pu,dd=cd,gd=id.a,fd=/khanacademy\.org\/.*\/v\/(.*)$/;function md(e){var t=fd.exec(e);return t?t[1]:e}const bd=createReactClass({displayName:"VideoEditor",getDefaultProps:function(){return{location:""}},_handleUrlChange:function(e){this.props.onChange({location:md(e)})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return pd.change.apply(this,t)},serialize(){return ud.serialize.call(this)},render:function(){return Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["URL or KA Video Slug:"," ",Object($t.jsx)(gd,{name:"location",value:this.props.location,style:{width:290},onChange:this._handleUrlChange}),Object($t.jsx)(dd,{children:"You can paste any URL here. KA video URLs will be converted to just the slug."})]})})}});hd.exports=bd;var vd=hd.exports,xd={exports:{}},yd=(xd.exports,h.a,x.b),jd=mu,wd=gc,Od="https://{hostname}/embed_video?slug={slug}&internal_video_only=1",Cd=/^https?:\/\//,Sd=/khanacademy\.org/,kd=createReactClass({displayName:"Video",getUserInput:function(){return null},simpleValidate:function(e){return kd.validate(null,e)},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return jd.change.apply(this,t)},render:function(){var e,t=this.props.location;if(!t)return Object($t.jsx)("div",{});if(Cd.test(t))e=t;else{e=Od.replace("{slug}",t);var n=document.location.hostname,s="www.khanacademy.org";Sd.test(n)&&(s=n),e=e.replace("{hostname}",s)}return Object($t.jsx)(wd,{width:1280,height:720,children:Object($t.jsx)("iframe",{className:"perseus-video-widget",sandbox:"allow-same-origin allow-scripts",width:1280,height:720,src:e,allowFullScreen:!0})},t+this.props.alignment)}});yd.extend(kd,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),xd.exports={name:"video",displayName:"Video",defaultAlignment:"block",supportedAlignments:["block","float-left","float-right","full-width"],widget:kd};var _d=xd.exports;function Td(e){this.order=Ed(e),this.mantissa=Id(e),this.positive=Pd(e),this.sigFigs=this.mantissa.length,this.sigDecs=this.order-this.mantissa.length}function Md(e,t,n,s){var i,r,o,a=""+e,l=Ed(a),c=Id(a),h=Pd(a),p=!1;if(0==e||""==c||"0"==c){for(c="",b=0;b<t;b++)c+="0";l=t+n,n<0&&-n>=t&&(p=!0)}else{if(r=l-c.length-n,o=t-c.length,(i=Math.min(o,r))<0){var u=Ad(c,-i);u.length>c.length+i&&(l++,r>o&&(u=Ad(u,1))),c=u}else if(i>0)for(b=0;b<i;b++)c+="0";""!=c&&"0"!=c||(c="0",h=!0,0!=(l=1+n)&&(p=!0))}var d="";if(h||(d+="-"),s||c.length>20||l>4||l<-2||l-c.length>0&&Nd(c)>0||p)d+=c.charAt(0),c.length>1&&(d+="."+c.substring(1,c.length)),l-1!=0&&(d+=" x 10^"+(l-1));else{var g="",f="",m=!0;if(l>0)if(c.length>l)g=c.substring(0,l),f=c.substring(l,c.length);else{g=c,m=0!=Nd(c);for(var b=0;b<l-c.length;b++)g+="0"}else{for(b=0;b<-l;b++)f+="0";f+=c}d+=(""==g?"0":g)+(m?".":"")+f}return d}function Nd(e){for(var t=0,n=e.length-1;n>=0;n--){if("0"!=e.charAt(n))return t;t++}return t}function Pd(e){for(var t=!0,n=!1,s=!1,i="",r="",o=!0,a=0;a<e.length;a++){var l=e.charAt(a);if(l>="1"&&l<="9")r+=i+l,i="",s=!0,n||0,t=!1;else if("0"==l)n?s?(r+=i+l,i=""):0:s?i+=l:l,t=!1;else if(n||"."!=l)if("e"==l||"E"==l&&a+1<e.length){var c=parseInt(e.substring(a+1,e.length));a=e.length}else!t||"+"!=l&&"-"!=l||"-"==l&&(o=!o);else r+=i,i="",n=!0,t=!1}return""==r||o}function Id(e){for(var t=!0,n=!1,s=!1,i="",r="",o="",a=!0,l=0;l<e.length;l++){var c=e.charAt(l);if(c>="1"&&c<="9")o+=i+c,i="",s=!0,n||0,t=!1;else if("0"==c)n?s?(o+=i+c,i=""):r+=c:s?(r+=c,i+=c):r+=c,t=!1;else if(n||"."!=c)if("e"==c||"E"==c&&l+1<e.length){var h=parseInt(e.substring(l+1,e.length));l=e.length}else!t||"+"!=c&&"-"!=c||"-"==c&&(a=!a);else o+=i,i="",n=!0,t=!1}return""==o?r:o}function Ed(e){for(var t=!0,n=!1,s=!1,i="",r="",o=0,a=0,l=!0,c=0;c<e.length;c++){var h=e.charAt(c);if(h>="1"&&h<="9")r+=i+h,i="",s=!0,n||(a++,o++),t=!1;else if("0"==h)n?s?(r+=i+h,i=""):o--:(a++,s?(o++,i+=h):h),t=!1;else if(n||"."!=h)if("e"==h||"E"==h&&c+1<e.length){var p=parseInt(e.substring(c+1,e.length));o+=p,a+=p,c=e.length}else!t||"+"!=h&&"-"!=h||"-"==h&&(l=!l);else r+=i,i="",n=!0,t=!1}return""==r?a:o}function Ad(e,t){var n=e.length-t-1;if(n<0)return"";if(n>=e.length-1)return e;var s=e.charAt(n+1),i=e.charAt(n),r=!1;if(s>"5")r=!0;else if("5"==s){for(var o=n+2;o<e.length;o++)"0"!=e.charAt(o)&&(r=!0);i%2==1&&(r=!0)}for(var a="",l=n;l>=0;l--){var c=e.charAt(l);if(r){var h;if("9"==c)h="0";else{switch(c){case"0":h="1";break;case"1":h="2";break;case"2":h="3";break;case"3":h="4";break;case"4":h="5";break;case"5":h="6";break;case"6":h="7";break;case"7":h="8";break;case"8":h="9"}r=!1}a=h+a}else a=c+a}return r&&(a="1"+a),a}var Rd={exports:{}};Rd.exports;const Dd=v.a,Ld=(h.a,i.a),Fd=x.b,zd=ce.firstNumericalParse,qd=ce.captureScratchpadTouchStart,Wd=G.a.number,Bd=Z,Vd=Bd.toNumericString,Hd=Bd.getNumericFormat,Ud=createReactClass({displayName:"NumberInput",getDefaultProps:function(){return{value:null,placeholder:null,format:null,onFormatChange:()=>null,checkValidity:()=>!0,useArrowKeys:!1}},getInitialState:function(){return{format:this.props.format}},render:function(){let e=Dd({"number-input":!0,"invalid-input":!this._checkValidity(this.props.value),mini:"mini"===this.props.size,small:"small"===this.props.size,normal:"normal"===this.props.size});return null!=this.props.className&&(e=e+" "+this.props.className),Object($t.jsx)("input",{...this.props,className:e,type:"text",ref:"input",onChange:this._handleChange,onFocus:this._handleFocus,onBlur:this._handleBlur,onKeyPress:this._handleBlur,onKeyDown:this._onKeyDown,onTouchStart:qd,defaultValue:Vd(this.props.value,this.state.format),value:void 0})},componentDidUpdate:function(e){Wd.equal(this.getValue(),this.props.value)||this._setValue(this.props.value,this.state.format)},getValue:function(){return this.parseInputValue(Ld.findDOMNode(this.refs.input).value)},getStringValue:function(){return Ld.findDOMNode(this.refs.input).value.toString()},parseInputValue:function(e){if(""===e){const e=this.props.placeholder;return Fd.isFinite(e)?+e:null}{const t=zd(e);return Fd.isFinite(t)?t:this.props.value}},focus:function(){Ld.findDOMNode(this.refs.input).focus(),this._handleFocus()},blur:function(){Ld.findDOMNode(this.refs.input).blur(),this._handleBlur()},setSelectionRange:function(e,t){Ld.findDOMNode(this).setSelectionRange(e,t)},getSelectionStart:function(){return Ld.findDOMNode(this).selectionStart},getSelectionEnd:function(){return Ld.findDOMNode(this).selectionEnd},_checkValidity:function(e){if(null==e)return!0;const t=zd(e),n=this.props.checkValidity;return Fd.isFinite(t)&&n(t)},_handleChange:function(e){const t=e.target.value,n=this.parseInputValue(t),s=Hd(t);this.props.onChange(n),s&&(this.props.onFormatChange(n,s),this.setState({format:s}))},_handleFocus:function(){this.props.onFocus&&this.props.onFocus()},_handleBlur:function(e){e&&"keypress"===e.type&&13!==e.keyCode||(this._setValue(this.props.value,this.state.format),this.props.onBlur&&this.props.onBlur())},_onKeyDown:function(e){if(this.props.onKeyDown&&this.props.onKeyDown(e),!this.props.useArrowKeys||!Fd.contains(["ArrowUp","ArrowDown"],e.key))return;let t=this.getValue();t===Math.floor(t)&&("ArrowUp"===e.key?t+=1:"ArrowDown"===e.key&&(t-=1),this._checkValidity(t)&&this.props.onChange(t))},_setValue:function(e,t){l()(Ld.findDOMNode(this.refs.input)).val(Vd(e,t))}});Rd.exports=Ud;var Gd=Rd.exports,$d={exports:{}};$d.exports;h.a;const Yd=x.b,Kd=mu,Xd=pu,Zd=Kt,Jd=Gd,Qd="all",eg="some";var tg=function(e){return e.simplify().asMul().partition()[1].flatten().simplify()},ng=createReactClass({displayName:"UnitExample",render:function(){var e;return e=this.state.valid?Object($t.jsxs)("span",{children:[Object($t.jsx)("span",{className:"unit-example-okay",children:Object($t.jsx)(Zd,{...ja})}),this.state.solvedExample]}):Object($t.jsx)("span",{className:"unit-example-not-okay",children:Object($t.jsx)(Zd,{...Oa})}),Object($t.jsxs)("div",{children:[e," ",this.props.name]})},componentWillReceiveProps:function(e){this._checkValidity(e)},componentWillMount:function(){this._checkValidity(this.props)},_checkValidity:function(e){let{name:t,original:n,sigfigs:s}=e;var i=U.unitParse(t),r="",o=!0;if(i.parsed&&n){var a=new U.Var("x"),{unit:l}=i,c=new U.Eq(n,"=",new U.Mul(a,l));try{r=function(e,t){return Md(e,t,-10,!1)}(c.solveLinearEquationForVariable(a).eval(),s),o=U.compare(tg(n),tg(l)).equal}catch(h){o=!1}}else o=!1;this.setState({valid:o,solvedExample:r})}});const sg=createReactClass({displayName:"UnitInputEditor",getDefaultProps:function(){return{value:"5x10^5 kg m / s^2",accepting:Qd,sigfigs:3}},render:function(){var{acceptingUnits:e,accepting:t}=this.props;e=e||[];var n=null;if(t===eg){var s=e.map(((e,t)=>Object($t.jsx)(ng,{name:e,original:this.original||null,sigfigs:this.props.sigfigs},t)));n=Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{type:"text",defaultValue:e.join(", "),onChange:this.handleAcceptingUnitsChange})," ","(comma-separated)",s]})}return Object($t.jsxs)("div",{className:"unit-editor",children:[Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{value:this.props.value,className:"unit-editor-canonical",onBlur:this._handleBlur,onKeyPress:this._handleBlur,onChange:this.onChange})," ",this.parsed?Object($t.jsx)("span",{className:"unit-example-okay",children:Object($t.jsx)(Zd,{...ja})}):Object($t.jsx)("span",{className:"unit-example-not-okay",children:Object($t.jsx)(Zd,{...Oa})})]}),Object($t.jsxs)("div",{children:["Significant Figures:"," ",Object($t.jsx)(Jd,{value:this.props.sigfigs,onChange:this.handleSigfigChange,checkValidity:this._checkSigfigValidity,useArrowKeys:!0})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"radio",name:this.groupId,onChange:()=>this._setAccepting(Qd),checked:this.props.accepting===Qd})," Any equivalent unit "]}),Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"radio",name:this.groupId,onChange:()=>this._setAccepting(eg),checked:this.props.accepting===eg})," Only these units "]})]}),n]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Kd.change.apply(this,t)},handleAcceptingUnitsChange:function(e){var t=e.target.value.split(",").map((e=>e.trim())).filter((e=>""!==e));this.change({acceptingUnits:t})},handleSigfigChange:function(e){this.change({sigfigs:e})},_checkSigfigValidity:function(e){return e>0&&e<=10},_setAccepting:function(e){this.change({accepting:e})},componentWillMount:function(){this.groupId=Yd.uniqueId("accepting"),this._doOriginal(this.props)},componentWillReceiveProps:function(e){this._doOriginal(e)},_doOriginal:function(e){var t=U.unitParse(e.value);this.parsed=!1,t.parsed&&"unitMagnitude"===t.type&&(this.original=t.expr,this.parsed=!0)},onChange:function(e){this.props.onChange({value:e.target.value})},getSaveWarnings:function(){var{value:e,accepting:t,acceptingUnits:n}=this.props,s=[];return U.unitParse(e).parsed||s.push("Answer did not parse"),t===eg&&0===n.length&&s.push("There are no accepted units"),s},serialize(){return Xd.serialize.call(this)}});$d.exports=sg;var ig=$d.exports,rg={exports:{}};rg.exports;function og(e,t,n){var s=e.indexOf("{",t)+1,i=function(e,t){for(var n=0,s=t,i=e.length;s<i;s++){var r=e[s];if("{"===r?n++:"}"===r&&n--,n<0)return s}return e.length}(e,s);return{endpoint:i,expression:lg(e.substring(s,i),n)}}function ag(e,t){var n=e.indexOf("\\frac",t),s=e.indexOf("\\dfrac",t);return n>-1&&s>-1?Math.min(n,s):n>-1?n:s>-1?s:-1}function lg(e,t){for(var n="",s=0,i=ag(e,s);i>-1;){n+=e.substring(s,i);var r=og(e,s=i,t),o=og(e,s=r.endpoint+1,t);s=o.endpoint+1,n.length&&(n+=" "),n+=t(r.expression,o.expression),i=ag(e,s)}return n+=e.slice(s)}rg.exports={parseTex:function(e){return lg(e,(function(e,t){return e+"/"+t})).replace("\\%","%")},modifyTex:function(e){function t(e){return e.indexOf("\\frac")>-1||e.indexOf("\\dfrac")>-1}return lg(e,(function(e,n){return(t(e)||t(n)?"\\dfrac":"\\frac")+" {"+e+"}{"+n+"}"}))}};var cg=rg.exports,hg={exports:{}};hg.exports;h.a;const pg=i.a,ug=x.b,dg=Ln.a,gg=Is.ClassNames,fg=cg.modifyTex,mg=createReactClass({displayName:"MathOutput",getDefaultProps:function(){return{value:"",onFocus:function(){},onBlur:function(){}}},getInitialState:function(){return{focused:!1,selectorNamespace:ug.uniqueId("math-output")}},_getInputClassName:function(){let e="math-output "+gg.INPUT+" "+gg.INTERACTIVE;return this.state.focused&&(e+=" "+gg.FOCUSED),this.props.className&&(e+=" "+this.props.className),e},_getDisplayValue:function(e){let t;return t=null!=e?""+e:"",fg(t)},render:function(){return Object($t.jsx)("span",{ref:"input",className:this._getInputClassName(),"aria-label":this.props.labelText,onMouseDown:this.focus,onTouchStart:this.focus,children:Object($t.jsx)("div",{style:{textAlign:"center"},children:Object($t.jsx)(dg,{children:this._getDisplayValue(this.props.value)})})})},getValue:function(){return this.props.value},focus:function(){this.state.focused||(this.props.onFocus(),this._bindBlurHandler(),this.setState({focused:!0}))},blur:function(){this.state.focused&&(this.props.onBlur(),this._unbindBlurHandler(),this.setState({focused:!1}))},_bindBlurHandler:function(){l()(document).bind("vclick."+this.state.selectorNamespace,(e=>{l()(e.target).closest(pg.findDOMNode(this)).length||this.blur()}))},_unbindBlurHandler:function(){l()(document).unbind("."+this.state.selectorNamespace)},componentWillUnmount:function(){this._unbindBlurHandler()}});hg.exports=mg;var bg=hg.exports,vg={exports:{}},xg=(vg.exports,op),yg=h.a,jg=i.a,wg=x.b,Og=Is.ClassNames,Cg=Is.Options,Sg=mu,kg=bg,_g=function(e){return new Td(e).sigFigs},Tg=createReactClass({displayName:"OldUnitInput",getDefaultProps:function(){return{apiOptions:Cg.defaults,value:""}},render:function(){var e=(this.props.apiOptions.staticRender?yg.createFactory(kg):ReactDOMtags.input)({onChange:this.handleChange,ref:"input",className:Og.INTERACTIVE,value:this.props.value,onFocus:this.handleFocus,onBlur:this.handleBlur});return Object($t.jsxs)("div",{className:"old-unit-input",children:[e,Object($t.jsx)("div",{ref:"error",className:"error",style:{display:"none"},children:i18n._("I don't understand that")})]})},_errorTimeout:null,_showError:function(){if(""!==this.props.value){var e=$(jg.findDOMNode(this.refs.error));e.is(":visible")||e.css({top:50,opacity:.1}).show().animate({top:0,opacity:1},300)}},_hideError:function(){var e=$(jg.findDOMNode(this.refs.error));e.is(":visible")&&e.animate({top:50,opacity:.1},300,(function(){$(this).hide()}))},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Sg.change.apply(this,t)},componentDidUpdate:function(){clearTimeout(this._errorTimeout),U.unitParse(this.props.value).parsed?this._hideError():this._errorTimeout=setTimeout(this._showError,2e3)},componentWillUnmount:function(){clearTimeout(this._errorTimeout)},handleBlur:function(){this.props.onBlur([]),clearTimeout(this._errorTimeout),U.unitParse(this.props.value).parsed||this._showError()},handleChange:function(e){this._hideError(),this.props.onChange({value:e.target.value})},simpleValidate:function(e,t){return t=t||function(){},Tg.validate(this.getUserInput(),e)},getUserInput:function(){return this.props.value},getInputPaths:function(){return[[]]},focusInputPath:function(e){jg.findDOMNode(this.refs.input).focus()},handleFocus:function(){this.props.onFocus([])},blurInputPath:function(e){jg.findDOMNode(this.refs.input).blur()},setInputValue:function(e,t,n){this.props.onChange({value:t},n)},getDOMNodeForPath:function(){return jg.findDOMNode(this.refs.input)},getGrammarTypeForPath:function(e){return"unit"}}),Mg=function(e){return e.simplify().asMul().partition()[1].flatten().simplify()};wg.extend(Tg,{validate:function(e,t){var n=U.unitParse(t.value).expr,s=U.unitParse(e);if(!s.parsed)return{type:"invalid",message:i18n._("I couldn't understand those units.")};var i,r,o=null,a=t.sigfigs,l=_g(s.coefficient)===a;l||(o=i18n._("Check your significant figures."));try{var c=new U.Var("x"),h=new U.Eq(n.simplify(),"=",new U.Mul(c,s.expr.simplify())).solveLinearEquationForVariable(c);i=Number(h.eval()).toPrecision(a)===Number(1).toPrecision(a)}catch(d){i=!1}i||(o=i18n._("That answer is numerically incorrect."));var p=Mg(s.expr.simplify()),u=Mg(n.simplify());if(!(r="all"===t.accepting?U.compare(p,u).equal:t.acceptingUnits.some((e=>{var t=Mg(U.unitParse(e).unit.simplify());return U.compare(t,p).equal}))))o=i18n._("Check your units.");return{type:"points",earned:r&&i&&l?1:0,total:1,message:o}}}),vg.exports={name:"unit-input",displayName:"Unit",defaultAlignment:"inline-block",widget:Tg,transform:e=>xg(e).del(["value"]).freeze(),version:{major:0,minor:1},countSigfigs:_g,sigfigPrint:function(e,t){return Md(e,t,-10,!1)},hidden:!0};var Ng=vg.exports,Pg={exports:{}};Pg.exports;h.a;const{KeypadInput:Ig}=ye.a.components,{KeypadTypes:Eg}=ye.a.consts,{keypadElementPropType:Ag}=ye.a.propTypes,Rg=createReactClass({displayName:"SimpleKeypadInput",focus(){this.refs.input.focus()},blur(){this.refs.input.blur()},getValue:function(){return this.props.value},render(){const{keypadElement:e,onFocus:t,value:n,...s}=this.props;return Object($t.jsx)(Ig,{ref:"input",keypadElement:e,onFocus:()=>{e?e.configure({keypadType:Eg.FRACTION},(()=>{this.isMounted()&&t&&t()})):t&&t()},value:null==n?"":""+n,...s})}});Pg.exports=Rg;var Dg=Pg.exports,Lg={exports:{}};Lg.exports;h.a;const Fg=i.a,zg=x.b,qg=ce,Wg=no,Bg=Ic,Vg={url:null},Hg={fontStyle:"italic",fontWeight:"bold",fontSize:"32px",width:"100%",height:"100%",textAlign:"center",backgroundColor:"white",position:"absolute",zIndex:1,transition:"opacity .25s ease-in-out","-moz-transition":"opacity .25s ease-in-out","-webkit-transition":"opacity .25s ease-in-out"},Ug={position:"relative",top:"25%"};const Gg=createReactClass({displayName:"Graph",getDefaultProps:function(){return{labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],snapStep:[.5,.5],markings:"graph",backgroundImage:Vg,showProtractor:!1,showRuler:!1,rulerLabel:"",rulerTicks:10,instructions:null,onGraphieUpdated:null,onClick:null,onMouseDown:null,isMobile:!1}},render:function(){let e;const t=this.props.backgroundImage;if(t.url){const n=this.props.box[0]/Cn;e=Object($t.jsx)(Bg,{src:t.url,width:t.width,height:t.height,scale:n,responsive:!1})}else e=null;return Object($t.jsxs)("div",{className:"graphie-container above-scratchpad",style:{width:this.props.box[0],height:this.props.box[1]},onMouseOut:this.onMouseOut,onMouseOver:this.onMouseOver,onClick:this.onClick,children:[e,Object($t.jsx)("div",{className:"graphie",ref:"graphieDiv"})]})},componentDidMount:function(){this._setupGraphie(!0)},componentDidUpdate:function(){this._hasSetupGraphieThisUpdate=!1,this._shouldSetupGraphie&&(this._setupGraphie(!1),this._shouldSetupGraphie=!1)},componentWillReceiveProps:function(e){const t=this;zg.each(["labels","range","step","markings","showProtractor","showRuler","rulerLabel","rulerTicks","gridStep","snapStep"],(function(n){zg.isEqual(t.props[n],e[n])||(t._shouldSetupGraphie=!0)}))},reset:function(){this._setupGraphie(!1)},graphie:function(){return this._graphie},pointsFromNormalized:function(e,t){const n=this;return zg.map(e,(function(e){return zg.map(e,(function(e,s){const i=n.props.range[s];if(t)return i[0]+(i[1]-i[0])*e;{const t=n.props.step[s],r=function(e,t){return Math.floor((e[1]-e[0])/t)}(i,t),o=Math.round(e*r);return i[0]+t*o}}))}))},_setupGraphie:function(e){if(this._hasSetupGraphieThisUpdate)return;const t=Fg.findDOMNode(this.refs.graphieDiv);$(t).empty();const n=this.props.labels,s=this.props.range,i=this._graphie=Wg.createGraphie(t),r=this._getGridConfig();i.snap=this.props.snapStep,"graph"===this.props.markings?(i.graphInit({range:s,scale:zg.pluck(r,"scale"),axisArrows:"<->",labelFormat:function(e){return"\\small{"+e+"}"},gridStep:this.props.gridStep,tickStep:zg.pluck(r,"tickStep"),labelStep:1,unityLabels:zg.pluck(r,"unityLabel"),isMobile:this.props.isMobile}),i.label([0,s[1][1]],n[1],this.props.isMobile?"below right":"above"),i.label([s[0][1],0],n[0],this.props.isMobile?"above left":"right")):"grid"===this.props.markings?i.graphInit({range:s,scale:zg.pluck(r,"scale"),gridStep:this.props.gridStep,axes:!1,ticks:!1,labels:!1,isMobile:this.props.isMobile}):"none"===this.props.markings&&i.init({range:s,scale:zg.pluck(r,"scale"),isMobile:this.props.isMobile});let o;if(this.props.instructions){o=$("<div/>"),zg.each(Hg,(function(e,t){o.css(t,e)})),o.css("opacity",.5);const e=$("<span/>",{text:this.props.instructions});zg.each(Ug,(function(t,n){e.css(n,t)})),o.append(e),$(t).append(o)}else o=void 0;const a=o||this.props.onMouseDown?zg.bind((function(e){o&&(o.remove(),o=null),this.props.onMouseDown(e)}),this):null,l=o?function(){o&&o.css("opacity",0)}:null,c=o?function(){o&&o.css("opacity",.5)}:null;i.addMouseLayer({onClick:this.props.onClick,onMouseDown:a,onMouseOver:l,onMouseOut:c,onMouseUp:this.props.onMouseUp,onMouseMove:this.props.onMouseMove,allowScratchpad:!0,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable}),this._updateProtractor(),this._updateRuler(),this._hasSetupGraphieThisUpdate=!0,!e&&this.props.onGraphieUpdated&&this.props.onGraphieUpdated(i)},_getGridConfig:function(){const e=this;return zg.map(e.props.step,(function(t,n){return qg.gridDimensionConfig(t,e.props.range[n],e.props.box[n],e.props.gridStep[n])}))},_updateProtractor:function(){if(this.protractor&&this.protractor.remove(),this.props.showProtractor){const e=this.pointsFromNormalized([[.5,.05]])[0];this.protractor=this._graphie.protractor(e)}},_updateRuler:function(){if(this.ruler&&this.ruler.remove(),this.props.showRuler){const e=this.pointsFromNormalized([[.5,.25]])[0],t=this._graphie.range[0][1]-this._graphie.range[0][0];this.ruler=this._graphie.ruler({center:e,label:this.props.rulerLabel,pixelsPerUnit:this._graphie.scale[0],ticksPerUnit:this.props.rulerTicks,units:Math.round(.8*t)})}},toJSON:function(){return zg.pick(this.props,"range","step","markings","labels","backgroundImage","showProtractor","showRuler","rulerLabel","rulerTicks","gridStep","snapStep")}});Lg.exports=Gg;var $g=Lg.exports,Yg={exports:{}},Kg=(Yg.exports,h.a,i.a),Xg=x.b,Zg=$g;const Jg=Kt;var Qg=Gd,ef=bg,tf=Ln.a;const nf=Dg;var sf=Is.Options;const{keypadElementPropType:rf}=ye.a.propTypes;var of=ce.deepEq,af=ce.getGridStep,lf=ce.captureScratchpadTouchStart,cf=G.a.number,hf=G.a.vector,pf=G.a.point,uf=G.a.ray,df=G.a.line;const gf=Z,ff=Di;var mf=Ei.assert,bf={url:null};var vf={apiOptions:sf.defaults,gradeEmpty:!1,graphMode:"interactive",listMode:"dynamic",graph:{},tools:{translation:{enabled:!0,required:!1,constraints:{}},rotation:{enabled:!0,required:!1,constraints:{fixed:!1},coord:[1,6]},reflection:{enabled:!0,required:!1,constraints:{fixed:!1},coords:[[2,-4],[2,2]]},dilation:{enabled:!0,required:!1,constraints:{fixed:!1},coord:[6,6]}},drawSolutionShape:!0,starting:{shape:{type:"polygon-3",coords:[[2,2],[2,6],[7,2]]},transformations:[]},correct:{shape:{type:"polygon-3",coords:[[2,2],[2,6],[7,2]]},transformations:[]}};function xf(e){return e.constraints.fixed?ff.DYNAMIC:ff.INTERACTIVE}function yf(e){return String(gf.roundTo(9,e))}function jf(e){return[Object($t.jsx)(tf,{children:"("}),yf(e[0]),Object($t.jsx)(tf,{children:", {}"}),yf(e[1]),Object($t.jsx)(tf,{children:")"})]}function wf(e,t){return e=Xg.clone(e).sort(pf.compare),t=Xg.clone(t).sort(pf.compare),Xg.all(Xg.map(e,(function(e,n){var s=t[n];return pf.equal(e,s)})))}const Of=e=>e.customKeypad?nf:e.staticRender?ef:Qg;var Cf={apply:function(e){return Sf[e.type].isValid(e)?Sf[e.type].apply(e):Xg.identity},append:function(e,t){var n=Cf._appendAndCollapseLastTwo(e,t);return Cf._collapseFinalNoOps(n)},_collapseFinalNoOps:function(e){return e.length&&Cf.isNoOp(Xg.last(e))?Xg.initial(e):e},_appendAndCollapseLastTwo:function(e,t){if(e.length){var n=Cf.collapse(Xg.last(e),t);return Xg.initial(e).concat(n)}return[t]},isNoOp:function(e){return Sf[e.type].isNoOp(e)},collapse:function(e,t){return e.type!==t.type?[e,t]:Cf.isEmpty(e)&&Cf.isEmpty(t)?[]:Cf.isValid(e)&&Cf.isValid(t)?Cf._collapseValidMonotypedTransforms(e,t):[e,t]},isValid:function(e){return Sf[e.type].isValid(e)},isEmpty:function(e){return Sf[e.type].isEmpty(e)},_collapseValidMonotypedTransforms:function(e,t){var n=Sf[e.type].collapse(e,t);return n?(Xg.isArray(n)||(n=[n]),Xg.each(n,(function(t){t.type=e.type})),n):[e,t]},toTeX:function(e){return Sf[e.type].toTeX(e)},ListItem:createReactClass({displayName:"ListItem",render:function(){if("dynamic"===this.props.mode)return Object($t.jsx)("div",{children:Cf.toTeX(this.props.transform)});if("interactive"===this.props.mode){var e=Sf[this.props.transform.type].Input;return Object($t.jsx)(e,{ref:"transform",onChange:this.handleChange,onFocus:this.props.onFocus,onBlur:this.props.onBlur,keypadElement:this.props.keypadElement,apiOptions:this.props.apiOptions,...this.props.transform})}throw new Error("Invalid mode: "+this.props.mode)},value:function(){return"interactive"===this.props.mode?Xg.extend({type:this.props.transform.type},this.refs.transform.value()):this.props.transform},handleChange:Xg.debounce((function(e){this.props.onChange(this.value(),e)}),300),_getComponentAtPath:function(e){var t=this.refs.transform,n=Xg.head(e);return t.refs[n]},focus:function(){var e=this.refs.transform,t=Xg.head(e.getInputPaths());t&&this.focusInputPath(t)},focusInputPath:function(e){this._getComponentAtPath(e).focus()},blurInputPath:function(e){this._getComponentAtPath(e).blur()},getDOMNodeForPath:function(e){return Kg.findDOMNode(this._getComponentAtPath(e))},getGrammarTypeForPath:function(e){return"number"},setInputValue:function(e,t,n){t.length&&(t=parseFloat(t),isNaN(t))||this.refs.transform.setInputValue(e,t,n)},getInputPaths:function(){return"dynamic"===this.props.mode?[]:this.refs.transform.getInputPaths()}})},Sf={translation:{verbName:i18n._("Translate"),nounName:i18n._("Translation"),lowerNounName:i18n._("translation"),apply:function(e){return function(t){return hf.add(t,e.vector)}},isValid:function(e){return Xg.isFinite(e.vector[0])&&Xg.isFinite(e.vector[1])},isEmpty:function(e){return null===e.vector[0]&&null===e.vector[1]},isNoOp:function(e){return hf.equal(e.vector,[0,0])},collapse:function(e,t){return{vector:hf.add(e.vector,t.vector)}},toTeX:function(e){return $_({vector:(t=e.vector,[Object($t.jsx)(tf,{children:"\\langle"}),yf(t[0]),Object($t.jsx)(tf,{children:", {}"}),yf(t[1]),Object($t.jsx)(tf,{children:"\\rangle"})])},"Translation by %(vector)s");var t},Input:createReactClass({displayName:"Input",getInitialState:function(){return{vector:this.props.vector||[null,null]}},componentDidUpdate:function(e){of(this.props,e)||this.setState({vector:this.props.vector})},render:function(){const e=Of(this.props.apiOptions);var t=[Object($t.jsx)(tf,{children:"\\langle"}),Object($t.jsx)(e,{ref:"x",placeholder:0,value:this.state.vector[0],useArrowKeys:!0,onChange:e=>{var t=this.state.vector[1];this.setState({vector:[e,t]},(()=>{this.props.onChange()}))},onFocus:Xg.partial(this.props.onFocus,"x"),onBlur:Xg.partial(this.props.onBlur,"x"),keypadElement:this.props.keypadElement}),Object($t.jsx)(tf,{children:", {}"}),Object($t.jsx)(e,{ref:"y",placeholder:0,value:this.state.vector[1],useArrowKeys:!0,onChange:e=>{var t=this.state.vector[0];this.setState({vector:[t,e]},(()=>{this.props.onChange()}))},onFocus:Xg.partial(this.props.onFocus,"y"),onBlur:Xg.partial(this.props.onBlur,"y"),keypadElement:this.props.keypadElement}),Object($t.jsx)(tf,{children:"\\rangle"})];return Object($t.jsx)("div",{children:$_({vector:t},"Translation by %(vector)s")})},value:function(){return{vector:[this.refs.x.getValue(),this.refs.y.getValue()]}},setInputValue:function(e,t,n){var s=Xg.first(e),i=Xg.clone(this.state.vector);"x"===s?i[0]=t:"y"===s&&(i[1]=t),this.setState({vector:i},(()=>{this.props.onChange(n)}))},getInputPaths:function(){return[["x"],["y"]]}})},rotation:{verbName:i18n._("Rotate"),nounName:i18n._("Rotation"),lowerNounName:i18n._("rotation"),apply:function(e){return function(t){return pf.rotateDeg(t,e.angleDeg,e.center)}},isValid:function(e){return Xg.isFinite(e.angleDeg)&&Xg.isFinite(e.center[0])&&Xg.isFinite(e.center[1])},isEmpty:function(e){return null===e.angleDeg&&null===e.center[0]&&null===e.center[1]},isNoOp:function(e){return cf.equal(e.angleDeg,0)},collapse:function(e,t){return!!pf.equal(e.center,t.center)&&{center:e.center,angleDeg:e.angleDeg+t.angleDeg}},toTeX:function(e){return $_({degrees:(t=e.angleDeg,yf(t)+"\xb0"),point:jf(e.center)},"Rotation by %(degrees)s about %(point)s");var t},Input:createReactClass({displayName:"Input",getInitialState:function(){return{center:this.props.center||[null,null],angleDeg:this.props.angleDeg||null}},componentDidUpdate:function(e){of(this.props,e)||this.setState({center:this.props.center,angleDeg:this.props.angleDeg})},render:function(){const e=Of(this.props.apiOptions);var t=[Object($t.jsx)(tf,{children:"("}),Object($t.jsx)(e,{ref:"centerX",placeholder:0,value:this.state.center[0],useArrowKeys:!0,onChange:e=>{var t=this.state.center[1];this.setState({center:[e,t]},(()=>{this.props.onChange()}))},onFocus:Xg.partial(this.props.onFocus,"centerX"),onBlur:Xg.partial(this.props.onBlur,"centerX"),keypadElement:this.props.keypadElement}),Object($t.jsx)(tf,{children:", {}"}),Object($t.jsx)(e,{ref:"centerY",placeholder:0,value:this.state.center[1],useArrowKeys:!0,onChange:e=>{var t=this.state.center[0];this.setState({center:[t,e]},(()=>{this.props.onChange()}))},onFocus:Xg.partial(this.props.onFocus,"centerY"),onBlur:Xg.partial(this.props.onBlur,"centerY"),keypadElement:this.props.keypadElement}),Object($t.jsx)(tf,{children:")"})],n=[Object($t.jsx)(e,{ref:"angleDeg",placeholder:0,value:this.state.angleDeg,useArrowKeys:!0,onChange:e=>{this.setState({angleDeg:e},(()=>{this.props.onChange()}))},onFocus:Xg.partial(this.props.onFocus,"angleDeg"),onBlur:Xg.partial(this.props.onBlur,"angleDeg"),keypadElement:this.props.keypadElement}),"\xb0"],s=$_({point:t,degrees:n},"Rotation about %(point)s by %(degrees)s");return Object($t.jsx)("div",{children:s})},value:function(){return{angleDeg:this.refs.angleDeg.getValue(),center:[this.refs.centerX.getValue(),this.refs.centerY.getValue()]}},setInputValue:function(e,t,n){var s=Xg.first(e),i=Xg.clone(this.state.angleDeg),r=Xg.clone(this.state.center);"angleDeg"===s?i=t:"centerX"===s?r[0]=t:"centerY"===s&&(r[1]=t),this.setState({angleDeg:i,center:r},(()=>{this.props.onChange(n)}))},getInputPaths:function(){return[["centerX"],["centerY"],["angleDeg"]]}})},reflection:{verbName:i18n._("Reflect"),nounName:i18n._("Reflection"),lowerNounName:i18n._("reflection"),apply:function(e){return function(t){return pf.reflectOverLine(t,e.line)}},isValid:function(e){return Xg.all(Xg.flatten(e.line),Xg.isFinite)&&!pf.equal(e.line[0],e.line[1])},isEmpty:function(e){return Xg.all(Xg.flatten(e.line),Xg.isNull)},isNoOp:function(e){return!1},collapse:function(e,t){return!!df.equal(e.line,t.line)&&[]},toTeX:function(e){var t=e.line[0],n=e.line[1];return $_({point1:jf(t),point2:jf(n)},"Reflection over the line from %(point1)s to %(point2)s")},Input:createReactClass({displayName:"Input",getInitialState:function(){return{line:this.props.line||[[null,null],[null,null]]}},componentDidUpdate:function(e){of(this.props,e)||this.setState({line:this.props.line})},render:function(){const e=Of(this.props.apiOptions);var t=[Object($t.jsx)(tf,{children:"("}),Object($t.jsx)(e,{ref:"x1",value:this.state.line[0][0],useArrowKeys:!0,onChange:this.changePoint.bind(this,0,0),onFocus:Xg.partial(this.props.onFocus,"x1"),onBlur:Xg.partial(this.props.onBlur,"x1"),keypadElement:this.props.keypadElement}),Object($t.jsx)(tf,{children:", {}"}),Object($t.jsx)(e,{ref:"y1",value:this.state.line[0][1],useArrowKeys:!0,onChange:this.changePoint.bind(this,0,1),onFocus:Xg.partial(this.props.onFocus,"y1"),onBlur:Xg.partial(this.props.onBlur,"y1"),keypadElement:this.props.keypadElement}),Object($t.jsx)(tf,{children:")"})],n=[Object($t.jsx)(tf,{children:"("}),Object($t.jsx)(e,{ref:"x2",value:this.state.line[1][0],useArrowKeys:!0,onChange:this.changePoint.bind(this,1,0),onFocus:Xg.partial(this.props.onFocus,"x2"),onBlur:Xg.partial(this.props.onBlur,"x2"),keypadElement:this.props.keypadElement}),Object($t.jsx)(tf,{children:", {}"}),Object($t.jsx)(e,{ref:"y2",value:this.state.line[1][1],useArrowKeys:!0,onChange:this.changePoint.bind(this,1,1),onFocus:Xg.partial(this.props.onFocus,"y2"),onBlur:Xg.partial(this.props.onBlur,"y2"),keypadElement:this.props.keypadElement}),Object($t.jsx)(tf,{children:")"})];return Object($t.jsx)("div",{children:$_({point1:t,point2:n},"Reflection over the line from %(point1)s to %(point2)s")})},changePoint:function(e,t,n,s){var i=Xg.map(this.state.line,Xg.clone);i[e][t]=n,this.setState({line:i},(()=>{this.props.onChange(s)}))},value:function(){return{line:[[this.refs.x1.getValue(),this.refs.y1.getValue()],[this.refs.x2.getValue(),this.refs.y2.getValue()]]}},setInputValue:function(e,t,n){var s,i,r=Xg.first(e);"x"===r[0]?s=0:"y"===r[0]&&(s=1),"1"===r[1]?i=0:"2"===r[1]&&(i=1),this.changePoint(i,s,t,n)},getInputPaths:function(){return[["x1"],["y1"],["x2"],["y2"]]}})},dilation:{verbName:i18n._("Dilate"),nounName:i18n._("Dilation"),lowerNounName:i18n._("dilation"),apply:function(e){return function(t){return function(e,t,n){var s=hf.subtract(e,t),i=hf.scale(s,n);return hf.add(t,i)}(t,e.center,e.scale)}},isValid:function(e){return Xg.isFinite(e.scale)&&Xg.isFinite(e.center[0])&&Xg.isFinite(e.center[1])},isEmpty:function(e){return null===e.scale&&null===e.center[0]&&null===e.center[1]},isNoOp:function(e){return cf.equal(e.scale,1)},collapse:function(e,t){return!!pf.equal(e.center,t.center)&&{center:e.center,scale:e.scale*t.scale}},toTeX:function(e){var t=function(e){var t=gf.toFraction(e,cf.DEFAULT_TOLERANCE);return 1===t[1]?yf(e):yf(t[0])+"/"+yf(t[1])}(e.scale);return $_({scale:t,point:jf(e.center)},"Dilation of scale %(scale)s about %(point)s")},Input:createReactClass({displayName:"Input",getInitialState:function(){return{center:this.props.center||[null,null],scale:this.props.scale||null}},componentDidUpdate:function(e){of(this.props,e)||this.setState({center:this.props.center,scale:this.props.scale})},render:function(){const e=Of(this.props.apiOptions);var t=[Object($t.jsx)(tf,{children:"("}),Object($t.jsx)(e,{ref:"x",placeholder:0,value:this.state.center[0],useArrowKeys:!0,onChange:e=>{var t=this.state.center[1];this.setState({center:[e,t]},(()=>{this.props.onChange()}))},onFocus:Xg.partial(this.props.onFocus,"x"),onBlur:Xg.partial(this.props.onBlur,"x"),keypadElement:this.props.keypadElement}),Object($t.jsx)(tf,{children:", {}"}),Object($t.jsx)(e,{ref:"y",placeholder:0,value:this.state.center[1],useArrowKeys:!0,onChange:e=>{var t=this.state.center[0];this.setState({center:[t,e]},(()=>{this.props.onChange()}))},onFocus:Xg.partial(this.props.onFocus,"y"),onBlur:Xg.partial(this.props.onBlur,"y"),keypadElement:this.props.keypadElement}),Object($t.jsx)(tf,{children:")"})],n=Object($t.jsx)(e,{ref:"scale",placeholder:1,value:this.state.scale,useArrowKeys:!0,onChange:e=>{this.setState({scale:e},(()=>{this.props.onChange()}))},onFocus:Xg.partial(this.props.onFocus,"scale"),onBlur:Xg.partial(this.props.onBlur,"scale"),keypadElement:this.props.keypadElement});return Object($t.jsx)("div",{children:$_({point:t,scale:n},"Dilation about %(point)s by %(scale)s")})},value:function(){return{scale:this.refs.scale.getValue(),center:[this.refs.x.getValue(),this.refs.y.getValue()]}},setInputValue:function(e,t,n){var s=Xg.first(e),i=this.state.scale,r=Xg.clone(this.state.center);"x"===s?r[0]=t:"y"===s?r[1]=t:"scale"===s&&(i=t),this.setState({scale:i,center:r},(()=>{this.props.onChange(n)}))},getInputPaths:function(){return[["x"],["y"],["scale"]]}})}},kf={getPointCountForType:function(e){var t=e.split("-");return"polygon"===t[0]?t[1]||3:"line"===t[0]||"lineSegment"===t[0]?2:"angle"===t[0]?3:"circle"===t[0]?2:"point"===t[0]?1:void 0},addMovableShape:function(e,t){if(t.editable&&t.translatable)throw new Error("It doesn't make sense to have a movable shape where you can stretch the points and translate them simultaneously. options: "+JSON.stringify(t));var n,s=Xg.map(t.shape.coords,(function(i){var r,o=!1,a=i;return r=e.addMovablePoint({coord:i,normalStyle:t.normalPointStyle,highlightStyle:t.highlightPointStyle,constraints:{fixed:!t.translatable&&!t.editable},visible:t.showPoints,snapX:t.snap&&t.snap[0]||0,snapY:t.snap&&t.snap[1]||0,bounded:!1,onMove:function(e,i){o||(a=r.coord,o=!0);var l=hf.subtract([e,i],r.coord);t.onMove&&(l=t.onMove(l[0],l[1])),t.translatable&&Xg.each(s,(function(e){e!==r&&e.setCoord(hf.add(e.coord,l))}));var c=r.coord,h=hf.add(r.coord,l);return r.coord=h,n.update(),r.coord=c,h},onMoveEnd:function(){if(t.onMoveEnd&&o){o=!1;var e=hf.subtract(r.coord,a);t.onMoveEnd(e[0],e[1])}n.update()}}),r.bounded=!0,r})),i=(n=kf.addShape(e,t,s)).remove;return n.remove=function(){i.apply(n),Xg.invoke(s,"remove")},n},addShape:function(e,t,n){n=n||t.shape.coords;var s=kf._typesOf(t.shape),i=t.shape.options||kf.defaultOptions(s),r=kf._mapTypes(s,n,(function(n,s,r){var o=Xg.extend({},t,i[r]);return kf._addType(e,n,s,o)})),o=Xg.filter(Xg.pluck(r,"update"),Xg.identity),a=Xg.filter(Xg.pluck(r,"remove"),Xg.identity),l=function(){return Xg.map(r,(function(e){return e.getOptions?e.getOptions():{}}))};return{type:s,points:n,update:function(){Xg.invoke(o,"call")},remove:function(){Xg.invoke(a,"call")},toJSON:function(){var e=Xg.map(n,(function(e){return Xg.isArray(e)?e:e.coord}));return{type:s,coords:e,options:l()}},getOptions:l}},equal:function(e,t){var n=kf._typesOf(e),s=kf._typesOf(t);if(n.length!==s.length)return!1;var i=kf._mapTypes(n,e.coords,kf._combine),r=kf._mapTypes(s,t.coords,kf._combine);return Xg.all(Xg.map(i,(function(e,t){var n=r[t];return e.type===n.type&&kf._forType(e.type).equal(e.coords,n.coords)})))},_typesOf:function(e){var t=e.type;return Xg.isArray(t)||(t=[t]),Xg.map(t,(function(e){return"polygon"===e?"polygon-3":e}))},defaultOptions:function(e){return Xg.map(e,(function(e){var t=kf._forType(e).defaultOptions;return Xg.extend({},t)}))},_forType:function(e){var t=e.split("-")[0];return kf[t]},_mapTypes:function(e,t,n,s){return Xg.map(e,(function(e,i){var r=kf.getPointCountForType(e),o=Xg.first(t,r);return t=Xg.rest(t,r),n.call(s,e,o,i)}))},_addType:function(e,t,n,s){var i=Xg.isArray(n[0])?{coordA:n[0],coordZ:n[1]}:{pointA:n[0],pointZ:n[1]};if("polygon"===(t=t.split("-")[0])){var r=e.addMovablePolygon(Xg.extend({},s,{fixed:!s.editable,snapX:s.snap&&s.snap[0]||0,snapY:s.snap&&s.snap[1]||0,points:n,constrainToGraph:!1}));return{update:r.transform.bind(r),remove:r.remove.bind(r)}}if("line"===t||"lineSegment"===t){var o=e.addMovableLineSegment(Xg.extend({},s,i,{movePointsWithLine:!0,fixed:!0,constraints:{fixed:!0},extendLine:"line"===t}));return{update:o.transform.bind(o,!0),remove:o.remove.bind(o)}}if("angle"===t){var a=!!s.editable&&null,l=e.addMovableAngle({angleLabel:"$deg0",fixed:!0,points:n,normalStyle:s.normalStyle,reflex:s.reflex});return Xg.isArray(n[0])||s.editable||(n[0].remove(),n[2].remove()),{update:l.update.bind(l,a),remove:l.remove.bind(l),getOptions:function(){return{reflex:l.isReflex()}}}}if("circle"===t){var c={remove:Xg.identity},h=function(){var t=n[0].coord||n[0],i=n[1].coord||n[1],r=pf.distanceToPoint(t,i);c.remove(),c=e.circle(t,r,Xg.extend({stroke:ff.DYNAMIC,"stroke-width":2},s.normalStyle))};return h(),n[1].remove&&!s.editable&&n[1].remove(),{update:h,remove:function(){c.remove()}}}if("point"===t)return{update:null,remove:null};throw new Error("Invalid shape type "+t)},_combine:function(e,t){return{type:e,coords:t}},polygon:{equal:wf},line:{equal:df.equal},lineSegment:{equal:wf},angle:{equal:function(e,t){if(!pf.equal(e[1],t[1]))return!1;var n=[e[1],e[0]],s=[e[1],e[2]],i=[t[1],t[0]],r=[t[1],t[2]],o=uf.equal(n,i)&&uf.equal(s,r),a=uf.equal(n,r)&&uf.equal(s,i);return o||a},defaultOptions:{reflex:!1}},circle:{equal:function(e,t){var n=pf.distanceToPoint(e[0],e[1]),s=pf.distanceToPoint(t[0],t[1]);return pf.equal(e[0],t[0])&&cf.equal(n,s)}},point:{equal:pf.equal}},_f=Cf.ListItem,Tf=createReactClass({displayName:"TransformationList",render:function(){if("static"===this.props.mode)return Object($t.jsx)("span",{});var e=Xg.map(this.props.transformations,(function(e,t){return Object($t.jsx)(_f,{ref:"transformation"+t,transform:e,mode:this.props.mode,onChange:this.handleChange,onFocus:Xg.partial(this.props.onFocus,""+t),onBlur:Xg.partial(this.props.onBlur,""+t),keypadElement:this.props.keypadElement,apiOptions:this.props.apiOptions},"transformation"+t)}),this);return Object($t.jsx)("div",{className:"perseus-transformation-list",children:e})},_transformationRefs:function(){return Xg.times(this.props.transformations.length,(e=>this.refs["transformation"+e]))},value:function(){return Xg.invoke(this._transformationRefs(),"value")},handleChange:function(e,t){this.props.onChange(this.value(),t)},focusLast:function(){var e=this._transformationRefs();0!==e.length&&Xg.last(e).focus()}}),Mf=createReactClass({displayName:"ToolButton",render:function(){var e=this.props.toggled?"simple-button exercise-orange toggled highlighted-tool-button":"simple-button";return Object($t.jsx)("button",{type:"button",className:e,disabled:this.props.disabled,onClick:this.props.onClick,onTouchStart:lf,children:this.props.children})}}),Nf=createReactClass({displayName:"ToolsBar",getInitialState:function(){return{selected:null}},render:function(){var e=Xg.map(Sf,(function(e,t){if(this.props.enabled[t])return Object($t.jsx)(Mf,{disabled:this.props.apiOptions.readOnly,toggled:this.state.selected===t,onClick:this.changeSelected.bind(this,t),children:e.verbName},t)}),this);return Object($t.jsxs)("div",{className:"transformer-tools-bar",children:[Object($t.jsx)("span",{className:"simple-button-group",children:e}),Object($t.jsxs)("button",{className:"transformer-undo-button simple-button",type:"button",disabled:this.props.apiOptions.readOnly,onClick:this.props.onUndoClick,onTouchStart:lf,children:[Object($t.jsx)(Jg,{...Ta})," "+i18n._("Undo")]}),Object($t.jsx)("div",{className:"clear"})]})},changeSelected:function(e){this.props.removeTool(this.state.selected),e&&e!==this.state.selected?(this.props.addTool(e),this.setState({selected:e})):this.setState({selected:null})}}),Pf=createReactClass({displayName:"AddTransformBar",render:function(){var e=Xg.map(Sf,(function(e,t){if(this.props.enabled[t])return Object($t.jsxs)(Mf,{toggled:!1,disabled:this.props.apiOptions.readOnly,onClick:this.changeSelected.bind(this,t),children:[Object($t.jsx)(Jg,{...wa})," ",e.nounName]},t)}),this);return Object($t.jsxs)("div",{className:"transformer-tools-bar",children:[e,Object($t.jsxs)("button",{className:"transformer-undo-button simple-button",type:"button",onClick:this.props.onUndoClick,disabled:this.props.apiOptions.readOnly,onTouchStart:lf,children:[Object($t.jsx)(Jg,{...Ta})," "+i18n._("Undo")]}),Object($t.jsx)("div",{className:"clear"})]})},changeSelected:function(e){e&&this.props.addTool(e)}}),If=createReactClass({displayName:"Transformer",getDefaultProps:function(){return Xg.defaults({transformations:[]},vf)},render:function(){var e,t,n=Xg.extend(function(e,t){var n=(e=e||{}).labels||["x","y"],s=e.range||[[-10,10],[-10,10]],i=e.step||[1,1];return{box:[t,t],labels:n,range:s,step:i,gridStep:e.gridStep||af(s,i,t),valid:!0,backgroundImage:bf,markings:"grid",showProtractor:!1}}(this.props.graph,400),this.props.graph),s="interactive"===this.props.graphMode,i=s?Nf:Pf,r=Object($t.jsx)("div",{style:{width:n.box[0]},children:Object($t.jsx)(i,{ref:"toolsBar",enabled:(e=this.props.tools,t="enabled",Xg.object(Xg.map(e,(function(e,n){return[n,e[t]]})))),apiOptions:this.props.apiOptions,addTool:this.addTool,removeTool:this.removeTool,onUndoClick:this.handleUndoClick})});return Object($t.jsxs)("div",{className:"perseus-widget perseus-widget-transformer",children:[Object($t.jsx)(Zg,{ref:"graph",box:n.box,range:n.range,labels:n.labels,step:n.step,gridStep:n.gridStep,markings:n.markings,backgroundImage:n.backgroundImage,showProtractor:n.showProtractor,onGraphieUpdated:this.setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),!s&&"Add transformations below:","static"===this.props.graphMode&&[Object($t.jsx)("br",{},"static-br"),Object($t.jsxs)("em",{children:[" ","Note: For this question, the shape will not move."," "]},"static-nomove")],s&&r,Object($t.jsx)(Tf,{ref:"transformationList",mode:this.props.listMode,transformations:this.props.transformations,onChange:this.setTransformationProps,onFocus:this._handleFocus,onBlur:this._handleBlur,keypadElement:this.props.keypadElement,apiOptions:this.props.apiOptions}),!s&&r]})},componentDidMount:function(){this.setupGraphie(this.graphie())},componentDidUpdate:function(e){this.shouldSetupGraphie(this.props,e)?this.refs.graph.reset():of(this.props.transformations,this.transformations)||this.setTransformations(this.props.transformations)},shouldSetupGraphie:function(e,t){return!of(t.starting,e.starting)||(t.graphMode!==e.graphMode||(t.listMode!==e.listMode||(t.drawSolutionShape!==e.drawSolutionShape||(!(!e.drawSolutionShape||of(t.correct.shape,e.correct.shape))||!of(this.tools,e.tools)))))},graphie:function(){return this.refs.graph.graphie()},setupGraphie:function(e){this.props.drawSolutionShape&&this.props.correct.shape&&this.props.correct.shape.coords&&kf.addShape(e,{fixed:!0,shape:this.props.correct.shape,normalStyle:{stroke:ff.GRAY,"stroke-dasharray":"","stroke-width":2}}),this.currentTool=null,this.refs.toolsBar.changeSelected(null),this.addTransformerShape(this.props.starting.shape,!1),this.setTransformations(this.props.transformations),this.tools={translation:Xg.clone(this.props.tools.translation),rotation:Xg.clone(this.props.tools.rotation),reflection:Xg.clone(this.props.tools.reflection),dilation:Xg.clone(this.props.tools.dilation)}},setTransformations:function(e){this.resetCoords(),this.transformations=Xg.clone(e),Xg.each(this.transformations,this.applyTransform)},addTransformerShape:function(e,t){var n=this,s=this.graphie();this.shape=kf.addMovableShape(s,{shape:e,editable:!1,showPoints:"static"!==this.props.graphMode,translatable:t,onMove:function(e,t){return e=gf.roundToNearest(s.snap[0],e),t=gf.roundToNearest(s.snap[1],t),n.addTransform({type:"translation",vector:[e,t]}),[e,t]},normalPointStyle:{fill:t?ff.INTERACTIVE:ff.DYNAMIC,stroke:t?ff.INTERACTIVE:ff.DYNAMIC},highlightPointStyle:{fill:ff.INTERACTING,stroke:ff.INTERACTING}})},addTool:function(e){var t=this;if("interactive"===this.props.graphMode)if("translation"===e)this.currentTool=this.addTranslationTool();else if("rotation"===e)this.currentTool=this.addRotationTool();else if("reflection"===e)this.currentTool=this.addReflectionTool();else{if("dilation"!==e)throw new Error("Invalid tool id: "+e);this.currentTool=this.addDilationTool()}else{var n;if("translation"===e)n={type:e,vector:[null,null]};else if("rotation"===e)n={type:e,center:[null,null],angleDeg:null};else if("reflection"===e)n={type:e,line:[[null,null],[null,null]]};else{if("dilation"!==e)throw new Error("Invalid tool id: "+e);n={type:e,center:[null,null],scale:null}}this.doTransform(n,(function(){t.refs.transformationList.focusLast()}))}},removeTool:function(e){this.currentTool&&this.currentTool.remove(),this.currentTool=null},addTranslationTool:function(){var e=this;return this.shape.remove(),this.addTransformerShape(this.shape.toJSON(),!0),{remove:function(){e.shape.remove(),e.addTransformerShape(e.shape.toJSON(),!1)}}},snapCoord:function(e){var t=this.graphie();return Xg.map(e,(function(e,n){return gf.roundToNearest(t.snap[n],e)}))},normalizeReflectionCoords:function(e){var t=this.snapCoord(df.midpoint(e)),n=hf.polarDegFromCart(hf.subtract(e[0],e[1])),s=[1,gf.roundToNearest(45,n[1])],i=hf.cartFromPolarDeg(s);return Xg.map([-1,1],(function(e){var n=hf.add(t,hf.scale(i,e*this.scaleToCurrentRange(2)));return this.snapCoord(n)}),this)},addReflectionTool:function(){var e=this.props.tools.reflection;if(e.enabled){var t,n=this,s=this.refs.graph.graphie(),i=function(){n.changeTool("reflection",{coords:Xg.pluck(o,"coord")})},r=this.normalizeReflectionCoords(e.coords),o=Xg.map(r,(function(e){return s.addMovablePoint({coord:e,visible:!1})}),this),a=xf(e);s.style({},(function(){t=s.addMovableLineSegment({fixed:e.constraints.fixed,constraints:e.constraints,pointA:o[0],pointZ:o[1],snapX:s.snap[0],snapY:s.snap[1],extendLine:!0,normalStyle:{stroke:a,"stroke-width":2,"stroke-dasharray":"- "},highlightStyle:{stroke:ff.INTERACTING,"stroke-width":2,"stroke-dasharray":"- "},movePointsWithLine:!0,onMoveEnd:i})}));var l=s.addReflectButton({fixed:e.constraints.fixed,line:t,size:this.scaleToCurrentRange(1),onClick:function(){n.doTransform({type:"reflection",line:Xg.pluck(o,"coord")}),c&&(c.setCoord(hf.add(l.coord,hf.subtract(l.coord,c.coord))),c.update())},normalStyle:{stroke:a,"stroke-width":2,fill:a},highlightStyle:{stroke:ff.INTERACTING,"stroke-width":3,fill:ff.INTERACTING},onMoveEnd:i}),c=null;if(!e.constraints.fixed){var h=hf.polarDegFromCart(hf.subtract(o[1].coord,o[0].coord))[1]+90;c=s.addRotateHandle({center:l,radius:this.scaleToCurrentRange(2),angleDeg:h,width:this.scaleToCurrentRange(.24),hoverWidth:this.scaleToCurrentRange(.4),lengthAngle:17,onMove:function(e){return gf.roundToNearest(45,e)},onMoveEnd:i})}return $(t).on("move",(function(){l.update(),$(l).trigger("move")})),c&&$(c).on("move",(function(){var e=n.snapCoord(c.coord),s=hf.subtract(e,l.coord),i=l.isFlipped()?1:0;o[i].setCoord(hf.add(l.coord,hf.rotateDeg(s,90))),o[1-i].setCoord(hf.add(l.coord,hf.rotateDeg(s,-90))),t.transform(!0),l.update()})),{remove:function(){l.remove(),c&&c.remove(),t.remove(),o[0].remove(),o[1].remove()}}}},scaleToCurrentRange:function(e){return function(e,t){var n=t[0][1]-t[0][0],s=t[1][1]-t[1][0];return e*Math.max(n,s)/20}(e,this.refs.graph.props.range)},addRotationTool:function(){var e=this.props.tools.rotation;if(e.enabled){var t=this,n=this.refs.graph.graphie(),s=xf(e);return this.rotatePoint=n.addMovablePoint({constraints:e.constraints,coord:e.coord,snapX:n.snap[0],snapY:n.snap[1],normalStyle:{"stroke-dasharray":"",stroke:s,fill:s},highlightStyle:{"stroke-dasharray":"",stroke:ff.INTERACTING,fill:ff.INTERACTING}}),this.rotateHandle=n.addRotateHandle({center:this.rotatePoint,radius:this.scaleToCurrentRange(1.5),width:this.scaleToCurrentRange(.24),hoverWidth:this.scaleToCurrentRange(.4),onMove:function(e,n){var s=t.getRotationTransformFromAngle(t.rotatePoint.coord,e-n);return t.doTransform(s),n+s.angleDeg}}),this.rotatePoint.onMoveEnd=function(e,n){t.changeTool("rotation",{coord:[e,n]})},{remove:function(){t.rotateHandle.remove(),t.rotatePoint.remove()}}}},addDilationTool:function(){var e=this.props.tools.dilation;if(e.enabled){var t=this,n=this.refs.graph.graphie(),s=xf(e);t.dilationCircle=n.addCircleGraph({centerConstraints:e.constraints,center:e.coord,radius:t.scaleToCurrentRange(2),snapX:n.snap[0],snapY:n.snap[1],minRadius:t.scaleToCurrentRange(1),snapRadius:t.scaleToCurrentRange(.5),onResize:function(e,n){t.doTransform({type:"dilation",center:t.dilationCircle.centerPoint.coord,scale:e/n})},circleNormalStyle:{stroke:s,"stroke-width":2,"stroke-dasharray":"- ","fill-opacity":0},circleHighlightStyle:{stroke:ff.INTERACTING,"stroke-width":2,"stroke-dasharray":"",fill:ff.INTERACTING,"fill-opacity":.05},centerNormalStyle:{stroke:s,fill:s,"stroke-width":2,"stroke-dasharray":""},centerHighlightStyle:{stroke:s,fill:s,"stroke-width":2,"stroke-dasharray":""}});var i=this.dilationCircle.centerPoint.onMoveEnd;return this.dilationCircle.centerPoint.onMoveEnd=function(){i&&i.apply(this,Xg.toArray(arguments)),t.changeTool("dilation",{coord:t.dilationCircle.centerPoint.coord})},{remove:function(){t.dilationCircle.remove()}}}},getRotationTransformFromAngle:function(e,t){return(t=(t+360)%360)>180&&(t-=360),{type:"rotation",center:e,angleDeg:15*Math.round(t/15)}},doTransform:function(e,t){this.applyTransform(e),this.addTransform(e,t)},applyTransform:function(e){if("static"!==this.props.graphMode){var t=Cf.apply(e);this.applyCoordTransformation(t)}},applyCoordTransformation:function(e){Xg.each(this.shape.points,(function(t){var n=e(t.coord);t.setCoord(n)})),this.shape.update()},resetCoords:function(){var e=this.props.starting.shape.coords;Xg.each(this.shape.points,(function(t,n){t.setCoord(e[n])})),this.shape.update()},handleUndoClick:function(){this.refs.toolsBar.changeSelected(null),this.props.transformations.length&&this.props.onChange({transformations:Xg.initial(this.props.transformations)})},setTransformationProps:function(e,t){this.props.onChange({transformations:e},t)},addTransform:function(e,t){this.transformations=Cf.append(this.transformations,e),this.props.onChange({transformations:Xg.clone(this.transformations)},t)},changeTool:function(e,t){var n=Xg.clone(this.props.tools);n[e]=Xg.extend({},this.props.tools[e],t),this.tools[e]=Xg.clone(n[e]),this.props.onChange({tools:n}),this.props.trackInteraction()},simpleValidate:function(e){return If.validate(this.getUserInput(),e)},getCoords:function(){var e=this.props.starting.shape.coords,t=this.props.transformations;return Xg.reduce(t,(function(e,t){return Xg.map(e,Cf.apply(t))}),e)},getEditorJSON:function(){var e=Xg.pick(this.props,"grading","starting","graphMode","listMode","tools","drawSolutionShape","gradeEmpty");return e.graph=this.refs.graph.toJSON(),e.version=1.2,e.answer=this.getUserInput(),e},getUserInput:function(){return{transformations:this.props.transformations,shape:{type:this.shape.type,coords:this.getCoords(),options:this.shape.getOptions()}}},_handleFocus:function(){var e=Array.prototype.slice.call(arguments);this.props.onFocus(e)},_handleBlur:function(){var e=Array.prototype.slice.call(arguments);this.props.onBlur(e)},_getTransformationForID:function(e){var t=["transformationList","transformation"+e],n=this;return Xg.each(t,(e=>{n=n.refs[e]})),n},getInputPaths:function(){if("static"===this.props.listMode)return[];var e=[];return Xg.each(this.props.transformations,((t,n)=>{var s=this._getTransformationForID(n).getInputPaths(),i=Xg.map(s,(e=>[""+n].concat(e)));e=e.concat(i)})),e},_passToInner:function(e,t){if(t&&t.length){var n=[Xg.rest(t)].concat(Xg.rest(arguments,2)),s=Xg.head(t),i=this._getTransformationForID(s);return i[e].apply(i,n)}},focus:function(){var e=this.getInputPaths();return e.length>0&&(this.focusInputPath(e[0]),!0)},focusInputPath:function(e){return 0!==e.length&&(mf(e.length>=2),this._passToInner("focusInputPath",e))},blurInputPath:function(e){return 0!==e.length&&(mf(e.length>=2),this._passToInner("blurInputPath",e))},setInputValue:function(e,t,n){return mf(e.length>=2),this._passToInner("setInputValue",e,t,n)},getDOMNodeForPath:function(e){return mf(e.length>=2),this._passToInner("getDOMNodeForPath",e)},getGrammarTypeForPath:function(e){return mf(e.length>=2),this._passToInner("getGrammarTypeForPath",e)}});Xg.extend(If,{validate:function(e,t){for(var n in Sf){if(t.tools[n].required)if(!Xg.any(Xg.map(e.transformations,(function(e){return e.type===n&&!Cf.isEmpty(e)&&!Cf.isNoOp(e)}))))return{type:"invalid",message:i18n._("Your transformation must use a %(type)s.",{type:Sf[n].lowerNounName})}}return kf.equal(e.shape,t.correct.shape)?{type:"points",earned:1,total:1,message:null}:!t.gradeEmpty&&of(e.shape.coords,t.starting.shape.coords)?{type:"invalid",message:i18n._("Use the interactive graph to define a correct transformation.")}:{type:"points",earned:0,total:1,message:null}}}),Yg.exports={name:"transformer",displayName:"Transformer",widget:If};var Ef=Yg.exports,Af={exports:{}};Af.exports;h.a;const Rf=x.b,Df=createReactClass({displayName:"PropCheckBox",DEFAULT_PROPS:{label:null,onChange:null,labelAlignment:"left"},getDefaultProps:function(){return this.DEFAULT_PROPS},propName:function(){const e=Rf.find(Rf.keys(this.props),(function(e){return!Rf.has(this.DEFAULT_PROPS,e)}),this);if(!e)throw new Error("Attempted to create a PropCheckBox with no prop!");return e},_labelAlignLeft:function(){return"left"===this.props.labelAlignment},render:function(){const e=this.propName();return Object($t.jsxs)("label",{children:[this._labelAlignLeft()&&this.props.label,Object($t.jsx)("input",{type:"checkbox",checked:this.props[e],onChange:this.toggle}),!this._labelAlignLeft()&&this.props.label]})},toggle:function(){const e=this.propName(),t={};t[e]=!this.props[e],this.props.onChange(t)}});Af.exports=Df;var Lf=Af.exports,Ff={exports:{}};Ff.exports;h.a;const zf=Gd,qf=()=>!0,Wf=createReactClass({displayName:"RangeInput",getDefaultProps:function(){return{placeholder:[null,null]}},render:function(){const e=this.props.value,t=this.props.checkValidity||qf;return Object($t.jsxs)("div",{className:"range-input",children:[Object($t.jsx)(zf,{...this.props,value:e[0],checkValidity:n=>t([n,e[1]]),onChange:this.onChange.bind(this,0),placeholder:this.props.placeholder[0]}),Object($t.jsx)(zf,{...this.props,value:e[1],checkValidity:n=>t([e[0],n]),onChange:this.onChange.bind(this,1),placeholder:this.props.placeholder[1]})]})},onChange:function(e,t){const n=this.props.value;0===e?this.props.onChange([t,n[1]]):this.props.onChange([n[0],t])}});Ff.exports=Wf;var Bf=Ff.exports,Vf=n(19),Hf={exports:{}};Hf.exports;h.a;const Uf=i.a,Gf=x.b,$f=mu,Yf=Vf.a,Kf=cd,Xf=Lf,Zf=Bf,Jf=Ln.a,Qf=ce,em=Z,tm={url:null,width:0,height:0};const nm=createReactClass({displayName:"GraphSettings",getDefaultProps:function(){return{editableSettings:["graph","snap","image","measure"],box:[Sn,Sn],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],snapStep:[1,1],valid:!0,backgroundImage:tm,markings:"graph",showProtractor:!1,showRuler:!1,showTooltips:!1,rulerLabel:"",rulerTicks:10}},getInitialState:function(){return this.stateFromProps(this.props)},componentDidMount:function(){this.changeGraph=Gf.debounce(this.changeGraph,300)},componentWillReceiveProps:function(e){Gf.isEqual(this.props.labels,e.labels)&&Gf.isEqual(this.props.gridStep,e.gridStep)&&Gf.isEqual(this.props.snapStep,e.snapStep)&&Gf.isEqual(this.props.step,e.step)&&Gf.isEqual(this.props.range,e.range)&&Gf.isEqual(this.props.backgroundImage,e.backgroundImage)||this.setState(this.stateFromProps(e))},stateFromProps:function(e){return{labelsTextbox:e.labels,gridStepTextbox:e.gridStep,snapStepTextbox:e.snapStep,stepTextbox:e.step,rangeTextbox:e.range,backgroundImage:Gf.clone(e.backgroundImage)}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return $f.change.apply(this,t)},changeRulerLabel:function(e){this.change({rulerLabel:e.target.value})},changeRulerTicks:function(e){this.change({rulerTicks:+e.target.value})},changeBackgroundUrl:function(e){if("keypress"===e.type&&"Enter"!==e.key)return;const t=(e,t,n)=>{const s=Gf.clone(this.props.backgroundImage);s.url=e,s.width=t,s.height=n,this.setState({backgroundImage:s},this.changeGraph)},n=Uf.findDOMNode(this.refs["bg-url"]).value;n?Qf.getImageSize(n,((e,s)=>{this.isMounted()&&t(n,e,s)})):t(null,0,0)},renderLabelChoices:function(e){return Gf.map(e,(function(e){return Object($t.jsx)("option",{value:e[1],children:e[0]})}))},validRange:function(e){return Gf.every(e,(function(e){return Gf.isFinite(e)}))?!(e[0]>=e[1])||"Range must have a higher number on the right":"Range must be a valid number"},validateStepValue:function(e){const{step:t,range:n,name:s,minTicks:i,maxTicks:r}=e;if(!Gf.isFinite(t))return s+" must be a valid number";const o=function(e,t){return Math.floor((e[1]-e[0])/t)}(n,t);return o<i?s+" is too large, there must be at least "+i+" ticks.":!(o>r)||s+" is too small, there can be at most "+r+" ticks."},validSnapStep:function(e,t){return this.validateStepValue({step:e,range:t,name:"Snap step",minTicks:5,maxTicks:60})},validGridStep:function(e,t){return this.validateStepValue({step:e,range:t,name:"Grid step",minTicks:3,maxTicks:60})},validStep:function(e,t){return this.validateStepValue({step:e,range:t,name:"Step",minTicks:3,maxTicks:20})},validBackgroundImageSize:function(e){if(!e.url)return!0;return!!(e.width<=450&&e.height<=450)||"Image must be smaller than 450px x 450px."},validateGraphSettings:function(e,t,n,s,i){const r=this;let o;const a=Gf.every(e,(function(e){return o=r.validRange(e),!0===o}));if(!a)return o;const l=Gf.every(t,(function(t,n){return o=r.validStep(t,e[n]),!0===o}));if(!l)return o;const c=Gf.every(n,(function(t,n){return o=r.validGridStep(t,e[n]),!0===o}));if(!c)return o;const h=Gf.every(s,(function(t,n){return o=r.validSnapStep(t,e[n]),!0===o}));if(!h)return o;const p=this.validBackgroundImageSize(i);return!0===p||(o=p,o)},changeLabel:function(e,t){const n=t.target.value,s=this.state.labelsTextbox.slice();s[e]=n,this.setState({labelsTextbox:s},this.changeGraph)},changeRange:function(e,t){const n=this.state.rangeTextbox.slice();n[e]=t;const s=this.state.stepTextbox.slice(),i=this.state.gridStepTextbox.slice(),r=this.state.snapStepTextbox.slice(),o=Qf.scaleFromExtent(n[e],this.props.box[e]);!0===this.validRange(n[e])&&(s[e]=Qf.tickStepFromExtent(n[e],this.props.box[e]),i[e]=Qf.gridStepFromTickStep(s[e],o),r[e]=i[e]/2),this.setState({stepTextbox:s,gridStepTextbox:i,snapStepTextbox:r,rangeTextbox:n},this.changeGraph)},changeStep:function(e){this.setState({stepTextbox:e},this.changeGraph)},changeSnapStep:function(e){this.setState({snapStepTextbox:e},this.changeGraph)},changeGridStep:function(e){this.setState({gridStepTextbox:e,snapStepTextbox:Gf.map(e,(function(e){return e/2}))},this.changeGraph)},changeGraph:function(){const e=this.state.labelsTextbox,t=Gf.map(this.state.rangeTextbox,(function(e){return Gf.map(e,Number)})),n=Gf.map(this.state.stepTextbox,Number),s=this.state.gridStepTextbox,i=this.state.snapStepTextbox,r=this.state.backgroundImage,o=this.validateGraphSettings(t,n,s,i,r);!0===o?this.change({valid:!0,labels:e,range:t,step:n,gridStep:s,snapStep:i,backgroundImage:r}):this.change({valid:o})},render:function(){const e=[em.roundTo(2,Qf.scaleFromExtent(this.props.range[0],this.props.box[0])),em.roundTo(2,Qf.scaleFromExtent(this.props.range[1],this.props.box[1]))];return Object($t.jsxs)("div",{children:[Gf.contains(this.props.editableSettings,"canvas")&&Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Canvas size (x,y pixels)",Object($t.jsx)(Zf,{value:this.props.box,onChange:e=>{this.change({box:e})}})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Scale (px per div):"," ",Object($t.jsx)(Jf,{children:"("+e[0]+", "+e[1]+")"})]})]}),Gf.contains(this.props.editableSettings,"graph")&&Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:[" ","x Label",Object($t.jsx)("input",{type:"text",className:"graph-settings-axis-label",ref:"labels-0",onChange:e=>this.changeLabel(0,e),value:this.state.labelsTextbox[0]})]}),Object($t.jsxs)("div",{className:"perseus-widget-right-col",children:["y Label",Object($t.jsx)("input",{type:"text",className:"graph-settings-axis-label",ref:"labels-1",onChange:e=>this.changeLabel(1,e),value:this.state.labelsTextbox[1]})]})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["x Range",Object($t.jsx)(Zf,{value:this.state.rangeTextbox[0],onChange:e=>this.changeRange(0,e)})]}),Object($t.jsxs)("div",{className:"perseus-widget-right-col",children:["y Range",Object($t.jsx)(Zf,{value:this.state.rangeTextbox[1],onChange:e=>this.changeRange(1,e)})]})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["Tick Step",Object($t.jsx)(Zf,{value:this.state.stepTextbox,onChange:this.changeStep})]}),Object($t.jsxs)("div",{className:"perseus-widget-right-col",children:["Grid Step",Object($t.jsx)(Zf,{value:this.state.gridStepTextbox,onChange:this.changeGridStep})]})]}),Gf.contains(this.props.editableSettings,"snap")&&Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["Snap Step",Object($t.jsx)(Zf,{value:this.state.snapStepTextbox,onChange:this.changeSnapStep})]})}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("label",{children:"Markings: "}),Object($t.jsx)(Yf,{value:this.props.markings,allowEmpty:!1,buttons:[{value:"graph",content:"Graph"},{value:"grid",content:"Grid"},{value:"none",content:"None"}],onChange:this.change("markings")})]}),Object($t.jsx)("div",{className:"perseus-widget-left-col",children:Object($t.jsx)(Xf,{label:"Show tooltips",showTooltips:this.props.showTooltips,onChange:this.change})})]}),Gf.contains(this.props.editableSettings,"image")&&Object($t.jsxs)("div",{className:"image-settings",children:[Object($t.jsx)("div",{children:"Background image:"}),Object($t.jsxs)("div",{children:["Url:"," ",Object($t.jsx)("input",{type:"text",className:"graph-settings-background-url",ref:"bg-url",value:this.state.backgroundImage.url,onChange:e=>{const t=Gf.clone(this.props.backgroundImage);t.url=e.target.value,this.setState({backgroundImage:t})},onKeyPress:this.changeBackgroundUrl,onBlur:this.changeBackgroundUrl}),Object($t.jsx)(Kf,{children:Object($t.jsx)("p",{children:'Create an image in graphie, or use the "Add image" function to create a background.'})})]})]}),Gf.contains(this.props.editableSettings,"measure")&&Object($t.jsxs)("div",{className:"misc-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("div",{className:"perseus-widget-left-col",children:Object($t.jsx)(Xf,{label:"Show ruler",showRuler:this.props.showRuler,onChange:this.change})}),Object($t.jsx)("div",{className:"perseus-widget-right-col",children:Object($t.jsx)(Xf,{label:"Show protractor",showProtractor:this.props.showProtractor,onChange:this.change})})]}),this.props.showRuler&&Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[" ","Ruler label:"," ",Object($t.jsxs)("select",{onChange:this.changeRulerLabel,value:this.props.rulerLabel,children:[Object($t.jsx)("option",{value:"",children:"None"}),Object($t.jsx)("optgroup",{label:"Metric",children:this.renderLabelChoices([["milimeters","mm"],["centimeters","cm"],["meters","m"],["kilometers","km"]])}),Object($t.jsx)("optgroup",{label:"Imperial",children:this.renderLabelChoices([["inches","in"],["feet","ft"],["yards","yd"],["miles","mi"]])})]})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[" ","Ruler ticks:"," ",Object($t.jsx)("select",{onChange:this.changeRulerTicks,value:this.props.rulerTicks,children:Gf.map([1,2,4,8,10,16],(function(e){return Object($t.jsx)("option",{value:e,children:e})}))})]})})]})]})]})}});Hf.exports=nm;var sm=Hf.exports,im={exports:{}};im.exports;h.a;const rm=x.b,om=Is.Options,am=$g,lm=sm,cm=cd,hm=Lf,pm=Ef.widget,um=ce.deepEq,dm=ce.getGridStep,gm=G.a.line,fm=G.a.number,mm=G.a.point,bm=G.a.ray,vm=G.a.vector,xm=Di;var ym={url:null};function jm(e,t){return e=rm.clone(e).sort(mm.compare),t=rm.clone(t).sort(mm.compare),rm.all(rm.map(e,(function(e,n){var s=t[n];return mm.equal(e,s)})))}var wm={apiOptions:om.defaults,gradeEmpty:!1,graphMode:"interactive",listMode:"dynamic",graph:{},tools:{translation:{enabled:!0,required:!1,constraints:{}},rotation:{enabled:!0,required:!1,constraints:{fixed:!1},coord:[1,6]},reflection:{enabled:!0,required:!1,constraints:{fixed:!1},coords:[[2,-4],[2,2]]},dilation:{enabled:!0,required:!1,constraints:{fixed:!1},coord:[6,6]}},drawSolutionShape:!0,starting:{shape:{type:"polygon-3",coords:[[2,2],[2,6],[7,2]]},transformations:[]},correct:{shape:{type:"polygon-3",coords:[[2,2],[2,6],[7,2]]},transformations:[]}};const Om=createReactClass({displayName:"ToolSettings",getDefaultProps:function(){return{allowFixed:!0}},render:function(){return Object($t.jsxs)("div",{children:[this.props.name,": "," ",Object($t.jsx)(hm,{label:"enabled:",enabled:this.props.settings.enabled,onChange:this.props.onChange})," ",this.props.settings.enabled&&Object($t.jsx)(hm,{label:"required:",required:this.props.settings.required,onChange:this.props.onChange}),this.props.settings.enabled&&Object($t.jsx)(cm,{children:"'Required' will only grade the answer as correct if the student has used at least one such transformation."})," ",this.props.allowFixed&&this.props.settings.enabled&&Object($t.jsx)(hm,{label:"fixed:",fixed:this.props.settings.constraints.fixed,onChange:this.changeConstraints}),this.props.allowFixed&&this.props.settings.enabled&&Object($t.jsx)(cm,{children:"Enable 'fixed' to prevent the student from repositioning the tool. The tool will appear in the position at which it is placed in the editor below."})]})},changeConstraints:function(e){var t=rm.extend({},this.props.constraints,e);this.props.onChange({constraints:t})}});var Cm=createReactClass({displayName:"TransformationExplorerSettings",render:function(){return Object($t.jsxs)("div",{className:"transformer-settings",children:[Object($t.jsxs)("div",{children:[" ","Mode:"," ",Object($t.jsxs)("select",{value:this.getMode(),onChange:this.changeMode,children:[Object($t.jsxs)("option",{value:"interactive,dynamic",children:[" ","Exploration with text"," "]}),Object($t.jsxs)("option",{value:"interactive,static",children:[" ","Exploration without text"," "]}),Object($t.jsxs)("option",{value:"dynamic,interactive",children:[" ","Formal with movement"," "]}),Object($t.jsxs)("option",{value:"static,interactive",children:[" ","Formal without movement"," "]})]}),Object($t.jsx)(cm,{children:Object($t.jsxs)("ul",{children:[Object($t.jsxs)("li",{children:[Object($t.jsx)("b",{children:"Exploration:"})," Students create transformations with tools on the graph."," "]}),Object($t.jsxs)("li",{children:[Object($t.jsx)("b",{children:"Formal with movement:"})," Students specify transformations mathematically in the transformation list. Graph shows the results of these transformations."," "]}),Object($t.jsxs)("li",{children:[Object($t.jsx)("b",{children:"Formal without movement:"})," Students specify transformations mathematically in the transformation list. Graph does not update."," "]})]})})]}),Object($t.jsx)(Om,{name:"Translations",settings:this.props.tools.translation,allowFixed:!1,onChange:this.changeHandlerFor("translation")}),Object($t.jsx)(Om,{name:"Rotations",settings:this.props.tools.rotation,onChange:this.changeHandlerFor("rotation")}),Object($t.jsx)(Om,{name:"Reflections",settings:this.props.tools.reflection,onChange:this.changeHandlerFor("reflection")}),Object($t.jsx)(Om,{name:"Dilations",settings:this.props.tools.dilation,onChange:this.changeHandlerFor("dilation")}),Object($t.jsx)(hm,{label:"Draw Solution:",drawSolutionShape:this.props.drawSolutionShape,onChange:this.props.onChange})]})},getMode:function(){return this.props.graphMode+","+this.props.listMode},changeMode:function(e){var t=e.target.value.split(",");this.props.onChange({graphMode:t[0],listMode:t[1]})},changeHandlerFor:function(e){return t=>{var n=rm.clone(this.props.tools);n[e]=rm.extend({},this.props.tools[e],t),this.props.onChange({tools:n})}}}),Sm={getPointCountForType:function(e){var t=e.split("-");return"polygon"===t[0]?t[1]||3:"line"===t[0]||"lineSegment"===t[0]?2:"angle"===t[0]?3:"circle"===t[0]?2:"point"===t[0]?1:void 0},addMovableShape:function(e,t){if(t.editable&&t.translatable)throw new Error("It doesn't make sense to have a movable shape where you can stretch the points and translate them simultaneously. options: "+JSON.stringify(t));var n,s=rm.map(t.shape.coords,(function(i){var r,o=!1,a=i;return r=e.addMovablePoint({coord:i,normalStyle:t.normalPointStyle,highlightStyle:t.highlightPointStyle,constraints:{fixed:!t.translatable&&!t.editable},visible:t.showPoints,snapX:t.snap&&t.snap[0]||0,snapY:t.snap&&t.snap[1]||0,bounded:!1,onMove:function(e,i){o||(a=r.coord,o=!0);var l=vm.subtract([e,i],r.coord);t.onMove&&(l=t.onMove(l[0],l[1])),t.translatable&&rm.each(s,(function(e){e!==r&&e.setCoord(vm.add(e.coord,l))}));var c=r.coord,h=vm.add(r.coord,l);return r.coord=h,n.update(),r.coord=c,h},onMoveEnd:function(){if(t.onMoveEnd&&o){o=!1;var e=vm.subtract(r.coord,a);t.onMoveEnd(e[0],e[1])}n.update()}}),r.bounded=!0,r})),i=(n=Sm.addShape(e,t,s)).remove;return n.remove=function(){i.apply(n),rm.invoke(s,"remove")},n},addShape:function(e,t,n){n=n||t.shape.coords;var s=Sm._typesOf(t.shape),i=t.shape.options||Sm.defaultOptions(s),r=Sm._mapTypes(s,n,(function(n,s,r){var o=rm.extend({},t,i[r]);return Sm._addType(e,n,s,o)})),o=rm.filter(rm.pluck(r,"update"),rm.identity),a=rm.filter(rm.pluck(r,"remove"),rm.identity),l=function(){return rm.map(r,(function(e){return e.getOptions?e.getOptions():{}}))};return{type:s,points:n,update:function(){rm.invoke(o,"call")},remove:function(){rm.invoke(a,"call")},toJSON:function(){var e=rm.map(n,(function(e){return rm.isArray(e)?e:e.coord}));return{type:s,coords:e,options:l()}},getOptions:l}},equal:function(e,t){var n=Sm._typesOf(e),s=Sm._typesOf(t);if(n.length!==s.length)return!1;var i=Sm._mapTypes(n,e.coords,Sm._combine),r=Sm._mapTypes(s,t.coords,Sm._combine);return rm.all(rm.map(i,(function(e,t){var n=r[t];return e.type===n.type&&Sm._forType(e.type).equal(e.coords,n.coords)})))},_typesOf:function(e){var t=e.type;return rm.isArray(t)||(t=[t]),rm.map(t,(function(e){return"polygon"===e?"polygon-3":e}))},defaultOptions:function(e){return rm.map(e,(function(e){var t=Sm._forType(e).defaultOptions;return rm.extend({},t)}))},_forType:function(e){var t=e.split("-")[0];return Sm[t]},_mapTypes:function(e,t,n,s){return rm.map(e,(function(e,i){var r=Sm.getPointCountForType(e),o=rm.first(t,r);return t=rm.rest(t,r),n.call(s,e,o,i)}))},_addType:function(e,t,n,s){var i=rm.isArray(n[0])?{coordA:n[0],coordZ:n[1]}:{pointA:n[0],pointZ:n[1]};if("polygon"===(t=t.split("-")[0])){var r=e.addMovablePolygon(rm.extend({},s,{fixed:!s.editable,snapX:s.snap&&s.snap[0]||0,snapY:s.snap&&s.snap[1]||0,points:n,constrainToGraph:!1}));return{update:r.transform.bind(r),remove:r.remove.bind(r)}}if("line"===t||"lineSegment"===t){var o=e.addMovableLineSegment(rm.extend({},s,i,{movePointsWithLine:!0,fixed:!0,constraints:{fixed:!0},extendLine:"line"===t}));return{update:o.transform.bind(o,!0),remove:o.remove.bind(o)}}if("angle"===t){var a=!!s.editable&&null,l=e.addMovableAngle({angleLabel:"$deg0",fixed:!0,points:n,normalStyle:s.normalStyle,reflex:s.reflex});return rm.isArray(n[0])||s.editable||(n[0].remove(),n[2].remove()),{update:l.update.bind(l,a),remove:l.remove.bind(l),getOptions:function(){return{reflex:l.isReflex()}}}}if("circle"===t){var c={remove:rm.identity},h=function(){var t=n[0].coord||n[0],i=n[1].coord||n[1],r=mm.distanceToPoint(t,i);c.remove(),c=e.circle(t,r,rm.extend({stroke:xm.DYNAMIC,"stroke-width":2},s.normalStyle))};return h(),n[1].remove&&!s.editable&&n[1].remove(),{update:h,remove:function(){c.remove()}}}if("point"===t)return{update:null,remove:null};throw new Error("Invalid shape type "+t)},_combine:function(e,t){return{type:e,coords:t}},polygon:{equal:jm},line:{equal:gm.equal},lineSegment:{equal:jm},angle:{equal:function(e,t){if(!mm.equal(e[1],t[1]))return!1;var n=[e[1],e[0]],s=[e[1],e[2]],i=[t[1],t[0]],r=[t[1],t[2]],o=bm.equal(n,i)&&bm.equal(s,r),a=bm.equal(n,r)&&bm.equal(s,i);return o||a},defaultOptions:{reflex:!1}},circle:{equal:function(e,t){var n=mm.distanceToPoint(e[0],e[1]),s=mm.distanceToPoint(t[0],t[1]);return mm.equal(e[0],t[0])&&fm.equal(n,s)}},point:{equal:mm.equal}},km=createReactClass({displayName:"TransformationsShapeEditor",render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsx)(am,{ref:"graph",box:this.props.graph.box,range:this.props.graph.range,labels:this.props.graph.labels,step:this.props.graph.step,gridStep:this.props.graph.gridStep,markings:this.props.graph.markings,backgroundImage:this.props.graph.backgroundImage,onGraphieUpdated:this.setupGraphie}),Object($t.jsxs)("select",{value:this.getTypeString(this.props.shape.type),onChange:this.changeType,children:[Object($t.jsx)("option",{value:"polygon-3",children:"Triangle"}),Object($t.jsx)("option",{value:"polygon-4",children:"Quadrilateral"}),Object($t.jsx)("option",{value:"polygon-5",children:"Pentagon"}),Object($t.jsx)("option",{value:"polygon-6",children:"Hexagon"}),Object($t.jsx)("option",{value:"line",children:"Line"}),Object($t.jsx)("option",{value:"line,line",children:"2 lines"}),Object($t.jsx)("option",{value:"lineSegment",children:"Line segment"}),Object($t.jsxs)("option",{value:"lineSegment,lineSegment",children:[" ","2 line segments"," "]}),Object($t.jsx)("option",{value:"angle",children:"Angle"}),Object($t.jsx)("option",{value:"circle",children:"Circle"})]},"type-select")]})},getTypeString:function(e){return rm.isArray(e)?rm.map(e,this.getTypeString).join(","):"polygon"===e?"polygon-"+this.props.shape.coords.length:e},changeType:function(e){var t,n=String(e.target.value).split(","),s=(t=rm.map(n,Sm.getPointCountForType),rm.reduce(t,(function(e,t){return e+t}),0)),i=function(e,t){var n=t[0][1]-t[0][0],s=t[1][1]-t[1][0];return e*Math.max(n,s)/20}(4,this.refs.graph.props.range),r=180*(.5-1/s),o=rm.times(s,(function(e){return mm.rotateDeg([i,0],360*e/s+r)}));this.props.onChange({shape:{type:n,coords:o,options:Sm.defaultOptions(n)}})},componentDidMount:function(){this.setupGraphie(this.refs.graph.graphie())},componentDidUpdate:function(e){um(e.shape,this.props.shape)||this.refs.graph.reset()},updateCoords:function(){this.props.onChange({shape:this.shape.toJSON()})},setupGraphie:function(e){this.shape=Sm.addMovableShape(e,{editable:!0,snap:e.snap,shape:this.props.shape,onMoveEnd:this.updateCoords})}}),_m=createReactClass({displayName:"TransformerEditor",getDefaultProps:function(){return wm},render:function(){var e=rm.extend(function(e,t){var n=(e=e||{}).labels||["x","y"],s=e.range||[[-10,10],[-10,10]],i=e.step||[1,1];return{box:[t,t],labels:n,range:s,step:i,gridStep:e.gridStep||dm(s,i,t),valid:!0,backgroundImage:ym,markings:"grid",showProtractor:!1}}(this.props.graph,340),this.props.graph);return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{children:[Object($t.jsx)(hm,{label:"Grade empty answers as wrong:",gradeEmpty:this.props.gradeEmpty,onChange:this.props.onChange}),Object($t.jsxs)(cm,{children:[Object($t.jsx)("p",{children:"We generally do not grade empty answers. This usually works well, but sometimes can result in giving away part of an answer in a multi-part question."}),Object($t.jsx)("p",{children:"If this is a multi-part question (there is another widget), you probably want to enable this option. Otherwise, you should leave it disabled."}),Object($t.jsx)("p",{children:"Confused? Talk to Elizabeth."})]})]}),Object($t.jsx)("div",{children:"Graph settings:"}),Object($t.jsx)(lm,{box:e.box,labels:e.labels,range:e.range,step:e.step,gridStep:e.gridStep,valid:e.valid,backgroundImage:e.backgroundImage,markings:e.markings,showProtractor:e.showProtractor,onChange:this.changeGraph}),Object($t.jsx)("div",{children:"Transformation settings:"}),Object($t.jsx)(Cm,{ref:"transformationSettings",graphMode:this.props.graphMode,listMode:this.props.listMode,tools:this.props.tools,drawSolutionShape:this.props.drawSolutionShape,onChange:this.props.onChange}),Object($t.jsx)("div",{children:"Starting location:"}),Object($t.jsx)(km,{ref:"shapeEditor",graph:e,shape:this.props.starting.shape,onChange:this.changeStarting,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),Object($t.jsx)("div",{children:"Solution transformations:"}),Object($t.jsx)(pm,{ref:"explorer",graph:e,graphMode:this.props.graphMode,listMode:this.props.listMode,gradeEmpty:this.props.gradeEmpty,tools:this.props.tools,drawSolutionShape:this.props.drawSolutionShape,starting:this.props.starting,correct:this.props.starting,transformations:this.props.correct.transformations,onChange:this.changeTransformer,trackInteraction:()=>{}})]})},changeGraph:function(e,t){var n=rm.extend({},this.props.graph,e);this.props.onChange({graph:n},t)},changeStarting:function(e){var t=rm.extend({},this.props.starting,e);this.props.onChange({starting:t})},changeTransformer:function(e,t){e.transformations&&(e.correct={...this.props.correct,transformations:e.transformations},delete e.transformations),this.props.onChange(e,t)},serialize:function(){var e=this.refs.explorer.getEditorJSON();return e.correct=e.answer,delete e.answer,e}});im.exports=_m;var Tm=im.exports,Mm={exports:{}},Nm=(Mm.exports,h.a,i.a),Pm=x.b,Im=bg;const Em=Dg;var Am=gh,Rm=ce;const{keypadElementPropType:Dm}=ye.a.propTypes;var Lm=Is.Options;const Fm=ie;var zm=Ei.assert,qm=function(e,t){return[""+e,""+t]},Wm=function(e){return zm(Pm.isArray(e)&&2===e.length),+e[0]},Bm=function(e){return zm(Pm.isArray(e)&&2===e.length),+e[1]},Vm=function(e){return"answer"+Wm(e)+","+Bm(e)},Hm=createReactClass({displayName:"Table",getDefaultProps:function(){var e=Pm.times(4,(function(){return Rm.stringArrayOfSize(1)}));return{apiOptions:Lm.defaults,headers:[""],editableHeaders:!1,rows:4,columns:1,answers:e,linterContext:je}},_getRows:function(){return this.props.answers.length},_getColumns:function(){return this.props.answers[0].length},render:function(){var e=this._getRows(),t=this._getColumns(),n=this.props.headers;let s,i;return this.props.apiOptions.customKeypad?(s=Em,i={width:80}):this.props.apiOptions.staticRender?(s=Im,i={}):(s="input",i={}),Object($t.jsxs)("table",{className:"perseus-widget-table-of-values non-markdown",children:[Object($t.jsx)("thead",{children:Object($t.jsx)("tr",{children:Pm.map(n,((e,t)=>this.props.editableHeaders?Object($t.jsx)("th",{children:Object($t.jsx)(this.props.Editor,{ref:"columnHeader"+t,apiOptions:this.props.apiOptions,content:e,widgetEnabled:!1,onChange:Pm.partial(this.onHeaderChange,t)})},t):Object($t.jsx)("th",{children:Object($t.jsx)(Am,{content:e,linterContext:this.props.linterContext})},t)))})}),Object($t.jsx)("tbody",{children:Pm.times(e,(e=>Object($t.jsx)("tr",{children:Pm.times(t,(t=>Object($t.jsx)("td",{children:Object($t.jsx)(s,{ref:Vm(qm(e,t)),type:"text",value:this.props.answers[e][t],keypadElement:this.props.keypadElement,disabled:this.props.apiOptions.readOnly,onFocus:Pm.partial(this._handleFocus,qm(e,t)),onBlur:Pm.partial(this._handleBlur,qm(e,t)),onChange:Pm.partial(this.onValueChange,e,t),style:i})},t)))},e)))})]})},getUserInput:function(){return Pm.map(this.props.answers,Pm.clone)},onValueChange:function(e,t,n){var s=Pm.map(this.props.answers,Pm.clone);s[e][t]=n.target?n.target.value:n,this.props.onChange({answers:s}),this.props.trackInteraction()},onHeaderChange:function(e,t){var n=this.props.headers.slice();n[e]=t.content,this.props.onChange({headers:n})},simpleValidate:function(e){return Hm.validate(this.getUserInput(),e)},_handleFocus:function(e){this.props.onFocus(e)},_handleBlur:function(e){this.props.onBlur(e)},focus:function(){return this.focusInputPath(qm(0,0)),!0},focusInputPath:function(e){var t=Vm(e),n=this.refs[t];this.props.apiOptions.customKeypad||this.props.apiOptions.staticRender?n.focus():Nm.findDOMNode(n).focus()},blurInputPath:function(e){var t=Vm(e),n=this.refs[t];this.props.apiOptions.customKeypad||this.props.apiOptions.staticRender?n.blur():Nm.findDOMNode(n).blur()},getDOMNodeForPath:function(e){var t=Vm(e);return Nm.findDOMNode(this.refs[t])},getInputPaths:function(){var e=this._getRows(),t=this._getColumns(),n=[];return Pm.times(e,(e=>{Pm.times(t,(t=>{var s=qm(e,t);n.push(s)}))})),n},getGrammarTypeForPath:function(e){return"number"},setInputValue:function(e,t,n){var s=Wm(e),i=Bm(e),r=Pm.map(this.props.answers,Pm.clone);r[s][i]=t,this.props.onChange({answers:r},n)}});Pm.extend(Hm,{validate:function(e,t){var n=function(e){return Pm.filter(e,(function(e){return Pm.some(e,Pm.identity)}))},s=n(t.answers),i=n(e);if(Pm.some(i,(function(e){return Pm.some(e,(function(e){return""===e}))}))||!i.length)return{type:"invalid",message:null};if(i.length!==s.length)return{type:"points",earned:0,total:1,message:null};var r=Fm.number.createValidatorFunctional,o=null;return{type:"points",earned:Pm.every(s,(function(e){var t;for(t=0;t<i.length;t++){var n=i[t],s=Pm.every(n,(function(t,n){var s=e[n],i=r(s,{simplify:!0})(t);return i.message&&(o=i.message),i.correct}));if(s)return i.splice(t,1),!0}return!1}))?1:0,total:1,message:o}}});Mm.exports={name:"table",displayName:"Table of values",accessible:!0,widget:Hm,transform:e=>{var t=e.answers.length,n=e.answers[0].length,s=Pm.times(t,(function(){return Rm.stringArrayOfSize(n)}));return Pm.extend({},e,{answers:s})},hidden:!0,isLintable:!0};var Um=Mm.exports,Gm=n(10),$m=n(8),Ym={exports:{}};Ym.exports;const Km=e=>{const{editorState:t,contentState:n,selection:s}=e,i={};return i.editorState=t||null,i.contentState=n||t&&t.getCurrentContent()||null,i.selection=s||t&&t.getSelection()||n&&n.getSelectionAfter()||null,i},Xm=e=>$m.SelectionState.createEmpty(e.getKey()).set("hasFocus",!0);const Zm=(e,t)=>{const n=[],s=t.getStartKey(),i=t.getEndKey(),r=e.getKeyAfter(i);for(let o=s;o!==r;o=e.getKeyAfter(o))n.push(e.getBlockForKey(o));return n};const Jm=/\r\n?|\n/g;const Qm=(e,t)=>{if(0===t||t===e.getLength())return!0;const n=e.getEntityAt(t-1),s=e.getEntityAt(t);return!(!!s&&"IMMUTABLE"===$m.Entity.get(s).mutability&&n===s)},eb=(e,t,n)=>{let s=t;for(;s>0&&s<e.getLength()&&!Qm(e,s);)s+=n;return s};Ym.exports={regexStrategy:function(e,t,n,s){const i=e.getText();let r;for(;null!==(r=n.exec(i));)if(s){const{start:e,end:n}=s(r);t(e,n)}else{const e=r.index;t(e,e+r[0].length)}},findPattern:function(e,t){const n=e.getBlockMap().values();for(const s of n){const e=t.exec(s.getText());if(null!==e){return Xm(s).merge({anchorOffset:e.index,focusOffset:e.index+e[0].length})}}},replaceSelection:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s=Km(e),i={};return i.contentState=$m.Modifier.replaceText(s.contentState,s.selection,t,null,n),s.editorState&&(i.editorState=$m.EditorState.push(s.editorState,i.contentState,"insert-characters")),i},deleteSelection:function(e){const t=Km(e),n={};return n.contentState=$m.Modifier.removeRange(t.contentState,t.selection,"backward"),t.editorState&&(n.editorState=$m.EditorState.push(t.editorState,n.contentState,"remove-range")),n},getEntities:function(e,t){let n=null,s=()=>!0;if(t){const i=Zm(e,t);n=$m.BlockMapBuilder.createFromArray(i);const r=t.getStartKey(),o=t.getEndKey();s=(e,n,s)=>!(e===r&&n<t.getStartOffset())&&!(e===o&&s>t.getEndOffset())}else n=e.getBlockMap();const i=[];return n.forEach(((e,t)=>{e.findEntityRanges((e=>null!==e.getEntity()),((n,r)=>{s(t,n,r)&&i.push($m.Entity.get(e.getEntityAt(n)))}))})),i},findEntity:function(e,t){const n=e.getBlocksAsArray();let s=null;return n.some((e=>(e.findEntityRanges((e=>null!==e.getEntity()&&t($m.Entity.get(e.getEntity()))),((t,n)=>{const i=Xm(e);s=i.merge({anchorOffset:t,focusOffset:n,isBackward:!1})})),!!s))),s},insertText:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>null;const s=Km(e),i={},r=t.split(Jm),o=$m.CharacterMetadata.create(),a=r.map((e=>{let t=e,s=Array(e.length).fill(o);const i=n(t,s);return null!==i&&(t=i.text,s=i.characterList),new $m.ContentBlock({key:Object($m.genKey)(),text:t,type:"unstyled",characterList:Object(Gm.List)(s)})})),l=$m.BlockMapBuilder.createFromArray(a);return i.contentState=$m.Modifier.replaceWithFragment(s.contentState,s.selection,l),s.editorState&&(i.editorState=$m.EditorState.push(s.editorState,i.contentState,"insert-fragment")),i},selectEnd:function(e){return Xm(e).merge({focusOffset:e.getCharacterList().size,anchorOffset:e.getCharacterList().size})},snapSelectionOutsideEntities:function(e,t){const n=Km(e),{contentState:s,selection:i,editorState:r}=n,o=s.getBlockForKey(i.getAnchorKey()),a=s.getBlockForKey(i.getFocusKey());let l=i.getAnchorOffset(),c=i.getFocusOffset();const h=i.getIsBackward()?-1:1,p=c-t.getFocusOffset();i.getFocusKey()===t.getFocusKey()&&1===Math.abs(p)&&!Qm(a,c)&&(c=eb(a,c,p)),c=eb(a,c,h),l=eb(o,l,-h),i.isCollapsed()&&(l=c);const u={contentState:s};return u.selection=i.merge({focusOffset:c,anchorOffset:l}),r&&(u.editorState=$m.EditorState.set(r,{selection:u.selection,forceSelection:!0})),u},toggleDecoration:function(e,t){const n=Km(e),s={},{contentState:i,selection:r}=n,o=Zm(i,r);let a=!0,l=n.contentState,c=n.contentState;if(o.forEach((e=>{let n=0,s=e.getLength();if(e.getKey()===r.getStartKey()&&(n=r.getStartOffset()),e.getKey()===r.getEndKey()&&(s=r.getEndOffset()),n===s)return;const i=e.getText().substring(n,s);a&&i.endsWith(t)&&i.startsWith(t)?c=((e,t,n,s,i)=>{let r=Xm(t),o=e;return r=r.merge({anchorOffset:s-i.length,focusOffset:s}),o=$m.Modifier.removeRange(o,r),r=r.merge({anchorOffset:n,focusOffset:n+i.length}),o=$m.Modifier.removeRange(o,r),o})(c,e,n,s,t):a=!1,l=((e,t,n,s,i)=>{let r=Xm(t),o=e;return r=r.merge({anchorOffset:s,focusOffset:s}),o=$m.Modifier.insertText(o,r,i),r=r.merge({anchorOffset:n,focusOffset:n}),o=$m.Modifier.insertText(o,r,i),o})(l,e,n,s,t)})),s.contentState=a?c:l,n.editorState){s.editorState=$m.EditorState.push(n.editorState,s.contentState,a?"remove-range":"insert-characters");let e=r.getEndOffset();if(e>0){e+=(a?-2:2)*t.length}let i=null;i=r.getIsBackward()?r.merge({anchorOffset:e}):r.merge({focusOFfset:e}),s.editorState=$m.EditorState.forceSelection(s.editorState,i)}return s}};var tb=Ym.exports,nb={exports:{}};nb.exports;const sb=h.a,ib=Hs,rb=tb,ob="[[\u2603 {id}]]",ab=/\[\[\u2603 [a-z-]+ [0-9]+\]\]/g,lb=/^\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]$/,cb=e=>new RegExp(`(\\[\\[\u2603 ${e}\\]\\])`,"gm"),hb=/\[\[([a-z-]+)$/,pb=/\*\*([\s\S]+?)\*\*(?!\*)/g,ub=/\**(?:^|[^*])((\*|_)(\w+(\s\w+)*)\2)/g,db=/(\*\*\*\w+(\s\w+)*\*\*\*)/g,gb=/__([\s\S]+?)__(?!_)/g,fb=/^ *(#{1,6})([^\n]+)$/g,mb=(e,t)=>Object($t.jsx)("span",{...e,style:t,children:e.children}),bb=(e,t)=>mb(e,{backgroundColor:t}),vb=(e,t)=>({strategy:function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return((e,t,n)=>e.findEntityRanges((e=>e.getEntity()&&$m.Entity.get(e.getEntity()).type===n),t))(...n,e)},component:e=>bb(e,t)}),xb={strategy:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return rb.regexStrategy(...t,pb)},component:e=>mb(e,{fontWeight:"bold"})},yb={strategy:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return rb.regexStrategy(...t,ub,(e=>{const t=e.index+e[0].length-e[1].length;return{start:t,end:t+e[1].length}}))},component:e=>mb(e,{fontStyle:"italic"})},jb={strategy:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return rb.regexStrategy(...t,gb)},component:e=>mb(e,{textDecoration:"underline"})},wb={strategy:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return rb.regexStrategy(...t,db)},component:e=>mb(e,{fontWeight:"bold",fontStyle:"italic"})},Ob={strategy:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return rb.regexStrategy(...t,fb)},component:e=>{const t=e.decoratedText.split(fb)[1].length;return sb.createElement(`h${t}`,{style:{marginBottom:0}},e.children)}},Cb=new $m.CompositeDecorator([vb("WIDGET","#DFD"),vb("TEMP_IMAGE","#fdffdd"),(Sb=/!\[[^\]]*?\]\([^\)].*?\)/g,kb="#dffdfa",{strategy:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return rb.regexStrategy(...t,Sb)},component:e=>bb(e,kb)}),wb,xb,jb,yb,Ob]);var Sb,kb;const _b=e=>{const t=$m.KeyBindingUtil.hasCommandModifier(e);return t&&66===e.keyCode?"perseus-bold":t&&73===e.keyCode?"perseus-italics":t&&85===e.keyCode?"perseus-underline":t&&219===e.keyCode?"perseus-decrease-font-size":t&&221===e.keyCode?"perseus-increase-font-size":t&&220===e.keyCode?"perseus-reset-font-size":Object($m.getDefaultKeyBinding)(e)},Tb=createReactClass({displayName:"PerseusEditor",getDefaultProps:()=>({onChange:()=>{},content:"",initialWidgets:{},widgetEnabled:!0,placeholder:"Type here"}),getInitialState(){const{content:e,initialWidgets:t,widgetEnabled:n}=this.props,s=$m.ContentState.createFromText(e);let i=$m.EditorState.createWithContent(s,Cb);return n&&(i=this._insertWidgetsAsEntities(i,t)),{editorState:i,widgets:t,fontSizePercentage:100}},componentDidUpdate(e){this.props.content!==this.lastContentUpdate&&(this.lastContentUpdate=this.props.content,this.setState(this.getInitialState()))},_insertWidgetsAsEntities(e,t){let n=e.getCurrentContent();Object.keys(t).forEach((e=>{const t=rb.findPattern(n,cb(e));if(t){const s=$m.Entity.create("WIDGET","IMMUTABLE",{id:e});n=$m.Modifier.applyEntity(n,t,s)}}));return $m.EditorState.set(e,{currentContent:n})},_getDraftData(){const e=this.state.editorState,t=e.getCurrentContent(),n=e.getSelection();return{editorState:e,contentState:t,selection:n}},_getNextWidgetId(e){const t=this.state.widgets;return Object.keys(t).filter((n=>t[n].type===e)).map((e=>+e.split(" ")[1])).reduce(((e,t)=>Math.max(e,t)),0)},_createInitialWidget(e){return[e+" "+(this._getNextWidgetId(e)+1),{options:ib.getEditor(e).defaultProps,type:e,version:ib.getVersion(e)}]},addWidget(e){this.focus((()=>this._handleChange(this._insertNewWidget(e))))},_insertNewWidget(e,t){const n={...this._getDraftData(),...t},[s,i]=this._createInitialWidget(e),r={...this.state.widgets,[s]:i};return{editorState:this._insertWidgetText(n,s).editorState,widgets:r}},_insertWidgetText(e,t){const n=ob.replace("{id}",t),s=$m.Entity.create("WIDGET","IMMUTABLE",{id:t});return rb.replaceSelection(e,n,s)},updateWidget(e,t){this.setState({widgets:{...this.state.widgets,[e]:t}})},removeWidget(e){this.focus((()=>{const{editorState:t,contentState:n}=this._getDraftData(),s=rb.findPattern(n,cb(e)),i=rb.deleteSelection({editorState:t,selection:s});this._handleChange({editorState:i.editorState})}))},addTemplate(e){this.focus((()=>{this._addTemplate(e)}))},_addTemplate(e){let{editorState:t,contentState:n,selection:s}=this._getDraftData();const i={...this.state.widgets},r=n.getBlockForKey(s.getEndKey());if(s=rb.selectEnd(r),r.getText().length>0&&(n=$m.Modifier.splitBlock(n,s),s=n.getSelectionAfter()),"allWidgets"===e){const e=ib.getAllWidgetTypes().sort();n=$m.Modifier.splitBlock(n,s),n=e.reduce(((e,t)=>{const[n,s]=this._createInitialWidget(t);return i[n]=s,e=this._insertWidgetText({contentState:e,selection:e.getSelectionAfter()},n).contentState,$m.Modifier.splitBlock(e,e.getSelectionAfter())}),n),t=$m.EditorState.push(t,n,"insert-fragment")}else{let i="";"table"===e?i="header 1 | header 2 | header 3\n- | - | -\ndata 1 | data 2 | data 3\ndata 4 | data 5 | data 6\ndata 7 | data 8 | data 9":"titledTable"===e?i="|| **Table title** ||\nheader 1 | header 2 | header 3\n- | - | -\ndata 1 | data 2 | data 3\ndata 4 | data 5 | data 6\ndata 7 | data 8 | data 9":"alignment"===e?i="$\\begin{align} x+5 &= 30 \\\\\nx+5-5 &= 30-5 \\\\\nx &= 25 \\end{align}$":"piecewise"===e&&(i="$f(x) = \\begin{cases}\n7 & \\text{if }x=1 \\\\\nf(x-1)+5 & \\text{if }x > 1\n\\end{cases}$"),t=rb.insertText({editorState:t,contentState:n,selection:s},`\n${i}\n`).editorState}this._handleChange({editorState:t,widgets:i})},_handleCopy(){const{contentState:e,selection:t}=this._getDraftData(),n=rb.getEntities(e,t).reduce(((e,t)=>{const n=t.getData().id;return e[n]=this.state.widgets[n],e}),{});return localStorage.perseusLastCopiedWidgets=JSON.stringify(n),!1},_createSafeWidgetMapping(e,t){const n=Object.keys(t).reduce(((e,t)=>{const[n,s]=t.split(" ");return e[n]=e[n]?Math.max(e[n],+s):+s,e}),{});return Object.keys(e).reduce(((e,t)=>{const s=t.split(" ")[0];return n[s]=n[s]?n[s]+1:1,e[t]=s+" "+n[s],e}),{})},_handlePaste(e,t,n){const s=localStorage.perseusLastCopiedWidgets;if(!s)return!1;const i=JSON.parse(s),r={...this.state.widgets},o=this._createSafeWidgetMapping(i,r),a=$m.CharacterMetadata.create(),l=this._getDraftData();l.selection=n||l.selection;const{editorState:c}=rb.insertText(l,e,(e=>{const t=e.replace(new RegExp("\r","g"),""),n=Array(t.length).fill(a);return{text:t.replace(ab,((e,t)=>{const s=lb.exec(e),l=s[0],c=s[1],h=o[c],p=ob.replace("{id}",h),u=$m.Entity.create("WIDGET","IMMUTABLE",{id:h}),d=$m.CharacterMetadata.applyEntity(a,u),g=Array(p.length).fill(d);return n.splice(t,l.length,...g),r[h]=i[c],l.replace(c,h)})),characterList:n}}));return this._handleChange({editorState:c,widgets:r}),!0},_handleDrop(e,t){const n=this.state.editorState.getCurrentContent(),s=e.getEndKey(),i=n.getBlockForKey(s),r=rb.selectEnd(i),o=t.getLink();if(!o){const e=t.getText();return this._handlePaste(e,null,r)}{const{editorState:e}=rb.insertText({...this._getDraftData(),selection:r},`\n![](${o})`);this._handleChange({editorState:e})}return!0},_handleDroppedFiles(e,t){const n=t.filter((e=>e.type.match("image.*")));let s=this.state.editorState.getCurrentContent();n.forEach((t=>{const n=`![](${t.name}...)`,i=Object($m.genKey)(),r=$m.Entity.create("TEMP_IMAGE","IMMUTABLE",{id:i}),o=$m.CharacterMetadata.create().merge({entity:r}),a=Array(n.length).fill(o),l=e.getEndKey(),c=s.getBlockForKey(l),h=rb.selectEnd(c);s=rb.insertText({contentState:s,selection:h},`\n${n}\n`,(e=>e===n?{text:n,characterList:a}:null)).contentState,this.props.imageUploader(t,(e=>{const t=this.state.editorState,n=t.getCurrentContent(),s=rb.findEntity(n,(e=>e.getData().id===i)),r=rb.replaceSelection({editorState:t,contentState:n,selection:s},`![](${e})`);this._handleChange({editorState:r.editorState})}))}));const i=$m.EditorState.push(this.state.editorState,s,"insert-fragment");return this._handleChange({editorState:i}),!0},_handleTab(e){const{contentState:t,selection:n}=this._getDraftData();if(!n.isCollapsed()||!this.props.widgetEnabled)return;e.preventDefault();const s=t.getBlockForKey(n.getEndKey()).getText().substring(0,n.getEndOffset()).match(hb);if(s){const e=s[1],t=ib.getAllWidgetTypes().filter((t=>t.substring(0,e.length)===e));if(1===t.length){const e=t[0],i=n.merge({anchorOffset:s.index});this._handleChange(this._insertNewWidget(e,{selection:i}))}}return!0},_getDecorationForStyle(e){switch(e){case"perseus-bold":return"**";case"perseus-italics":return"*";case"perseus-underline":return"__";default:return null}},_handleKeyCommand(e){const{fontSizePercentage:t}=this.state;if("perseus-increase-font-size"===e)return this.setState({fontSizePercentage:t+10}),!0;if("perseus-decrease-font-size"===e)return this.setState({fontSizePercentage:t-10}),!0;if("perseus-reset-font-size"===e)return this.setState({fontSizePercentage:100}),!0;const n=this._getDecorationForStyle(e);if(null!==n){const e=this._getDraftData(),{editorState:t}=rb.toggleDecoration(e,n);return this._handleChange({editorState:t}),!0}return!1},lastContentUpdate:"",_updateParent(e,t){const n=rb.getEntities(e).reduce(((e,n)=>{const s=n.getData().id;return e[s]=t[s],e}),{});this.lastContentUpdate=e.getPlainText("\n"),this.props.onChange({content:this.lastContentUpdate,widgets:n})},pastContentState:null,lastIdleCallback:null,_handleChange(e){const t={...this.state,...e},n=t.widgets;let s=t.editorState;s=rb.snapSelectionOutsideEntities({editorState:s},this.state.editorState.getSelection()).editorState;const i=s.getCurrentContent();i!==this.pastContentState&&(clearTimeout(this.lastIdleCallback),this.lastIdleCallback=setTimeout((()=>this._updateParent(i,n)),100)),this.pastContentState=i,this.setState({editorState:s,widgets:n})},focus(e){this.editor.focus();let t=this.state.editorState;t=$m.EditorState.set(t,{selection:t.getSelection().set("hasFocus",!0),forceSelection:!0}),this.setState({editorState:t},e)},render(){return Object($t.jsx)("div",{onCopy:this._handleCopy,onCut:this._handleCopy,onDragStart:this._handleCopy,style:{fontSize:`${this.state.fontSizePercentage}%`},children:Object($t.jsx)($m.Editor,{ref:e=>this.editor=e,editorState:this.state.editorState,onChange:e=>this._handleChange({editorState:e}),spellCheck:!0,stripPastedStyles:!0,placeholder:this.props.placeholder,handlePastedText:this._handlePaste,handleDroppedFiles:this._handleDroppedFiles,handleDrop:this._handleDrop,keyBindingFn:_b,handleKeyCommand:this._handleKeyCommand,onTab:this._handleTab})})}});nb.exports=Tb;var Mb=nb.exports,Nb={exports:{}};Nb.exports;h.a;const Pb=createReactClass({displayName:"KatexErrorView",getInitialState:()=>({showErrors:!1}),handleToggleKatexErrors(e){this.setState({showErrors:!this.state.showErrors})},render(){const{errorList:e}=this.props,{showErrors:t}=this.state,n=t?"icon-chevron-down":"icon-chevron-right";return Object($t.jsxs)("div",{className:Object(Nn.css)(Ib.errorContainer),children:[Object($t.jsxs)("div",{className:Object(Nn.css)(Ib.title),onClick:this.handleToggleKatexErrors,children:[Object($t.jsx)("i",{className:n,style:{fontSize:14}}),"\xa0 KaTeX Errors (",e.length,")"]}),t&&Object($t.jsx)("div",{className:Object(Nn.css)(Ib.errorExplanation),children:"These errors will cause your LaTeX to load really slowly for the student. Please fix them if you can. If you can\u2019t because KaTeX doesn\u2019t support the feature you need, please message Cam."}),t&&e.map(((e,t)=>Object($t.jsxs)("div",{className:Object(Nn.css)(Ib.error),children:[Object($t.jsx)("div",{style:{color:"red"},children:e.math}),Object($t.jsx)("div",{children:e.message})]},t)))]})}}),Ib=Nn.StyleSheet.create({title:{backgroundColor:"#eee",fontSize:"1.25em",padding:"4px 10px"},errorContainer:{border:"1px solid #ddd",borderTop:"none"},errorExplanation:{padding:"4px 10px",backgroundColor:"pink"},error:{padding:"4px 10px"}});Nb.exports=Pb;var Eb=Nb.exports,Ab=n(123),Rb=n(124),Db={exports:{}},Lb=(Db.exports,h.a,i.a),Fb=Rb.a,zb=l.a,qb=x.b,Wb=Ab.a,Bb=Kt,Vb=Eb,Hb=ns,Ub=Lf,Gb=ce,$b=Hs,Yb=hs,Kb=Mb,Xb=ou,Zb="(\\[\\[\u2603 {id}\\]\\])",Jb=new RegExp(Zb.replace("{id}","[a-z-]+ [0-9]+"),"g"),Qb=/^\[\[([a-z\-]+)$/,ev=/(?:\n{2,}|^\n*)$/,tv=/(\n*)$/,nv=/^(\n*)/,sv=e=>{var t=e.toString();return t.length>=5&&(t=t.replace(/(\d)(?=(\d{3})+$)/g,"$1{,}")),t},iv=createReactClass({displayName:"WidgetSelect",shouldComponentUpdate:function(){return!1},handleChange:function(e){var t=e.target.value;""!==t&&this.props.onChange&&this.props.onChange(t)},render:function(){var e=$b.getPublicWidgets(),t=qb.sortBy(qb.keys(e),(t=>e[t].displayName));return Object($t.jsxs)("select",{value:"",onChange:this.handleChange,children:[Object($t.jsx)("option",{value:"",children:"Add a widget\u2026"}),Object($t.jsx)("option",{disabled:!0,children:"--"}),qb.map(t,(t=>Object($t.jsx)("option",{value:t,children:e[t].displayName},t)))]})}}),rv=createReactClass({displayName:"WidgetEditor",getInitialState:function(){return{showWidget:!1}},componentWillMount:function(){this._upgradeWidgetInfo(this.props)},componentWillReceiveProps:function(e){this._upgradeWidgetInfo(e)},_upgradeWidgetInfo:function(e){var t=qb.omit(e,Xb),n=$b.upgradeWidgetInfoToLatestVersion(t);this.setState({widgetInfo:n})},_toggleWidget:function(e){e.preventDefault(),this.setState({showWidget:!this.state.showWidget})},_handleWidgetChange:function(e,t,n){var s=qb.clone(this.state.widgetInfo);s.options=qb.extend(this.refs.widget.serialize(),e),this.props.onChange(s,t,n)},_toggleStatic:function(e){e.preventDefault();var t=qb.extend({},this.state.widgetInfo,{static:!this.state.widgetInfo.static});this.props.onChange(t)},_handleAlignmentChange:function(e){var t=e.target.value,n=qb.clone(this.state.widgetInfo);n.alignment=t,this.props.onChange(n)},render:function(){var e,t=this.state.widgetInfo,n=$b.getEditor(t.type);e=this.props.apiOptions.showAlignmentOptions?$b.getSupportedAlignments(t.type):["default"];var s=$b.supportsStaticMode(t.type),i="transformer"===t.type,r=Object($t.jsx)(Ub,{label:"Graded:",graded:t.graded,onChange:this.props.onChange});return Object($t.jsxs)("div",{className:"perseus-widget-editor",children:[Object($t.jsxs)("div",{className:"perseus-widget-editor-title "+(this.state.showWidget?"open":"closed"),children:[Object($t.jsxs)("a",{className:"perseus-widget-editor-title-id",href:"#",onClick:this._toggleWidget,children:[this.props.id,this.state.showWidget?Object($t.jsx)(Bb,{...ha}):Object($t.jsx)(Bb,{...pa})]}),s&&Object($t.jsx)("input",{type:"button",onClick:this._toggleStatic,className:"simple-button--small",value:t.static?"Unset as static":"Set as static"}),e.length>1&&Object($t.jsx)("select",{className:"alignment",value:t.alignment,onChange:this._handleAlignmentChange,children:e.map((e=>Object($t.jsx)("option",{children:e},e)))}),Object($t.jsx)("a",{href:"#",className:"remove-widget simple-button simple-button--small orange",onClick:e=>{e.preventDefault(),this.props.onRemove()},children:Object($t.jsx)(Bb,{..._a})})]}),Object($t.jsxs)("div",{className:"perseus-widget-editor-content "+(this.state.showWidget?"enter":"leave"),children:[i&&r,Object($t.jsx)(n,{ref:"widget",onChange:this._handleWidgetChange,static:t.static,apiOptions:this.props.apiOptions,...t.options})]})]})},getSaveWarnings:function(){var e=this.refs.widget.getSaveWarnings;return e?e():[]},serialize:function(){var e=this.state.widgetInfo;return{type:e.type,alignment:e.alignment,static:e.static,graded:e.graded,options:this.refs.widget.serialize(),version:e.version}}}),ov=/!\[[^\]]*\]\(([^\s\)]+)[^\)]*\)/g,av=createReactClass({displayName:"Editor",getDefaultProps:function(){return{content:"",placeholder:"",widgets:{},images:{},disabled:!1,widgetEnabled:!0,immutableWidgets:!1,showWordCount:!1,warnNoPrompt:!1,warnNoWidgets:!1}},getInitialState:function(){return{showKatexErrors:!1}},getWidgetEditor:function(e,t){if($b.getEditor(t))return Object($t.jsx)(rv,{ref:e,id:e,type:t,onChange:this._handleWidgetEditorChange.bind(this,e),onRemove:this._handleWidgetEditorRemove.bind(this,e),apiOptions:this.props.apiOptions,...this.props.widgets[e]})},_handleWidgetEditorChange:function(e,t,n,s){var i=qb.clone(this.props.widgets);i[e]=qb.extend({},i[e],t),this.props.apiOptions.useDraftEditor&&this.refs.textarea.updateWidget(e,t),this.props.onChange({widgets:i},n,s)},_handleWidgetEditorRemove:function(e){const t=this.refs.textarea;if(this.props.apiOptions.useDraftEditor)t.removeWidget(e);else{const n=new RegExp(Zb.replace("{id}",e),"gm");this.props.onChange({content:t.value.replace(n,"")})}},_sizeImages:function(e){var t,n=(t=e.content,qb.map(function(e,t){for(var n=[];;){var s=e.exec(t);if(!s)break;n.push(s)}return n}(ov,t),(e=>e[1]))),s=qb.pick(e.images,n),i=qb.filter(n,(e=>!s[e]));qb.each(i,(t=>{Gb.getImageSize(t,((n,i)=>{s[t]={width:n,height:i},e.onChange({images:qb.clone(s)},null,!0)}))}))},componentDidMount:function(){this._sizeImages(this.props),this.props.apiOptions.useDraftEditor||zb(Lb.findDOMNode(this.refs.textarea)).on("copy cut",this._maybeCopyWidgets).on("paste",this._maybePasteWidgets)},componentDidUpdate:function(e){Lb.findDOMNode(this.refs.textarea).value=this.props.content,this.props.content!==e.content&&this._sizeImages(this.props)},handleDrop:function(e){if(!this.props.apiOptions.useDraftEditor){var t=this.props.content,n=e.nativeEvent.dataTransfer,s=n.files;if(0!==s.length)qb.chain(s).map((function(e){if(!e.type.match("image.*"))return null;var n="\u2603 "+qb.uniqueId("image_");return t+="\n\n![]("+n+")",{file:e,sentinel:n}})).reject(qb.isNull).tap((()=>{this.props.onChange({content:t})})).each((e=>{this.props.imageUploader(e.file,(t=>{this.props.onChange({content:this.props.content.replace(e.sentinel,t)})}))}));else{var i=n.getData("URL");if(i){var r=t+"\n\n![]("+i+")";this.props.onChange({content:r})}}}},handleChange:function(){var e=Lb.findDOMNode(this.refs.textarea);this.props.onChange({content:e.value})},_handleKeyDown:function(e){if("Tab"===e.key){var t=Lb.findDOMNode(this.refs.textarea),n=Gb.textarea.getWordBeforeCursor(t),s=n.string.toLowerCase().match(Qb);if(null!=s){var i=s[1],r=$b.getAllWidgetTypes(),o=qb.filter(r,(e=>e.substring(0,i.length)===i));if(1===o.length){var a=o[0];this._addWidgetToContent(this.props.content,[n.pos.start,n.pos.end+1],a)}e.preventDefault()}}},_maybeCopyWidgets:function(e){var t=e.target,n=t.value.substring(t.selectionStart,t.selectionEnd),s=qb.map(n.match(Jb),(e=>Gb.rWidgetParts.exec(e)[1])),i=qb.pick(this.serialize().widgets,s);localStorage.perseusLastCopiedText=n,localStorage.perseusLastCopiedWidgets=JSON.stringify(i),console.log(`Widgets copied: ${localStorage.perseusLastCopiedWidgets}`)},_maybePasteWidgets:function(e){var t=localStorage.perseusLastCopiedWidgets,n=localStorage.perseusLastCopiedText,s=e.originalEvent.clipboardData.getData("text");if(t&&n===s){e.preventDefault();var i=JSON.parse(t),r=this._safeWidgetNameMapping(i),o={};for(const[e,t]of Object.entries(i))o[r[e]]=t;var a=qb.extend(o,this.props.widgets),l=n.replace(Jb,(e=>{var t=Gb.rWidgetParts.exec(e),n=t[0],s=t[1];return n.replace(s,r[s])})),c=e.target,h=c.selectionStart,p=this.props.content.substr(0,h)+l+this.props.content.substr(c.selectionEnd);this.props.onChange({content:p,widgets:a},(()=>{var e=h+l.length;Gb.textarea.moveCursor(c,e)}))}},_safeWidgetNameMapping:function(e){var t=qb.keys(e).map((e=>e.split(" "))),n=qb.uniq(t.map((e=>e[0]))),s=qb.keys(this.props.widgets).map((e=>e.split(" "))),i={};qb.each(n,(e=>{i[e]=qb.chain(s).filter((t=>t[0]===e)).map((e=>+e[1]+1)).max().value(),i[e]=Math.max(i[e],1)}));var r={};return qb.each(t,(e=>{var t=e.join(" "),n=e[0];r[t]=`${n} ${i[n]}`,i[n]++})),r},_addWidgetToContent:function(e,t,n){var s=Lb.findDOMNode(this.refs.textarea),i=qb.map(e.match(Jb),(e=>{var t=Gb.rWidgetParts.exec(e);return[t[2],+t[3]]})),r=qb.reduce(i,((e,t)=>{var[s,i]=t;return s===n?Math.max(i+1,e):e}),1),o=n+" "+r,a="[[\u2603 {id}]]".replace("{id}",o),l="block"===$b.getDefaultAlignment(n),c=e.slice(0,t[0]),h=e.slice(t[1]),p=(l?(e=>{if(ev.test(e))return e;var t=tv.exec(e)[1];return e+"\n\n".slice(0,2-t.length)})(c):c)+a+(l?(e=>{var t=nv.exec(e)[1];return"\n\n".slice(0,2-t.length)+e})(h):h),u=qb.clone(this.props.widgets);u[o]={options:$b.getEditor(n).defaultProps,type:n,version:$b.getVersion(n)},this.props.onChange({content:p,widgets:u},(function(){Gb.textarea.moveCursor(s,p.length-h.length)}))},_addWidget:function(e){var t=this.refs.textarea;this.props.apiOptions.useDraftEditor?t.addWidget(e):(this._addWidgetToContent(this.props.content,[t.selectionStart,t.selectionEnd],e),t.focus())},addTemplate:function(e){var t=e.target.value;if(""!==t)if(e.target.value="",this.props.apiOptions.useDraftEditor)this.refs.textarea.addTemplate(t);else{var n,s=this.props.content;if(s=s.replace(/\n*$/,"\n\n"),"table"===t)n="header 1 | header 2 | header 3\n- | - | -\ndata 1 | data 2 | data 3\ndata 4 | data 5 | data 6\ndata 7 | data 8 | data 9";else if("titledTable"===t)n="|| **Table title** ||\nheader 1 | header 2 | header 3\n- | - | -\ndata 1 | data 2 | data 3\ndata 4 | data 5 | data 6\ndata 7 | data 8 | data 9";else if("alignment"===t)n="$\\begin{align} x+5 &= 30 \\\\\nx+5-5 &= 30-5 \\\\\nx &= 25 \\end{align}$";else if("piecewise"===t)n="$f(x) = \\begin{cases}\n7 & \\text{if }x=1 \\\\\nf(x-1)+5 & \\text{if }x > 1\n\\end{cases}$";else{if("allWidgets"!==t)throw new Error("Invalid template type: "+t);n=$b.getAllWidgetTypes().map((e=>`[[${Gb.snowman} ${e} 1]]`)).join("\n\n")}var i=s+n;this.props.onChange({content:i},this.focusAndMoveToEnd)}},getSaveWarnings:function(){var e=qb.intersection(this.widgetIds,qb.keys(this.refs));return qb.chain(e).map((e=>{var t=this.refs[e].getSaveWarnings,n=t?t():[];return qb.map(n,(t=>e+": "+t))})).flatten(!0).value()},focus:function(){Lb.findDOMNode(this.refs.textarea).focus()},focusAndMoveToEnd:function(){this.focus();var e=Lb.findDOMNode(this.refs.textarea);e.selectionStart=e.value.length,e.selectionEnd=e.value.length},render:function(){var e,t,n,s,i,r,o,a=[];if(this.props.showWordCount){var l=Hb.characterCount(this.props.content),c=Math.floor(l/6);o=Object($t.jsx)("span",{className:"perseus-editor-word-count",title:"~"+sv(c)+" words ("+sv(l)+" characters)",children:sv(c)})}if(this.props.widgetEnabled){e=Gb.split(this.props.content,Jb),t={},n=[];for(var h=0;h<e.length;h++)if(h%2===0){n.push(e[h]);const t=Hb.parse(e[h]);Hb.traverseContent(t,(e=>{if("math"===e.type||"blockMath"===e.type){const n=Yb(e.content);try{katex.renderToString(n)}catch(t){a.push({math:n,message:t.message})}}}))}else{var p=Gb.rWidgetParts.exec(e[h]),u=p[1],d=p[2],g=u in t;t[u]=this.getWidgetEditor(u,d);var f=g||!t[u]?"error ":"",m=g?h:u;n.push(Object($t.jsx)("b",{className:f,children:e[h]},m))}this.widgetIds=qb.keys(t),s=Object($t.jsx)(iv,{ref:"widgetSelect",onChange:this._addWidget});i=Object($t.jsxs)("select",{onChange:this.addTemplate,children:[Object($t.jsx)("option",{value:"",children:"Insert template\u2026"}),Object($t.jsx)("option",{disabled:!0,children:"--"}),Object($t.jsx)("option",{value:"table",children:"Table"}),Object($t.jsx)("option",{value:"titledTable",children:"Titled table"}),Object($t.jsx)("option",{value:"alignment",children:"Aligned equations"}),Object($t.jsx)("option",{value:"piecewise",children:"Piecewise function"}),Object($t.jsx)("option",{disabled:!0,children:"--"}),Object($t.jsx)("option",{value:"allWidgets",children:"All widgets (for testing)"})]}),this.props.immutableWidgets||(r=Object($t.jsxs)("div",{className:"perseus-editor-widgets",children:[Object($t.jsxs)("div",{className:"perseus-editor-widgets-selectors",children:[s,i,o]}),Fb(t)]}),o=null)}else n=[this.props.content];n.push(Object($t.jsx)("br",{},"end"));var b,v=[Object($t.jsx)("div",{className:"perseus-textarea-underlay",ref:"underlay",children:n},"underlay"),Object($t.jsx)("textarea",{ref:"textarea",onChange:this.handleChange,onKeyDown:this._handleKeyDown,placeholder:this.props.placeholder,disabled:this.props.disabled,value:this.props.content},"textarea")];this.props.apiOptions.useDraftEditor&&(v=Object($t.jsx)(Kb,{ref:"textarea",onChange:this.props.onChange,content:this.props.content,placeholder:this.props.placeholder,initialWidgets:this.props.widgets,imageUploader:this.props.imageUploader,widgetEnabled:this.props.widgetEnabled})),b=this.props.imageUploader?Object($t.jsx)(Wb,{onDrop:this.handleDrop,className:"perseus-textarea-pair",children:v}):Object($t.jsx)("div",{className:"perseus-textarea-pair",children:v});var x=0===this.props.content.replace(/\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]/g,"").trim().length,y=!/\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]/g.test(this.props.content),j={borderTop:"none",padding:4,backgroundColor:"pink"};return Object($t.jsxs)("div",{className:"perseus-single-editor "+(this.props.className||""),children:[b,a.length>0&&Object($t.jsx)(Vb,{errorList:a}),this.props.warnNoPrompt&&x&&Object($t.jsx)("div",{style:j,children:"Graded Groups should contain a prompt"}),this.props.warnNoWidgets&&y&&Object($t.jsx)("div",{style:j,children:"Graded Groups should contain at least one widget"}),o,r]})},serialize:function(e){var t={},n=qb.intersection(this.widgetIds,qb.keys(this.refs));return qb.each(n,(e=>{t[e]=this.refs[e].serialize()})),e&&e.keepDeletedWidgets&&qb.chain(this.props.widgets).keys().reject((e=>qb.contains(n,e))).each((e=>{t[e]=this.props.widgets[e]})),{replace:this.props.replace,content:this.props.content,images:this.props.images,widgets:t}}});Db.exports=av;var lv=Db.exports,cv={exports:{}};cv.exports;h.a;const hv=i.a,pv=x.b,uv=ce,dv=cd,gv=Gd,fv=lv,mv=Um.widget,bv=createReactClass({displayName:"TableEditor",getDefaultProps:function(){return{headers:[""],rows:4,columns:1,answers:pv.times(4,(function(){return uv.stringArrayOfSize(1)}))}},focus:function(){hv.findDOMNode(this.refs.numberOfColumns).focus()},render:function(){var e=pv.pick(this.props,"headers","answers","onChange","apiOptions");return pv.extend(e,{editableHeaders:!0,Editor:fv,onFocus:()=>{},onBlur:()=>{},trackInteraction:()=>{}}),Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{children:["Number of columns:"," ",Object($t.jsx)(gv,{ref:"numberOfColumns",value:this.props.columns,onChange:e=>{e&&this.onSizeInput(this.props.rows,e)},useArrowKeys:!0})]})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{children:["Number of rows:"," ",Object($t.jsx)(gv,{ref:"numberOfRows",value:this.props.rows,onChange:e=>{e&&this.onSizeInput(e,this.props.columns)},useArrowKeys:!0})]})}),Object($t.jsxs)("div",{children:[" ","Table of answers:"," ",Object($t.jsx)(dv,{children:Object($t.jsx)("p",{children:"The student has to fill out all cells in the table. For partially filled tables create a table using the template, and insert text input boxes as desired."})})]}),Object($t.jsx)("div",{children:Object($t.jsx)(mv,{...e})})]})},onSizeInput:function(e,t){var n=+e||0,s=+t||0;n=Math.min(Math.max(1,n),30),s=Math.min(Math.max(1,s),6);var i=this.props.columns,r=this.props.rows,o=this.props.answers;function a(e){s<=i?e.length=s:pv.times(s-i,(function(){e.push("")}))}n<=r?o.length=n:pv.times(n-r,(function(){o.push(uv.stringArrayOfSize(i))}));var l=this.props.headers;a(l),pv.each(o,a),this.props.onChange({rows:n,columns:s,answers:o,headers:l})},serialize:function(){var e=pv.pick(this.props,"headers","rows","columns");return pv.extend({},e,{answers:pv.map(this.props.answers,pv.clone)})}});cv.exports=bv;var vv=cv.exports,xv={exports:{}};xv.exports;h.a;const yv=x.b,jv=cd,wv=Lf,Ov=Cs,Cv="horizontal",Sv=createReactClass({displayName:"SorterEditor",getDefaultProps:function(){return{correct:["$x$","$y$","$z$"],layout:Cv,padding:!0}},render:function(){var e=this;return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{children:[" ","Correct answer:"," ",Object($t.jsx)(jv,{children:Object($t.jsx)("p",{children:"Enter the correct answer (in the correct order) here. The preview on the right will have the cards in a randomized order, which is how the student will see them."})})]}),Object($t.jsx)(Ov,{options:this.props.correct,onChange:function(t,n){e.props.onChange({correct:t},n)},layout:this.props.layout}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[" ","Layout:"," ",Object($t.jsxs)("select",{value:this.props.layout,onChange:this.onLayoutChange,children:[Object($t.jsx)("option",{value:Cv,children:"Horizontal"}),Object($t.jsx)("option",{value:"vertical",children:"Vertical"})]})]}),Object($t.jsx)(jv,{children:Object($t.jsx)("p",{children:"Use the horizontal layout for short text and small images. The vertical layout is best for longer text and larger images."})})]}),Object($t.jsxs)("div",{children:[Object($t.jsx)(wv,{label:"Padding:",padding:this.props.padding,onChange:this.props.onChange}),Object($t.jsx)(jv,{children:Object($t.jsx)("p",{children:"Padding is good for text, but not needed for images."})})]})]})},onLayoutChange:function(e){this.props.onChange({layout:e.target.value})},serialize:function(){return yv.pick(this.props,"correct","layout","padding")}});xv.exports=Sv;var kv=xv.exports,_v={exports:{}};_v.exports;h.a;const Tv=i.a,Mv=x.b,Nv=ce,Pv=gh,Iv=Is.ClassNames,Ev=ls,Av="horizontal",Rv="vertical",Dv="static",Lv="dragging",Fv="animating",zv="disabled",qv=createReactClass({displayName:"Placeholder",render:function(){const{layout:e}=this.props,t=Object(Nn.css)(Vv.card,Vv.placeholder,e===Av&&Vv.horizontalCard),n={width:this.props.width,height:this.props.height};return null!=this.props.margin&&(n.margin=this.props.margin),Object($t.jsx)("li",{className:t,style:n})}}),Wv=createReactClass({displayName:"Draggable",getDefaultProps:function(){return{includePadding:!0,type:Dv,linterContext:je}},getInitialState:function(){return{startPosition:{left:0,top:0},startMouse:{left:0,top:0},mouse:{left:0,top:0}}},componentDidMount:function(){this.isMouseMoveUpBound=!1},componentWillUnmount:function(){this.isMouseMoveUpBound&&this.unbindMouseMoveUp()},getCurrentPosition:function(){return{left:this.state.startPosition.left+this.state.mouse.left-this.state.startMouse.left,top:this.state.startPosition.top+this.state.mouse.top-this.state.startMouse.top}},render:function(){const{includePadding:e,layout:t,type:n}=this.props;let s=Object(Nn.css)(Vv.card,Vv.draggable,t===Av&&Vv.horizontalCard,t===Rv&&Vv.verticalCard,n===Lv&&Vv.dragging,n===Fv&&Vv.animating,n===zv&&Vv.disabled,!e&&Vv.unpaddedCard)+" "+Iv.INTERACTIVE+" perseus-sortable-draggable";e||(s+=" perseus-sortable-draggable-unpadded");const i={position:"static"};return this.props.type!==Lv&&this.props.type!==Fv||Mv.extend(i,{position:"absolute"},this.getCurrentPosition()),this.props.width&&(i.width=this.props.width+1),this.props.height&&(i.height=this.props.height),null!=this.props.margin&&(i.margin=this.props.margin),Object($t.jsx)("li",{className:s,style:i,onMouseDown:this.onMouseDown,onTouchStart:this.onMouseDown,onTouchMove:this.onMouseMove,onTouchEnd:this.onMouseUp,onTouchCancel:this.onMouseUp,children:Object($t.jsx)(Pv,{content:this.props.content,linterContext:Ev.pushContextStack(this.props.linterContext,"draggable"),onRender:this.props.onRender})})},componentDidUpdate:function(e){if(this.props.type!==e.type)if(this.props.type===Fv){const e=this.getCurrentPosition(),t=15*Math.sqrt(Math.sqrt(Math.pow(this.props.endPosition.left-e.left,2)+Math.pow(this.props.endPosition.top-e.top,2)));$(Tv.findDOMNode(this)).animate(this.props.endPosition,{duration:Math.max(t,1),complete:this.props.onAnimationEnd})}else this.props.type===Dv&&$(Tv.findDOMNode(this)).finish()},bindMouseMoveUp:function(){this.isMouseMoveUpBound=!0,$(document).on("mousemove",this.onMouseMove),$(document).on("mouseup",this.onMouseUp)},unbindMouseMoveUp:function(){this.isMouseMoveUpBound=!1,$(document).off("mousemove",this.onMouseMove),$(document).off("mouseup",this.onMouseUp)},onMouseDown:function(e){if(this.props.type!==Dv)return;if(0!==e.button&&(null==e.touches||1!==e.touches.length))return;e.preventDefault();const t=Nv.extractPointerLocation(e);t&&this.setState({startPosition:$(Tv.findDOMNode(this)).position(),startMouse:t,mouse:t},(function(){this.bindMouseMoveUp(),this.props.onMouseDown()}))},onMouseMove:function(e){if(this.props.type!==Lv)return;e.preventDefault();const t=Nv.extractPointerLocation(e);t&&this.setState({mouse:t},this.props.onMouseMove)},onMouseUp:function(e){if(this.props.type!==Lv)return;e.preventDefault();Nv.extractPointerLocation(e)&&(this.unbindMouseMoveUp(),this.props.onMouseUp())}}),Bv=createReactClass({displayName:"Sortable",getDefaultProps:function(){return{layout:Av,padding:!0,disabled:!1,constraints:{},onMeasure:function(){},margin:5,onChange:function(){},linterContext:je}},getInitialState:function(){return{items:this.itemsFromProps(this.props)}},componentWillReceiveProps:function(e){const t=this.props;Mv.isEqual(e.options,t.options)?e.layout===t.layout&&e.padding===t.padding&&e.disabled===t.disabled&&Mv.isEqual(e.constraints,t.constraints)||this.setState({items:this.clearItemMeasurements(this.state.items)}):this.setState({items:this.itemsFromProps(e)})},componentDidUpdate:function(e){this.state.items.length&&!this.state.items[0].width&&this.measureItems()},itemsFromProps:function(e){const t=e.disabled?zv:Dv;return Mv.map(e.options,(function(e,n){return{option:e,key:n,type:t,endPosition:{},width:0,height:0}}))},clearItemMeasurements:function(e){return Mv.map(e,(function(e){return Mv.extend(e,{width:0,height:0})}))},measureItems:function(){let e=Mv.clone(this.state.items);const t=Mv.map(e,(function(e){return $(Tv.findDOMNode(this.refs[e.key]))}),this),n=Mv.invoke(t,"outerWidth"),s=Mv.invoke(t,"outerHeight"),i=this.props.constraints,r=this.props.layout;let o,a;i.width?o=Mv.max(n.concat(i.width)):r===Rv&&(o=Mv.max(n)),i.height?a=Mv.max(s.concat(i.height)):r===Av&&(a=Mv.max(s)),e=Mv.map(e,(function(e,t){return e.width=o||n[t],e.height=a||s[t],e})),this.setState({items:e},(()=>{this.props.onMeasure({widths:n,heights:s})}))},remeasureItems:Mv.debounce((function(){this.setState({items:this.clearItemMeasurements(this.state.items)})}),20),render:function(){const e=[],{layout:t}=this.props,n=Object(Nn.css)(Vv.sortable)+" perseus-sortable";return Mv.each(this.state.items,(function(n,s,i){const r=s===i.length-1,o=n.type===Dv||n.type===zv;let a;this.props.layout===Av?a="0 "+this.props.margin+"px 0 0":this.props.layout===Rv&&(a="0 0 "+this.props.margin+"px 0"),e.push(Object($t.jsx)(Wv,{content:n.option,type:n.type,ref:n.key,width:n.width,height:n.height,layout:t,includePadding:this.props.padding,margin:r&&o?0:a,endPosition:n.endPosition,linterContext:Ev.pushContextStack(this.props.linterContext,"sortable"),onRender:this.remeasureItems,onMouseDown:this.onMouseDown.bind(this,n.key),onMouseMove:this.onMouseMove.bind(this,n.key),onMouseUp:this.onMouseUp.bind(this,n.key),onTouchMove:this.onMouseMove.bind(this,n.key),onTouchEnd:this.onMouseUp.bind(this,n.key),onTouchCancel:this.onMouseUp.bind(this,n.key),onAnimationEnd:this.onAnimationEnd.bind(this,n.key)},n.key)),n.type!==Lv&&n.type!==Fv||e.push(Object($t.jsx)(qv,{ref:"placeholder_"+n.key,width:n.width,height:n.height,layout:t,margin:r?0:a},"placeholder_"+n.key))}),this),Object($t.jsx)("ul",{className:n,children:e})},onMouseDown:function(e){const t=Mv.map(this.state.items,(function(t){return t.key===e&&(t.type=Lv),t}));this.setState({items:t})},onMouseMove:function(e){const t=$(Tv.findDOMNode(this.refs[e])),n=$(Tv.findDOMNode(this)),s=Mv.clone(this.state.items),i=Mv.findWhere(this.state.items,{key:e}),r=this.props.margin,o=Mv.indexOf(s,i);let a=0;if(s.splice(o,1),this.props.layout===Av){const e=t.offset().left-n.offset().left;let i,o=0;Mv.each(s,(function(t){i=t.width,e>o+i/2&&(a+=1),o+=i+r}))}else{const e=t.offset().top-n.offset().top;let i,o=0;Mv.each(s,(function(t){i=t.height,e>o+i/2&&(a+=1),o+=i+r}))}a!==o&&(s.splice(a,0,i),this.setState({items:s}))},onMouseUp:function(e){const t=Mv.map(this.state.items,(function(t){return t.key===e&&(t.type=Fv,t.endPosition=$(Tv.findDOMNode(this.refs["placeholder_"+e])).position()),t}),this);this.setState({items:t}),this.props.onChange({})},onAnimationEnd:function(e){const t=Mv.map(this.state.items,(function(t){return t.key===e&&(t.type=Dv),t}));this.setState({items:t})},getOptions:function(){return Mv.pluck(this.state.items,"option")}}),Vv=Nn.StyleSheet.create({sortable:{boxSizing:"border-box",float:"left",padding:0,margin:0},card:{boxSizing:"border-box",background:"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",minWidth:25,minHeight:44,padding:10,listStyleType:"none",userSelect:"none",touchAction:"none"},placeholder:{background:"#ddd",border:"1px solid #ccc"},draggable:{textAlign:"center"},horizontalCard:{float:"left",cursor:"ew-resize"},verticalCard:{maxWidth:"100%",cursor:"ns-resize"},unpaddedCard:{padding:0},dragging:{background:"#ffedcd",opacity:"0.8"},disabled:{backgroundColor:"inherit",border:"1px solid transparent",cursor:"default"}});_v.exports=Bv;var Hv=_v.exports,Uv={exports:{}},Gv=(Uv.exports,h.a,x.b),$v=Hv,Yv=ce.shuffle,Kv=createReactClass({displayName:"Sorter",getDefaultProps:function(){return{correct:[],layout:"horizontal",padding:!0,problemNum:0,onChange:function(){},linterContext:je}},render:function(){var e=Yv(this.props.correct,this.props.problemNum,!0);const t=this.props.apiOptions.isMobile?8:5;return Object($t.jsx)("div",{className:"perseus-widget-sorter perseus-clearfix",children:Object($t.jsx)($v,{options:e,layout:this.props.layout,margin:t,padding:this.props.padding,onChange:this.handleChange,linterContext:this.props.linterContext,ref:"sortable"})})},handleChange:function(e){this.props.onChange(e),this.props.trackInteraction()},getUserInput:function(){return{options:this.refs.sortable.getOptions()}},simpleValidate:function(e){return Kv.validate(this.getUserInput(),e)}});Gv.extend(Kv,{validate:function(e,t){return{type:"points",earned:Gv.isEqual(e.options,t.correct)?1:0,total:1,message:null}}}),Uv.exports={name:"sorter",displayName:"Sorter",widget:Kv,isLintable:!0};var Xv=Uv.exports,Zv={exports:{}};Zv.exports;h.a;const Jv=x.b,Qv=mu,ex=pu,tx=cd,nx=Gd,sx=createReactClass({displayName:"SimulatorEditor",getDefaultProps:function(){return{xAxisLabel:"Proportion (%)",yAxisLabel:"Number of times seen",numTrials:100,proportionLabel:"Underlying proportion",proportionOrPercentage:"proportion"}},render:function(){return Object($t.jsxs)("div",{className:"perseus-widget-simulator",children:[Object($t.jsxs)("div",{children:[i18n._("X-Axis Label"),":",Object($t.jsx)("input",{type:"text",className:"graph-settings-axis-label",value:this.props.xAxisLabel,onChange:Jv.partial(this.handleTargetValueChange,"xAxisLabel")})]}),Object($t.jsxs)("div",{children:[i18n._("Y-Axis Label"),":",Object($t.jsx)("input",{type:"text",className:"graph-settings-axis-label",value:this.props.yAxisLabel,onChange:Jv.partial(this.handleTargetValueChange,"yAxisLabel")})]}),Object($t.jsxs)("div",{children:[i18n._('"True Proportion" Label'),":",Object($t.jsx)("input",{type:"text",className:"graph-settings-axis-label",value:this.props.proportionLabel,onChange:Jv.partial(this.handleTargetValueChange,"proportionLabel")}),Object($t.jsx)(tx,{children:Object($t.jsx)("p",{children:'This text will be displayed next to the box in which the user enters the sample proportion for their simulation. For example, if your question is about surveying for approval ratings, you might want this to say "Sample approval rating".'})})]}),Object($t.jsxs)("div",{children:[i18n._("Proportion or Percentage"),":",Object($t.jsxs)("select",{className:"perseus-widget-dropdown",value:this.props.proportionOrPercentage,onChange:Jv.partial(this.handleTargetValueChange,"proportionOrPercentage"),children:[Object($t.jsx)("option",{value:"proportion",children:"Proportion"},"proportion"),Object($t.jsx)("option",{value:"percentage",children:"Percentage"},"percentage")]}),Object($t.jsx)(tx,{children:Object($t.jsx)("p",{children:"Do you want the user to describe their simulation in terms of a proportion or a percentage?"})})]}),Object($t.jsxs)("div",{children:[i18n._("Number of trials"),":",Object($t.jsx)(nx,{value:this.props.numTrials,checkValidity:e=>e>=0&&e<=5e3,onChange:this.change("numTrials")}),Object($t.jsx)(tx,{children:Object($t.jsx)("p",{children:"This controls the number of trials used in the simulation. For example, if you set this to 50, then the survey will be conducted 50 times. Warning: setting this too high (i.e., greater than 5000 or so) will freeze the page."})})]})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qv.change.apply(this,t)},handleTargetValueChange:function(e,t){this.change(e,t.target.value)},serialize(){return ex.serialize.call(this)}});Zv.exports=sx;var ix=Zv.exports,rx={exports:{}},ox=(rx.exports,cd),ax=(h.a,i.a),lx=x.b,cx=mu,hx=Is.Options,px=Ei.assert,ux=hc,{Path:dx,Arc:gx,Circle:fx,Label:mx,Line:bx,MovablePoint:vx,MovableLine:xx}=ux,yx=Gd,jx=bg,wx=(ce.seededRNG,ce),Ox=G.a.number;const Cx=Di,Sx=Z;var kx=createReactClass({displayName:"Histogram",getDefaultProps:function(){return{data:null,xAxisLabel:"Proportion (%)",yAxisLabel:"Number of times seen",box:[400,400]}},getInitialState:function(){return{threshold:this._getInitialThreshold(this._range())}},componentWillReceiveProps:function(e){var t=this._range(),n=this._range(e);wx.deepEq(t,n)||this.setState({threshold:this._getInitialThreshold(n)})},_renderThresholdLine:function(){var e=[0,this._range()[1][1]],t=lx.map(e,(e=>[this.state.threshold,e]));return Object($t.jsx)(xx,{onMove:this.handleMouseInteraction,children:lx.map(t,((e,t)=>Object($t.jsx)(vx,{static:!0,coord:e,normalStyle:{stroke:"none",fill:"none"}},t)))})},_renderCircle:function(){var e=this.props.data,t=lx.reduce(e,((e,t)=>e+t),0),n=lx.reduce(e,((e,t,n)=>null!=this.state.threshold&&n<=this.state.threshold?e+t:e),0),s=n/t,i=1e-5,r=[this.props.box[0]-30,30],o=this._range()[0],a=Math.min(Math.max(this.state.threshold,o[0]),o[1]).toFixed(2);return[s>0&&(()=>{var e={key:"below",center:r,radius:20,startAngle:0,endAngle:s<1?360*s:359.99999,sector:1!==s,unscaled:!0,style:{fill:Cx.LIGHT_RED,stroke:Cx.RED}};return Object($t.jsx)(gx,{...e})})(),s<1&&(()=>{var e={key:"above",center:r,radius:20,startAngle:s>0?360*s:i,endAngle:360,sector:0!==s,unscaled:!0,style:{fill:Cx.LIGHT_BLUE,stroke:Cx.BLUE}};return Object($t.jsx)(gx,{...e})})(),(()=>{var e={key:"label",coord:[r[0],r[1]+30],text:n+" of "+t+" results below "+a+"%",direction:"center",tex:!1,unscaled:!0,style:{fontSize:"12px"}};return Object($t.jsx)(mx,{...e})})()]},_renderData:function(){var e=this.props.data;this._range();return lx.map(e,((e,t)=>{if(e){var n=null!=this.state.threshold&&t<=this.state.threshold,s={fill:n?Cx.LIGHT_RED:Cx.LIGHT_BLUE,stroke:n?Cx.RED:Cx.BLUE},i=[[t,0],[t,e],[t+1,e],[t+1,0]];return Object($t.jsx)(dx,{coords:i,style:s},t)}}))},render:function(){var e=this.props.data,t=this._range(),n={xAxisLabel:this.props.xAxisLabel,yAxisLabel:this.props.yAxisLabel,box:this.props.box,range:t,data:e,scale:[wx.scaleFromExtent(t[0],this.props.box[0]),wx.scaleFromExtent(t[1],this.props.box[1])]},s=[t[0][0],0],i=[t[0][1],0];return Object($t.jsxs)(ux,{box:n.box,range:n.range,options:n,setup:this._setupGraphie,onMouseMove:this.handleMouseInteraction,onMouseDown:this.handleMouseInteraction,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable,children:[Object($t.jsx)(bx,{start:s,end:i,style:{stroke:"#000",strokeWidth:1,opacity:1}}),e&&this._renderData(),e&&this._renderCircle(),e&&this._renderThresholdLine()]})},_setupGraphie:function(e,t){var n=t.data,s=t.range,i=t.scale,r=s[0][1]-s[0][0],o=s[1][1]-0,a=Math.ceil(o/20);if(lx.each(lx.range(0,s[1][1],a),(t=>{n&&e.label([s[0][0],t],Sx.roundToApprox(t,2),"left",!0),e.line([s[0][0],t],[s[0][1],t],{stroke:"#000",strokeWidth:1,opacity:.3})})),n){var l=Math.ceil(r/15);lx.each(lx.range(s[0][0],s[0][1],l),(t=>{e.label([t,0],Ox.round(t,2),"below",!0);e.line([t,0],[t,-8/i[1]],{stroke:"#000",strokeWidth:1})}))}var c=[s[0][0],0],h=[s[0][0],s[1][1]];e.line(c,h,{stroke:"#000",strokeWidth:2,opacity:1});var p=s[0][0]+r/2,u=n?25:0;e.label([p,-u/i[1]],t.xAxisLabel,"below",!1).css("font-weight","bold");var d=0+o/2,g=n?55:28;e.label([s[0][0]-g/i[0],d],t.yAxisLabel,"center",!1).css("font-weight","bold").css("-webkit-transform","rotate(-90deg)")},handleMouseInteraction:function(e){this.setState({threshold:e[0]})},_range:function(e){return(e=e||this.props).data?this._getRangeForData(e.data):[[0,100],[-1,10]]},_getRangeForData:function(e){var t=lx.indexOf(e,lx.find(e,(e=>e>0))),n=Math.max(0,t-10),s=lx.lastIndexOf(e,lx.last(lx.filter(e,(e=>e>0))));return[[n,Math.min(101,s+1+10)],[-1,lx.max(e)]]},_getInitialThreshold:function(e){var t=e[0];return t[0]+(t[1]-t[0])/3}}),_x=createReactClass({displayName:"Simulator",getInitialState:function(){return{invalidInput:!1}},getDefaultProps:function(){return{data:null,userProportion:null,sampleSize:null,numTrials:null,randomSeed:0,xAxisLabel:"Proportion (%)",yAxisLabel:"Number of times seen",proportionLabel:"Underlying proportion",proportionOrPercentage:"proportion",apiOptions:hx.defaults}},componentWillMount:function(){null!=this.props.randomSeed&&(this.generateNumber=wx.seededRNG(this.props.randomSeed))},componentWillReceiveProps:function(e){e.randomSeed!==this.props.randomSeed&&(this.generateNumber=wx.seededRNG(e.randomSeed))},render:function(){var e={marginLeft:"5px"},t="0px 0px 0px 2px rgba(255, 165, 0, 1)",n=lx.extend({},e,{WebkitBoxShadow:t,MozBoxShadow:t,boxShadow:t,transition:"all 0.15s"}),s=lx.extend({},e,{transition:"all 0.15s"}),i=this.state.invalidInput?n:s,r=this.props.apiOptions.staticRender?jx:yx,o=Object($t.jsxs)("div",{children:[Object($t.jsx)(r,{ref:"userProportion",style:i,value:this.calculateDisplayProportion(),checkValidity:this.checkProportionValidity,disabled:this.props.apiOptions.readOnly,onChange:this.handleUserProportionChange,onFocus:()=>this.props.onFocus(["userProportion"]),onBlur:()=>this.props.onBlur(["userProportion"])}),Object($t.jsx)(ox,{children:Object($t.jsx)("p",{children:"This controls the proportion or percentage that will be used in your simulation."})})]}),a=Object($t.jsxs)("div",{children:[Object($t.jsx)(r,{ref:"sampleSize",style:i,value:this.props.sampleSize,checkValidity:e=>e>=0,disabled:this.props.apiOptions.readOnly,onChange:this.handleSampleSizeChange,onFocus:()=>this.props.onFocus(["sampleSize"]),onBlur:()=>this.props.onBlur(["sampleSize"])}),Object($t.jsx)(ox,{children:Object($t.jsx)("p",{children:"This controls the sample size that will be used in your simulation. For example, if you set this to 100, then for each trial, responses from 100 participants will be simulated."})})]}),l=Object($t.jsxs)("div",{style:{textAlign:"right"},children:[Object($t.jsx)("b",{children:this.props.numTrials}),Object($t.jsx)(ox,{children:Object($t.jsx)("p",{children:"This is the number of trials used in the simulation. For example, if set to 50, then the survey will be conducted 50 times."})})]}),c=[{title:this.props.proportionLabel+":",value:o},{title:"Sample size:",value:a},{title:"Number of trials:",value:l}],h=Object($t.jsx)("button",{className:"simple-button",style:{margin:"20px 0"},disabled:this.props.apiOptions.readOnly,onClick:this.handleRunSimulation,children:i18n._("Run simulation")}),p={paddingBottom:this.props.data?40:0},u=Object($t.jsx)("div",{style:p,children:Object($t.jsx)(kx,{data:this.props.data,xAxisLabel:this.props.xAxisLabel,yAxisLabel:this.props.yAxisLabel,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable})});return Object($t.jsxs)("div",{children:[(e=>{var t=Object($t.jsx)("thead",{children:Object($t.jsxs)("tr",{children:[Object($t.jsx)("th",{children:"Parameter"}),Object($t.jsx)("th",{children:"Value"})]})}),n=Object($t.jsx)("tbody",{children:lx.map(e,((e,t)=>Object($t.jsxs)("tr",{children:[Object($t.jsx)("td",{children:e.title}),Object($t.jsx)("td",{children:e.value})]},t)))});return Object($t.jsxs)("table",{children:[t,n]})})(c),h,u]})},calculateDisplayProportion:function(){var e=this.props.userProportion;return"percentage"===this.props.proportionOrPercentage?Math.round(100*e):e},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return cx.change.apply(this,t)},checkProportionValidity:function(e){return e>=0&&"proportion"===this.props.proportionOrPercentage&&e<=1||"percentage"===this.props.proportionOrPercentage&&e<=100},handleUserProportionChange:function(e,t){var n;null!=(n="percentage"===this.props.proportionOrPercentage?e/100:e)&&(n=Math.min(1,Math.max(0,n))),this.props.onChange({userProportion:n},t)},handleSampleSizeChange:function(e,t){null!=e&&(e=Math.min(1e3,Math.max(0,Math.floor(e)))),this.props.onChange({sampleSize:e},t)},handleRunSimulation:function(){null!=this.props.numTrials&&null!=this.props.userProportion&&null!=this.props.sampleSize?(this.setState({invalidInput:!1}),this.props.onChange({data:this.generateData()}),this.props.trackInteraction()):this.setState({invalidInput:!0})},generateData:function(e){return((e,t,n)=>{var s=()=>this.generateNumber()<n,i=lx.times(101,(()=>0));return lx.times(t,(()=>{var t=lx.times(e,s),n=lx.filter(t,lx.identity).length,r=Math.floor(100*n/e);i[r]++})),i})((e=e||this.props).sampleSize,e.numTrials,e.userProportion)},getInputPaths:function(){return[["userProportion"],["sampleSize"]]},focus:function(){var e=lx.head(this.getInputPaths());return this.focusInputPath(e),!0},focusInputPath:function(e){px(e.length>0);var t=lx.head(e);this.refs[t].focus()},blurInputPath:function(e){px(e.length>0);var t=lx.head(e);this.refs[t].blur()},getDOMNodeForPath:function(e){px(e.length>0);var t=lx.head(e);return ax.findDOMNode(this.refs[t])},getGrammarTypeForPath:function(e){return px(e.length>0),"number"},setInputValue:function(e,t,n){px(e.length>0);var s=lx.head(e);this["handle"+(s.charAt(0).toUpperCase()+s.slice(1))+"Change"](t,n)},getUserInput:function(){return null},simpleValidate:function(e){return _x.validate(this.getUserInput(),e)}});lx.extend(_x,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}});rx.exports={name:"simulator",displayName:"Simulator",widget:_x,transform:e=>{var t=lx.clone(e);return t.randomSeed=e.problemNum,t},hidden:!0};var Tx=rx.exports,Mx={exports:{}};Mx.exports;h.a;const Nx=x.b,Px=lv,Ix=Kt;var Ex=createReactClass({displayName:"StepControlButton",render:function(){return Object($t.jsx)("a",{href:"#",className:"step-control-button simple-button simple-button--small orange",onClick:e=>{e.preventDefault(),this.props.onClick()},children:Object($t.jsx)(Ix,{...this.props.icon})})}});const Ax=createReactClass({displayName:"SequenceEditor",getDefaultProps:function(){return{json:[{content:"",widgets:{},images:{}}]}},render:function(){return Object($t.jsx)("div",{className:"perseus-sequence-editor",children:Nx.map(this.props.json,((e,t)=>Object($t.jsxs)("div",{children:["Step ",t+1,Object($t.jsxs)("div",{style:{display:"inline-block",float:"right"},children:[t+1<this.props.json.length&&Object($t.jsx)(Ex,{icon:da,onClick:()=>{this._handleMoveStepLater(t)}}),t>0&&Object($t.jsx)(Ex,{icon:ga,onClick:()=>{this._handleMoveStepEarlier(t)}}),Object($t.jsx)(Ex,{icon:_a,onClick:()=>{confirm("Are you sure you want to remove step "+(t+1)+"?")&&this._handleRemoveStep(t)}}),Object($t.jsx)(Ex,{icon:wa,onClick:()=>{this._handleAddStepAfter(t)}})]}),Object($t.jsx)(Px,{ref:"editor"+t,apiOptions:this.props.apiOptions,content:e.content,widgets:e.widgets,images:e.images,widgetEnabled:!0,immutableWidgets:!1,onChange:Nx.partial(this._handleEditorChange,t)})]},t)))})},_handleEditorChange:function(e,t){var n=Nx.clone(this.props.json);n[e]=Nx.extend({},n[e],t),this.props.onChange({json:n})},serialize:function(){return{json:Nx.times(this.props.json.length,(e=>this.refs["editor"+e].serialize()))}},_handleMoveStepEarlier:function(e){if(0!==e){var t=Nx.clone(this.props.json),n=t[e];t.splice(e,1),t.splice(e-1,0,n),this.props.onChange({json:t})}},_handleMoveStepLater:function(e){var t=Nx.clone(this.props.json);if(e+1!==t.length){var n=t[e];t.splice(e,1),t.splice(e+1,0,n),this.props.onChange({json:t})}},_handleAddStepAfter:function(e){var t=Nx.clone(this.props.json),n=e>=0?{widgets:t[e].widgets}:{};t.splice(e+1,0,n),this.props.onChange({json:t})},_handleRemoveStep:function(e){var t=Nx.clone(this.props.json);t.splice(e,1),this.props.onChange({json:t})}});Mx.exports=Ax;var Rx=Mx.exports,Dx={exports:{}},Lx=(Dx.exports,h.a,x.b),Fx=mu;const zx=Kt;var qx=gh,Wx=ce,Bx=createReactClass({displayName:"Sequence",getDefaultProps:function(){return{json:[{content:"",widgets:{},images:{}}],linterContext:je}},getInitialState:function(){return{visible:1}},shouldComponentUpdate:function(e,t){return e!==this.props||t!==this.state},render:function(){var e=Object($t.jsx)(zx,{...ja,style:{color:"green"}}),t=Lx.chain(this.props.json).first(this.state.visible).map(((e,t)=>`[[${Wx.snowman} group ${t}]]`)).join("\n\n").value(),n={};return Lx.each(this.props.json,((t,s)=>{n[`group ${s}`]={type:"group",graded:!0,version:{major:0,minor:0},options:Lx.extend({},t,{icon:s<this.state.visible-1?e:null})}})),Object($t.jsx)("div",{className:"perseus-sequence",children:Object($t.jsx)(qx,{ref:"renderer",content:t,widgets:n,onInteractWithWidget:this._handleInteraction,apiOptions:this.props.apiOptions,linterContext:this.props.linterContext})})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Fx.change.apply(this,t)},_handleInteraction:function(e){var t=parseInt(e.split(" ")[1]);if(t===this.state.visible-1){var n=this.refs.renderer.getWidgetInstance("group "+t);n.showRationalesForCurrentlySelectedChoices();var s=n.simpleValidate();"points"===s.type&&s.total===s.earned&&(this.setState({visible:this.state.visible+1}),this.props.trackInteraction({visible:this.state.visible+1}))}}});Dx.exports={name:"sequence",displayName:"Graded Sequence",widget:Bx,traverseChildWidgets:function(e,t){var n=e.json;Lx.isArray(n)||(n=[n]);var s=Lx.map(n,(e=>t(e)));return Lx.extend({},e,{json:s})},tracking:"all",hidden:!0,isLintable:!0};var Vx=Dx.exports,Hx={exports:{}};Hx.exports;h.a;const Ux=i.a,Gx=createReactClass({displayName:"TextInput",getDefaultProps:function(){return{value:"",disabled:!1}},render:function(){const{labelText:e,...t}=this.props;return Object($t.jsx)("input",{...t,type:"text","aria-label":e,onChange:e=>this.props.onChange(e.target.value)})},focus:function(){Ux.findDOMNode(this).focus()},blur:function(){Ux.findDOMNode(this).blur()},getValue:function(){return Ux.findDOMNode(this).value},getStringValue:function(){return Ux.findDOMNode(this).value.toString()},setSelectionRange:function(e,t){Ux.findDOMNode(this).setSelectionRange(e,t)},getSelectionStart:function(){return Ux.findDOMNode(this).selectionStart},getSelectionEnd:function(){return Ux.findDOMNode(this).selectionEnd}});Hx.exports=Gx;var $x=Hx.exports,Yx={exports:{}};Yx.exports;h.a;const Kx=mu,Xx=pu,Zx=Gd,Jx=$x;var Qx=createReactClass({displayName:"ReactionDiagramWidgetEditor",getDefaultProps:function(){return{smiles:["",""],rotationAngle:[0,0],separators:[{type:"right",topText:"",bottomText:""}]}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Kx.change.apply(this,t)},updateMolecule:function(e){return function(t){const n=[...this.props.smiles];n[e]=t,this.change({smiles:n})}.bind(this)},updateRotation:function(e){return function(t){const n=[...this.props.rotationAngle];n[e]=t,this.change({rotationAngle:n})}.bind(this)},updateSeparators:function(e,t){return n=>{const s=this.props.separators.map((e=>({...e})));s[e][t]=n,this.change({separators:s})}},serialize(){return Xx.serialize.call(this)},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["LHS SMILES:\xa0",Object($t.jsx)(Jx,{onChange:this.updateMolecule(0),value:this.props.smiles[0]})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["LHS Rotation (deg):\xa0",Object($t.jsx)(Zx,{onChange:this.updateRotation(0),value:this.props.rotationAngle[0]})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["RHS SMILES:\xa0",Object($t.jsx)(Jx,{onChange:this.updateMolecule(1),value:this.props.smiles[1]})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["RHS Rotation (deg):\xa0",Object($t.jsx)(Zx,{onChange:this.updateRotation(1),value:this.props.rotationAngle[1]})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Top of arrow text:\xa0",Object($t.jsx)(Jx,{onChange:this.updateSeparators(0,"topText"),value:this.props.separators[0].topText})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Bottom of arrow text:\xa0",Object($t.jsx)(Jx,{onChange:this.updateSeparators(0,"bottomText"),value:this.props.separators[0].bottomText})]})})]})}});Yx.exports=Qx;var ey=Yx.exports,ty={exports:{}};ty.exports;const ny=new RegExp("^[A-Za-z\\[\\]()=#+-]*$"),sy=new RegExp("^(Cl|Br|[CONPSFBI]|\\[)");function iy(e){this.message=e}function ry(e,t,n){const s=t[0],i=t.slice(1);let r;r=Array.isArray(e)?[...e]:{...e||{}};let o=n;return i.length>0&&(o=ry(r[s],i,n)),r[s]=o,r}function oy(e,t){if(0===t.length)return e;if(""===e)throw new iy("Mismatched parentheses");const n=e[0],s=e.slice(1);return oy(s,"("===n?t.concat(n):")"===n?t.slice(1):t)}function ay(e,t){const n=e[0],s=e.slice(1);if("("===n){let e={...t,parens:t.parens+"("};e=function(e,t){const n=t.reduce((function(e,t){return e[t]}),e);return ry(e,t,n+1)}(t,["idx",t.idx.length-1,1]);let n=-1;t.idx[t.idx.length-1][0]%2===0&&(n=0);const i=cy(s,{...e,idx:e.idx.concat([[n,0]]),parens:e.parens.concat("(")}),r=cy(oy(s,["("]),e);return[i].concat(r)}if(")"===n){if("("!==t.parens[t.parens.length-1])throw new iy("Mismatched parentheses");return null}throw new iy("Invalid bare character: "+n)}function ly(e,t){const n=function(e,t){let n=null,s=null;if("["===e[0]){const t=e.indexOf("]");if(-1===t)return["",e];n=e.slice(1,t),s=e.slice(t+1)}else n=sy.exec(e)[1],s=e.slice(n.length);return[n,s]}(e),s=n[0];if(""===s)return["error","Unable to parse bracketed atom."];const i=n[1],r=ry(t,["idx",t.idx.length-1],[1+t.idx[t.idx.length-1][0],0]);let o=cy(i,ry(r,["bond","bondType"],"single"));!Array.isArray(o)&&o&&(o=[o]);const a={type:"atom",symbol:s,bonds:o,idx:r.idx};return t.bond?{type:"bond",bondType:t.bond.bondType,to:a}:a}function cy(e,t){if(!function(e){return ny.test(e)}(e))throw new iy("Invalid input.");return e&&0!==e.length?(n=e,sy.test(n)?ly(e,t||{idx:[[0,0]],parens:[],stack:[],bondModifiers:[]}):function(e){return"="===e||"#"===e}(e[0])?function(e,t){const n=e[0],s=e.slice(1);if("="===n)return cy(s,ry(t,["bond","bondType"],"double"));if("#"===n)return cy(s,ry(t,["bond","bondType"],"triple"));throw new iy("Invalid character: "+n)}(e,t):ay(e,t)):null;var n}ty.exports={parse:cy,ParseError:iy};var hy=ty.exports,py={exports:{}};py.exports;const uy=30;function dy(e,t,n,s){let i=e.symbol;if("C"===i&&1!==Object.keys(t).length&&(i=null),"1,0"===e.idx){const t=[0,0];return e.pos=t,e.baseAngle=-30+s,{type:"text",value:i,pos:t,idx:e.idx}}const r=t[e.connections.find((function(e){return t[e].pos}))],o=r.connections.indexOf(e.idx);let a=60,l=120;4===r.connections.length?(l=90,a=90):(n.find((t=>"triple"===t.bondType&&t.to===e.idx))||n.find((e=>"triple"===e.bondType&&e.to===r.idx)))&&(l=0,a=0);let c=0;const h=r.idx.split(":"),p=h[h.length-1].split(",")[0];c=parseInt(p)%2!==0?r.baseAngle-(a-l*o):r.baseAngle+(a-l*o);const u=function(e,t,n){const s=e[0],i=e[1];return[s+Math.cos(2*t*Math.PI/360)*n,i+-1*Math.sin(2*t*Math.PI/360)*n]}(r.pos,c,uy);return e.pos=u,e.baseAngle=c,{type:"text",value:i,pos:u,idx:e.idx}}function gy(e,t){const n=function(e,t){let n=[e.pos[0],e.pos[1]],s=[t.pos[0],t.pos[1]];return"C"!==e.symbol&&(n=[t.pos[0]-.75*(t.pos[0]-e.pos[0]),t.pos[1]-.75*(t.pos[1]-e.pos[1])]),"C"!==t.symbol&&(s=[e.pos[0]-.75*(e.pos[0]-t.pos[0]),e.pos[1]-.75*(e.pos[1]-t.pos[1])]),[n,s]}(t[e.from],t[e.to]);return{type:"line:"+e.bondType,startPos:n[0],endPos:n[1]}}function fy(e){return e.join(":")}function my(e,t,n){if(null===n)return[e,t];if("atom"===n.type){const s=fy(n.idx);e[s]={idx:s,symbol:n.symbol,connections:[]},n.bonds&&n.bonds.forEach((function(n){const i=fy(n.to.idx);e[s].connections.push(i),t.push({from:s,to:i,bondType:n.bondType}),my(e,t,n.to),e[i].connections.push(s)}))}return[e,t]}function by(e,t,n,s,i){if(0===t.length)return e;const r=t.shift(),o=n[r];return o.connections.forEach((function(e){n[e].pos||t.push(e)})),by(e.concat(dy(o,n,s,i)),t,n,s,i)}function vy(e,t,n){return 0===n.length?e:vy(e.concat(gy(n[0],t)),t,n.slice(1))}function xy(e,t){const n=my({},[],e),s=n[0],i=n[1];return vy(by([],["1,0"],s,i,t),s,i)}py.exports={layout:xy,_atomLayout:dy,_bondLayout:gy,_bondLength:uy,_convertTree:my};py.exports;var yy={exports:{}};yy.exports;function jy(e,t){const n=new Path2D;e.lineWidth=Sy.lineWidth,e.strokeStyle=Sy.fgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n)}const wy={text:function(e,t){null!==t.value&&(e.fillStyle=Sy.fgColor,e.font=Sy.font,e.fillText(t.value,t.pos[0]-Sy.fontSizePx/2+1,t.pos[1]+Sy.fontSizePx/2))},"line:single":jy,"line:double":function(e,t){let n=new Path2D;e.lineWidth=5*Sy.lineWidth,e.strokeStyle=Sy.fgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n),n=new Path2D,e.lineWidth=3*Sy.lineWidth,e.strokeStyle=Sy.bgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n)},"line:triple":function(e,t){let n=new Path2D;e.lineWidth=7*Sy.lineWidth,e.strokeStyle=Sy.fgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n),n=new Path2D,e.lineWidth=5*Sy.lineWidth,e.strokeStyle=Sy.bgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n),jy(e,t)}};const Oy={"line:single":0,"line:double":0,"line:triple":0,text:1};function Cy(e,t){return Oy[e.type]-Oy[t.type]}const Sy={bgColor:"rgb(255, 255, 255)",fgColor:"rgb(0, 0, 0)",fontSizePx:12,lineWidth:1};Sy.font=Sy.fontSizePx+"px sans",yy.exports=function(e,t){t.sort(Cy).forEach(function(e){return function(t){wy[t.type](e,t)}}(e))};var ky=yy.exports,_y={exports:{}};_y.exports;h.a;const Ty=ky,My=hy,Ny=My.parse,Py=My.ParseError,Iy=createReactClass({displayName:"Molecule",getInitialState:function(){return{parsedSmiles:null,error:null}},componentWillMount:function(){this.stateFromSmiles(this.props.smiles)},componentDidMount:function(){this.canvasRender()},componentWillReceiveProps:function(e){this.stateFromSmiles(e.smiles)},componentDidUpdate:function(){this.canvasRender()},stateFromSmiles:function(e){try{this.setState({parsedSmiles:Ny(e),error:null})}catch(t){if(!(t instanceof Py))throw t;this.setState({error:t.message})}},setCanvasBounds:function(e,t){const n=Math.max(...t.map((e=>e.pos?e.pos[0]:-1/0))),s=Math.max(...t.map((e=>e.pos?e.pos[1]:-1/0))),i=Math.min(...t.map((e=>e.pos?e.pos[0]:1/0))),r=Math.min(...t.map((e=>e.pos?e.pos[1]:1/0))),o=n-i+60,a=s-r+60;return e.width=o,e.height=a,[30-i,30-r]},canvasRender:function(){if(this.state.error||!this.state.parsedSmiles)return;const e=xy(this.state.parsedSmiles,this.props.rotationAngle),t=this.refs.canvas,n=this.setCanvasBounds(t,e),s=t.getContext("2d");s.clearRect(0,0,t.width,t.height),s.save(),s.translate(n[0],n[1]),Ty(s,e),s.restore()},render:function(){let e=Object($t.jsxs)("canvas",{className:"molecule-canvas",id:this.props.id+"-molecule",ref:"canvas",children:["A molecular structure drawing. SMILES notation:",this.props.smiles,"."]});return this.state.error&&(e=Object($t.jsx)("div",{className:"error",children:this.state.error})),Object($t.jsx)("div",{className:"molecule-canvas",children:e})}}),Ey=createReactClass({displayName:"MoleculeWidget",getDefaultProps:function(){return{rotationAngle:0}},simpleValidate:function(){return{type:"points",earned:0,total:0,message:null}},getUserInput:function(){return[]},validate:function(e,t){return{type:"points",earned:0,total:0,message:null}},render:function(){return Object($t.jsx)(Iy,{id:this.props.widgetId,smiles:this.props.smiles,rotationAngle:this.props.rotationAngle})}});_y.exports={name:"molecule-renderer",displayName:"Molecule renderer",hidden:!0,widget:Ey,molecule:Iy};var Ay=_y.exports,Ry={exports:{}};Ry.exports;h.a;const Dy=Ay.molecule,Ly=createReactClass({displayName:"Separator",componentDidMount:function(){this.drawArrow()},componentDidUpdate:function(){this.drawArrow()},arrowLength:100,drawArrow:function(){const e=this.refs["arrowCanvas"+this.props.index],t=e.getContext("2d");t.clearRect(0,0,e.width,e.height);const n=new Path2D;t.strokeStyle="rgb(0,0,0)",t.lineWidth=1.2,t.lineCap="round";n.moveTo(5,e.height/2),n.lineTo(e.width-5,e.height/2),n.moveTo(e.width-10,e.height/2-5),n.lineTo(e.width-5,e.height/2),n.moveTo(e.width-10,e.height/2+5),n.lineTo(e.width-5,e.height/2),t.stroke(n)},render:function(){return Object($t.jsxs)("div",{className:"arrow-container",children:[Object($t.jsx)("div",{className:"above-text",children:this.props.data.topText}),Object($t.jsx)("canvas",{height:"30",id:"arrowCanvas"+this.props.index,ref:"arrowCanvas"+this.props.index,width:this.arrowLength,children:"Reaction arrow pointing to the right."}),Object($t.jsx)("div",{className:"below-text",children:this.props.data.bottomText})]})}}),Fy=createReactClass({displayName:"ReactionDiagramWidget",getDefaultProps:function(){return{smiles:[],rotationAngle:[],separators:[]}},simpleValidate:function(){return{type:"points",earned:0,total:0,message:null}},getUserInput:function(){return[]},validate:function(e,t){return{type:"points",earned:0,total:0,message:null}},focus:function(){return!0},render:function(){return Object($t.jsx)("div",{className:"reaction",ref:"reaction",children:this.props.smiles.map(((e,t)=>{const n=this.props.widgetId+"-"+t;return Object($t.jsxs)("div",{className:"molecule-container",children:[Object($t.jsx)(Dy,{id:n,rotationAngle:this.props.rotationAngle[t],smiles:e}),t===this.props.smiles.length-1?null:Object($t.jsx)(Ly,{data:this.props.separators[t],index:t})]},n)}))})}});Ry.exports={name:"reaction-diagram",displayName:"Chemical reaction",hidden:!0,widget:Fy};var zy=Ry.exports,qy={exports:{}},Wy=(qy.exports,h.a,i.a),By=x.b,Vy=Is.ClassNames,Hy=ce.deepEq;const Uy=Z,Gy=Di,$y=no,Yy=Cl,Ky=rr;var Xy="bar",Zy="line",Jy="pic",Qy="histogram",ej="dotplot";PropTypes.oneOf([Xy,Zy,Jy,Qy,ej]),PropTypes.arrayOf(PropTypes.string),PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.number,PropTypes.string])),PropTypes.number,PropTypes.number,PropTypes.number,PropTypes.number,PropTypes.number,PropTypes.string,PropTypes.arrayOf(PropTypes.number),PropTypes.number,PropTypes.arrayOf(PropTypes.number),PropTypes.bool;var tj=createReactClass({displayName:"Plotter",getDefaultProps:function(){return{type:Xy,labels:["",""],categories:[""],scaleY:1,maxY:10,snapsPerLine:2,picSize:40,picBoxHeight:48,picUrl:"",plotDimensions:[380,300],labelInterval:1}},getInitialState:function(){return{values:this.props.starting||[1]}},DOT_PLOT_POINT_SIZE:function(){return this.props.apiOptions.isMobile?6:4},DOT_PLOT_POINT_PADDING:function(){return 8},DOT_TICK_POINT_SIZE:function(){return 2},render:function(){const e={marginBottom:this.props.labels[0]?75:0};return Object($t.jsx)("div",{className:"perseus-widget-plotter graphie "+Vy.INTERACTIVE,ref:"graphieDiv",style:e})},componentDidUpdate:function(e,t){this.shouldSetupGraphie&&this.setupGraphie(t)},componentDidMount:function(){this.setupGraphie(this.state)},componentWillReceiveProps:function(e){this.shouldSetupGraphie=By.any(["type","labels","categories","scaleY","maxY","snapsPerLine","picUrl","labelInterval","static"],(function(t){return!By.isEqual(this.props[t],e[t])}),this),By.isEqual(this.props.starting,e.starting)||By.isEqual(this.state.values,e.starting)||(this.shouldSetupGraphie=!0,this.setState({values:e.starting}))},setupGraphie:function(e){var t=this;t.shouldSetupGraphie=!1;var n=Wy.findDOMNode(t.refs.graphieDiv);$(n).empty();var s=$y.createGraphie(n);t.graphie=s,t.graphie.pics=[],t.graphie.dotTicks=[];var i=t.props.type===Xy,r=t.props.type===Zy,o=t.props.type===Jy,a=t.props.type===Qy,l=t.props.type===ej,c=o||l,h={},p=h;const u=this.props.apiOptions.isMobile;p.graph={lines:[],bars:[],points:[],dividers:[]},p.scaleY=t.props.scaleY,p.dimX=t.props.categories.length;var d=u?[288,336]:t.props.plotDimensions;if(r)p.dimX+=u?-.2:1;else if(a)p.barPad=0,p.barWidth=1;else if(i)p.barPad=u?.08:.15,p.barWidth=1-2*p.barPad,p.dimX+=(u?-2:2)*p.barPad;else if(c){p.picBoxHeight=t.props.picBoxHeight,p.picBoxWidthPx=d[0]/t.props.categories.length;var g=d[0]-p.dimX*p.picBoxWidthPx;p.picPad=g/(2*p.dimX+2);var f=p.picBoxWidthPx+2*p.picPad;p.picPad=p.picPad/f,p.picBoxWidth=p.picBoxWidthPx/f,p.dimX+=2*p.picPad}l&&(p.picBoxHeight=2*this.DOT_PLOT_POINT_SIZE()+this.DOT_PLOT_POINT_PADDING()),p.dimY=Math.ceil(t.props.maxY/p.scaleY)*p.scaleY;var m=25,b=25;if((i||r)&&u&&(m=0!==t.props.labels[1].length?17:11),l&&(m/=2),u&&c&&0===t.props.labels[1].length&&(m=0),p.scale=u?By.map([[p.dimX,m],[p.dimY,b]],((e,t)=>{let[n,s]=e;return(d[t]-4*s)/n})):By.map([p.dimX,p.dimY],(function(e,t){return d[t]/e})),m/=p.scale[0],b/=p.scale[1],c&&(p.scale[1]=p.picBoxHeight/p.scaleY),s.init({range:[[-3*m,p.dimX+m],[-3*b,p.dimY+b]],scale:p.scale,isMobile:this.props.apiOptions.isMobile}),s.addMouseLayer({allowScratchpad:!0,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),!c){for(var v=u?p.scaleY:0;v<=p.dimY;v+=p.scaleY)s.label([0,v],Uy.roundToApprox(v,2),"left",!0),s.style({stroke:u?"#e9ebec":"#000",strokeWidth:1,opacity:u?1:.3},(function(){s.line([0,v],[p.dimX,v])}))}(i||r)&&u&&(t.graphie.dragPrompt=s.label([p.dimX/2,p.dimY/2],"Drag handles to make graph","center",!1).css("font-weight","bold").css("color",Gy.KA_GREEN).css("display","none")),t.setupCategories(h),c&&u&&(t.graphie.dotPrompt=s.label([p.dimX/2,p.dimY/2],"Tap to add points","center",!1).css("font-weight","bold").css("color",Gy.KA_GREEN).css("display","none")),c&&t.drawPicHeights(t.state.values,e.values),s.style({stroke:"#000",strokeWidth:2,opacity:1},(function(){c?l?s.style({stroke:u?Gy.GRAY_G:"#000",strokeWidth:u?1:2},(()=>s.line([u?0:.5,0],[p.dimX-(u?0:.5),0]))):(s.line([0,0],[p.dimX,0]),0===t.props.labels[1].length&&u||s.style({stroke:u?Gy.GRAY_G:"#000",strokeWidth:u?1:2},(()=>s.line([0,0],[0,p.dimY])))):(s.style({stroke:u?Gy.GRAY_G:"#000",strokeWidth:u?1:2},(()=>s.line([u?3*-m:0,0],[p.dimX+(u?m:0),0]))),(i||r)&&u||s.style({stroke:u?Gy.GRAY_G:"#000",strokeWidth:u?1:2},(()=>s.line([0,0],[0,p.dimY]))))})),s.label([p.dimX/2,u?3*-b:-35/p.scale[1]],t.props.labels[0],u?"above":"below",!1).css("font-weight","bold").css("color",u&&Gy.GRAY_F),s.label([(u?-35:-60)/p.scale[0],p.dimY/2],t.props.labels[1],"center",!1).css("font-weight","bold").css("color",u&&Gy.GRAY_F).addClass("rotate"),this.props.apiOptions.isMobile&&(this.horizHairline=new Ky(this.graphie,[0,0],[0,0],{normalStyle:{strokeWidth:1}}),this.horizHairline.attr({stroke:Gy.INTERACTIVE}),this.horizHairline.hide(),this.hairlineRange=[[0,p.dimX],[0,p.dimY]])},showHairlines:function(e){this.props.apiOptions.isMobile&&"none"!==this.props.markings&&(this.horizHairline.moveTo([this.hairlineRange[0][0],e[1]],[this.hairlineRange[0][1],e[1]]),this.horizHairline.show())},hideHairlines:function(){this.props.apiOptions.isMobile&&this.horizHairline.hide()},labelCategory:function(e,t){const n=this.props.apiOptions.isMobile;var s=this.graphie,i=!1,r=(t+="").match(/^\$(.*)\$$/);r&&(t=r[1],i=!0);this.props.labels[0].length;s.style({color:n?Gy.GRAY_G:"inherit",transform:n&&!r?"translateX(-50%) translateX(5px) translateY(-50%) rotate(-45deg)":"none",transformOrigin:"100%"},(()=>s.label([e,n?-.5:0],t,"below",i)))},setupCategories:function(e){var t=this,n=e,s=t.graphie;const i=this.props.apiOptions.isMobile;t.props.type===Qy?(By.times(t.props.categories.length-1,(function(n){t.setupBar({index:n,startHeight:t.state.values[n],config:e,isHistogram:!0})})),By.each(t.props.categories,(function(e,r){var o=.5+r*n.barWidth;t.labelCategory(o,e);var a=6/n.scale[1];s.style({stroke:"#000",strokeWidth:i?1:2,opacity:1},(function(){s.line([o,-a],[o,0])}))}))):By.each(t.props.categories,(function(r,o){var a,l=t.state.values[o];t.props.type===Xy?a=t.setupBar({index:o,startHeight:l,config:e,isHistogram:!1}):t.props.type===Zy?a=t.setupLine(o,l,e):t.props.type===Jy?a=t.setupPic(o,e):t.props.type===ej&&(a=t.setupDotplot(o,e));var c=0,h=-6/n.scale[1];t.props.type!==ej||i||(c=-h),t.props.type===ej?o%t.props.labelInterval!==0&&o!==t.props.categories.length-1||(t.labelCategory(a,r),c*=1.5,h*=1.5):t.labelCategory(a,r),s.style({stroke:i?Gy.GRAY_G:"#000",strokeWidth:i?1:2,opacity:1},(function(){s.line([a,c],[a,h])}))}))},_clampValue:function(e,t,n){return Math.max(Math.min(e,n),t)},_maybeShowDragPrompt:function(){null!=this.graphie.dragPrompt&&(this.graphie.dragPrompt[0].style.display="inline")},_maybeHideDragPrompt:function(){null!=this.graphie.dragPrompt&&(this.graphie.dragPrompt[0].style.display="none")},setupBar:function(e){const t=this.props.apiOptions.isMobile;var n,s=e.index,i=e.startHeight,r=e.config,o=e.isHistogram,a=this,l=a.graphie,c=r.barWidth/2;n=o?.5+s*r.barWidth+c:(t?c:.5+r.barPad)+s;var h=function(e,n){var s=l.scalePoint(0);if(r.graph.bars[e].scale(1,Math.max(t?.2:.01,n/r.scaleY),s[0],s[1]),o){var i=r.graph.dividers[e-1],c=r.graph.dividers[e];if(i){var h=Math.min(a.state.values[e-1],n);i.scale(1,Math.max(.01,h/r.scaleY),s[0],s[1])}if(c){h=Math.min(a.state.values[e+1],n);c.scale(1,Math.max(.01,h/r.scaleY),s[0],s[1])}}};if(l.style({stroke:"none",fill:t?Gy.BLUE_C:Gy.LIGHT_BLUE,opacity:1},(function(){r.graph.bars[s]=l.path([[n-c,0],[n-c,r.scaleY],[n+c,r.scaleY],[n+c,0],[n-c,0]])})),o&&s>0&&l.style({stroke:"#000",strokeWidth:1,opacity:.3},(function(){r.graph.dividers.push(l.path([[n-c,0],[n-c,r.scaleY]]))})),t){const e=r.scaleY/a.props.snapsPerLine;r.graph.lines[s]=Yy.addMaybeMobileMovablePoint(this,{coord:[n,i],constraints:[(t,s,i)=>[n,this._clampValue(Math.round(t[1]/e)*e,0,r.dimY)]],onMoveStart:function(){r.graph.bars[s].attr({fill:Gy.INTERACTIVE})},onMove:function(){const e=r.graph.lines[s].coord()[1];var t=By.clone(a.state.values);t[s]=e,a.setState({values:t}),a.changeAndTrack({values:t}),a._maybeHideDragPrompt(),h(s,e)},onMoveEnd:function(){r.graph.bars[s].attr({fill:Gy.BLUE_C})}}),r.graph.lines[s].state.visibleShape.wrapper.style.zIndex="1",a._maybeShowDragPrompt()}else r.graph.lines[s]=l.addMovableLineSegment({coordA:[n-c,i],coordZ:[n+c,i],snapY:r.scaleY/a.props.snapsPerLine,constraints:{constrainX:!0},normalStyle:{stroke:Gy.INTERACTIVE,"stroke-width":this.props.static?0:4}}),r.graph.lines[s].onMove=function(e,t){var n=this.coordA[1];(n<0||n>r.dimY)&&(n=Math.min(Math.max(n,0),r.dimY),this.coordA[1]=this.coordZ[1]=n,this.transform());var i=By.clone(a.state.values);i[s]=n,a.setState({values:i}),a.changeAndTrack({values:i}),h(s,n)};return h(s,i),n},setupLine:function(e,t,n){const s=this.props.apiOptions.isMobile;var i=this,r=n,o=i.graphie,a=e+(s?.4:1);if(s){const s=n.scaleY/i.props.snapsPerLine;r.graph.points[e]=Yy.addMaybeMobileMovablePoint(this,{coord:[a,t],constraints:[(e,t,i)=>[a,this._clampValue(Math.round(e[1]/s)*s,0,n.dimY)]],onMove:function(){const t=r.graph.points[e].coord()[1];var n=By.clone(i.state.values);n[e]=t,i.setState({values:n}),i.changeAndTrack({values:n}),i._maybeHideDragPrompt()}}),i._maybeShowDragPrompt(),e>0&&(r.graph.lines[e]=Yy.addMovableLine(o,{points:[r.graph.points[e-1],r.graph.points[e]],constraints:Yy.MovablePoint.constraints.fixed(),normalStyle:{stroke:Gy.BLUE_C,"stroke-width":2},highlightStyle:{stroke:Gy.BLUE_C,"stroke-width":2}}))}else r.graph.points[e]=o.addMovablePoint({coord:[a,t],constraints:{constrainX:!0},normalStyle:{fill:Gy.INTERACTIVE,stroke:Gy.INTERACTIVE},snapY:r.scaleY/i.props.snapsPerLine}),r.graph.points[e].onMove=function(t,n){n=Math.min(Math.max(n,0),r.dimY);var s=By.clone(i.state.values);return s[e]=n,i.setState({values:s}),i.changeAndTrack({values:s}),[t,n]},e>0&&(r.graph.lines[e]=o.addMovableLineSegment({pointA:r.graph.points[e-1],pointZ:r.graph.points[e],constraints:{fixed:!0},normalStyle:{stroke:"#9ab8ed","stroke-width":2}}));return a},setupDotplot:function(e,t){var n=this.graphie;const s=this.props.apiOptions.isMobile;return this.setupTiledPlot(e,s?.5:1,t,((e,t)=>n.ellipse([e,t],[this.DOT_PLOT_POINT_SIZE()/n.scale[0],this.DOT_PLOT_POINT_SIZE()/n.scale[1]],{fill:Gy.INTERACTIVE,stroke:Gy.INTERACTIVE})))},setupPic:function(e,t){var n=this.graphie;return this.setupTiledPlot(e,0,t,((e,t)=>{var s=n.scalePoint([e,t]),i=this.props.picSize;return n.raphael.image(this.props.picUrl,s[0]-i/2,s[1]-i/2,i,i)}))},setupTiledPlot:function(e,t,n,s){var i=this,r=n,o=i.graphie,a=o.pics,l=o.dotTicks,c=e+.5+r.picPad;o.mouselayer.canvas.style.touchAction="none",a[e]=[],l[e]=[];var h=Math.round(r.dimY/r.scaleY)+1;return By.times(h,(function(n){var h=((n-=1)+.5)*r.scaleY,p=c-r.picBoxWidth/2,u=h+.5*r.scaleY,d=o.scalePoint([p,u+t]),g=o.mouselayer.rect(d[0],d[1],r.picBoxWidthPx,r.picBoxHeight);$(g[0]).css({fill:"#000",opacity:0,cursor:"pointer"}).on("vmousedown",(function(n){n.preventDefault(),i.whichPicClicked=e,i.setPicHeight(e,u),$(document).on("vmouseup.plotTile",(function(e){$(document).unbind(".plotTile")})),$(document).on("vmousemove.plotTile",(function(e){e.preventDefault();var n=o.getMouseCoord(e)[1],s=Math.floor(n-t),a=(Math.max(-1,Math.floor(s/r.scaleY))+.5)*r.scaleY+.5*r.scaleY;i.setPicHeight(i.whichPicClicked,a)}))})),n<0||(a[e][n]=s(c,h+t),l[e][n]=o.ellipse([c,h+t],[i.DOT_TICK_POINT_SIZE()/o.scale[0],i.DOT_TICK_POINT_SIZE()/o.scale[1]],{fill:"#dee1e3",stroke:"#dee1e3"}))})),c},setPicHeight:function(e,t){var n=By.clone(this.state.values);n[e]=t,this.drawPicHeights(n,this.state.values),this.setState({values:n}),this.changeAndTrack({values:n})},changeAndTrack:function(e){this.props.onChange(e),this.props.trackInteraction()},drawPicHeights:function(e,t){var n=this,s=n.graphie,i=s.pics;const r=this.props.apiOptions.isMobile;if(r){const t=e.every((e=>0===e));s.dotPrompt[0].style.display=t?"inline":"none"}By.each(i,(function(i,o){By.each(i,(function(i,a){var l=(a+1)*n.props.scaleY,c=l<=e[o];if(n.props.type===ej){var h=l<=t[o];c&&!h&&i.animate({"stroke-width":8},75,(()=>i.animate({"stroke-width":2},75)))}$(i[0]).css({display:c?"inline":"none"}),s.dotTicks[o][a][0].style.display=c||!r?"none":"inline"}))}))},getUserInput:function(){return this.state.values},simpleValidate:function(e){return tj.validate(this.getUserInput(),e)}});By.extend(tj,{validate:function(e,t){return Hy(e,t.starting)?{type:"invalid",message:null}:{type:"points",earned:Hy(e,t.correct)?1:0,total:1,message:null}}});var nj=By.identity;qy.exports={name:"plotter",displayName:"Plotter",widget:tj,staticTransform:nj};var sj=qy.exports,ij={exports:{}};ij.exports;h.a;const rj=i.a,oj=x.b,aj=id.a,lj=cd,cj=Gd,hj=Bf,pj=Ic,uj=Cs,dj=sj.widget,gj=G.a.number,fj="line",mj="pic",bj="histogram",vj="dotplot";function xj(e,t,n){var s=oj.clone(e);s.length=t;for(var i=e.length;i<t;i++)s[i]=n;return s}const yj={scaleY:1,maxY:10,snapsPerLine:2};var jj=e=>"$"+gj.round(e,2)+"$";const wj=createReactClass({displayName:"PlotterEditor",getDefaultProps:function(){return oj.extend({},yj,{correct:[1],starting:[1],type:"bar",labels:["",""],categories:[""],picSize:30,picBoxHeight:36,picUrl:Khan.imageBase+"badges/earth-small.png",plotDimensions:[275,200],labelInterval:1})},getInitialState:function(){return{editing:"correct",pic:null,loadedUrl:null,minX:null,maxX:null,tickStep:null}},componentWillMount:function(){this.fetchPic(this.props.picUrl)},componentWillReceiveProps:function(e){this.fetchPic(e.picUrl)},fetchPic:function(e){if(this.state.loadedUrl!==e){var t=new Image;t.src=e,t.onload=()=>{this.setState({pic:t,loadedUrl:e})}}},render:function(){var e=oj.contains([fj,bj,vj],this.props.type),t=!oj.contains([mj,vj],this.props.type),n={trackInteraction:()=>{},...this.props};return Object($t.jsxs)("div",{className:"perseus-widget-plotter-editor",children:[Object($t.jsxs)("div",{children:["Chart type:"," ",oj.map(["bar",fj,mj,bj,vj],(function(e){return Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"radio",name:"chart-type",checked:this.props.type===e,onChange:oj.partial(this.changeType,e)}),e]},e)}),this)]}),Object($t.jsxs)("div",{children:["Labels:"," ",oj.map(["x","y"],(function(e,t){return Object($t.jsxs)("label",{children:[e+":",Object($t.jsx)("input",{type:"text",onChange:oj.partial(this.changeLabel,t),defaultValue:this.props.labels[t]})]},e)}),this)]}),e&&Object($t.jsxs)("div",{className:"set-from-scale-box",children:[Object($t.jsx)("span",{className:"categories-title",children:"Set Categories From Scale"}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Tick Step:"," ",Object($t.jsx)(cj,{placeholder:1,useArrowKeys:!0,value:this.state.tickStep,onChange:this.handleChangeTickStep})]}),Object($t.jsx)(lj,{children:Object($t.jsx)("p",{children:"The difference between adjacent ticks."})})]}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Range:"," ",Object($t.jsx)(hj,{placeholder:[0,10],useArrowKeys:!0,value:[this.state.minX,this.state.maxX],onChange:this.handleChangeRange})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("button",{onClick:this.setCategoriesFromScale,children:["Set Categories"," "]})})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Label Interval:"," ",Object($t.jsx)(cj,{useArrowKeys:!0,value:this.props.labelInterval,onChange:this.changeLabelInterval})]}),Object($t.jsx)(lj,{children:Object($t.jsx)("p",{children:'Which ticks to display the labels for. For instance, setting this to "4" will only show every 4th label (plus the last one)'})})]}),this.props.type===mj&&Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Picture:"," ",Object($t.jsx)(aj,{className:"pic-url",value:this.props.picUrl,onChange:this.changePicUrl}),Object($t.jsx)(lj,{children:Object($t.jsx)("p",{children:'Use the default picture of Earth, or insert the URL for a different picture using the "Add image" function.'})})]}),this.state.pic&&this.state.pic.width!==this.state.pic.height&&Object($t.jsxs)("p",{className:"warning",children:[Object($t.jsx)("b",{children:"Warning"}),": You are using a picture which is not square. This means the image will get distorted. You should probably crop it to be square."]})]}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Categories:"," ",Object($t.jsx)(uj,{ref:"categories",layout:"horizontal",options:this.props.categories,onChange:this.changeCategories})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Scale (y):"," ",Object($t.jsx)("input",{type:"text",onChange:this.changeScale,defaultValue:this.props.scaleY})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Max y:"," ",Object($t.jsx)("input",{type:"text",ref:"maxY",onChange:this.changeMax,defaultValue:this.props.maxY})]})}),t&&Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Snaps per line:"," ",Object($t.jsx)("input",{type:"text",onChange:this.changeSnaps,defaultValue:this.props.snapsPerLine})]}),Object($t.jsx)(lj,{children:Object($t.jsx)("p",{children:"Creates the specified number of divisions between the horizontal lines. Fewer snaps between lines makes the graph easier for the student to create correctly."})})]}),Object($t.jsxs)("div",{children:["Editing values:"," ",oj.map(["correct","starting"],(function(e){return Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"radio",name:"editing",checked:this.state.editing===e,onChange:oj.partial(this.changeEditing,e)}),e]},e)}),this),Object($t.jsxs)(lj,{children:[Object($t.jsx)("p",{children:"Use this toggle to switch between editing the correct answer (what the student will be graded on) and the starting values (what the student will see plotted when they start the problem). Note: These cannot be the same."}),Object($t.jsx)("p",{children:"In static mode, the starting values are rendered out to the displayed widget."})]})]}),Object($t.jsx)(dj,{...n,starting:this.props[this.state.editing],onChange:this.handlePlotterChange})]})},handleChangeTickStep:function(e){this.setState({tickStep:e})},handleChangeRange:function(e){this.setState({minX:e[0],maxX:e[1]})},changeLabelInterval:function(e){this.props.onChange({labelInterval:e})},handlePlotterChange:function(e){var t={};t[this.state.editing]=e.values,this.props.onChange(t)},changeType:function(e){var t;e===bj?(t=[jj(0)].concat(this.props.categories),this.props.onChange({type:e,categories:t})):this.props.type===bj?(t=this.props.categories.slice(1),this.props.onChange({type:e,categories:t})):this.props.onChange({type:e}),t&&(rj.findDOMNode(this.refs.categories).value=t.join(", "))},changeLabel:function(e,t){var n=oj.clone(this.props.labels);n[e]=t.target.value,this.props.onChange({labels:n})},changePicUrl:function(e){var t=pj.getRealImageUrl(e);this.props.onChange({picUrl:t})},changeCategories:function(e){var t=e.length;this.props.type===bj&&t--;var n=this.props.scaleY;this.props.onChange({categories:e,correct:xj(this.props.correct,t,n),starting:xj(this.props.starting,t,n)})},changeScale:function(e){var t=this.props.scaleY,n=+e.target.value||yj.scaleY,s=function(e){return e*n/t},i=s(this.props.maxY);this.props.onChange({scaleY:n,maxY:i,correct:oj.map(this.props.correct,s),starting:oj.map(this.props.starting,s)}),rj.findDOMNode(this.refs.maxY).value=i},changeMax:function(e){this.props.onChange({maxY:+e.target.value||yj.maxY})},changeSnaps:function(e){this.props.onChange({snapsPerLine:+e.target.value||yj.snapsPerLine})},changeEditing:function(e){this.setState({editing:e})},setCategoriesFromScale:function(){var e,t=this.state.tickStep||1,n=this.state.minX||0,s=this.state.maxX||0,i=Math.floor((s-n)/t)*t;e=this.props.type===bj||this.props.type===vj?oj.range(0,i+t,t):oj.range(t,i+t,t),e=oj.map(e,(e=>e+n)),e=oj.map(e,jj),this.changeCategories(e),rj.findDOMNode(this.refs.categories).value=e.join(", ")},serialize:function(){var e=oj.pick(this.props,"correct","starting","type","labels","categories","scaleY","maxY","snapsPerLine","labelInterval");return this.props.type===mj&&(e.picUrl=this.props.picUrl),e}});ij.exports=wj;var Oj=ij.exports,Cj={exports:{}};Cj.exports;h.a,x.b;const Sj=mu,kj=pu,_j=createReactClass({displayName:"PassageRefTargetEditor",getDefaultProps:function(){return{content:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Sj.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{children:["Content:",Object($t.jsx)("input",{type:"text",value:this.props.content,onChange:this.handleContentChange})]})},handleContentChange:function(e){this.change({content:e.target.value})},serialize(){return kj.serialize.call(this)}});Cj.exports=_j;var Tj=Cj.exports,Mj={exports:{}},Nj=(Mj.exports,h.a,x.b),Pj=mu,Ij=Bu,Ej=gh,Aj=createReactClass({displayName:"PassageRefTarget",getDefaultProps:function(){return{content:"",linterContext:je}},getUserInput:function(){return Ij.getUserInput.call(this)},render:function(){return Object($t.jsx)(Ej,{content:this.props.content,inline:!0,apiOptions:this.props.apiOptions,linterContext:this.props.linterContext})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Pj.change.apply(this,t)},simpleValidate:function(e){return Aj.validate(this.getUserInput(),e)}});Nj.extend(Aj,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),Mj.exports={name:"passage-ref-target",displayName:"PassageRefTarget",defaultAlignment:"inline",widget:Aj,hidden:!0,transform:e=>Nj.pick(e,"content"),version:{major:0,minor:0},isLintable:!0};var Rj=Mj.exports,Dj={exports:{}};Dj.exports;h.a;const Lj=mu,Fj=pu,zj=cd,qj=Gd,Wj=$x,Bj=createReactClass({displayName:"PassageRefEditor",getDefaultProps:function(){return{passageNumber:1,referenceNumber:1,summaryText:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Lj.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Passage Number: ",Object($t.jsx)(qj,{value:this.props.passageNumber,onChange:this.change("passageNumber")})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Reference Number: ",Object($t.jsx)(qj,{value:this.props.referenceNumber,onChange:this.change("referenceNumber")})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Summary Text: ",Object($t.jsx)(Wj,{value:this.props.summaryText,onChange:this.change("summaryText")}),Object($t.jsxs)(zj,{children:[Object($t.jsx)("p",{children:"Short summary of the referenced section. This will be included in parentheses and quotes automatically."}),Object($t.jsx)("p",{children:"Ex: The start ... the end"})]})]})})]})},serialize(){return Fj.serialize.call(this)}});Dj.exports=Bj;var Vj=Dj.exports,Hj={exports:{}},Uj=(Hj.exports,h.a,x.b),Gj=mu,$j=ns,Yj=Bu,Kj=createReactClass({displayName:"PassageRef",getDefaultProps:function(){return{passageNumber:1,referenceNumber:1,summaryText:""}},getInitialState:function(){return{lineRange:null,content:null}},shouldComponentUpdate:function(e,t){return!Uj.isEqual(this.props,e)||!Uj.isEqual(this.state,t)},getUserInput:function(){return Yj.getUserInput.call(this)},render:function(){var e,t,n=this.state.lineRange;if(e=n?n[0]===n[1]?$_({lineNumber:n[0]},"line %(lineNumber)s"):$_({lineRange:n[0]+"\u2013"+n[1]},"lines %(lineRange)s"):$_({lineRange:"?\u2013?"},"lines %(lineRange)s"),this.props.summaryText){var s=$j.parseInline(this.props.summaryText);t=Object($t.jsxs)("span",{"aria-hidden":!0,children:[" ","(\u201c",$j.basicOutput(s),"\u201d)"]})}else t=null;return Object($t.jsxs)("span",{children:[e,t,n&&Object($t.jsx)("div",{className:"perseus-sr-only",children:this.state.content})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Gj.change.apply(this,t)},componentDidMount:function(){this._deferredUpdateRange(),this._throttledUpdateRange=Uj.throttle(this._deferredUpdateRange,500),window.addEventListener("resize",this._throttledUpdateRange)},componentDidUpdate:function(){this._deferredUpdateRange()},componentWillUnmount:function(){window.removeEventListener("resize",this._throttledUpdateRange)},_deferredUpdateRange:function(){Uj.defer(this._updateRange)},_updateRange:function(){var e=this.props.findWidgets("passage "+this.props.passageNumber)[0],t=null;e&&(t=e.getReference(this.props.referenceNumber)),this.isMounted()&&(t?this.setState({lineRange:[t.startLine,t.endLine],content:t.content}):this.setState({lineRange:null,content:null}))},simpleValidate:function(e){return Kj.validate(this.getUserInput(),e)}});Uj.extend(Kj,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),Hj.exports={name:"passage-ref",displayName:"PassageRef (SAT only)",defaultAlignment:"inline",widget:Kj,transform:e=>Uj.pick(e,"passageNumber","referenceNumber","summaryText"),version:{major:0,minor:1}};var Xj=Hj.exports,Zj={exports:{}};Zj.exports;h.a,x.b;const Jj=mu,Qj=pu,ew=lv,tw=cd,nw=Lf,sw=createReactClass({displayName:"PassageEditor",getDefaultProps:function(){return{passageTitle:"",passageText:"",footnotes:"",showLineNumbers:!0}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Jj.change.apply(this,t)},render:function(){var e=Object($t.jsx)(ew,{ref:"passage-editor",apiOptions:this.props.apiOptions,content:this.props.passageText,widgetEnabled:!1,placeholder:"Type passage here...",onChange:e=>{this.change({passageText:e.content})},showWordCount:!0}),t=Object($t.jsx)(ew,{ref:"passage-footnotes-editor",apiOptions:this.props.apiOptions,content:this.props.footnotes,widgetEnabled:!1,placeholder:"Type footnotes here...",onChange:e=>{this.change({footnotes:e.content})}});return Object($t.jsxs)("div",{className:"perseus-widget-passage-editor",children:[Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(nw,{label:"Show line numbers",labelAlignment:"right",showLineNumbers:this.props.showLineNumbers,onChange:this.props.onChange})}),Object($t.jsxs)("div",{children:["Passage title:",Object($t.jsx)(tw,{children:Object($t.jsx)("p",{children:"An optional title that will appear directly above the passage in the same font style. (E.g. Passage 1)"})}),Object($t.jsx)("div",{children:Object($t.jsx)("input",{type:"text",defaultValue:this.props.passageTitle,onChange:e=>{this.change({passageTitle:e.target.value})}})})]}),Object($t.jsxs)("div",{children:["Passage Text:",e]}),Object($t.jsxs)("div",{children:["Footnotes:",Object($t.jsx)(tw,{children:Object($t.jsx)("p",{children:"To add footnotes, add ^ characters where they belong in the passage. Then, add ^ in the footnotes area to reference the footnotes in the passage."})}),t]})]})},serialize(){return Qj.serialize.call(this)}});Zj.exports=sw;var iw=Zj.exports,rw={exports:{}},ow=(rw.exports,h.a,zn.a),aw=x.b,lw="start-ref-",cw="end-ref-",hw={display:"inline-block",width:0,visibility:"hidden"},pw={display:"inline",whiteSpace:"nowrap"},uw={display:"inline-block",color:"rgb(255, 255, 255)",backgroundColor:"rgb(90, 90, 90)",paddingLeft:10,paddingRight:10,userSelect:"none",WebkitUserSelect:"none"},dw={display:"inline-block",color:"rgb(255, 255, 255)",backgroundColor:"rgb(90, 90, 90)",userSelect:"none",WebkitUserSelect:"none",width:22,height:22,borderRadius:"50%",textAlign:"center"},gw=createReactClass({displayName:"RefStart",render:function(){return Object($t.jsx)("span",{style:hw,children:"_"})},getRefContent:function(){return this.props.refContent}}),fw=createReactClass({displayName:"RefEnd",render:function(){return Object($t.jsx)("span",{style:hw,children:"_"})}}),mw={newline:ow.defaultRules.newline,paragraph:ow.defaultRules.paragraph,escape:ow.defaultRules.escape,passageFootnote:{order:ow.defaultRules.escape.order+.1,match:ow.inlineRegex(/^\^/),parse:(e,t,n)=>{var s=n.lastFootnote.id+1,i={id:s,text:1===s?"*":""+s};return"*"===n.lastFootnote.text&&(n.lastFootnote.text=""+n.lastFootnote.id),n.lastFootnote=i,i},react:(e,t,n)=>Object($t.jsx)("sup",{children:e.text},n.key)},refStart:{order:ow.defaultRules.escape.order+.2,match:function(e,t){var n=/^\{\{/.exec(e);if(n){for(var s=2,i=0;s<e.length;){var r=e.slice(s,s+2);if("{{"===r)i++,s++;else if("}}"===r){if(!(i>0))break;i--,s++}s++}var o=e.slice(2,s);return[n[0],o]}return null},parse:(e,t,n)=>{if(!n.useRefs)return{ref:null,refContent:null};var s=n.lastRef+1;return n.lastRef=s,n.currentRef.push(s),{ref:s,refContent:t("(\u201c"+e[1]+"\u201d)\n\n",aw.defaults({useRefs:!1},bw))}},react:(e,t,n)=>{if(null==e.ref)return null;var s=t(e.refContent,{});return Object($t.jsx)(gw,{ref:lw+e.ref,refContent:s},lw+e.ref)}},refEnd:{order:ow.defaultRules.escape.order+.3,match:ow.inlineRegex(/^\}\}/),parse:(e,t,n)=>n.useRefs?{ref:n.currentRef.pop()||null}:{ref:null},react:(e,t,n)=>null!=e.ref?Object($t.jsx)(fw,{ref:cw+e.ref},cw+e.ref):null},squareLabel:{order:ow.defaultRules.escape.order+.4,match:ow.inlineRegex(/^\[\[(\w+)\]\]( *)/),parse:(e,t,n)=>(n.firstQuestionRef||(n.firstQuestionRef=e[1]),{content:e[1],space:e[2].length>0}),react:(e,t,n)=>[Object($t.jsx)("span",{className:"perseus-passage-square-label",style:pw,"aria-hidden":"true",children:Object($t.jsx)("span",{style:uw,children:e.content})},"visual-square"),Object($t.jsx)("span",{className:"perseus-sr-only",children:$_({number:e.content},"[Marker for question %(number)s]")},"alt-text"),e.space?"\xa0":null]},circleLabel:{order:ow.defaultRules.escape.order+.5,match:ow.inlineRegex(/^\(\((\w+)\)\)( *)/),parse:(e,t,n)=>({content:e[1],space:e[2].length>0}),react:(e,t,n)=>[Object($t.jsx)("span",{className:"perseus-passage-circle-label",style:pw,"aria-hidden":!0,children:Object($t.jsx)("span",{style:dw,children:e.content})},"visual-circle"),Object($t.jsx)("span",{className:"perseus-sr-only",children:$_({number:e.content},"[Circle marker %(number)s]")},"alt-text"),e.space?"\xa0":null]},squareBracketRef:{order:ow.defaultRules.escape.order+.6,match:ow.inlineRegex(/^\[(\d+)\]( *)/),parse:(e,t,n)=>(n.firstSentenceRef||(n.firstSentenceRef=e[1]),{content:e[1],space:e[2].length>0}),react:(e,t,n)=>[Object($t.jsxs)("span",{className:"perseus-passage-bracket-label","aria-hidden":"true",children:["[",e.content,"]"]},"visual-brackets"),Object($t.jsx)("span",{className:"perseus-sr-only",children:$_({number:e.content},"[Sentence %(number)s]")},"alt-text"),e.space?"\xa0":null]},highlight:{order:ow.defaultRules.escape.order+.7,match:ow.inlineRegex(/^{highlighting.start}(.+?){highlighting.end}/),parse:(e,t,n)=>({content:e[1]}),react:(e,t,n)=>[Object($t.jsx)("span",{className:"perseus-highlight",children:e.content})]},reviewHighlight:{order:ow.defaultRules.escape.order+.7,match:ow.inlineRegex(/^{review-highlighting.start}(.+?){review-highlighting.end}/),parse:(e,t,n)=>({content:e[1]}),react:(e,t,n)=>[Object($t.jsx)("span",{className:"perseus-review-highlight",children:e.content})]},strong:ow.defaultRules.strong,u:ow.defaultRules.u,em:ow.defaultRules.em,del:ow.defaultRules.del,text:{...ow.defaultRules.text,react:(e,t,n)=>Object($t.jsx)("span",{children:e.content},n.key)}},bw={currentRef:[],useRefs:!0,lastRef:0,lastFootnote:{id:0,text:""}},vw=ow.parserFor(mw);rw.exports={parse:(e,t)=>(t=t||{},vw(e+"\n\n",aw.extend(t,bw))),output:ow.reactFor(ow.ruleOutput(mw,"react")),START_REF_PREFIX:lw,END_REF_PREFIX:cw,_rulesForTesting:mw};var xw=rw.exports;function yw(e,t,n,s){let i;return i="start"===t&&"start"===s?Range.START_TO_START:"start"===t&&"end"===s?Range.END_TO_START:"end"===t&&"start"===s?Range.START_TO_END:Range.END_TO_END,e.compareBoundaryPoints(i,n)}function jw(e,t){const n=e.cloneRange();return n.setEnd(t.endContainer,t.endOffset),n}function ww(e,t){return!(yw(e,"end",t,"start")<0||yw(t,"end",e,"start")<0)}function Ow(e,t){return yw(e,"start",t,"start")<=0&&yw(e,"end",t,"end")>=0}function Cw(e,t){if(!ww(e,t))return null;return jw(yw(e,"start",t,"start")>0?e:t,yw(e,"end",t,"end")<0?e:t)}function Sw(e,t){if(!ww(e,t))return null;return jw(yw(e,"start",t,"start")<0?e:t,yw(e,"end",t,"end")>0?e:t)}function kw(e,t,n,s,i){let r=-1,o=s,a=i,l=0;for(;o<=a;){if(l++,l>2*t.length)throw new Error(`Assertion error: Binary search isn't terminating? lower=${o}, upper=${a}`);const s=Math.floor((o+a)/2);if("first"===n){yw(t[s],"end",e,"start")<=0?o=s+1:(r=s,a=s-1)}else{yw(t[s],"start",e,"end")>=0?a=s-1:(r=s,o=s+1)}}return r}function _w(e,t){const n=kw(e,t,"first",0,t.length-1);if(n<0)return null;const s=kw(e,t,"last",n,t.length-1);return s<0?null:[n,s]}function Tw(e,t){const n={};let s=t.domRange,i=t.firstWordIndex,r=t.lastWordIndex;for(const l of Object.keys(e)){const t=e[l],o=Sw(t.domRange,s);o?(s=o,i=Math.min(t.firstWordIndex,i),r=Math.max(t.lastWordIndex,r)):n[l]=t}const o={firstWordIndex:i,lastWordIndex:r,domRange:s},a=function(e){const t=`${(new Date).getTime()}`;if(!e.includes(t))return t;let n,s=0;do{n=`${t}-${s}`,s++}while(e.includes(n));return n}(Object.keys(n));return n[a]=o,n}function Mw(e,t,n){for(const o of Object.keys(e)){if(Ow(e[o].domRange,n))return null}const s=_w(n,t);if(!s)return null;const[i,r]=s;return{firstWordIndex:i,lastWordIndex:r,domRange:jw(t[i],t[r])}}function Nw(e,t){const{firstWordIndex:n,lastWordIndex:s}=e.range,i=t[n];if(!i)throw new Error(`first word index ${i} is out of bounds: must be 0\u2013${t.length-1} inclusive`);const r=t[s];if(!r)throw new Error(`last word index ${r} is out of bounds: must be 0\u2013${t.length-1} inclusive`);return{firstWordIndex:n,lastWordIndex:s,domRange:jw(i,r)}}function Pw(e){const{firstWordIndex:t,lastWordIndex:n}=e;return{range:{type:"word-indexes",firstWordIndex:t,lastWordIndex:n}}}var Iw={exports:{}};Iw.exports;const Ew=h.a;class Aw extends Ew.PureComponent{componentDidMount(){this._sendWordsUpdate()}componentDidUpdate(){this._sendWordsUpdate()}_sendWordsUpdate(){this.props.onWordsUpdate(this._getWordRanges())}_getWordRanges(){const e=this._container;if(!e)throw new Error("invariant violation: `this._container` is not defined, but this method is only called after mount/update");const t=e.ownerDocument.createTreeWalker(e,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,(()=>NodeFilter.FILTER_ACCEPT),!1),n=[];let s=null;for(;t.nextNode();){const e=t.currentNode;if(e.nodeType===Node.ELEMENT_NODE){"inline"!==getComputedStyle(e).display&&(s=null)}else if(e.nodeType===Node.TEXT_NODE){const t=e.nodeValue,i=/\S+/g;let r,o=null;for(;null!==(r=i.exec(t));){const i=r.index,a=r.index+r[0].length;let l;0===i&&s?(l=s,l.setEnd(e,a)):(l=e.ownerDocument.createRange(),l.setStart(e,i),l.setEnd(e,a),n.push(l)),a===t.length&&(o=l)}s=o}}return n}render(){return Object($t.jsx)("div",{ref:e=>this._container=e,children:this.props.children})}}Iw.exports=Aw;var Rw=Iw.exports,Dw={exports:{}};Dw.exports;const Lw=h.a;class Fw extends Lw.PureComponent{constructor(){super(...arguments),this.state={mouseState:"up",trackedSelection:null},this._handleSelectionChange=()=>{this._updateTrackedSelection(this.props.buildHighlight),"down"===this.state.mouseState&&this.setState({mouseState:"down-and-selecting"})},this._handleMouseDown=()=>{this.setState({mouseState:"down"})},this._handleMouseUp=()=>{this.setState({mouseState:"up"})}}componentDidMount(){this._updateListeners(!1,this.props.enabled)}componentWillReceiveProps(e){this.props.buildHighlight!==e.buildHighlight&&this._updateTrackedSelection(e.buildHighlight),this._updateListeners(this.props.enabled,e.enabled)}componentWillUnmount(){this._updateListeners(this.props.enabled,!1)}_updateListeners(e,t){!e&&t?(window.addEventListener("mousedown",this._handleMouseDown),window.addEventListener("mouseup",this._handleMouseUp),document.addEventListener("selectionchange",this._handleSelectionChange)):e&&!t&&(window.removeEventListener("mousedown",this._handleMouseDown),window.removeEventListener("mouseup",this._handleMouseUp),document.removeEventListener("selectionchange",this._handleSelectionChange),this.setState({mouseState:"up",trackedSelection:null}))}_computeFocusAndRange(){const e=document.getSelection();if(!e||0===e.rangeCount)return null;const t=e.getRangeAt(0);if(t.collapsed)return null;return{focusNode:e.focusNode,focusOffset:e.focusOffset,range:t}}_computeTrackedSelection(e){const t=this._computeFocusAndRange();if(!t)return null;const{focusNode:n,focusOffset:s,range:i}=t,r=e(i);return r?{focusNode:n,focusOffset:s,proposedHighlight:r}:null}_updateTrackedSelection(e){const t=this._computeTrackedSelection(e);this.setState({trackedSelection:t})}render(){const{mouseState:e,trackedSelection:t}=this.state,n="down-and-selecting"===e;return this.props.children&&Object($t.jsx)("div",{children:this.props.children(t,n)})}}Dw.exports=Fw;var zw=Dw.exports;function qw(e,t){return{left:e.left-t.left,top:e.top-t.top}}function Ww(e,t){return{...qw(e,t),width:e.width,height:e.height}}function Bw(e){const t=[];return Vw(e.commonAncestorContainer,e,t),t}function Vw(e,t,n){const s=new Range;if(s.selectNodeContents(e),e.nodeType===Node.TEXT_NODE){const i=Cw(t,s);i&&function(e,t,n){const s=e.parentElement,i=window.getComputedStyle(s);let r=null;if("string"===typeof i.lineHeight&&i.lineHeight.endsWith("px")){const e=parseFloat(i.lineHeight);isNaN(e)||(r=e)}const o=Array.from(t.getClientRects());for(const a of o){const e={left:a.left,top:a.top,height:a.height,width:a.width};if(null!==r){const t=r-e.height;e.top-=t,e.height=r}n.push(e)}}(e,i,n)}else if(e.nodeType===Node.ELEMENT_NODE){if(!ww(t,s))return;for(const s of Array.from(e.childNodes))Vw(s,t,n)}}var Hw={exports:{}};Hw.exports;const Uw=h.a;class Gw extends Uw.PureComponent{_getPosition(){const{focusNode:e,focusOffset:t,offsetParent:n}=this.props,s=document.createRange();s.setStart(e,t),s.setEnd(e,t);const i=s.getClientRects()[0];if(!i)return console.warn('[Highlighting] Known bug: Could not determine the focus position, so did not show an "Add Highlight" tooltip. https://app.asana.com/0/329800276300868/413878480039713'),null;return qw(i,n.getBoundingClientRect())}render(){const e=this._getPosition();return e?Object($t.jsxs)("div",{className:Object(Nn.css)($w.tooltip),onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,style:{left:e.left,top:e.top,zIndex:this.props.zIndex},children:[Object($t.jsx)("div",{className:Object(Nn.css)($w.label),children:this.props.label}),Object($t.jsx)("div",{className:Object(Nn.css)($w.arrow)})]}):null}}const $w=Nn.StyleSheet.create({tooltip:{position:"absolute",transform:"translate(-50%, -100%)",cursor:"pointer",userSelect:"none"},label:{background:"#314453",borderRadius:2,boxShadow:"0 1px 4px 0 rgba(97, 101, 105, 0.42)",padding:"8px 11px",color:"white",fontSize:12,lineHeight:1.5,textAlign:"center"},arrow:{height:0,width:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:"6px solid #314453",margin:"0 auto"}});Hw.exports=Gw;var Yw=Hw.exports,Kw={exports:{}};Kw.exports;(function(){const e=h.a;class t extends e.PureComponent{constructor(){super(...arguments),this.state={cachedHighlightRects:this._computeRects(this.props),tooltipIsHovered:!1}}componentWillReceiveProps(e){this.props.highlight===e.highlight&&this.props.offsetParent===e.offsetParent||this.setState({cachedHighlightRects:this._computeRects(e)})}_computeRects(e){const{highlight:t,offsetParent:n}=e,s=Bw(t.domRange),i=n.getBoundingClientRect();return s.map((e=>Ww(e,i)))}_rectIsHovered(e,t){const n=qw(t,e);return 0<=n.left&&n.left<e.width&&0<=n.top&&n.top<e.height}isHovered(e){if(!e)return!1;const{offsetParent:t}=this.props,{cachedHighlightRects:n}=this.state,s=qw(e,t.getBoundingClientRect());return n.some((e=>this._rectIsHovered(e,s)))}render(){const e=this.state.cachedHighlightRects;return Object($t.jsx)("div",{children:e.map(((e,t)=>Object($t.jsx)("div",{className:Object(Nn.css)(n.highlightRect),style:{position:"absolute",width:e.width,height:e.height,top:e.top,left:e.left,zIndex:this.props.zIndexes.belowContent}},t)))})}}const n=Nn.StyleSheet.create({highlightRect:{background:"#fffabe"}});Kw.exports=t}).call(Kw.exports);var Xw=Kw.exports,Zw={exports:{}};Zw.exports;const Jw=h.a,Qw=Xw,eO=Yw;class tO extends Jw.PureComponent{constructor(){super(...arguments),this.state={mouseClientPosition:null,hoveringTooltipFor:null},this._highlightRenderers={},this._handleMouseMove=e=>{this.setState({mouseClientPosition:{left:e.clientX,top:e.clientY}})}}componentDidMount(){this._updateEditListeners(!1,this.props.editable)}componentWillReceiveProps(e){this._updateEditListeners(this.props.editable,e.editable),"string"!==typeof this.state.hoveringTooltipFor||this.state.hoveringTooltipFor in e.highlights||this.setState({hoveringTooltipFor:null})}componentWillUnmount(){this._updateEditListeners(this.props.editable,!1)}_updateEditListeners(e,t){!e&&t?window.addEventListener("mousemove",this._handleMouseMove):e&&!t&&(window.removeEventListener("mousemove",this._handleMouseMove),this.setState({mouseClientPosition:null}))}_getHoveredHighlightKey(){const{hoveringTooltipFor:e}=this.state;if("string"===typeof e)return e;return Object.keys(this.props.highlights).find((e=>{const t=this._highlightRenderers[e];return t&&t.isHovered(this.state.mouseClientPosition)}))}_renderTooltip(){const e=this._getHoveredHighlightKey();if("string"!==typeof e)return null;const t=this.props.highlights[e];return Object($t.jsx)(eO,{label:i18n._("Remove highlight"),focusNode:t.domRange.endContainer,focusOffset:t.domRange.endOffset,offsetParent:this.props.offsetParent,zIndex:this.props.zIndexes.aboveContent,onClick:()=>this.props.onRemoveHighlight(e),onMouseEnter:()=>this.setState({hoveringTooltipFor:e}),onMouseLeave:()=>this.setState({hoveringTooltipFor:null})})}render(){return Object($t.jsxs)("div",{children:[Object.keys(this.props.highlights).map((e=>Object($t.jsx)(Qw,{ref:t=>{t?this._highlightRenderers[e]=t:delete this._highlightRenderers[e]},editable:this.props.editable,highlight:this.props.highlights[e],highlightKey:e,mouseClientPosition:this.state.mouseClientPosition,offsetParent:this.props.offsetParent,onRemoveHighlight:this.props.onRemoveHighlight,zIndexes:this.props.zIndexes},e))),this.props.editable&&this._renderTooltip()]})}}Zw.exports=tO;var nO=Zw.exports,sO={exports:{}};sO.exports;const iO=h.a,rO=nO,oO=Yw,aO=zw;class lO extends iO.PureComponent{_handleAddHighlight(e){this.props.onAddHighlight(e);const t=document.getSelection();t&&t.collapseToEnd()}_selectionIsValid(e){if(!e)return!1;const{contentNode:t}=this.props,n=new Range;n.selectNodeContents(t);const s=new Range;s.setStart(e.focusNode,e.focusOffset),s.collapse(!0);return ww(n,s)}render(){return Object($t.jsx)(aO,{buildHighlight:this.props.buildHighlight,enabled:this.props.editable,children:(e,t)=>Object($t.jsxs)("div",{children:[Object($t.jsx)(rO,{editable:this.props.editable&&!this._selectionIsValid(e),highlights:this.props.highlights,offsetParent:this.props.offsetParent,onRemoveHighlight:this.props.onRemoveHighlight,zIndexes:this.props.zIndexes}),this._selectionIsValid(e)&&!t&&Object($t.jsx)(oO,{label:i18n._("Add highlight"),onClick:()=>this._handleAddHighlight(e.proposedHighlight),focusNode:e.focusNode,focusOffset:e.focusOffset,offsetParent:this.props.offsetParent,zIndex:this.props.zIndexes.aboveContent})]})})}}sO.exports=lO;var cO=sO.exports,hO={exports:{}};hO.exports;const pO=h.a,uO=cO,dO=Rw;class gO extends pO.PureComponent{constructor(){super(...arguments),this.state={wordRanges:[]},this._handleAddHighlight=e=>{const t=Tw(this._getDOMHighlights(),e),n={};for(const s of Object.keys(t))n[s]=Pw(t[s]);this.props.onSerializedHighlightsUpdate(n)},this._handleRemoveHighlight=e=>{const{serializedHighlights:t}=this.props,n={...t};delete n[e],this.props.onSerializedHighlightsUpdate(n)},this._handleWordsUpdate=e=>{this.setState({wordRanges:e})}}_buildHighlight(e){return Mw(this._getDOMHighlights(),this.state.wordRanges,e)}_getDOMHighlights(){const{serializedHighlights:e}=this.props,{wordRanges:t}=this.state,n={};for(const s of Object.keys(e))n[s]=Nw(e[s],t);return n}render(){const e=this._getDOMHighlights();return Object($t.jsxs)("div",{className:Object(Nn.css)(fO.container),ref:e=>this._container=e,children:[Object($t.jsx)("div",{children:this.props.enabled&&this._container&&this._content&&Object($t.jsx)(uO,{buildHighlight:e=>this._buildHighlight(e),contentNode:this._content,editable:this.props.editable,highlights:e,offsetParent:this._container,zIndexes:{aboveContent:2,belowContent:0},onAddHighlight:this._handleAddHighlight,onRemoveHighlight:this._handleRemoveHighlight})}),Object($t.jsx)("div",{className:Object(Nn.css)(fO.content),ref:e=>this._content=e,children:Object($t.jsx)(dO,{onWordsUpdate:this._handleWordsUpdate,children:this.props.children})})]})}}const fO=Nn.StyleSheet.create({container:{position:"relative",zIndex:0},content:{position:"relative",zIndex:1}});hO.exports=gO;var mO=hO.exports,bO={exports:{}};bO.exports;const vO=h.a,xO=i.a,yO=x.b,jO=l.a,wO=mO,OO=gh,CO=xw;class SO extends vO.Component{measureLineHeight(){return"number"!==typeof this._cachedLineHeight&&this.forceMeasureLineHeight(),this._cachedLineHeight}forceMeasureLineHeight(){this.$body.text(" \x80"),this._cachedLineHeight=this.$end.offset().top-this.$body.offset().top,this.$body.text("")}render(){return Object($t.jsx)("div",{className:Object(Nn.css)(kO.measurer),children:Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{ref:e=>this.$body=jO(e),className:"paragraph"}),Object($t.jsx)("div",{ref:e=>this.$end=jO(e)})]})})}}const kO=Nn.StyleSheet.create({measurer:{position:"absolute",width:"100%",top:0,left:0}});class _O extends vO.Component{constructor(){super(...arguments),this.state={nLines:null,startLineNumbersAfter:0,stylesAreApplied:!1},this._handleSerializedHighlightsUpdate=e=>{this.props.onChange({highlights:e})}}componentDidMount(){this._updateState(),this._onResize=yO.throttle((()=>{this.shouldRenderJipt()||(this._lineHeightMeasurer.forceMeasureLineHeight(),this._updateState())}),500),window.addEventListener("resize",this._onResize),window.setTimeout((()=>{this.setState({stylesAreApplied:!0})}),0)}shouldComponentUpdate(e,t){return!yO.isEqual(this.props,e)||!yO.isEqual(this.state,t)}componentDidUpdate(){this._updateState()}componentWillUnmount(){window.removeEventListener("resize",this._onResize)}_updateState(){this.shouldRenderJipt()||this.setState({nLines:this._measureLines(),startLineNumbersAfter:this._getInitialLineNumber()})}_measureLines(){const e=jO(xO.findDOMNode(this.refs.content)).height(),t=this._getLineHeight();return Math.round(e/t)}_getInitialLineNumber(){let e=!0;return this.props.findWidgets(((t,n)=>"passage"===n.type&&(t===this.props.widgetId&&(e=!1),e))).map((e=>e.getLineCount())).reduce(((e,t)=>e+t),0)}_getLineHeight(){return this._lineHeightMeasurer.measureLineHeight()}getLineCount(){return null!=this.state.nLines?this.state.nLines:this._measureLines()}_getStartRefLineNumber(e){const t=CO.START_REF_PREFIX+e,n=this.refs[t];if(!n)return null;const s=jO(xO.findDOMNode(n));let i=s.next();0===i.length&&(i=s);const r=i.offset().top;return this.state.startLineNumbersAfter+1+this._convertPosToLineNumber(r)}_getEndRefLineNumber(e){const t=CO.END_REF_PREFIX+e,n=this.refs[t];if(!n)return null;const s=jO(xO.findDOMNode(n));let i=s.prev();0===i.length&&(i=s);const r=i.height(),o=i.offset().top;let a=this._convertPosToLineNumber(o+r);return 0===r&&(a+=1),this.state.startLineNumbersAfter+a}_convertPosToLineNumber(e){const t=e-jO(xO.findDOMNode(this.refs.content)).offset().top,n=this._getLineHeight();return Math.round(t/n)}_getRefContent(e){const t=CO.START_REF_PREFIX+e,n=this.refs[t];return n?n.getRefContent():null}getReference(e){const t=this._getStartRefLineNumber(e),n=this._getEndRefLineNumber(e);if(null==t||null==n)return null;return{startLine:t,endLine:n,content:this._getRefContent(e)}}getUserInput(){return null}simpleValidate(e){return _O.validate(this.getUserInput(),e)}static validate(e,t){return{type:"points",earned:0,total:0,message:null}}_renderInstructions(e){const t=e.firstQuestionRef,n=e.firstSentenceRef;let s="";t&&(s+=i18n._("The symbol %(questionSymbol)s indicates that question %(questionNumber)s references this portion of the passage.",{questionSymbol:"[["+t+"]]",questionNumber:t})),n&&(s+=i18n._(" The symbol %(sentenceSymbol)s indicates that the following sentence is referenced in a question.",{sentenceSymbol:"["+n+"]"}));const i=CO.parse(s);return Object($t.jsx)("div",{className:"perseus-widget-passage-instructions",children:CO.output(i)})}shouldRenderJipt(){return"undefined"!==typeof KA&&"en-pt"===KA.language&&-1!==this.props.passageText.indexOf("crwdns")}_renderContent(e){const t=this.state.stylesAreApplied,n=!this.props.reviewModeRubric;return Object($t.jsx)(wO,{editable:n,enabled:t,onSerializedHighlightsUpdate:this._handleSerializedHighlightsUpdate,serializedHighlights:this.props.highlights,children:Object($t.jsxs)("div",{ref:"content",children:[Object($t.jsx)(SO,{ref:e=>this._lineHeightMeasurer=e}),CO.output(e)]})})}_hasFootnotes(){const e=this.props.footnotes;return!/^\s*$/.test(e)}_renderFootnotes(){const e=this.props.footnotes,t=CO.parse(e);return CO.output(t)}render(){let e;const t=this.state.nLines;this.props.showLineNumbers&&t&&(e=yO.range(1,t+1).map((e=>4===e&&t>4?Object($t.jsx)("span",{className:"line-marker",children:"Line"},"line-marker"):Object($t.jsx)("span",{children:e+this.state.startLineNumbersAfter},e))));const n={firstSentenceRef:null,firstQuestionRef:null},s=CO.parse(this.props.passageText,n),i=/\S/.test(this.props.passageTitle);return Object($t.jsx)("div",{children:Object($t.jsxs)("div",{className:"perseus-widget-passage-container",children:[this._renderInstructions(n),Object($t.jsxs)("div",{className:"perseus-widget-passage",children:[i&&Object($t.jsx)("h3",{className:"passage-title",children:Object($t.jsx)(OO,{content:this.props.passageTitle,linterContext:this.props.linterContext})}),e&&Object($t.jsx)("div",{className:"line-numbers","aria-hidden":!0,children:e}),!i&&Object($t.jsx)("h3",{className:"perseus-sr-only",children:i18n._("Beginning of reading passage.")}),Object($t.jsx)("div",{className:"passage-text",children:this.shouldRenderJipt()?Object($t.jsx)(OO,{content:this.props.passageText}):this._renderContent(s)}),this._hasFootnotes()&&[Object($t.jsx)("h4",{className:"perseus-sr-only",children:i18n._("Beginning of reading passage footnotes.")},"footnote-start"),Object($t.jsx)("div",{className:"footnotes",children:this._renderFootnotes()},"footnotes")],Object($t.jsx)("div",{className:"perseus-sr-only",children:i18n._("End of reading passage.")})]})]})})}}_O.defaultProps={passageTitle:"",passageText:"",footnotes:"",showLineNumbers:!0,highlights:{},linterContext:je},bO.exports={name:"passage",displayName:"Passage (SAT only)",widget:_O,transform:e=>yO.pick(e,"passageTitle","passageText","footnotes","showLineNumbers"),isLintable:!0};var TO=bO.exports,MO={exports:{}};MO.exports;h.a;const NO=x.b,PO=cd,IO=Cs;var EO="normal",AO="horizontal";const RO=createReactClass({displayName:"OrdererEditor",getDefaultProps:function(){return{correctOptions:[{content:"$x$"}],otherOptions:[{content:"$y$"}],height:EO,layout:AO}},render:function(){return Object($t.jsxs)("div",{className:"perseus-widget-orderer",children:[Object($t.jsxs)("div",{children:[" ","Correct answer:"," ",Object($t.jsx)(PO,{children:Object($t.jsx)("p",{children:"Place the cards in the correct order. The same card can be used more than once in the answer but will only be displayed once at the top of a stack of identical cards."})})]}),Object($t.jsx)(IO,{options:NO.pluck(this.props.correctOptions,"content"),onChange:this.onOptionsChange.bind(this,"correctOptions"),layout:this.props.layout}),Object($t.jsxs)("div",{children:[" ","Other cards:"," ",Object($t.jsx)(PO,{children:Object($t.jsx)("p",{children:"Create cards that are not part of the answer."})})]}),Object($t.jsx)(IO,{options:NO.pluck(this.props.otherOptions,"content"),onChange:this.onOptionsChange.bind(this,"otherOptions"),layout:this.props.layout}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[" ","Layout:"," ",Object($t.jsxs)("select",{value:this.props.layout,onChange:this.onLayoutChange,children:[Object($t.jsx)("option",{value:AO,children:"Horizontal"}),Object($t.jsx)("option",{value:"vertical",children:"Vertical"})]})]}),Object($t.jsx)(PO,{children:Object($t.jsx)("p",{children:"Use the horizontal layout for short text and small images. The vertical layout is best for longer text (e.g. proofs)."})})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[" ","Height:"," ",Object($t.jsxs)("select",{value:this.props.height,onChange:this.onHeightChange,children:[Object($t.jsx)("option",{value:EO,children:"Normal"}),Object($t.jsx)("option",{value:"auto",children:"Automatic"})]})]}),Object($t.jsx)(PO,{children:Object($t.jsx)("p",{children:'Use "Normal" for text, "Automatic" for images.'})})]})]})},onOptionsChange:function(e,t,n){var s={};s[e]=NO.map(t,(function(e){return{content:e}})),this.props.onChange(s,n)},onLayoutChange:function(e){this.props.onChange({layout:e.target.value})},onHeightChange:function(e){this.props.onChange({height:e.target.value})},serialize:function(){return{options:NO.chain(NO.pluck(this.props.correctOptions,"content")).union(NO.pluck(this.props.otherOptions,"content")).uniq().reject((function(e){return""===e})).sort().sortBy((function(e){return/\d/.test(e)?0:/^\$?[a-zA-Z]+\$?$/.test(e)?2:1})).map((function(e){return{content:e}})).value(),correctOptions:this.props.correctOptions,otherOptions:this.props.otherOptions,height:this.props.height,layout:this.props.layout}}});MO.exports=RO;var DO=MO.exports,LO={exports:{}},FO=(LO.exports,h.a,i.a),zO=x.b,qO=gh,WO=ce,BO=Is.ClassNames,VO=createReactClass({displayName:"PlaceholderCard",render:function(){return Object($t.jsx)("div",{className:"card-wrap "+BO.INTERACTIVE,style:{width:this.props.width},children:Object($t.jsx)("div",{className:"card placeholder",style:{height:this.props.height}})})}}),HO=createReactClass({displayName:"DragHintCard",render:function(){return Object($t.jsx)("div",{className:"card-wrap "+BO.INTERACTIVE,children:Object($t.jsx)("div",{className:"card drag-hint"})})}}),UO=createReactClass({displayName:"Card",getDefaultProps:function(){return{stack:!1,animating:!1,linterContext:je}},render:function(){var e={};this.props.floating&&(e={position:"absolute",left:this.props.startOffset.left,top:this.props.startOffset.top}),this.props.width&&(e.width=this.props.width);var t=["card"];this.props.stack&&t.push("stack"),this.props.floating&&!this.props.animating&&(t.push("dragging"),e.left+=this.props.mouse.left-this.props.startMouse.left,e.top+=this.props.mouse.top-this.props.startMouse.top);var n=zO.pick(this.props,"content"),s=this.props.animating?$.noop:this.onMouseDown;return Object($t.jsx)("div",{className:"card-wrap "+BO.INTERACTIVE,style:e,onMouseDown:s,onTouchStart:s,onTouchMove:this.onMouseMove,onTouchEnd:this.onMouseUp,onTouchCancel:this.onMouseUp,children:Object($t.jsx)("div",{className:t.join(" "),children:Object($t.jsx)(qO,{...n,linterContext:this.props.linterContext})})})},shouldComponentUpdate:function(e,t){return this.props.floating||e.floating||this.props.content!==e.content||this.props.fakeRef!==e.fakeRef},componentDidMount:function(){this.mouseMoveUpBound=!1},componentDidUpdate:function(e,t){if(this.props.animating&&!e.animating){var n=15*Math.sqrt(Math.sqrt(Math.pow(this.props.animateTo.left-this.props.startOffset.left,2)+Math.pow(this.props.animateTo.top-this.props.startOffset.top,2)));$(FO.findDOMNode(this)).animate(this.props.animateTo,Math.max(n,1),this.props.onAnimationEnd)}},componentWillUnmount:function(){this.mouseMoveUpBound&&(console.warn("Removing an element with bound event handlers."),this.unbindMouseMoveUp(),WO.resetTouchHandlers())},bindMouseMoveUp:function(){this.mouseMoveUpBound=!0,$(document).on("mousemove",this.onMouseMove),$(document).on("mouseup",this.onMouseUp)},unbindMouseMoveUp:function(){this.mouseMoveUpBound=!1,$(document).off("mousemove",this.onMouseMove),$(document).off("mouseup",this.onMouseUp)},onMouseDown:function(e){e.preventDefault();var t=WO.extractPointerLocation(e);t&&(this.bindMouseMoveUp(),this.props.onMouseDown&&this.props.onMouseDown(t,this))},onMouseMove:function(e){e.preventDefault();var t=WO.extractPointerLocation(e);t&&this.props.onMouseMove&&this.props.onMouseMove(t)},onMouseUp:function(e){e.preventDefault();var t=WO.extractPointerLocation(e);t&&(this.unbindMouseMoveUp(),this.props.onMouseUp&&this.props.onMouseUp(t))}}),GO="horizontal",$O=createReactClass({displayName:"Orderer",getDefaultProps:function(){return{current:[],options:[],correctOptions:[],height:"normal",layout:GO,linterContext:je}},getInitialState:function(){return{current:[],dragging:!1,placeholderIndex:null}},componentWillReceiveProps:function(e){zO.isEqual(this.props.current,e.current)||this.setState({current:e.current})},render:function(){var e=this.state.dragging&&Object($t.jsx)(UO,{ref:"dragging",floating:!0,content:this.state.dragContent,startOffset:this.state.offsetPos,startMouse:this.state.grabPos,mouse:this.state.mousePos,width:this.state.dragWidth,onMouseUp:this.onRelease,onMouseMove:this.onMouseMove,linterContext:this.props.linterContext},this.state.dragKey||"draggingCard"),t=this.state.animating&&Object($t.jsx)(UO,{floating:!0,animating:!0,content:this.state.dragContent,startOffset:this.state.offsetPos,width:this.state.dragWidth,animateTo:this.state.animateTo,onAnimationEnd:this.state.onAnimationEnd,linterContext:this.props.linterContext},this.state.dragKey||"draggingCard"),n=zO.map(this.state.current,(function(e,t){return Object($t.jsx)(UO,{ref:"sortable"+t,fakeRef:"sortable"+t,floating:!1,content:e.content,width:e.width,linterContext:this.props.linterContext,onMouseDown:this.state.animating?$.noop:this.onClick.bind(null,"current",t)},e.key)}),this);if(null!=this.state.placeholderIndex){var s=Object($t.jsx)(VO,{ref:"placeholder",width:this.state.dragWidth,height:this.state.dragHeight},"placeholder");n.splice(this.state.placeholderIndex,0,s)}var i=n.length>0;n.push(e,t);var r=Object($t.jsxs)("div",{className:"perseus-clearfix draggable-box",children:[!i&&Object($t.jsx)(HO,{}),Object($t.jsx)("div",{ref:"dragList",children:n})]}),o=Object($t.jsx)("div",{ref:"bank",className:"bank perseus-clearfix",children:zO.map(this.props.options,((e,t)=>Object($t.jsx)(UO,{ref:"bank"+t,floating:!1,content:e.content,stack:!0,linterContext:this.props.linterContext,onMouseDown:this.state.animating?$.noop:this.onClick.bind(null,"bank",t),onMouseMove:this.onMouseMove,onMouseUp:this.onRelease},t)),this)});return Object($t.jsxs)("div",{className:"draggy-boxy-thing orderer height-"+this.props.height+" layout-"+this.props.layout+" above-scratchpad blank-background perseus-clearfix "+BO.INTERACTIVE,ref:"orderer",children:[o,r]})},onClick:function(e,t,n,s){var i,r=$(FO.findDOMNode(s)),o=this.state.current.slice(),a=null;"current"===e?(o.splice(t,1),i=this.state.current[t],a=t):"bank"===e&&(i=this.props.options[t]),this.setState({current:o,dragging:!0,placeholderIndex:a,dragKey:i.key,dragContent:i.content,dragWidth:r.width(),dragHeight:r.height(),grabPos:n,mousePos:n,offsetPos:r.position()})},onRelease:function(e){var t=this.refs.dragging;if(null!=t){var n=this.isCardInBank(t),s=this.state.placeholderIndex,i=()=>{var e=this.state.current.slice();if(!n){var t={content:this.state.dragContent,key:zO.uniqueId("perseus_draggable_card_"),width:this.state.dragWidth};e.splice(s,0,t)}this.props.onChange({current:e}),this.setState({current:e,dragging:!1,placeholderIndex:null,animating:!1}),this.props.trackInteraction()},r=$(FO.findDOMNode(t)).position(),o=null;n?zO.each(this.props.options,(function(e,t){if(e.content===this.state.dragContent){var n=FO.findDOMNode(this.refs["bank"+t]);o=$(n).position()}}),this):null!=this.refs.placeholder&&(o=$(FO.findDOMNode(this.refs.placeholder)).position()),null==o?i():this.setState({offsetPos:r,animateTo:o,onAnimationEnd:i,animating:!0,dragging:!1})}},onMouseMove:function(e){var t,n=this.refs.dragging;null!=n&&(t=this.isCardInBank(n)?null:this.findCorrectIndex(n,this.state.current),this.setState({mousePos:e,placeholderIndex:t}))},findCorrectIndex:function(e,t){var n=this.props.layout===GO,s=$(FO.findDOMNode(this.refs.dragList)),i=s.offset().left,r=s.offset().top,o=$(FO.findDOMNode(e)).offset().left-i,a=$(FO.findDOMNode(e)).offset().top-r,l=0,c=0,h=0;return n?zO.each(t,(function(e,t){var n=FO.findDOMNode(this.refs["sortable"+t]),s=$(n).outerWidth(!0);o>c+s/2&&(l+=1),c+=s}),this):zO.each(t,(function(e,t){var n=FO.findDOMNode(this.refs["sortable"+t]),s=$(n).outerHeight(!0);a>h+s/2&&(l+=1),h+=s}),this),l},isCardInBank:function(e){if(null==e)return!1;var t=this.props.layout===GO,n=$(FO.findDOMNode(e)),s=$(FO.findDOMNode(this.refs.bank)),i=n.offset(),r=s.offset(),o=n.outerHeight(!0),a=s.outerHeight(!0),l=s.outerWidth(!0),c=FO.findDOMNode(this.refs.dragList),h=($(c).width(),n.outerWidth(!0));return t?i.top+o/2<r.top+a:i.left+h/2<r.left+l},getUserInput:function(){return{current:zO.map(this.props.current,(function(e){return e.content}))}},simpleValidate:function(e){return $O.validate(this.getUserInput(),e)}});zO.extend($O,{validate:function(e,t){return 0===e.current.length?{type:"invalid",message:null}:{type:"points",earned:zO.isEqual(e.current,zO.pluck(t.correctOptions,"content"))?1:0,total:1,message:null}}}),LO.exports={name:"orderer",displayName:"Orderer",widget:$O,isLintable:!0};var YO=LO.exports,KO={exports:{}},XO=(KO.exports,h.a,x.b),ZO=pu,JO=Vf.a,QO=cd,eC=Gd,tC=Lf,nC=Bf,sC=G.a.number,iC=createReactClass({displayName:"NumberLineEditor",getDefaultProps:function(){return{range:[0,10],labelRange:[null,null],labelStyle:"decimal",labelTicks:!0,divisionRange:[1,12],numDivisions:5,snapDivisions:2,tickStep:null,correctRel:"eq",correctX:null,initialX:null,showTooltips:!1}},onRangeChange:function(e){this.props.onChange({range:e})},onLabelRangeChange:function(e,t){var n=this.props.labelRange.slice(),s=n[1-e];null==t||null==s?n[e]=t:n=[Math.min(t,s),Math.max(t,s)],this.props.onChange({labelRange:n})},onDivisionRangeChange:function(e){var t,n,s,i=this.props.numDivisions;t=i,n=e[0],s=e[1],i=Math.min(Math.max(t,n),s),this.props.onChange({divisionRange:e,numDivisions:i})},onNumChange:function(e,t){var n={};n[e]=t,this.props.onChange(n)},onNumDivisionsChange:function(e){var t=this.props.divisionRange.slice();XO.isFinite(e)||(e=null),(e=(e=Math.round(e))<0?-1*e:e)&&(e=Math.min(t[1],Math.max(t[0],e)),this.props.onChange({tickStep:null,divisionRange:t,numDivisions:e}))},onTickStepChange:function(e){this.props.onChange({numDivisions:null,tickStep:e})},onChangeRelation:function(e){const t=e.target.value;this.props.onChange({correctRel:t,isInequality:"eq"!==t})},onLabelStyleChange:function(e){this.props.onChange({labelStyle:e})},serialize(){return ZO.serialize.call(this)},render:function(){var e=this.props.range,t=this.props.labelRange,n=this.props.divisionRange;e[0]=+e[0],e[1]=+e[1];var s=e[1]-e[0],i=this.props.numDivisions,r=this.props.snapDivisions,o=this.props.tickStep,a=this.props.isTickCtrl;let l;l=a?null:o?o/r:s/i/r;return Object($t.jsxs)("div",{className:"perseus-widget-number-line-editor",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Correct x"," ",Object($t.jsxs)("select",{value:this.props.correctRel,onChange:this.onChangeRelation,children:[Object($t.jsx)("option",{value:"eq",children:" = "}),Object($t.jsx)("option",{value:"lt",children:" < "}),Object($t.jsx)("option",{value:"gt",children:" > "}),Object($t.jsx)("option",{value:"le",children:" \u2264 "}),Object($t.jsx)("option",{value:"ge",children:" \u2265 "})]})," ",Object($t.jsx)(eC,{value:this.props.correctX,format:this.props.labelStyle,onChange:this.onNumChange.bind(this,"correctX"),checkValidity:t=>t>=e[0]&&t<=e[1]&&(!l||sC.isInteger((t-e[0])/l)),placeholder:"answer",size:"normal",useArrowKeys:!0}),Object($t.jsx)(QO,{children:Object($t.jsx)("p",{children:"This is the correct answer. The answer is validated (as right or wrong) by using only the end position of the point and the relation (=, <, >, \u2264, \u2265)."})})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[this.props.static?Object($t.jsx)("label",{children:"Range:"}):Object($t.jsxs)("label",{children:["Position:"," ",Object($t.jsx)(eC,{value:this.props.initialX,format:this.props.labelStyle,onChange:this.onNumChange.bind(this,"initialX"),placeholder:e[0],checkValidity:t=>t>=e[0]&&t<=e[1],useArrowKeys:!0})," \u2208 "]}),Object($t.jsx)(nC,{value:e,onChange:this.onRangeChange,format:this.props.labelStyle,useArrowKeys:!0}),Object($t.jsxs)(QO,{children:[Object($t.jsxs)("p",{children:["This controls the initial position of the point along the number line and the",Object($t.jsx)("strong",{children:"range"}),", the position of the endpoints of the number line. Setting the range constrains the position of the answer and the labels."]}),Object($t.jsx)("p",{children:"In static mode, the initial position of the point is determined by Correct x instead of position."})]})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["Labels:"," ",Object($t.jsx)(eC,{value:t[0],placeholder:e[0],format:this.props.labelStyle,checkValidity:t=>t>=e[0]&&t<=e[1],onChange:this.onLabelRangeChange.bind(this,0),useArrowKeys:!0}),Object($t.jsx)("span",{children:" & "}),Object($t.jsx)(eC,{value:t[1],placeholder:e[1],format:this.props.labelStyle,checkValidity:t=>t>=e[0]&&t<=e[1],onChange:this.onLabelRangeChange.bind(this,1),useArrowKeys:!0}),Object($t.jsx)(QO,{children:Object($t.jsxs)("p",{children:["This controls the position of the left / right labels. By default, the labels are set by the range ",Object($t.jsx)("br",{}),Object($t.jsx)("strong",{children:"Note:"})," Ensure that the labels line up with the tick marks, or it may be confusing for users."]})})]})}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Style:"," ",Object($t.jsx)(JO,{allowEmpty:!1,value:this.props.labelStyle,buttons:[{value:"decimal",content:"0.75",title:"Decimals"},{value:"improper",content:"\u2077\u2044\u2084",title:"Improper fractions"},{value:"mixed",content:"1\xbe",title:"Mixed numbers"},{value:"non-reduced",content:"\u2078\u2044\u2084",title:"Non-reduced"}],onChange:this.onLabelStyleChange}),Object($t.jsx)(QO,{children:Object($t.jsx)("p",{children:"This controls the styling of the labels for the two main labels as well as all the tick mark labels, if applicable. Your choices are decimal, improper fractions, mixed fractions, and non-reduced fractions."})})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[!this.props.static&&Object($t.jsx)("div",{className:"perseus-widget-left-col",children:Object($t.jsx)(tC,{label:"Show tick controller",isTickCtrl:this.props.isTickCtrl,onChange:this.props.onChange})}),Object($t.jsx)("div",{className:"perseus-widget-right-col",children:Object($t.jsx)(tC,{label:"Show label ticks",labelTicks:this.props.labelTicks,onChange:this.props.onChange})})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:!this.props.static&&Object($t.jsx)(tC,{label:"Show tooltips",showTooltips:this.props.showTooltips,onChange:this.props.onChange})}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[a&&Object($t.jsxs)("span",{children:[Object($t.jsxs)("label",{children:["Start num divisions at"," ",Object($t.jsx)(eC,{value:this.props.numDivisions||null,format:"decimal",onChange:this.onNumDivisionsChange,checkValidity:e=>e>=n[0]&&e<=n[1],placeholder:s/this.props.tickStep,useArrowKeys:!0})]}),Object($t.jsx)(QO,{children:Object($t.jsxs)("p",{children:["This controls the number (and position) of the tick marks. The number of divisions is constrained to"," "+n[0]+"\u2013"+n[1],".",Object($t.jsx)("br",{}),Object($t.jsx)("strong",{children:"Note:"})," The user will be able to specify the number of divisions in a number input."]})})]}),!a&&Object($t.jsxs)("span",{children:[Object($t.jsxs)("label",{children:["Num divisions:"," ",Object($t.jsx)(eC,{value:this.props.numDivisions||null,format:"decimal",onChange:this.onNumDivisionsChange,checkValidity:e=>e>=n[0]&&e<=n[1],placeholder:s/this.props.tickStep,useArrowKeys:!0})]})," ",Object($t.jsxs)("label",{children:["or tick step:"," ",Object($t.jsx)(eC,{value:this.props.tickStep||null,format:this.props.labelStyle,onChange:this.onTickStepChange,checkValidity:e=>e>0&&e<=s,placeholder:s/this.props.numDivisions,useArrowKeys:!0})]}),Object($t.jsx)(QO,{children:Object($t.jsxs)("p",{children:["This controls the number (and position) of the tick marks; you can either set the number of divisions (2 divisions would split the entire range in two halves), or the tick step (the distance between ticks) and the other value will be updated accordingly."," ",Object($t.jsx)("br",{}),Object($t.jsx)("strong",{children:"Note:"})," There is no check to see if labels coordinate with the tick marks, which may be confusing for users if the blue labels and black ticks are off-step."]})})]})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("label",{children:["Snap increments per tick:"," ",Object($t.jsx)(eC,{value:r,checkValidity:e=>e>0,format:this.props.labelStyle,onChange:this.onNumChange.bind(this,"snapDivisions"),useArrowKeys:!0})]}),Object($t.jsx)(QO,{children:Object($t.jsxs)("p",{children:["This determines the number of different places the point will snap between two adjacent tick marks."," ",Object($t.jsx)("br",{}),Object($t.jsx)("strong",{children:"Note:"}),"Ensure the required number of snap increments is provided to answer the question."]})})]})]})}});KO.exports=iC;var rC=KO.exports,oC={exports:{}},aC=(oC.exports,h.a,i.a),lC=x.b,cC=mu,hC=Gd,pC=bg;const uC=Dg;var dC=Is.Options;const{keypadElementPropType:gC}=ye.a.propTypes;var fC=hc,mC=fC.MovablePoint,bC=fC.Line,vC=G.a.number;const xC=Z,yC=Di;var jC=Ei.assert;var wC={ge:"le",gt:"lt",le:"ge",lt:"gt"},OC={ge:"gt",gt:"ge",le:"lt",lt:"le"};function CC(e,t){return 1===t?""+e:`\\dfrac{${e}}{${t}}`}function SC(e,t){if(e<0)return"-"+SC(-e,t);var n=Math.floor(e/t);return 0===n?CC(e,t):e-n*t===0?""+n:n+CC(e-n*t,t)}var kC=(e,t,n,s,i)=>{if(s=s||n,"decimal"===t||"decimal ticks"===t)return e.label([n,-.53],Math.round(100*s)/100,"center");if("improper"===t){const t=xC.toFraction(s);return e.label([n,-.17],CC(t[0],t[1]),"below")}if("mixed"===t){const t=xC.toFraction(s);return e.label([n,-.17],SC(t[0],t[1]),"below")}if("non-reduced"===t){const t=xC.toFraction(s);return e.label([n,-.17],function(e,t,n){return CC(e*Math.floor(n/t),n)}(t[0],t[1],i),"below")}},_C=fC.createSimpleClass(((e,t)=>{if(!lC.isFinite(t.tickStep)||t.tickStep<=0)return[];var n,s=[],i=t.range,r=t.labelRange,o=null==r[0]?i[0]:r[0],a=null==r[1]?i[1]:r[1];if("non-reduced"===t.labelStyle){var l=[o,a];for(let e=0;e<=t.numDivisions;e++){const n=i[0]+e*t.tickStep;l.push(n)}var c=lC.map(l,(e=>vC.toFraction(e)[1]));n=lC.reduce(c,((e,t)=>xC.getLCM(e,t)))}else n=void 0;for(let h=0;h<=t.numDivisions;h++){const r=i[0]+h*t.tickStep;s.push(e.line([r,-.2],[r,.2])),(t.labelTicks||"decimal ticks"===t.labelStyle)&&s.push(kC(e,t.labelStyle,r,r,n))}return s.push(e.style(t.isMobile?{color:yC.BLUE_D}:{},(()=>kC(e,t.labelStyle,o,o,n)))),s.push(e.style(t.isMobile?{color:yC.BLUE_D}:{},(()=>kC(e,t.labelStyle,a,a,n)))),e.style({stroke:t.isMobile?yC.BLUE_D:yC.DYNAMIC,strokeWidth:3.5},(()=>{s.push(e.line([o,-.2],[o,.2])),s.push(e.line([a,-.2],[a,.2]))})),s})),TC=createReactClass({displayName:"NumberLine",getDefaultProps:function(){return{range:[0,10],labelStyle:"decimal",labelRange:[null,null],divisionRange:[1,12],labelTicks:!0,isTickCtrl:!1,isInequality:!1,numLinePosition:0,snapDivisions:2,showTooltips:!1,rel:"ge",apiOptions:dC.defaults}},getInitialState:()=>({numDivisionsEmpty:!1}),change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return cC.change.apply(this,t)},isValid:function(){var e=this.props.range,t=this.props.numLinePosition,n=this.props.divisionRange;return t=null==t?e[0]:t,e[0]<e[1]&&vC.sign(t-e[0])>=0&&vC.sign(t-e[1])<=0&&n[0]<n[1]&&0<this.props.numDivisions&&0<this.props.snapDivisions},onNumDivisionsChange:function(e,t){var n=this.props.divisionRange.slice(),s=this.props.range[1]-this.props.range[0];if(e=(e=Math.round(e))<0?-1*e:e){var i=lC.extend({},this.props,{tickStep:s/e}),r=this.snapNumLinePosition(i,this.props.numLinePosition);this.setState({numDivisionsEmpty:!1},(()=>{this.props.onChange({divisionRange:n,numDivisions:e,numLinePosition:r},t)}))}else this.setState({numDivisionsEmpty:!0},t)},_handleTickCtrlFocus:function(){this.props.onFocus(["tick-ctrl"])},_handleTickCtrlBlur:function(){this.props.onBlur(["tick-ctrl"])},focus:function(){if(this.props.isTickCtrl)return this.refs["tick-ctrl"].focus(),!0},focusInputPath:function(e){1===e.length&&this.refs[e[0]].focus()},blurInputPath:function(e){1===e.length&&this.refs[e[0]].blur()},getInputPaths:function(){return this.props.isTickCtrl?[["tick-ctrl"]]:[]},getDOMNodeForPath:function(e){if(1===e.length)return aC.findDOMNode(this.refs[e[0]])},getGrammarTypeForPath:function(e){if(1===e.length&&"tick-ctrl"===e[0])return"number"},setInputValue:function(e,t,n){1===e.length&&"tick-ctrl"===e[0]&&this.onNumDivisionsChange(t,n)},_renderGraphie:function(){var e=this.props.range,t=e[1]-e[0],n=lC.pick(this.props,["range","isTickCtrl"]),s=lC.extend({},this.props,{tickStep:t/this.props.numDivisions});return Object($t.jsxs)(fC,{ref:"graphie",box:[this.props.apiOptions.isMobile?288:460,80],options:n,onMouseDown:e=>{this.refs.graphie.movables.numberLinePoint.grab(e)},setup:this._setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,isMobile:this.props.apiOptions.isMobile,children:[Object($t.jsx)(_C,{...lC.pick(s,["range","numDivisions","labelTicks","labelStyle","labelRange","tickStep"]),isMobile:this.props.apiOptions.isMobile}),this._renderInequality(s),this._renderNumberLinePoint(s)]},this.props.labelStyle)},snapNumLinePosition:function(e,t){var n=e.range[0],s=e.range[1],i=e.tickStep/e.snapDivisions;let r=((e,t,n)=>Math.min(Math.max(e,t),n))(t,n,s);return r=n+vC.roundTo(r-n,i),jC(lC.isFinite(r)),r},_renderNumberLinePoint:function(e){var t=["lt","gt"].includes(e.rel),n={fill:t?yC._BACKGROUND:e.static?yC.DYNAMIC:yC.INTERACTIVE,stroke:e.static?yC.DYNAMIC:yC.INTERACTIVE,"stroke-width":t?3:1},s={fill:t?yC._BACKGROUND:yC.INTERACTING,"stroke-width":t?3:1};const i=e.isInequality?{stroke:yC.INTERACTIVE,"fill-opacity":t?0:1}:{};return Object($t.jsx)(mC,{ref:"numberLinePoint",pointSize:6,coord:[e.numLinePosition,0],constraints:[(e,t)=>[e[0],t[1]],(t,n)=>[this.snapNumLinePosition(e,t[0]),t[1]]],normalStyle:n,highlightStyle:s,onMove:e=>{this.change({numLinePosition:e[0]}),this.props.trackInteraction()},isMobile:this.props.apiOptions.isMobile,mobileStyleOverride:i,showTooltips:this.props.showTooltips,xOnlyTooltip:!0})},handleReverse:function(){var e=wC[this.props.rel];this.props.onChange({rel:e})},handleToggleStrict:function(){var e=OC[this.props.rel];this.props.onChange({rel:e})},_getInequalityEndpoint:function(e){var t=["ge","gt"].includes(e.rel),n=e.range,s=30*((n[1]-n[0])/400),i=n[0]-s,r=n[1]+s;return t?[r,0]:[i,0]},_renderInequality:function(e){if(e.isInequality){var t=this._getInequalityEndpoint(e),n={arrows:"->",stroke:this.props.apiOptions.isMobile?yC.INTERACTIVE:yC.DYNAMIC,strokeWidth:3.5};const s=["ge","gt"].includes(e.rel);return Object($t.jsx)(bC,{start:[(s?.4:-.4)+e.numLinePosition,0],end:t,style:n})}return null},_setupGraphie:function(e,t){if(!this.isValid())return;var n=this.props.apiOptions.isMobile?228:400,s=t.range,i=(s[1]-s[0])/n,r=30*i,o=s[0]-r,a=s[1]+r;var l="improper"===this.props.labelStyle||"mixed"===this.props.labelStyle||"non-reduced"===this.props.labelStyle?-1.5:-1;e.init({range:[[o,a],[l,1]],scale:[1/i,40],isMobile:this.props.apiOptions.isMobile});var c=(s[0]+s[1])/2;e.line([c,0],[a,0],{arrows:"->"}),e.line([c,0],[o,0],{arrows:"->"})},getUserInput:function(){return{numLinePosition:this.props.numLinePosition,rel:this.props.isInequality?this.props.rel:"eq",numDivisions:this.props.numDivisions,divisionRange:this.props.divisionRange}},simpleValidate:function(e){return TC.validate(this.getUserInput(),e)},render:function(){var e,t,n=this.props.divisionRange,s=n[0]+"\u2013"+n[1],i=this.props.numDivisions<n[0]||this.props.numDivisions>n[1],r=Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{type:"button",className:"simple-button",value:i18n._("Switch direction"),onClick:this.handleReverse}),Object($t.jsx)("input",{type:"button",className:"simple-button",value:["le","ge"].includes(this.props.rel)?i18n._("Make circle open"):i18n._("Make circle filled"),onClick:this.handleToggleStrict})]});this.props.isTickCtrl&&(t=this.props.apiOptions.customKeypad?uC:this.props.apiOptions.staticRender?pC:hC,e=Object($t.jsxs)("label",{children:[i18n._("Number of divisions:")," ",Object($t.jsx)(t,{ref:"tick-ctrl",value:this.state.numDivisionsEmpty?null:this.props.numDivisions||n[0],checkValidity:e=>e>=n[0]&&e<=n[1],onChange:this.onNumDivisionsChange,onFocus:this._handleTickCtrlFocus,onBlur:this._handleTickCtrlBlur,useArrowKeys:!0,keypadElement:this.props.keypadElement})]}));return Object($t.jsxs)("div",{className:"perseus-widget perseus-widget-interactive-number-line",children:[e,this.isValid()?this.props.isTickCtrl&&i?Object($t.jsx)("div",{className:"perseus-error",children:$_({divRangeString:s},"Please make sure the number of divisions is in the range %(divRangeString)s.")}):this._renderGraphie():Object($t.jsx)("div",{className:"perseus-error",children:"Invalid number line configuration."}),!this.props.static&&this.props.isInequality&&r]})}});lC.extend(TC,{validate:function(e,t){var n=t.range,s=e.divisionRange,i=null!=t.initialX?t.initialX:n[0],r=t.isInequality?"ge":"eq",o=t.correctRel||"eq",a=vC.equal(e.numLinePosition,t.correctX||0),l=e.numDivisions>s[1]||e.numDivisions<s[0];return e.isTickCrtl&&l?{type:"invalid",message:"Number of divisions is outside the allowed range."}:a&&o===e.rel?{type:"points",earned:1,total:1,message:null}:e.numLinePosition===i&&e.rel===r?{type:"invalid",message:null}:{type:"points",earned:0,total:1,message:null}}});oC.exports={name:"number-line",displayName:"Number line",widget:TC,transform:e=>{var t,n=lC.pick(e,["range","labelRange","labelStyle","labelTicks","divisionRange","snapDivisions","isTickCtrl","isInequality","showTooltips"]),s=null!=e.initialX?e.initialX:e.range[0],i=e.range[1]-e.range[0];return t=null!=e.numDivisions?e.numDivisions:null!=e.tickStep?i/e.tickStep:void 0,lC.extend(n,{numLinePosition:s,numDivisions:t,snapDivisions:n.snapDivisions||void 0}),n},staticTransform:e=>{var t,n=lC.pick(e,["range","labelRange","labelStyle","labelTicks","divisionRange","snapDivisions","isInequality"]),s=null!=e.correctX?e.correctX:e.range[0],i=e.range[1]-e.range[0];return t=null!=e.numDivisions?e.numDivisions:null!=e.tickStep?i/e.tickStep:void 0,lC.extend(n,{numLinePosition:s,numDivisions:t,rel:e.isInequality?e.correctRel:null,snapDivisions:n.snapDivisions||void 0}),n}};var MC=oC.exports,NC={exports:{}};NC.exports;h.a;const PC=pu,IC=mu,EC=Gd,AC=$x,RC=createReactClass({displayName:"MoleculeWidgetEditor",change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return IC.change.apply(this,t)},updateMolecule:function(e){this.change({smiles:e})},updateRotation:function(e){this.change({rotationAngle:e})},serialize(){return PC.serialize.call(this)},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["SMILES:\xa0",Object($t.jsx)(AC,{onChange:this.updateMolecule,value:this.props.smiles})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Rotation (deg):\xa0",Object($t.jsx)(EC,{onChange:this.updateRotation,value:this.props.rotationAngle})]})})]})}});NC.exports=RC;var DC=NC.exports,LC={exports:{}};LC.exports;h.a;const FC=x.b,zC=mu,qC=pu,WC=cd,BC=Gd,VC=Lf,HC=Bf,UC={url:null,top:0,left:0},GC=createReactClass({displayName:"MeasurerEditor",className:"perseus-widget-measurer",getDefaultProps:function(){return{box:[480,480],image:{},showProtractor:!0,showRuler:!1,rulerLabel:"",rulerTicks:10,rulerPixels:40,rulerLength:10}},render:function(){var e=FC.extend({},UC,this.props.image);return Object($t.jsxs)("div",{className:"perseus-widget-measurer",children:[Object($t.jsx)("div",{children:"Image displayed under protractor and/or ruler:"}),Object($t.jsxs)("div",{children:["URL:"," ",Object($t.jsx)("input",{type:"text",className:"perseus-widget-measurer-url",ref:"image-url",defaultValue:e.url,onChange:this._changeUrl}),Object($t.jsx)(WC,{children:Object($t.jsx)("p",{children:'Create an image in graphie, or use the "Add image" function to create a background.'})})]}),e.url&&Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("label",{className:"perseus-widget-left-col",children:["Pixels from top:"," ",Object($t.jsx)(BC,{placeholder:0,onChange:this._changeTop,value:e.top,useArrowKeys:!0})]}),Object($t.jsxs)("label",{className:"perseus-widget-right-col",children:["Pixels from left:"," ",Object($t.jsx)(BC,{placeholder:0,onChange:this._changeLeft,value:e.left,useArrowKeys:!0})]})]}),Object($t.jsxs)("div",{children:["Containing area [width, height]:"," ",Object($t.jsx)(HC,{onChange:this.change("box"),value:this.props.box,useArrowKeys:!0})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("div",{className:"perseus-widget-left-col",children:Object($t.jsx)(VC,{label:"Show ruler",showRuler:this.props.showRuler,onChange:this.props.onChange})}),Object($t.jsx)("div",{className:"perseus-widget-right-col",children:Object($t.jsx)(VC,{label:"Show protractor",showProtractor:this.props.showProtractor,onChange:this.props.onChange})})]}),this.props.showRuler&&Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[" ","Ruler label:"," ",Object($t.jsxs)("select",{onChange:e=>this.change("rulerLabel",e.target.value),value:this.props.rulerLabel,children:[Object($t.jsx)("option",{value:"",children:"None"}),Object($t.jsx)("optgroup",{label:"Metric",children:this.renderLabelChoices([["milimeters","mm"],["centimeters","cm"],["meters","m"],["kilometers","km"]])}),Object($t.jsx)("optgroup",{label:"Imperial",children:this.renderLabelChoices([["inches","in"],["feet","ft"],["yards","yd"],["miles","mi"]])})]})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[" ","Ruler ticks:"," ",Object($t.jsx)("select",{onChange:e=>this.change("rulerTicks",+e.target.value),value:this.props.rulerTicks,children:FC.map([1,2,4,8,10,16],(function(e){return Object($t.jsx)("option",{value:e,children:e},e)}))})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Ruler pixels per unit:"," ",Object($t.jsx)(BC,{placeholder:40,onChange:this.change("rulerPixels"),value:this.props.rulerPixels,useArrowKeys:!0})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Ruler length in units:"," ",Object($t.jsx)(BC,{placeholder:10,onChange:this.change("rulerLength"),value:this.props.rulerLength,useArrowKeys:!0})]})})]})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return zC.change.apply(this,t)},_changeUrl:function(e){this._changeImage("url",e.target.value)},_changeTop:function(e){this._changeImage("top",e)},_changeLeft:function(e){this._changeImage("left",e)},_changeImage:function(e,t){var n=FC.clone(this.props.image);n[e]=t,this.change("image",n)},renderLabelChoices:function(e){return FC.map(e,(function(e){var[t,n]=e;return Object($t.jsx)("option",{value:n,children:t},n)}))},serialize(){return qC.serialize.call(this)}});LC.exports=GC;var $C=LC.exports,YC={exports:{}},KC=(YC.exports,h.a,i.a),XC=x.b;const ZC=no;var JC={url:null,top:0,left:0},QC=createReactClass({displayName:"Measurer",getDefaultProps:function(){return{box:[480,480],image:{},showProtractor:!0,protractorX:7.5,protractorY:.5,showRuler:!1,rulerLabel:"",rulerTicks:10,rulerPixels:40,rulerLength:10}},getInitialState:function(){return{}},render:function(){var e=XC.extend({},JC,this.props.image);return Object($t.jsxs)("div",{className:"perseus-widget perseus-widget-measurer graphie-container above-scratchpad",style:{width:this.props.box[0],height:this.props.box[1]},children:[e.url&&Object($t.jsx)("img",{src:e.url,style:{top:e.top,left:e.left}}),Object($t.jsx)("div",{className:"graphie",ref:"graphieDiv"})]})},componentDidMount:function(){this.setupGraphie()},componentDidUpdate:function(e){XC.any(["box","showProtractor","showRuler","rulerLabel","rulerTicks","rulerPixels","rulerLength"],(function(t){return e[t]!==this.props[t]}),this)&&this.setupGraphie()},setupGraphie:function(){var e=KC.findDOMNode(this.refs.graphieDiv);$(e).empty();var t=this.graphie=ZC.createGraphie(e),n=[40,40],s=[[0,this.props.box[0]/n[0]],[0,this.props.box[1]/n[1]]];t.init({range:s,scale:n}),t.addMouseLayer({allowScratchpad:!0,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),this.protractor&&this.protractor.remove(),this.props.showProtractor&&(this.protractor=t.protractor([this.props.protractorX,this.props.protractorY])),this.ruler&&this.ruler.remove(),this.props.showRuler&&(this.ruler=t.ruler({center:[(s[0][0]+s[0][1])/2,(s[1][0]+s[1][1])/2],label:this.props.rulerLabel,pixelsPerUnit:this.props.rulerPixels,ticksPerUnit:this.props.rulerTicks,units:this.props.rulerLength}))},getUserInput:function(){return{}},simpleValidate:function(e){return QC.validate(this.getUserInput(),e)},focus:$.noop});XC.extend(QC,{validate:function(e,t){return{type:"points",earned:1,total:1,message:null}}});var eS={1:e=>XC.chain(e).omit("imageUrl","imageTop","imageLeft").extend({image:{url:e.imageUrl,top:e.imageTop,left:e.imageLeft}}).value()};YC.exports={name:"measurer",displayName:"Measurer",widget:QC,version:{major:1,minor:0},propUpgrades:eS};var tS=YC.exports,nS={exports:{}},sS=(nS.exports,h.a,x.b),iS=cd,rS=Lf,oS=Cs,aS=createReactClass({displayName:"MatcherEditor",getDefaultProps:function(){return{left:["$x$","$y$","$z$"],right:["$1$","$2$","$3$"],labels:["test","label"],orderMatters:!1,padding:!0}},render:function(){return Object($t.jsxs)("div",{className:"perseus-matcher-editor",children:[Object($t.jsxs)("div",{children:[" ","Correct answer:"," ",Object($t.jsx)(iS,{children:Object($t.jsx)("p",{children:"Enter the correct answers here. The preview on the right will show the cards in a randomized order, which is how the student will see them."})})]}),Object($t.jsxs)("div",{className:"perseus-clearfix",children:[Object($t.jsx)(oS,{options:this.props.left,onChange:(e,t)=>{this.props.onChange({left:e},t)},layout:"vertical"}),Object($t.jsx)(oS,{options:this.props.right,onChange:(e,t)=>{this.props.onChange({right:e},t)},layout:"vertical"})]}),Object($t.jsxs)("span",{children:[" ","Labels:"," ",Object($t.jsx)(iS,{children:Object($t.jsx)("p",{children:"These are entirely optional."})})]}),Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{type:"text",defaultValue:this.props.labels[0],onChange:this.onLabelChange.bind(this,0)}),Object($t.jsx)("input",{type:"text",defaultValue:this.props.labels[1],onChange:this.onLabelChange.bind(this,1)})]}),Object($t.jsxs)("div",{children:[Object($t.jsx)(rS,{label:"Order of the matched pairs matters:",orderMatters:this.props.orderMatters,onChange:this.props.onChange}),Object($t.jsxs)(iS,{children:[Object($t.jsx)("p",{children:"With this option enabled, only the order provided above will be treated as correct. This is useful when ordering is significant, such as in the context of a proof."}),Object($t.jsx)("p",{children:"If disabled, pairwise matching is sufficient. To make this clear, the left column becomes fixed in the provided order and only the cards in the right column can be moved."})]})]}),Object($t.jsxs)("div",{children:[Object($t.jsx)(rS,{label:"Padding:",padding:this.props.padding,onChange:this.props.onChange}),Object($t.jsx)(iS,{children:Object($t.jsx)("p",{children:"Padding is good for text, but not needed for images."})})]})]})},onLabelChange:function(e,t){var n=sS.clone(this.props.labels);n[e]=t.target.value,this.props.onChange({labels:n})},getSaveWarnings:function(){return this.props.left.length!==this.props.right.length?["The two halves of the matcher have different numbers of cards."]:[]},serialize:function(){return sS.pick(this.props,"left","right","labels","orderMatters","padding")}});nS.exports=aS;var lS=nS.exports,cS={exports:{}};cS.exports;h.a;const hS=x.b,pS=gh,uS=Hv,dS=ce.shuffle,gS=ce.seededRNG,fS=createReactClass({displayName:"Matcher",getDefaultProps:function(){return{left:[],right:[],labels:["",""],orderMatters:!1,padding:!0,problemNum:0,onChange:function(){},linterContext:je}},getInitialState:function(){return{leftHeight:0,rightHeight:0}},render:function(){var e,t=gS(this.props.problemNum);e=this.props.orderMatters?dS(this.props.left,t,!0):this.props.left;var n=dS(this.props.right,t,!0),s=hS.any(this.props.labels),i={height:hS.max([this.state.leftHeight,this.state.rightHeight])};const r=this.props.apiOptions.isMobile?8:5;return Object($t.jsx)("table",{className:Object(Nn.css)(bS.widget)+" perseus-widget-matcher",children:Object($t.jsxs)("tbody",{children:[s&&Object($t.jsxs)("tr",{className:Object(Nn.css)(bS.row),children:[Object($t.jsx)("th",{className:Object(Nn.css)(bS.column,bS.columnLabel),children:Object($t.jsx)(pS,{content:this.props.labels[0]||"...",linterContext:this.props.linterContext})}),Object($t.jsx)("th",{className:Object(Nn.css)(bS.column,bS.columnRight,bS.columnLabel),children:Object($t.jsx)(pS,{content:this.props.labels[1]||"...",linterContext:this.props.linterContext})})]}),Object($t.jsxs)("tr",{className:Object(Nn.css)(bS.row),children:[Object($t.jsx)("td",{className:Object(Nn.css)(bS.column),children:Object($t.jsx)(uS,{options:e,layout:"vertical",padding:this.props.padding,disabled:!this.props.orderMatters,constraints:i,onMeasure:this.onMeasureLeft,onChange:this.changeAndTrack,margin:r,linterContext:this.props.linterContext,ref:"left"})}),Object($t.jsx)("td",{className:Object(Nn.css)(bS.column,bS.columnRight),children:Object($t.jsx)(uS,{options:n,layout:"vertical",padding:this.props.padding,constraints:i,onMeasure:this.onMeasureRight,onChange:this.changeAndTrack,margin:r,linterContext:this.props.linterContext,ref:"right"})})]})]})})},changeAndTrack:function(e){this.props.onChange(e),this.props.trackInteraction()},onMeasureLeft:function(e){var t=hS.max(e.heights);this.setState({leftHeight:t})},onMeasureRight:function(e){var t=hS.max(e.heights);this.setState({rightHeight:t})},getUserInput:function(){return{left:this.refs.left.getOptions(),right:this.refs.right.getOptions()}},simpleValidate:function(e){return fS.validate(this.getUserInput(),e)}});hS.extend(fS,{validate:function(e,t){return{type:"points",earned:hS.isEqual(e.left,t.left)&&hS.isEqual(e.right,t.right)?1:0,total:1,message:null}}});const mS="1px solid #444",bS=Nn.StyleSheet.create({widget:{paddingTop:5,maxWidth:"100%",minWidth:"auto"},row:{border:0},column:{padding:0,border:0},columnRight:{borderLeft:mS},columnLabel:{fontWeight:"inherit",borderBottom:mS,padding:"0 5px 5px 5px",textAlign:"center"}});cS.exports={name:"matcher",displayName:"Two column matcher",widget:fS,isLintable:!0};var vS=cS.exports,xS={exports:{}},yS=(xS.exports,v.a),jS=(h.a,i.a),wS=x.b,OS=Gd,CS=gh,SS=$x,kS=bg;const _S=Dg;var TS=Is.Options;const MS=ie,{keypadElementPropType:NS}=ye.a.propTypes;var PS=Ei.assert,IS=ce.stringArrayOfSize,ES={INPUT_MARGIN:4,INPUT_HEIGHT:38,INPUT_WIDTH:82},AS={INPUT_MARGIN:3,INPUT_HEIGHT:30,INPUT_WIDTH:40};const RS={INPUT_MARGIN:4,INPUT_HEIGHT:36,INPUT_WIDTH:64};var DS=function(e,t){return[""+e,""+t]},LS=function(){return DS(0,0)},FS=function(e){return PS(wS.isArray(e)&&2===e.length),+e[0]},zS=function(e){return PS(wS.isArray(e)&&2===e.length),+e[1]},qS=function(e){return"answer"+FS(e)+","+zS(e)},WS=function(e){var t=[1,1];return wS.each(e,((e,n)=>{var s=0;wS.each(e,((e,t)=>{null!=e&&e.toString().length&&(s=t+1)})),t[1]=Math.max(t[1],s),s>0&&(t[0]=Math.max(t[0],n+1))})),t},BS=createReactClass({displayName:"Matrix",getDefaultProps:function(){return{matrixBoardSize:[3,3],answers:[[]],prefix:"",suffix:"",cursorPosition:[0,0],apiOptions:TS.defaults,linterContext:je}},getInitialState:function(){return{enterTheMatrix:0}},componentDidMount:function(){this.cursorPosition=[0,0]},render:function(){let e;e=this.props.apiOptions.customKeypad?RS:this.props.apiOptions.staticRender?ES:AS;const{INPUT_MARGIN:t,INPUT_HEIGHT:n,INPUT_WIDTH:s}=e;var i=WS(this.props.answers),r=this.props.matrixBoardSize[0],o=this.props.matrixBoardSize[1],a=this.props.cursorPosition[0],l=this.props.cursorPosition[1],c=Math.max(a,i[0]-1),h=Math.max(l,i[1]-1),p=(c+1)*(n+2*t),u=(h+1)*(s+2*t),d=yS({"perseus-matrix":!0,"static-mode":this.props.static,"the-matrix":this.state.enterTheMatrix>=5});return Object($t.jsxs)("div",{className:d,children:[this.props.prefix&&Object($t.jsx)("div",{className:"matrix-prefix",children:Object($t.jsx)(CS,{content:this.props.prefix,linterContext:this.props.linterContext})}),Object($t.jsxs)("div",{className:"matrix-input",children:[Object($t.jsx)("div",{className:"matrix-bracket bracket-left",style:{height:p}}),Object($t.jsx)("div",{className:"matrix-bracket bracket-right",style:{height:p,left:u}}),wS.times(r,(e=>{var i=this.props.answers[e];return Object($t.jsx)("div",{className:"matrix-row",children:wS.times(o,(r=>{var o=e>c||r>h,a={className:o?"outside":"inside",ref:qS(DS(e,r)),value:i?i[r]:null,style:{height:n,width:s,margin:t},disabled:this.props.apiOptions.readOnly,onFocus:()=>{this.cursorPosition=[e,r],this.props.onChange({cursorPosition:[e,r]},(()=>!1)),this._handleFocus(e,r)},onBlur:()=>{e===this.cursorPosition[0]&&r===this.cursorPosition[1]&&this.props.onChange({cursorPosition:[0,0]},(()=>!1)),this._handleBlur(e,r)},onKeyDown:t=>{this.handleKeyDown(e,r,t)},onChange:(t,n)=>{this.onValueChange(e,r,t,n)}};let l;if(this.props.apiOptions.customKeypad){const e={margin:t,minWidth:s,minHeight:n,boxSizing:"border-box",backgroundColor:o?"#f3f3f3":"#fff"};l=Object($t.jsx)(_S,{...a,style:e,scrollable:!0,keypadElement:this.props.keypadElement})}else l=this.props.apiOptions.staticRender?Object($t.jsx)(kS,{...a}):this.props.numericInput?Object($t.jsx)(OS,{...a}):Object($t.jsx)(SS,{...a});return Object($t.jsx)("span",{className:"matrix-input-field",children:l},r)}))},e)}))]}),this.props.suffix&&Object($t.jsx)("div",{className:"matrix-suffix",children:Object($t.jsx)(CS,{content:this.props.suffix,linterContext:this.props.linterContext})})]})},getInputPaths:function(){var e=[],t=this.props.matrixBoardSize[0],n=this.props.matrixBoardSize[1];return wS.times(t,(t=>{wS.times(n,(n=>{var s=DS(t,n);e.push(s)}))})),e},getGrammarTypeForPath:function(e){return"number"},_handleFocus:function(e,t){this.props.onFocus(DS(e,t))},_handleBlur:function(e,t){this.props.onBlur(DS(e,t))},focus:function(){return this.focusInputPath(LS()),!0},focusInputPath:function(e){var t=qS(e);this.refs[t].focus()},blurInputPath:function(e){0===e.length&&(e=LS());var t=qS(e);this.refs[t].blur()},getDOMNodeForPath:function(e){var t=qS(e);return jS.findDOMNode(this.refs[t])},setInputValue:function(e,t,n){var s=FS(e),i=zS(e);this.onValueChange(s,i,t,n)},handleKeyDown:function(e,t,n){var s=this.props.matrixBoardSize[0],i=this.props.matrixBoardSize[1],r=null,o=this.refs[qS(DS(e,t))],a=o.getStringValue(),l=o.getSelectionStart(),c=o.getSelectionEnd(),h=null;if("ArrowUp"===n.key&&e>0?h=DS(e-1,t):"ArrowDown"===n.key&&e+1<s?h=DS(e+1,t):"ArrowLeft"===n.key&&t>0?0===l&&0===c&&(h=DS(e,t-1)):"ArrowRight"===n.key&&t+1<i?l===a.length&&(h=DS(e,t+1)):"Enter"===n.key?r=this.state.enterTheMatrix+1:"Escape"===n.key&&(r=0),h){n.preventDefault();var p=this.refs[qS(h)],u=2*p.getStringValue().length;p.focus(),"ArrowRight"===n.key?p.setSelectionRange(0,0):p.setSelectionRange(u,u)}null!=r&&this.setState({enterTheMatrix:r})},onValueChange:function(e,t,n,s){var i=wS.map(this.props.answers,wS.clone);i[e]||(i[e]=[]),i[e][t]=n,this.props.onChange({answers:i},s),this.props.trackInteraction()},getUserInput:function(){return{answers:this.props.answers}},simpleValidate:function(e){return BS.validate(this.getUserInput(),e)}});wS.extend(BS,{validate:function(e,t){var n=t.answers,s=e.answers,i=WS(n),r=WS(s),o=i[0]!==r[0]||i[1]!==r[1],a=MS.number.createValidatorFunctional,l=null,c=!1,h=!1;return wS.times(r[0],(e=>{wS.times(r[1],(t=>{null!=s[e][t]&&0!==s[e][t].toString().length||(c=!0);var i=a(n[e][t],{simplify:!0})(s[e][t]);i.message&&(l=i.message),i.correct||(h=!0)}))})),c?{type:"invalid",message:i18n._("Make sure you fill in all cells in the matrix.")}:o?{type:"points",earned:0,total:1,message:null}:{type:"points",earned:h?0:1,total:1,message:l}}});xS.exports={name:"matrix",displayName:"Matrix",widget:BS,transform:e=>{var t=wS.times(e.matrixBoardSize[0],(function(){return IS(e.matrixBoardSize[1])}));return e=wS.pick(e,"matrixBoardSize","prefix","suffix"),wS.extend(e,{answers:t})},staticTransform:e=>{var t=wS.pick(e,"matrixBoardSize","prefix","suffix");return t.answers=wS.map(e.answers,(e=>wS.map(e,(e=>null!=e?String(e):"")))),t},isLintable:!0};var VS=xS.exports,HS={exports:{}},US=(HS.exports,h.a,x.b),GS=mu,$S=pu,YS=lv,KS=Bf,XS=VS.widget,ZS=createReactClass({displayName:"MatrixEditor",getDefaultProps:function(){return{matrixBoardSize:[3,3],answers:[[]],prefix:"",suffix:"",cursorPosition:[0,0]}},render:function(){var e=US.extend({numericInput:!0,onBlur:()=>{},onFocus:()=>{},trackInteraction:()=>{}},this.props);return Object($t.jsxs)("div",{className:"perseus-matrix-editor",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[" ","Max matrix size:"," ",Object($t.jsx)(KS,{value:this.props.matrixBoardSize,onChange:this.onMatrixBoardSizeChange,format:this.props.labelStyle,useArrowKeys:!0})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(XS,{...e})}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[" ","Matrix prefix:"," ",Object($t.jsx)(YS,{ref:"prefix",apiOptions:this.props.apiOptions,content:this.props.prefix,widgetEnabled:!1,onChange:e=>{this.change({prefix:e.content})}})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[" ","Matrix suffix:"," ",Object($t.jsx)(YS,{ref:"suffix",apiOptions:this.props.apiOptions,content:this.props.suffix,widgetEnabled:!1,onChange:e=>{this.change({suffix:e.content})}})]})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return GS.change.apply(this,t)},onMatrixBoardSizeChange:function(e){var t=function(e){var t=[1,1];return US.each(e,((e,n)=>{var s=0;US.each(e,((e,t)=>{null!=e&&e.toString().length&&(s=t+1)})),t[1]=Math.max(t[1],s),s>0&&(t[0]=Math.max(t[0],n+1))})),t}(this.props.answers);if(null!==e[0]&&null!==e[1]){e=[Math.round(Math.min(Math.max(e[0],1),6)),Math.round(Math.min(Math.max(e[1],1),6))];var n=US.times(Math.min(e[0],t[0]),(n=>US.times(Math.min(e[1],t[1]),(e=>this.props.answers[n][e]))));this.props.onChange({matrixBoardSize:e,answers:n})}},serialize(){return $S.serialize.call(this)}});HS.exports=ZS;var JS=HS.exports,QS={exports:{}};QS.exports;h.a;const ek=x.b,tk=mu,nk=pu,sk=Gd,ik=Lf,rk=cd;var ok={display:"table",tableLayout:"fixed"},ak={display:"table-row"},lk={display:"table-cell",padding:5},ck={borderRadius:10,cursor:"pointer"},hk={plus:()=>[[!1,!0,!1],[!0,!0,!0],[!1,!0,!1]],x:()=>[[!0,!1,!0],[!1,!0,!1],[!0,!1,!0]],"plus/x":e=>e%2?hk.x():hk.plus()},pk=function(e,t,n){return e=Math.floor(e),e=Math.max(e,t),e=Math.min(e,n)},uk=createReactClass({displayName:"Tile",render:function(){var e=this.props.value?"#55dd55":"#115511",t=ek.extend({},ck,{width:this.props.size,height:this.props.size,backgroundColor:e});return Object($t.jsx)("div",{style:t,onClick:this._flip})},_flip:function(){this.props.onChange(!this.props.value)}}),dk=createReactClass({displayName:"TileGrid",render:function(){return Object($t.jsx)("div",{style:ok,className:"no-select",children:ek.map(this.props.cells,((e,t)=>Object($t.jsx)("div",{style:ak,children:ek.map(e,((e,n)=>Object($t.jsx)("div",{style:lk,children:Object($t.jsx)(uk,{value:e,size:this.props.size,onChange:ek.partial(this.props.onChange,t,n)})},n)))},t)))})}});const gk=createReactClass({displayName:"LightsPuzzleEditor",getDefaultProps:function(){return{startCells:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],flipPattern:"plus",gradeIncompleteAsWrong:!1}},_height:function(){return this.props.startCells.length},_width:function(){return 0!==this.props.startCells.length?this.props.startCells[0].length:0},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return tk.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{children:["Width:",Object($t.jsx)(sk,{value:this._width(),placeholder:5,onChange:this._changeWidth}),", ","Height:",Object($t.jsx)(sk,{value:this._height(),placeholder:5,onChange:this._changeHeight})]}),Object($t.jsxs)("div",{children:["Flip pattern:",Object($t.jsx)("select",{value:this.props.flipPattern,onChange:this._handlePatternChange,children:ek.map(ek.keys(hk),((e,t)=>Object($t.jsx)("option",{value:e,children:e},t)))})]}),Object($t.jsxs)("div",{children:["Grade incomplete puzzles as wrong:"," ",Object($t.jsx)(ik,{gradeIncompleteAsWrong:this.props.gradeIncompleteAsWrong,onChange:this.props.onChange}),Object($t.jsx)(rk,{children:"By default, incomplete puzzles are graded as empty."})]}),Object($t.jsx)("div",{children:"Starting configuration:"}),Object($t.jsx)("div",{style:{overflowX:"auto"},children:Object($t.jsx)(dk,{cells:this.props.startCells,size:50,onChange:this._switchTile})})]})},_handlePatternChange:function(e){this.change("flipPattern",e.target.value)},_changeWidth:function(e){e=pk(e,1,8),this._truncateCells(e,this._height())},_changeHeight:function(e){e=pk(e,1,8),this._truncateCells(this._width(),e)},_truncateCells:function(e,t){var n=ek.times(t,(t=>ek.times(e,(e=>!(!this.props.startCells[t]||!this.props.startCells[t][e])))));this.change({startCells:n})},_switchTile:function(e,t){var n,s,i=(n=this.props.startCells,s=(n,s)=>n===e&&s===t,ek.map(n,((e,t)=>ek.map(e,((e,n)=>s(t,n)?!e:e)))));this.change({startCells:i})},serialize(){return nk.serialize.call(this)}});QS.exports=gk;var fk=QS.exports,mk={exports:{}},bk=(mk.exports,h.a,x.b),vk=mu,xk=Bu,yk={display:"table",tableLayout:"fixed"},jk={display:"table-row"},wk={display:"table-cell",padding:5},Ok={borderRadius:10,cursor:"pointer"},Ck={padding:5,display:"inline-block"},Sk={float:"right",paddingRight:5},kk={plus:()=>[[!1,!0,!1],[!0,!0,!0],[!1,!0,!1]],x:()=>[[!0,!1,!0],[!1,!0,!1],[!0,!1,!0]],"plus/x":e=>e%2?kk.x():kk.plus()},_k=createReactClass({displayName:"Tile",render:function(){var e=this.props.value?"#55dd55":"#115511",t=bk.extend({},Ok,{width:this.props.size,height:this.props.size,backgroundColor:e});return Object($t.jsx)("div",{style:t,onClick:this._flip})},_flip:function(){this.props.onChange(!this.props.value)}}),Tk=createReactClass({displayName:"TileGrid",render:function(){return Object($t.jsx)("div",{style:yk,className:"no-select",children:bk.map(this.props.cells,((e,t)=>Object($t.jsx)("div",{style:jk,children:bk.map(e,((e,n)=>Object($t.jsx)("div",{style:wk,children:Object($t.jsx)(_k,{value:e,size:this.props.size,onChange:bk.partial(this.props.onChange,t,n)})},n)))},t)))})}}),Mk=(e,t,n,s)=>((e,t)=>bk.map(e,((e,n)=>bk.map(e,((e,s)=>t(n,s)?!e:e)))))(e,((e,i)=>{var r=e-t,o=i-n;return Math.abs(r)<=1&&Math.abs(o)<=1&&s[r+1][o+1]})),Nk=createReactClass({displayName:"LightsPuzzle",getDefaultProps:function(){return{cells:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],startCells:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],flipPattern:"plus",moveCount:0}},getUserInput:function(){return xk.getUserInput.call(this)},render:function(){var e=60*this._width();return Object($t.jsxs)("div",{children:[Object($t.jsx)(Tk,{cells:this.props.cells,size:50,onChange:this._flipTile}),Object($t.jsxs)("div",{style:{width:e},children:[Object($t.jsxs)("div",{style:Ck,children:["Moves: ",this.props.moveCount]}),Object($t.jsx)("div",{style:Sk,children:Object($t.jsx)("input",{type:"button",value:"Reset",onClick:this._reset,className:"simple-button"})})]}),Object($t.jsx)("div",{className:"clearfix"})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vk.change.apply(this,t)},_width:function(){return 0!==this.props.cells.length?this.props.cells[0].length:0},componentDidMount:function(){this._initNextPatterns()},componentDidUpdate:function(e){e.flipPattern!==this.props.flipPattern&&this._initNextPatterns()},_initNextPatterns:function(){this._currPattern=kk[this.props.flipPattern](0),this._nextPattern=kk[this.props.flipPattern](1),this._patternIndex=2},_shiftPatterns:function(){this._currPattern=this._nextPattern,this._nextPattern=kk[this.props.flipPattern](this._patternIndex),this._patternIndex++},_flipTile:function(e,t){var n=Mk(this.props.cells,e,t,this._currPattern);this._shiftPatterns(),this.change({cells:n,moveCount:this.props.moveCount+1})},_reset:function(){this.change({cells:this.props.startCells,moveCount:0})},simpleValidate:function(e){return Pk(e,this.getUserInput())}}),Pk=function(e,t){return bk.all(t.cells,((t,n)=>bk.all(t,((t,s)=>t===e.startCells[n][s]))))?{type:"invalid",message:i18n._("Click on the tiles to change the lights.")}:bk.all(t.cells,(e=>bk.all(e,(e=>e))))?{type:"points",earned:1,total:1,message:null}:e.gradeIncompleteAsWrong?{type:"points",earned:0,total:1,message:null}:{type:"invalid",message:i18n._("You must turn on all of the lights to continue.")}};mk.exports={name:"lights-puzzle",displayName:"Lights Puzzle",hidden:!0,widget:Nk,transform:function(e){return{cells:e.startCells,startCells:e.startCells,flipPattern:e.flipPattern}}};var Ik=mk.exports,Ek={exports:{}},Ak=(Ek.exports,h.a,x.b),Rk=$g,Dk=cd,Lk=Cl,Fk=Gd,zk=ce,qk=G.a.number,Wk=G.a.point;const Bk=Di,Vk=no,Hk=rr;var Uk=zk.DeprecationMixin,Gk={url:null},$k=zk.eq,Yk=zk.deepEq,Kk="unlimited";function Xk(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}function Zk(e,t,n){return $k(Xk(e,t,n),0)}function Jk(e){return $k(e,0)?0:e>0?1:-1}function Qk(e,t){return null==e?t:e}function e_(e,t,n){return n[0]<=Math.max(e[0],t[0])&&n[0]>=Math.min(e[0],t[0])&&n[1]<=Math.max(e[1],t[1])&&n[1]>=Math.min(e[1],t[1])}function t_(e,t){var n=[[e[0],e[1],t[0]],[e[0],e[1],t[1]],[t[0],t[1],e[0]],[t[0],t[1],e[1]]],s=Ak.map(n,(function(e){return Jk(Xk.apply(null,e))}));if(s[0]!==s[1]&&s[2]!==s[3])return!0;for(var i=0;i<4;i++)if(0===s[i]&&e_.apply(null,n[i]))return!0;return!1}function n_(e,t){return Ak.map(Ak.zip(e,t),(function(e){return e[0]-e[1]}))}function s_(e){return Math.sqrt(Ak.reduce(e,(function(e,t){return e+Math.pow(t,2)}),0))}function i_(e){var t=Ak.zip(e,c_(e));return Ak.map(t,(function(e){return s_(n_.apply(null,e))}))}function r_(e){var t=Ak.zip(c_(e,-1),e,c_(e,1)),n=Ak.map(t,(function(e){var t,n,s=n_(e[1],e[0]),i=n_(e[2],e[1]),r=Math.acos((t=s,n=i,Ak.reduce(Ak.zip(t,n),(function(e,t){return e+t[0]*t[1]}),0)/(s_(s)*s_(i))));return Jk(Xk.apply(null,e))>0?r:-r})),s=Ak.reduce(n,(function(e,t){return e+t}),0);return Ak.map(n,(function(e){return s>0?Math.PI-e:Math.PI+e}))}function o_(e,t,n){if(e.length!==t.length)return!1;for(var s=e.length,i=r_(e),r=r_(t),o=i_(e),a=i_(t),l=0;l<2*s;l++){var c=r.slice(),h=a.slice();if(l>=s&&(c.reverse(),h.reverse(),h=c_(h,1)),c=c_(c,l),h=c_(h,l),Yk(i,c)){var p=Ak.zip(o,h),u=Ak.map(p,(function(e){return e[0]/e[1]})),d=Ak.all(u,(function(e){return $k(u[0],e)})),g=Ak.all(p,(function(e){return qk.equal(e[0],e[1],n)}));if(d&&g)return!0}}return!1}function a_(e,t){return e<t||$k(e,t)}function l_(e){var t=e[0],n=e[1],s=e[2],i=e[3];t<0&&(t*=-1,n*=-1,s*=-1);var r=2*Math.PI;for(n<0&&(n*=-1,s*=-1,s+=r/2);s>0;)s-=r;for(;s<0;)s+=r;return[t,n,s,i]}function c_(e,t){return t="undefined"===typeof t?1:t%e.length,e.slice(t).concat(e.slice(0,t))}function h_(e){return e.replace(/(?:^|-)(.)/g,(function(e,t){return t.toUpperCase()}))}function p_(e,t){if($k(e[0],t[0]))return"x = "+e[0].toFixed(3);var n=(t[1]-e[1])/(t[0]-e[0]),s=e[1]-n*e[0];return"y = "+n.toFixed(3)+"x + "+s.toFixed(3)}var u_=createReactClass({displayName:"InteractiveGraph",getInitialState:function(){return{shouldShowInstructions:this._getShouldShowInstructions()}},getDefaultProps:function(){return{labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],backgroundImage:Gk,markings:"graph",showTooltips:!1,showProtractor:!1,showRuler:!1,rulerLabel:"",rulerTicks:10,graph:{type:"linear"}}},deprecatedProps:{showGraph:function(e){return{markings:e.showGraph?"graph":"none"}}},componentWillMount(){Uk.componentWillMount.call(this)},_getShouldShowInstructions:function(e){return e=e||this.props,this.isClickToAddPoints(e)&&(null==e.graph.coords||0===e.graph.coords.length)},componentDidUpdate:function(e,t){var n=e.graph.type,s=this.props.graph.type;n===s&&e.graph.allowReflexAngles===this.props.graph.allowReflexAngles&&e.graph.angleOffsetDeg===this.props.graph.angleOffsetDeg&&e.graph.numPoints===this.props.graph.numPoints&&e.graph.numSides===this.props.graph.numSides&&e.graph.numSegments===this.props.graph.numSegments&&e.graph.showAngles===this.props.graph.showAngles&&e.graph.showSides===this.props.graph.showSides&&e.graph.snapTo===this.props.graph.snapTo&&e.graph.snapDegrees===this.props.graph.snapDegrees||(this["remove"+h_(n)+"Controls"](),this["add"+h_(s)+"Controls"]()),this.shouldResetGraphie&&this.resetGraphie()},render:function(){var e,t;if(this.props.flexibleType)if(e=Object($t.jsxs)("select",{value:this.props.graph.type,onChange:e=>{var t=e.target.value;this.onChange({graph:{type:t}})},children:[Object($t.jsx)("option",{value:"linear",children:"Linear function"}),Object($t.jsx)("option",{value:"quadratic",children:"Quadratic function"}),Object($t.jsx)("option",{value:"sinusoid",children:"Sinusoid function"}),Object($t.jsx)("option",{value:"circle",children:"Circle"}),Object($t.jsx)("option",{value:"point",children:"Point(s)"}),Object($t.jsx)("option",{value:"linear-system",children:"Linear System"}),Object($t.jsx)("option",{value:"polygon",children:"Polygon"}),Object($t.jsx)("option",{value:"segment",children:"Line Segment(s)"}),Object($t.jsx)("option",{value:"ray",children:"Ray"}),Object($t.jsx)("option",{value:"angle",children:"Angle"})]}),"point"===this.props.graph.type)t=Object($t.jsxs)("select",{value:this.props.graph.numPoints||1,onChange:e=>{var t=+e.target.value||e.target.value;this.onChange({graph:{type:"point",numPoints:t,coords:null}})},children:[Ak.map(Ak.range(1,7),(function(e){return Object($t.jsxs)("option",{value:e,children:[e," point",e>1&&"s"]})})),Object($t.jsx)("option",{value:Kk,children:"unlimited"})]},"point-select");else if("polygon"===this.props.graph.type)t=Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("select",{value:this.props.graph.numSides||3,onChange:e=>{var t=+e.target.value||e.target.value,n=Ak.extend({},this.props.graph,{numSides:t,coords:null,snapTo:"grid"});this.onChange({graph:n})},children:[Ak.map(Ak.range(3,13),(function(e){return Object($t.jsxs)("option",{value:e,children:[e," sides"]})})),Object($t.jsx)("option",{value:Kk,children:"unlimited sides"})]},"polygon-select")}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[" ","Snap to"," ",Object($t.jsxs)("select",{value:this.props.graph.snapTo,onChange:e=>{var t=Ak.extend({},this.props.graph,{snapTo:e.target.value,coords:null});this.onChange({graph:t})},children:[Object($t.jsx)("option",{value:"grid",children:"grid"}),this.props.graph.numSides!==Kk&&[Object($t.jsxs)("option",{value:"angles",children:[" ","interior angles"," "]}),Object($t.jsxs)("option",{value:"sides",children:[" ","side measures"," "]})]]},"polygon-snap")]}),Object($t.jsxs)(Dk,{children:[Object($t.jsx)("p",{children:"These options affect the movement of the vertex points. The grid option will guide the points to the nearest half step along the grid."}),Object($t.jsx)("p",{children:"The interior angle and side measure options guide the points to the nearest whole angle or side"})," ","measure respectively."," "]})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show angle measures:"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.graph.showAngles,onChange:this.toggleShowAngles})]}),Object($t.jsx)(Dk,{children:Object($t.jsx)("p",{children:"Displays the interior angle measures."})})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show side measures:"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.graph.showSides,onChange:this.toggleShowSides})]}),Object($t.jsx)(Dk,{children:Object($t.jsx)("p",{children:"Displays the side lengths."})})]})]});else if("segment"===this.props.graph.type)t=Object($t.jsx)("select",{value:this.props.graph.numSegments||1,onChange:e=>{var t=+e.target.value;this.onChange({graph:{type:"segment",numSegments:t,coords:null}})},children:Ak.map(Ak.range(1,7),(function(e){return Object($t.jsxs)("option",{value:e,children:[e," segment",e>1&&"s"]})}))},"segment-select");else if("angle"===this.props.graph.type){var n=Qk(this.props.graph.allowReflexAngles,!0);t=Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Show angle measure:"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.graph.showAngles,onChange:this.toggleShowAngles})]})}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Allow reflex angles:"," ",Object($t.jsx)("input",{type:"checkbox",checked:n,onChange:e=>{this.onChange({graph:Ak.extend({},this.props.graph,{allowReflexAngles:!n,coords:null})})}})]}),Object($t.jsxs)(Dk,{children:[Object($t.jsx)("p",{children:"Reflex angles are angles with a measure greater than 180 degrees."}),Object($t.jsx)("p",{children:"By default, these should remain enabled."})]})]}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Snap to increments of"," ",Object($t.jsx)(Fk,{placeholder:1,value:this.props.graph.snapDegrees,onChange:e=>{this.onChange({graph:Ak.extend({},this.props.graph,{snapDegrees:Math.abs(e),coords:null})})}},"degree-snap")," ","degrees"," "]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[" ","With an offset of"," ",Object($t.jsx)(Fk,{placeholder:0,value:this.props.graph.angleOffsetDeg,onChange:e=>{this.onChange({graph:Ak.extend({},this.props.graph,{angleOffsetDeg:e,coords:null})})}},"angle-offset")," ","degrees"," "]})})]})}const s=Gs(this.props.containerSizeClass);var i;this.isClickToAddPoints()&&this.state.shouldShowInstructions?"point"===this.props.graph.type?i=i18n._("Click to add points"):"polygon"===this.props.graph.type&&(i=i18n._("Click to add vertices")):i=void 0;var r=this.isClickToAddPoints()?this.handleAddPointsMouseDown:null,o=this.props.gridStep||zk.getGridStep(this.props.range,this.props.step,s[0]),a=this.props.snapStep||zk.snapStepFromGridStep(o);const l=this.props.apiOptions.isMobile;return Object($t.jsxs)("div",{className:"perseus-widget perseus-widget-interactive-graph",style:{width:s[0],height:this.props.flexibleType?"auto":s[1]},children:[Object($t.jsx)(Rk,{instructions:i,ref:"graph",box:s,labels:this.props.labels,range:this.props.range,step:l?zk.constrainedTickStepsFromTickSteps(this.props.step,this.props.range):this.props.step,gridStep:o,snapStep:a,markings:this.props.markings,backgroundImage:this.props.backgroundImage,showProtractor:this.props.showProtractor,showRuler:this.props.showRuler,rulerLabel:this.props.rulerLabel,rulerTicks:this.props.rulerTicks,onMouseDown:r,onGraphieUpdated:this.setGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,isMobile:l}),e,t]})},componentDidMount:function(){this.setGraphie(this.refs.graph.graphie())},setGraphie:function(e){this.graphie=e,this.setupGraphie()},handleAddPointsMouseDown:function(e){if(!this.isClickToAddPoints())throw new Error("handleAddPointsClick should not be registeredwhen isClickToAddPoints() is false");if(!this.isCoordInTrash(e)){var t;if("point"===this.props.graph.type){if(!(t=this.createPointForPointsType(e,this.points.length)).constrain())return void t.remove();this.points.push(t);var n=this.points.length-1;this.points[n].grab(e),this.updateCoordsFromPoints()}else if("polygon"===this.props.graph.type){if(this.polygon.closed())return;t=this.createPointForPolygonType(e,this.points.length),this.points.push(t);n=this.points.length-1;this.points[n].grab(e),this.updatePolygon()}this.setState({shouldShowInstructions:!1})}},resetGraphie:function(){this.shouldResetGraphie=!1,this.parabola=null,this.sinusoid=null,this.refs.graph.reset()},setupGraphie:function(){this.setTrashCanVisibility(0),this.isClickToAddPoints()&&this.setTrashCanVisibility(.5),this.props.apiOptions.isMobile&&(this.horizHairline=new Hk(this.graphie,[0,0],[0,0],{normalStyle:{strokeWidth:1}}),this.horizHairline.attr({stroke:Bk.INTERACTIVE}),this.horizHairline.hide(),this.vertHairline=new Hk(this.graphie,[0,0],[0,0],{normalStyle:{strokeWidth:1}}),this.vertHairline.attr({stroke:Bk.INTERACTIVE}),this.vertHairline.hide()),this["add"+h_(this.props.graph.type)+"Controls"]()},showHairlines:function(e){this.props.apiOptions.isMobile&&"none"!==this.props.markings&&(this.horizHairline.moveTo([this.props.range[0][0],e[1]],[this.props.range[0][1],e[1]]),this.horizHairline.show(),this.vertHairline.moveTo([e[0],this.props.range[1][0]],[e[0],this.props.range[1][1]]),this.vertHairline.show())},hideHairlines:function(){this.props.apiOptions.isMobile&&(this.horizHairline.hide(),this.vertHairline.hide())},setTrashCanVisibility:function(e){var t=this.graphie;qk.equal(e,0)?this.trashCan&&(this.trashCan.remove(),this.trashCan=null):this.props.apiOptions.isMobile||(this.trashCan||(this.trashCan=t.raphael.image("https://ka-perseus-graphie.s3.amazonaws.com/b1452c0d79fd0f7ff4c3af9488474a0a0decb361.png",t.xpixels-40,t.ypixels-40,40,40)),this.trashCan.attr({opacity:e}))},componentWillReceiveProps:function(e){this.isClickToAddPoints()!==this.isClickToAddPoints(e)&&(this.shouldResetGraphie=!0,this.setState({shouldShowInstructions:this._getShouldShowInstructions(e)})),this.props.backgroundImage.url===e.backgroundImage.url&&this.props.backgroundImage===e.backgroundImage&&this.props.containerSizeClass===e.containerSizeClass||(this.shouldResetGraphie=!0)},isClickToAddPoints:function(e){return"point"===(e=e||this.props).graph.type&&e.graph.numPoints===Kk||"polygon"===e.graph.type&&e.graph.numSides===Kk},_lineStroke:function(){return this.props.isMobile?{"stroke-width":3}:{}},addLine:function(e){var t=this,n=t.graphie,s=u_.getLineCoords(t.props.graph,t.props),i=t.points=Ak.map(s,(e=>Lk.addMaybeMobileMovablePoint(this,{coord:e,constraints:[Lk.MovablePoint.constraints.bound(),Lk.MovablePoint.constraints.snap()],onMove:()=>{var e=Ak.extend({},t.props.graph,{coords:Ak.invoke(i,"coord")});t.onChange({graph:e})}}))),r={points:i,static:!0,normalStyle:{stroke:this.props.apiOptions.isMobile?Bk.BLUE_C:Bk.INTERACTIVE,...this._lineStroke()}};"line"===e?r.extendLine=!0:"ray"===e&&(r.extendRay=!0);t.line=Lk.addMovableLine(n,r);i[0].listen("constraints","isLine",(e=>!Wk.equal(e,i[1].coord()))),i[1].listen("constraints","isLine",(e=>!Wk.equal(e,i[0].coord())))},removeLine:function(){Ak.invoke(this.points,"remove"),this.line.remove()},addLinearControls:function(){this.addLine("line")},removeLinearControls:function(){this.removeLine()},addQuadraticControls:function(){this.graphie;var e,t,n,s=this.props.graph.coords;s||(s=u_.defaultQuadraticCoords(this.props));var i=()=>{var s=Ak.extend({},this.props.graph,{coords:[e.coord(),t.coord(),n.coord()]});this.onChange({graph:s}),this.updateQuadratic()};e=this.pointA=Lk.addMaybeMobileMovablePoint(this,{coord:s[0],constraints:[Lk.MovablePoint.constraints.bound(),Lk.MovablePoint.constraints.snap(),s=>!e||s[0]!==t.coord()[0]&&s[0]!==n.coord()[0]],onMove:i}),t=this.pointB=Lk.addMaybeMobileMovablePoint(this,{coord:s[1],constraints:[Lk.MovablePoint.constraints.bound(),Lk.MovablePoint.constraints.snap(),s=>!t||s[0]!==e.coord()[0]&&s[0]!==n.coord()[0]],onMove:i}),n=this.pointC=Lk.addMaybeMobileMovablePoint(this,{coord:s[2],constraints:[Lk.MovablePoint.constraints.bound(),Lk.MovablePoint.constraints.snap(),s=>!n||s[0]!==e.coord()[0]&&s[0]!==t.coord()[0]],onMove:i}),this.updateQuadratic()},updateQuadratic:function(){var e=u_.getCurrentQuadraticCoefficients(this.props);if(e){var t=e[0],n=e[1],s=e[2];if(this.parabola){var i=this.graphie.svgParabolaPath(t,n,s);this.parabola.attr({path:i})}else this.parabola=this.graphie.parabola(t,n,s),this.parabola.attr({stroke:this.props.apiOptions.isMobile?Bk.BLUE_C:Bk.DYNAMIC,...this._lineStroke()}),this.parabola.toBack()}},removeQuadraticControls:function(){this.pointA.remove(),this.pointB.remove(),this.pointC.remove(),this.parabola&&(this.parabola.remove(),this.parabola=null)},addSinusoidControls:function(){this.graphie;var e,t,n=this.props.graph.coords;n||(n=u_.defaultSinusoidCoords(this.props));var s=()=>{var n=Ak.extend({},this.props.graph,{coords:[e.coord(),t.coord()]});this.onChange({graph:n}),this.updateSinusoid()};e=this.pointA=Lk.addMaybeMobileMovablePoint(this,{coord:n[0],constraints:[Lk.MovablePoint.constraints.bound(),Lk.MovablePoint.constraints.snap(),n=>!e||n[0]!==t.coord()[0]],onMove:s}),t=this.pointB=Lk.addMaybeMobileMovablePoint(this,{coord:n[1],constraints:[Lk.MovablePoint.constraints.bound(),Lk.MovablePoint.constraints.snap(),t=>!e||t[0]!==e.coord()[0]],onMove:s}),this.updateSinusoid()},updateSinusoid:function(){var e=u_.getCurrentSinusoidCoefficients(this.props);if(e){var t=e[0],n=e[1],s=e[2],i=e[3];if(this.sinusoid){var r=this.graphie.svgSinusoidPath(t,n,s,i);this.sinusoid.attr({path:r})}else this.sinusoid=this.graphie.sinusoid(t,n,s,i),this.sinusoid.attr({stroke:this.props.apiOptions.isMobile?Bk.BLUE_C:Bk.DYNAMIC,...this._lineStroke()}),this.sinusoid.toBack()}},removeSinusoidControls:function(){this.pointA.remove(),this.pointB.remove(),this.sinusoid&&(this.sinusoid.remove(),this.sinusoid=null)},addCircleControls:function(){var e=this.graphie,t=Ak.min(e.snap),n=this.circle=e.addCircleGraph({center:this.props.graph.center||[0,0],radius:this.props.graph.radius||Ak.min(this.props.step),snapX:e.snap[0],snapY:e.snap[1],minRadius:t,snapRadius:t});$(n).on("move",(()=>{var e=Ak.extend({},this.props.graph,{center:n.center,radius:n.radius});this.onChange({graph:e})}))},removeCircleControls:function(){this.circle.remove()},addLinearSystemControls:function(){var e=this.graphie,t=u_.getLinearSystemCoords(this.props.graph,this.props),n=[Bk.INTERACTIVE,Bk.GREEN],s=this.points=Ak.map(t,((e,t)=>{var s=Ak.map(e,((e,i)=>Lk.addMaybeMobileMovablePoint(this,{coord:e,constraints:[Lk.MovablePoint.constraints.bound(),Lk.MovablePoint.constraints.snap(),e=>{if(s)return!Wk.equal(e,s[1-i].coord())}],onMove:()=>{var e=Ak.extend({},this.props.graph,{coords:Ak.map(this.points,(e=>Ak.invoke(e,"coord")))});this.onChange({graph:e})},normalStyle:{fill:n[t]},highlightStyle:{fill:n[t]}})));return s}));this.lines=Ak.map(s,((t,s)=>Lk.addMovableLine(e,{points:t,static:!0,extendLine:!0,normalStyle:{stroke:n[s]}})))},removeLinearSystemControls:function(){Ak.invoke(this.lines,"remove"),Ak.map(this.points,(e=>Ak.invoke(e,"remove")))},isCoordInTrash:function(e){if(this.props.apiOptions.isMobile)return!1;var t=this.graphie,n=t.scalePoint(e);return n[0]>=t.xpixels-40&&n[1]>=t.ypixels-40},createPointForPointsType:function(e,t){var n=this;n.graphie;const s=()=>{n.points=Ak.filter(n.points,(function(e){return e!==i})),n.updateCoordsFromPoints(),setTimeout(i.remove.bind(i),0)};var i=Lk.addMaybeMobileMovablePoint(this,{coord:e,constraints:[Lk.MovablePoint.constraints.bound(),Lk.MovablePoint.constraints.snap(),function(e){return Ak.all(n.points,(function(t){return i===t||!Wk.equal(e,t.coord())}))}],onMoveStart:function(){n.isClickToAddPoints()&&n.setTrashCanVisibility(1)},onMove:n.updateCoordsFromPoints,onMoveEnd:function(e){n.isClickToAddPoints()&&(n.isCoordInTrash(e)&&s(),n.setTrashCanVisibility(.5))},...this.props.apiOptions.isMobile&&n.isClickToAddPoints()?{onRemove:s}:{}});return i},removePoint:function(e){var t=null;return this.points=Ak.filter(this.points,(function(n,s){return n!==e||(t=s,!1)})),t},createPointForPolygonType:function(e,t){this.graphie;var n=!Ak.contains(["angles","sides"],this.props.graph.snapTo),s=e=>(t+e+this.points.length)%this.points.length;const i=()=>{var e=this.removePoint(r);this.polygon.closed()&&(this.points=c_(this.points,e),this.polygon.update({closed:!1})),this.updatePolygon(),this.clearCoords(),setTimeout(r.remove.bind(r),0)};var r=Lk.addMaybeMobileMovablePoint(this,{coord:e,constraints:[Lk.MovablePoint.constraints.bound(),n?Lk.MovablePoint.constraints.snap():null,e=>{if(null==this.points||0===this.points.length)return!0;var n,i,r,o=Ak.invoke(this.points,"coord");if(o[t]=e,!this.isClickToAddPoints()){if(Zk(o[s(-2)],o[s(-1)],o[t])||Zk(o[s(-1)],o[t],o[s(1)])||Zk(o[t],o[s(1)],o[s(2)]))return!1;var a=Ak.zip(o,c_(o));if(this.points.length>3)for(var l=-1;l<=0;l++)for(var c=a[s(l)],h=Ak.without(a,c,a[s(l-1)],a[s(l+1)]),p=0;p<h.length;p++){if(t_(c,h[p]))return!1}}if("angles"===this.props.graph.snapTo&&this.points.length>2){var u=Ak.map(r_(o),(function(e){return 180*e/Math.PI}));Ak.each([-1,1],(function(e){u[s(e)]=Math.round(u[s(e)])}));var d=function(e,t,n){return(Vk.findAngle(o[s(e)],o[s(n)],o[s(t)])+360)%360},g=[u[s(-1)]-d(-2,-1,1),u[s(1)]-d(-1,1,2)];if(g[2]=180-(g[0]+g[1]),Ak.any(g,(function(e){return a_(e,1)})))return!1;var f=s_(n_(o[s(-1)],o[s(1)])),m=1===Jk(Xk(o[s(-1)],o[s(1)],o[t])),b=Math.sin(g[1]*Math.PI/180)/Math.sin(g[2]*Math.PI/180)*f,v=Vk.findAngle(o[s(1)],o[s(-1)]),x=this.graphie.polar(b,v+(m?1:-1)*g[0]);return this.graphie.addPoints(o[s(-1)],x)}if("sides"===this.props.graph.snapTo&&this.points.length>1){var y=Ak.map([[o[s(-1)],o[t]],[o[t],o[s(1)]],[o[s(-1)],o[s(1)]]],(function(e){return s_(n_.apply(null,e))}));if(Ak.each([0,1],(function(e){y[e]=Math.round(y[e])})),a_(y[1]+y[2],y[0])||a_(y[0]+y[2],y[1])||a_(y[0]+y[1],y[2]))return!1;var j=(n=y[0],i=y[2],r=y[1],180*Math.acos((n*n+i*i-r*r)/(2*n*i))/Math.PI);v=Vk.findAngle(o[s(1)],o[s(-1)]),m=1===Jk(Xk(o[s(-1)],o[s(1)],o[t])),x=this.graphie.polar(y[0],v+(m?1:-1)*j);return this.graphie.addPoints(o[s(-1)],x)}return!0}],onMoveStart:()=>{this.isClickToAddPoints()&&this.setTrashCanVisibility(1)},onMove:()=>{this.polygon.closed()&&this.updateCoordsFromPoints()},onMoveEnd:e=>{if(this.isClickToAddPoints()){if(this.isCoordInTrash(e))i();else if(this.points.length>1&&(r===this.points[0]&&Wk.equal(e,Ak.last(this.points).coord())||r===Ak.last(this.points)&&Wk.equal(e,this.points[0].coord()))){var t=this.points.pop();this.points.length>2?(this.polygon.update({closed:!0}),this.updateCoordsFromPoints()):(this.polygon.update({closed:!1}),this.clearCoords()),this.updatePolygon(),setTimeout(t.remove.bind(t),0)}else{Ak.any(this.points,(function(t){return t!==r&&Wk.equal(t.coord(),e)}))?(this.removePoint(r),this.points.length<3?(this.polygon.update({closed:!1}),this.clearCoords()):this.polygon.closed()&&this.updateCoordsFromPoints(),this.updatePolygon(),setTimeout(r.remove.bind(r),0)):r!==this.points[0]&&r!==Ak.last(this.points)||r.hasMoved()||r.state.isInitialMove||this.polygon.closed()||!(this.points.length>2)||(this.polygon.update({closed:!0}),this.updatePolygon(),this.updateCoordsFromPoints())}this.setTrashCanVisibility(.5)}r.state.isInitialMove=!1},...this.props.apiOptions.isMobile&&this.isClickToAddPoints()?{onRemove:i}:{}});return r.state.isInitialMove=!0,r},updateCoordsFromPoints:function(){var e=Ak.extend({},this.props.graph,{coords:Ak.map(this.points,(function(e){return Ak.result(e,"coord")}))});this.onChange({graph:e})},clearCoords:function(){var e=Ak.extend({},this.props.graph,{coords:null});this.onChange({graph:e})},onChange:function(e){this.props.onChange(e),this.props.trackInteraction()},addPointControls:function(){var e=u_.getPointCoords(this.props.graph,this.props);this.points=[],this.points=Ak.map(e,this.createPointForPointsType,this)},removePointControls:function(){Ak.invoke(this.points,"remove")},addSegmentControls:function(){var e=this,t=this.graphie,n=u_.getSegmentCoords(this.props.graph,this.props);const s=e=>Lk.addMaybeMobileMovablePoint(this,e);this.points=[],this.lines=Ak.map(n,(function(n,i){var r=function(){var t=Ak.extend({},e.props.graph,{coords:Ak.invoke(e.lines,"coords")});e.onChange({graph:t})},o=Ak.map(n,(function(e,t){return s({coord:e,constraints:[Lk.MovablePoint.constraints.bound(),Lk.MovablePoint.constraints.snap(),e=>{if(o)return!Wk.equal(e,o[1-t].coord())}],onMove:r})}));e.points=e.points.concat(o);var a=Lk.addMovableLine(t,{points:o,static:!1,constraints:[Lk.MovableLine.constraints.bound(),Lk.MovableLine.constraints.snap()],onMove:[Lk.MovableLine.onMove.updatePoints,r],normalStyle:{stroke:this.props.apiOptions.isMobile?Bk.BLUE_C:Bk.INTERACTIVE,...this._lineStroke()},highlightStyle:{stroke:this.props.apiOptions.isMobile?Bk.BLUE_C:Bk.INTERACTING,...this._lineStroke()}});return Ak.invoke(o,"toFront"),a}),this)},removeSegmentControls:function(){Ak.invoke(this.points,"remove"),Ak.invoke(this.lines,"remove")},addRayControls:function(){this.addLine("ray")},removeRayControls:function(){this.removeLine()},addPolygonControls:function(){this.polygon=null;var e=u_.getPolygonCoords(this.props.graph,this.props);this.points=[],this.points=Ak.map(e,this.createPointForPolygonType,this),this.updatePolygon()},updatePolygon:function(){var e;e=this.polygon?this.polygon.closed():this.points.length>=3;var t=this.graphie,n=this.points.length,s=!Ak.contains(["angles","sides"],this.props.graph.snapTo),i=Ak.times(n,(function(t){return this.props.graph.showAngles&&(e||0!==t&&t!==n-1)?"angles"===this.props.graph.snapTo?"$deg0":"$deg1":""}),this),r=Ak.times(n,(function(t){return e||0!==t&&t!==n-1}),this),o=Ak.times(n,(function(t){return this.props.graph.showAngles&&(e||0!==t&&t!==n-1)?1:0}),this),a=Ak.times(n,(function(t){return!this.props.graph.showSides||!e&&t===n-1?"":"sides"===this.props.graph.snapTo?"$len0":"$len1"}),this);if(null==this.polygon){var l=this;l.polygon=Lk.addMovablePolygon(t,{constraints:[Lk.MovablePolygon.constraints.bound(),s?Lk.MovablePolygon.constraints.snap():null],closed:e,points:l.points,angleLabels:i,showRightAngleMarkers:r,numArcs:o,sideLabels:a,onMove:[Lk.MovablePolygon.onMove.updatePoints,function(){this.closed()&&l.updateCoordsFromPoints()}],normalStyle:{stroke:this.props.apiOptions.isMobile?Bk.BLUE_C:Bk.INTERACTIVE,...this._lineStroke()}})}else this.polygon.update({closed:e,points:this.points,angleLabels:i,showRightAngleMarkers:r,numArcs:o,sideLabels:a})},removePolygonControls:function(){Ak.invoke(this.points,"remove"),this.polygon.remove()},addAngleControls:function(){var e=this.graphie,t=u_.getAngleCoords(this.props.graph,this.props);this.points=Ak.map(t,(function(t,n){return e.addMovablePoint(Ak.extend({coord:t,normalStyle:{stroke:Bk.INTERACTIVE,fill:Bk.INTERACTIVE}},1===n?{snapX:e.snap[0],snapY:e.snap[1]}:{}))})),this.angle=e.addMovableAngle({points:this.points,snapDegrees:this.props.graph.snapDegrees||1,snapOffsetDeg:this.props.graph.angleOffsetDeg||0,angleLabel:this.props.graph.showAngles?"$deg0":"",pushOut:2,allowReflex:Qk(this.props.graph.allowReflexAngles,!0)}),$(this.angle).on("move",(()=>{var e=Ak.extend({},this.props.graph,{coords:this.angle.getClockwiseCoords()});this.onChange({graph:e})}))},removeAngleControls:function(){Ak.invoke(this.points,"remove"),this.angle.remove()},toggleShowAngles:function(){var e=Ak.extend({},this.props.graph,{showAngles:!this.props.graph.showAngles});this.onChange({graph:e})},toggleShowSides:function(){var e=Ak.extend({},this.props.graph,{showSides:!this.props.graph.showSides});this.onChange({graph:e})},getUserInput:function(){return this.props.graph},simpleValidate:function(e){return u_.validate(this.getUserInput(),e,this)},focus:$.noop});Ak.extend(u_,{getQuadraticCoefficients:function(e){var t=e[0],n=e[1],s=e[2],i=(t[0]-n[0])*(t[0]-s[0])*(n[0]-s[0]);if(0!==i)return[(s[0]*(n[1]-t[1])+n[0]*(t[1]-s[1])+t[0]*(s[1]-n[1]))/i,(s[0]*s[0]*(t[1]-n[1])+n[0]*n[0]*(s[1]-t[1])+t[0]*t[0]*(n[1]-s[1]))/i,(n[0]*s[0]*(n[0]-s[0])*t[1]+s[0]*t[0]*(s[0]-t[0])*n[1]+t[0]*n[0]*(t[0]-n[0])*s[1])/i]},getSinusoidCoefficients:function(e){var t=e[0],n=e[1],s=n[1]-t[1],i=Math.PI/(2*(n[0]-t[0]));return[s,i,t[0]*i,t[1]]},getLineCoords:function(e,t){return e.coords||u_.pointsFromNormalized(t,[[.25,.75],[.75,.75]])},getPointCoords:function(e,t){var n=e.numPoints||1;if(s=e.coords)return s;switch(n){case 1:s=[e.coord||[0,0]];break;case 2:s=[[-5,0],[5,0]];break;case 3:s=[[-5,0],[0,0],[5,0]];break;case 4:s=[[-6,0],[-2,0],[2,0],[6,0]];break;case 5:s=[[-6,0],[-3,0],[0,0],[3,0],[6,0]];break;case 6:s=[[-5,0],[-3,0],[-1,0],[1,0],[3,0],[5,0]];break;case Kk:s=[]}var s;return s=u_.normalizeCoords(s,[[-10,10],[-10,10]]),s=u_.pointsFromNormalized(t,s)},getLinearSystemCoords:function(e,t){return e.coords||Ak.map([[[.25,.75],[.75,.75]],[[.25,.25],[.75,.25]]],(e=>u_.pointsFromNormalized(t,e)))},getPolygonCoords:function(e,t){var n=e.coords;if(n)return n;var s=e.numSides||3;if(s===Kk)n=[];else{var i=2*Math.PI/s,r=(1/s-.5)*Math.PI,o="sides"===e.snapTo?Math.sqrt(3)/3*7:4;n=Ak.times(s,(function(e){return[o*Math.cos(e*i+r),o*Math.sin(e*i+r)]}))}n=u_.normalizeCoords(n,[[-10,10],[-10,10]]);var a=!Ak.contains(["angles","sides"],e.snapTo);return n=u_.pointsFromNormalized(t,n,!a)},getSegmentCoords:function(e,t){var n=e.coords;if(n)return n;var s={1:[5],2:[5,-5],3:[5,0,-5],4:[6,2,-2,-6],5:[6,3,0,-3,-6],6:[5,3,1,-1,-3,-5]}[e.numSegments||1],i=[[-10,10],[-10,10]];return Ak.map(s,(function(e){var n=[[-5,e],[5,e]];return n=u_.normalizeCoords(n,i),n=u_.pointsFromNormalized(t,n)}))},getAngleCoords:function(e,t){var n=e.coords;if(n)return n;for(var s=e.snapDegrees||1,i=s;i<20;)i+=s;i=i*Math.PI/180;var r=(e.angleOffsetDeg||0)*Math.PI/180;n=u_.pointsFromNormalized(t,[[.85,.5],[.5,.5]]);var o=s_(n_.apply(null,n));return n[0]=[n[1][0]+o*Math.cos(r),n[1][1]+o*Math.sin(r)],n[2]=[n[1][0]+o*Math.cos(i+r),n[1][1]+o*Math.sin(i+r)],n},normalizeCoords:function(e,t){return Ak.map(e,(function(e){return Ak.map(e,(function(e,n){var s=t[n][1]-t[n][0];return(e+t[n][1])/s}))}))},getEquationString:function(e){var t="get"+h_(e.graph.type)+"EquationString";return u_[t](e)},pointsFromNormalized:function(e,t,n){return Ak.map(t,(function(t){return Ak.map(t,(function(t,s){var i=e.range[s];if(n)return i[0]+(i[1]-i[0])*t;var r=e.step[s],o=function(e,t){return Math.floor((e[1]-e[0])/t)}(i,r),a=Math.round(t*o);return i[0]+r*a}))}))},getLinearEquationString:function(e){var t=u_.getLineCoords(e.graph,e);if($k(t[0][0],t[1][0]))return"x = "+t[0][0].toFixed(3);var n=(t[1][1]-t[0][1])/(t[1][0]-t[0][0]),s=t[0][1]-n*t[0][0];return $k(n,0)?"y = "+s.toFixed(3):"y = "+n.toFixed(3)+"x + "+s.toFixed(3)},getCurrentQuadraticCoefficients:function(e){var t=e.graph.coords||u_.defaultQuadraticCoords(e);return u_.getQuadraticCoefficients(t)},defaultQuadraticCoords:function(e){return u_.pointsFromNormalized(e,[[.25,.75],[.5,.25],[.75,.75]])},getQuadraticEquationString:function(e){var t=u_.getCurrentQuadraticCoefficients(e);return"y = "+t[0].toFixed(3)+"x^2 + "+t[1].toFixed(3)+"x + "+t[2].toFixed(3)},getCurrentSinusoidCoefficients:function(e){var t=e.graph.coords||u_.defaultSinusoidCoords(e);return u_.getSinusoidCoefficients(t)},defaultSinusoidCoords:function(e){return u_.pointsFromNormalized(e,[[.5,.5],[.65,.6]])},getSinusoidEquationString:function(e){var t=u_.getCurrentSinusoidCoefficients(e);return"y = "+t[0].toFixed(3)+"sin("+t[1].toFixed(3)+"x - "+t[2].toFixed(3)+") + "+t[3].toFixed(3)},getCircleEquationString:function(e){var t=e.graph,n=t.center||[0,0],s=t.radius||2;return"center ("+n[0]+", "+n[1]+"), radius "+s},getLinearSystemEquationString:function(e){var t=u_.getLinearSystemCoords(e.graph,e);return"\n"+p_(t[0][0],t[0][1])+"\n"+p_(t[1][0],t[1][1])+"\n"+function(e,t){var n=e[0][0],s=e[0][1],i=e[1][0],r=e[1][1],o=t[0][0],a=t[0][1],l=t[1][0],c=t[1][1],h=(n-i)*(a-c)-(s-r)*(o-l);if(Math.abs(h)<1e-9)return"Lines are parallel";var p=((n*r-s*i)*(a-c)-(s-r)*(o*c-a*l))/h;return"Intersection: ("+(((n*r-s*i)*(o-l)-(n-i)*(o*c-a*l))/h).toFixed(3)+", "+p.toFixed(3)+")"}(t[0],t[1])},getPointEquationString:function(e){return u_.getPointCoords(e.graph,e).map((function(e){return"("+e[0]+", "+e[1]+")"})).join(", ")},getSegmentEquationString:function(e){var t=u_.getSegmentCoords(e.graph,e);return Ak.map(t,(function(e){return"["+Ak.map(e,(function(e){return"("+e.join(", ")+")"})).join(" ")+"]"})).join(" ")},getRayEquationString:function(e){var t=u_.getLineCoords(e.graph,e),n=t[0],s=t[1],i=u_.getLinearEquationString(e);return n[0]>s[0]?i+=" (for x <= "+n[0].toFixed(3)+")":n[0]<s[0]?i+=" (for x >= "+n[0].toFixed(3)+")":n[1]>s[1]?i+=" (for y <= "+n[1].toFixed(3)+")":i+=" (for y >= "+n[1].toFixed(3)+")",i},getPolygonEquationString:function(e){var t=u_.getPolygonCoords(e.graph,e);return Ak.map(t,(function(e){return"("+e.join(", ")+")"})).join(" ")},getAngleEquationString:function(e){var t=u_.getAngleCoords(e.graph,e);return Vk.findAngle(t[2],t[0],t[1]).toFixed(0)+"\xb0 angle at ("+t[1].join(", ")+")"},validate:function(e,t,n){var s=!!(e.coords||e.center&&e.radius);if(e.type===t.correct.type&&s)if("linear"===e.type){var i=e.coords;if(Zk((c=t.correct.coords)[0],c[1],i[0])&&Zk(c[0],c[1],i[1]))return{type:"points",earned:1,total:1,message:null}}else if("linear-system"===e.type){i=e.coords;if(Zk((c=t.correct.coords)[0][0],c[0][1],i[0][0])&&Zk(c[0][0],c[0][1],i[0][1])&&Zk(c[1][0],c[1][1],i[1][0])&&Zk(c[1][0],c[1][1],i[1][1])||Zk(c[0][0],c[0][1],i[1][0])&&Zk(c[0][0],c[0][1],i[1][1])&&Zk(c[1][0],c[1][1],i[0][0])&&Zk(c[1][0],c[1][1],i[0][1]))return{type:"points",earned:1,total:1,message:null}}else if("quadratic"===e.type){var r=this.getQuadraticCoefficients(e.coords),o=this.getQuadraticCoefficients(t.correct.coords);if(Yk(r,o))return{type:"points",earned:1,total:1,message:null}}else if("sinusoid"===e.type){r=this.getSinusoidCoefficients(e.coords),o=this.getSinusoidCoefficients(t.correct.coords);var a=l_(r),l=l_(o);if(Yk(a,l))return{type:"points",earned:1,total:1,message:null}}else if("circle"===e.type){if(Yk(e.center,t.correct.center)&&$k(e.radius,t.correct.radius))return{type:"points",earned:1,total:1,message:null}}else if("point"===e.type){i=e.coords;var c=u_.getPointCoords(t.correct,n);if(i=i.slice(),c=c.slice(),i.sort(),c.sort(),Yk(i,c))return{type:"points",earned:1,total:1,message:null}}else if("polygon"===e.type){i=e.coords.slice(),c=t.correct.coords.slice();if("similar"===t.correct.match?h=o_(i,c,Number.POSITIVE_INFINITY):"congruent"===t.correct.match?h=o_(i,c,qk.DEFAULT_TOLERANCE):"approx"===t.correct.match?h=o_(i,c,.1):(i.sort(),c.sort(),h=Yk(i,c)),h)return{type:"points",earned:1,total:1,message:null}}else if("segment"===e.type){i=e.coords.slice(),c=t.correct.coords.slice();if(i=Ak.invoke(i,"sort").sort(),c=Ak.invoke(c,"sort").sort(),Yk(i,c))return{type:"points",earned:1,total:1,message:null}}else if("ray"===e.type){i=e.coords,c=t.correct.coords;if(Yk(i[0],c[0])&&Zk(c[0],c[1],i[1]))return{type:"points",earned:1,total:1,message:null}}else if("angle"===e.type){var h;i=e.coords,c=t.correct.coords;if("congruent"===t.correct.match){var p=Ak.map([i,c],(function(e){return(Vk.findAngle(e[2],e[0],e[1])+360)%360}));h=$k.apply(null,p)}else h=Yk(i[1],c[1])&&Zk(c[1],c[0],i[0])&&Zk(c[1],c[2],i[2]);if(h)return{type:"points",earned:1,total:1,message:null}}return!s||Ak.isEqual(e,t.graph)?{type:"invalid",message:null}:{type:"points",earned:0,total:1,message:null}}}),Ek.exports={name:"interactive-graph",displayName:"Interactive graph",widget:u_};var d_=Ek.exports,g_={exports:{}};g_.exports;h.a;const f_=x.b,m_=ce,b_=m_.DeprecationMixin,v_=sm,x_=cd,y_=d_.widget,j_={url:null};const w_=createReactClass({displayName:"InteractiveGraphEditor",className:"perseus-widget-interactive-graph",getDefaultProps:function(){return{labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],valid:!0,backgroundImage:j_,markings:"graph",showProtractor:!1,showRuler:!1,showTooltips:!1,rulerLabel:"",rulerTicks:10,correct:{type:"linear",coords:null}}},deprecatedProps:{showGraph:function(e){return{markings:e.showGraph?"graph":"none"}}},componentWillMount(){b_.componentWillMount.call(this)},render:function(){var e,t,n=this.props.gridStep||m_.getGridStep(this.props.range,this.props.step,Cn),s=this.props.snapStep||m_.snapStepFromGridStep(n);const i=Us.SMALL;if(!0===this.props.valid){var r={ref:"graph",box:this.props.box,range:this.props.range,labels:this.props.labels,step:this.props.step,gridStep:n,snapStep:s,graph:this.props.correct,backgroundImage:this.props.backgroundImage,markings:this.props.markings,showProtractor:this.props.showProtractor,showRuler:this.props.showRuler,rulerLabel:this.props.rulerLabel,rulerTicks:this.props.rulerTicks,trackInteraction:function(){},flexibleType:!0,onChange:e=>{var t=this.props.correct;t=t.type===e.graph.type?f_.extend({},t,e.graph):e.graph,this.props.onChange({correct:t})}};e=Object($t.jsx)(y_,{...r,containerSizeClass:i,apiOptions:{...this.props.apiOptions,isMobile:!1}}),t=y_.getEquationString(r)}else e=Object($t.jsx)("div",{className:"perseus-error",children:this.props.valid});return Object($t.jsxs)("div",{className:"perseus-widget-interactive-graph",children:[Object($t.jsxs)("div",{children:["Correct answer"," ",Object($t.jsx)(x_,{children:Object($t.jsx)("p",{children:"Graph the correct answer in the graph below and ensure the equation or point coordinates displayed represent the correct answer."})})," ",": ",t]}),Object($t.jsx)(v_,{box:Gs(i),range:this.props.range,labels:this.props.labels,step:this.props.step,gridStep:n,snapStep:s,valid:this.props.valid,backgroundImage:this.props.backgroundImage,markings:this.props.markings,showProtractor:this.props.showProtractor,showRuler:this.props.showRuler,showTooltips:this.props.showTooltips,rulerLabel:this.props.rulerLabel,rulerTicks:this.props.rulerTicks,onChange:this.props.onChange}),"polygon"===this.props.correct.type&&Object($t.jsxs)("div",{className:"type-settings",children:[Object($t.jsxs)("label",{children:[" ","Student answer must"," ",Object($t.jsxs)("select",{value:this.props.correct.match,onChange:this.changeMatchType,children:[Object($t.jsx)("option",{value:"exact",children:"match exactly"}),Object($t.jsx)("option",{value:"congruent",children:"be congruent"}),Object($t.jsx)("option",{value:"approx",children:"be approximately congruent"}),Object($t.jsx)("option",{value:"similar",children:"be similar"})]})]}),Object($t.jsx)(x_,{children:Object($t.jsxs)("ul",{children:[Object($t.jsx)("li",{children:Object($t.jsxs)("p",{children:[Object($t.jsx)("b",{children:"Match Exactly:"})," Match exactly in size, orientation, and location on the grid even if it is not shown in the background."]})}),Object($t.jsx)("li",{children:Object($t.jsxs)("p",{children:[Object($t.jsx)("b",{children:"Be Congruent:"})," Be congruent in size and shape, but can be located anywhere on the grid."]})}),Object($t.jsx)("li",{children:Object($t.jsxs)("p",{children:[Object($t.jsx)("b",{children:"Be Approximately Congruent:"})," Be exactly similar, and congruent in size and shape to within 0.1 units, but can be located anywhere on the grid."," ",Object($t.jsx)("em",{children:"Use this with snapping to angle measure."})]})}),Object($t.jsx)("li",{children:Object($t.jsxs)("p",{children:[Object($t.jsx)("b",{children:"Be Similar:"})," Be similar with matching interior angles, and side measures that are matching or a multiple of the correct side measures. The figure can be located anywhere on the grid."]})})]})})]}),"angle"===this.props.correct.type&&Object($t.jsx)("div",{className:"type-settings",children:Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[" ","Student answer must"," ",Object($t.jsxs)("select",{value:this.props.correct.match,onChange:this.changeMatchType,children:[Object($t.jsx)("option",{value:"exact",children:"match exactly"}),Object($t.jsx)("option",{value:"congruent",children:"be congruent"})]})]}),Object($t.jsx)(x_,{children:Object($t.jsx)("p",{children:"Congruency requires only that the angle measures are the same. An exact match implies congruency, but also requires that the angles have the same orientation and that the vertices are in the same position."})})]})}),e]})},changeMatchType:function(e){var t=f_.extend({},this.props.correct,{match:e.target.value});this.props.onChange({correct:t})},serialize:function(){var e=f_.pick(this.props,"step","backgroundImage","markings","labels","showProtractor","showRuler","showTooltips","rulerLabel","rulerTicks","range","gridStep","snapStep"),t=this.refs.graph;if(t){var n=t&&t.getUserInput();f_.extend(e,{graph:{type:n.type},correct:n}),f_.each(["allowReflexAngles","angleOffsetDeg","numPoints","numSides","numSegments","showAngles","showSides","snapTo","snapDegrees"],(function(t){f_.has(n,t)&&(e.graph[t]=n[t])}))}return e}});g_.exports=w_;var O_=g_.exports,C_={exports:{}};C_.exports;h.a;const S_=x.b,k_=Ln.a,__={fontSize:"150%"},T_={fontSize:"120%"},M_={fontSize:"130%"},N_=[()=>[Object($t.jsx)("span",{style:T_,children:"+"},"plus"),"+"],()=>[Object($t.jsx)("span",{style:__,children:"-"},"minus"),"-"],e=>e.convertDotToTimes?[Object($t.jsx)(k_,{style:__,children:"\\times"},"times"),"\\times"]:[Object($t.jsx)(k_,{style:__,children:"\\cdot"},"times"),"\\cdot"],()=>[Object($t.jsx)(k_,{style:__,children:"\\frac{\u25a1}{\u25a1}"},"frac"),e=>{const t=e.latex();e.typedText("/"),e.latex()===t&&e.cmd("\\frac")}]],P_={basic:N_,"basic+div":N_.concat([()=>[Object($t.jsx)(k_,{children:"\\div"},"div"),"\\div"]]),trig:[()=>[Object($t.jsx)(k_,{children:"\\sin"},"sin"),"\\sin"],()=>[Object($t.jsx)(k_,{children:"\\cos"},"cos"),"\\cos"],()=>[Object($t.jsx)(k_,{children:"\\tan"},"tan"),"\\tan"],()=>[Object($t.jsx)(k_,{style:M_,children:"\\theta"},"theta"),"\\theta"],()=>[Object($t.jsx)(k_,{style:M_,children:"\\phi"},"pi"),"\\phi"]],prealgebra:[()=>[Object($t.jsx)(k_,{children:"\\sqrt{x}"},"sqrt"),"\\sqrt"],()=>[Object($t.jsx)(k_,{children:"\\sqrt[3]{x}"},"nthroot"),e=>{e.typedText("nthroot3"),e.keystroke("Right")}],()=>[Object($t.jsx)(k_,{style:T_,children:"\u25a1^a"},"pow"),e=>{const t=e.latex();e.typedText("^"),e.latex()===t&&e.typedText("a^b")}],()=>[Object($t.jsx)(k_,{style:T_,children:"\\pi"},"pi"),"\\pi"]],logarithms:[()=>[Object($t.jsx)(k_,{children:"\\log"},"log"),"\\log"],()=>[Object($t.jsx)(k_,{children:"\\ln"},"ln"),"\\ln"],()=>[Object($t.jsx)(k_,{children:"\\log_b"},"log_b"),e=>{e.typedText("log_"),e.keystroke("Right"),e.typedText("("),e.keystroke("Left"),e.keystroke("Left")}]],"basic relations":[()=>[Object($t.jsx)(k_,{children:"="},"eq"),"="],()=>[Object($t.jsx)(k_,{children:"\\lt"},"lt"),"\\lt"],()=>[Object($t.jsx)(k_,{children:"\\gt"},"gt"),"\\gt"]],"advanced relations":[()=>[Object($t.jsx)(k_,{children:"\\neq"},"neq"),"\\neq"],()=>[Object($t.jsx)(k_,{children:"\\leq"},"leq"),"\\leq"],()=>[Object($t.jsx)(k_,{children:"\\geq"},"geq"),"\\geq"]]},I_=PropTypes.arrayOf(PropTypes.oneOf(Object.keys(P_))),E_=createReactClass({displayName:"TexButtons",render:function(){const e=S_.sortBy(this.props.sets,(e=>S_.keys(P_).indexOf(e))).map((e=>P_[e])).map((e=>e.map((e=>{const t=e(this.props);return Object($t.jsx)("button",{onClick:()=>this.props.onInsert(t[1]),className:"tex-button",tabIndex:-1,type:"button",children:t[0]},t[0].key)})))).map(((e,t)=>Object($t.jsx)("div",{className:"clearfix tex-button-row",children:e},this.props.sets[t])));return Object($t.jsx)("div",{className:`${this.props.className} preview-measure`,children:e})},statics:{buttonSets:P_,buttonSetsType:I_}});C_.exports=E_;var A_=C_.exports,R_={exports:{}};R_.exports;const D_=v.a,L_=(h.a,i.a),F_=x.b,z_=A_,q_=window.MathQuill,W_=createReactClass({displayName:"MathInput",render:function(){let e=D_({"perseus-math-input":!0,"mq-editable-field":!0,"mq-math-mode":!0});this.props.className&&(e=e+" "+this.props.className);let t=null;return this._shouldShowButtons()&&(t=Object($t.jsx)(z_,{sets:this.props.buttonSets,className:"math-input-buttons absolute",convertDotToTimes:this.props.convertDotToTimes,onInsert:this.insert})),Object($t.jsxs)("div",{style:{display:"inline-block"},children:[Object($t.jsx)("div",{style:{display:"inline-block"},children:Object($t.jsx)("span",{className:e,ref:"mathinput","aria-label":this.props.labelText,onFocus:this.handleFocus,onBlur:this.handleBlur})}),Object($t.jsx)("div",{style:{position:"relative"},children:t})]})},handleFocus:function(){this.setState({focused:!0})},handleMouseDown:function(e){const t=L_.findDOMNode(this).contains(e.target);this.mouseDown=t,t||this.setState({focused:!1})},handleMouseUp:function(){this.mouseDown&&this.focus(),this.mouseDown=!1},handleBlur:function(){this.mouseDown||this.setState({focused:!1})},_shouldShowButtons:function(){return"always"===this.props.buttonsVisible||"never"!==this.props.buttonsVisible&&this.state.focused},getDefaultProps:function(){return{value:"",convertDotToTimes:!1,buttonsVisible:"focused"}},getInitialState:function(){return{focused:!1}},insert:function(e){const t=this.mathField();F_.isFunction(e)?e(t):"\\"===e[0]?t.cmd(e).focus():t.write(e).focus(),t.focus()},mathField:function(e){return q_.getInterface(2).MathField(L_.findDOMNode(this.refs.mathinput),e)},componentWillUnmount:function(){window.removeEventListener("mousedown",this.handleMouseDown),window.removeEventListener("mouseup",this.handleMouseUp)},componentDidMount:function(){window.addEventListener("mousedown",this.handleMouseDown),window.addEventListener("mouseup",this.handleMouseUp);let e=!1;this.mathField({autoCommands:"pi theta phi sqrt nthroot",charsThatBreakOutOfSupSub:"+-*/=<>\u2260\u2264\u2265",supSubsRequireOperand:!0,spaceBehavesLikeTab:!0,handlers:{edited:t=>{let n=t.latex();if(n=n.replace(/<>/g,"\\ne"),this.props.convertDotToTimes){n=n.replace(/\\cdot/g,"\\times");const e=t.__controller.cursor[q_.L];e&&"\\cdot "===e.ctrlSeq&&(t.__controller.backspace(),t.cmd("\\times"))}else n=n.replace(/\\times/g,"\\cdot");e&&this.props.value!==n&&this.props.onChange(n)},enter:()=>{l()(L_.findDOMNode(this.refs.mathinput)).submit()},upOutOf:e=>{e.typedText("^")}}}),this.mathField().latex(this.props.value),e=!0},componentDidUpdate:function(){F_.isEqual(this.mathField().latex(),this.props.value)||this.mathField().latex(this.props.value)},focus:function(){this.mathField().focus(),this.setState({focused:!0})},blur:function(){this.mathField().blur(),this.setState({focused:!1})}});R_.exports=W_;var B_=R_.exports,V_={exports:{}};V_.exports;const H_=h.a,U_=Kt;class G_ extends H_.Component{constructor(e){super(e),this.toggle=e=>{e.preventDefault(),this.setState({show:!this.state.show})},this.state={show:e.initiallyVisible}}render(){return Object($t.jsxs)("div",{className:"perseus-interaction-element",children:[Object($t.jsxs)("a",{href:"#",className:"perseus-interaction-element-title "+(this.state.show?"open":"closed"),onClick:this.toggle,children:[this.state.show?Object($t.jsx)(U_,{...ha}):Object($t.jsx)(U_,{...pa}),this.props.title]}),Object($t.jsxs)("div",{className:"perseus-interaction-element-content "+(this.state.show?"enter":"leave"),children:[this.props.children,(null!=this.props.onUp||null!=this.props.onDown||null!=this.props.onDelete)&&Object($t.jsxs)("div",{className:"edit-controls",children:[null!=this.props.onUp&&Object($t.jsx)("button",{onClick:this.props.onUp,children:Object($t.jsx)(U_,{...ga})}),null!=this.props.onDown&&Object($t.jsx)("button",{onClick:this.props.onDown,children:Object($t.jsx)(U_,{...da})}),null!=this.props.onDelete&&Object($t.jsx)("button",{onClick:this.props.onDelete,children:Object($t.jsx)(U_,{..._a})})]})]})]})}}G_.defaultProps={initiallyVisible:!1,title:"More"},V_.exports=G_;var Y_=V_.exports,K_={exports:{}};K_.exports;const X_=Vf.a,Z_=h.a;class J_ extends Z_.Component{render(){return Object($t.jsx)(X_,{value:this.props.value,allowEmpty:!1,buttons:[{value:"",content:Object($t.jsx)("span",{children:"\u2014"})},{value:"-",content:Object($t.jsx)("span",{children:"\u2013\u2013\u2013"})},{value:"- ",content:Object($t.jsx)("span",{children:"\u2013\xa0\xa0\u2013"})},{value:".",content:Object($t.jsx)("span",{children:"\xb7\xb7\xb7\xb7"})},{value:". ",content:Object($t.jsx)("span",{children:"\xb7 \xb7 \xb7"})}],onChange:this.props.onChange})}}J_.defaultProps={value:""},K_.exports=J_;var Q_=K_.exports,eT={exports:{}};eT.exports;const tT=h.a,nT=Ln.a,sT=Vf.a,iT=B_,rT=Gd;class oT extends tT.Component{constructor(){var e;super(...arguments),e=this,this.change=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return gu.apply(e,n)}}render(){return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Constraint:"," ",Object($t.jsx)(sT,{value:this.props.constraint,allowEmpty:!1,buttons:[{value:"none",content:"None"},{value:"snap",content:"Snap"},{value:"x",content:"x="},{value:"y",content:"y="}],onChange:this.change("constraint")})]}),"snap"===this.props.constraint&&Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Snap:"," ",Object($t.jsx)(rT,{value:this.props.snap,placeholder:0,onChange:this.change("snap")})]}),"x"===this.props.constraint&&Object($t.jsx)("div",{className:"graph-settings",children:Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(nT,{children:"x="})," ",Object($t.jsx)(iT,{buttonSets:[],buttonsVisible:"never",value:this.props.constraintFn,onChange:this.change("constraintFn")})]})}),"y"===this.props.constraint&&Object($t.jsx)("div",{className:"graph-settings",children:Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(nT,{children:"y="})," ",Object($t.jsx)(iT,{buttonSets:[],buttonsVisible:"never",value:this.props.constraintFn,onChange:this.change("constraintFn")})]})}),"Ensure these are set so nothing can be dragged off the canvas:",Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(nT,{children:"x \\in \\Large["})," ",Object($t.jsx)(iT,{buttonSets:[],buttonsVisible:"never",value:this.props.constraintXMin,onChange:this.change("constraintXMin")}),Object($t.jsx)(nT,{children:", "})," ",Object($t.jsx)(iT,{buttonSets:[],buttonsVisible:"never",value:this.props.constraintXMax,onChange:this.change("constraintXMax")})," ",Object($t.jsx)(nT,{children:"\\Large]"})]})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(nT,{children:"y \\in \\Large["})," ",Object($t.jsx)(iT,{buttonSets:[],buttonsVisible:"never",value:this.props.constraintYMin,onChange:this.change("constraintYMin")}),Object($t.jsx)(nT,{children:", "})," ",Object($t.jsx)(iT,{buttonSets:[],buttonsVisible:"never",value:this.props.constraintYMax,onChange:this.change("constraintYMax")})," ",Object($t.jsx)(nT,{children:"\\Large]"})]})})]})}}oT.defaultProps={constraint:"none",snap:.5,constraintFn:"0",constraintXMin:"-10",constraintXMax:"10",constraintYMin:"-10",constraintYMax:"10"},eT.exports=oT;var aT=eT.exports,lT={exports:{}};lT.exports;const cT=Vf.a,hT=h.a,pT=x.b,uT=Di,dT=[uT.BLACK,uT.BLUE,uT.GREEN,uT.PINK,uT.PURPLE,uT.RED,uT.GRAY],gT=[uT.LIGHT_BLUE,uT.LIGHT_ORANGE,uT.LIGHT_PINK,uT.LIGHT_GREEN,uT.LIGHT_PURPLE,uT.LIGHT_RED,"#fff"];class fT extends hT.Component{render(){const e=this.props.lightColors?gT:dT;return Object($t.jsx)(cT,{value:this.props.value,allowEmpty:!1,buttons:pT.map(e,(e=>({value:e,content:Object($t.jsxs)("span",{children:[Object($t.jsx)("span",{className:"colorpicker-circle",style:{background:e}}),"\xa0"]})}))),onChange:this.props.onChange})}}fT.defaultProps={value:uT.BLACK,lightColors:!1},lT.exports=fT;var mT=lT.exports,bT={exports:{}};bT.exports;const vT=Vf.a,xT=h.a;class yT extends xT.Component{render(){return Object($t.jsx)(vT,{value:this.props.value,allowEmpty:!1,buttons:[{value:"",content:Object($t.jsx)("span",{children:"\u2014"})},{value:"->",content:Object($t.jsx)("span",{children:"\u2192"})}],onChange:this.props.onChange})}}yT.defaultProps={value:""},bT.exports=yT;var jT=bT.exports,wT={exports:{}};wT.exports;h.a;const OT=x.b,CT=mu,ST=pu,kT=jT,_T=mT,TT=aT,MT=Q_,NT=Y_,PT=sm,IT=B_,ET=Gd,AT=Ln.a,RT=$x,DT=Di;var LT={graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],tickStep:[1,1],gridStep:[1,1],markings:"graph"},elements:[]};const FT=createReactClass({displayName:"PointEditor",getDefaultProps:function(){return{coordX:"0",coordY:"0",color:DT.BLACK}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Coordinate: ",Object($t.jsx)(AT,{children:"\\Large("}),Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.coordX,onChange:this.change("coordX")}),Object($t.jsx)(AT,{children:","})," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.coordY,onChange:this.change("coordY")}),Object($t.jsx)(AT,{children:"\\Large)"})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(_T,{value:this.props.color,onChange:this.change("color")})})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return CT.change.apply(this,t)},serialize(){return ST.serialize.call(this)}});var zT=createReactClass({displayName:"LineEditor",getDefaultProps:function(){return{startX:"-5",startY:"5",endX:"5",endY:"5",color:DT.BLACK,strokeDasharray:"",arrows:"",strokeWidth:2}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Start: ",Object($t.jsx)(AT,{children:"\\Large("}),Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.startX,onChange:this.change("startX")}),Object($t.jsx)(AT,{children:","})," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.startY,onChange:this.change("startY")}),Object($t.jsx)(AT,{children:"\\Large)"})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["End: ",Object($t.jsx)(AT,{children:"\\Large("}),Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.endX,onChange:this.change("endX")}),Object($t.jsx)(AT,{children:","})," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.endY,onChange:this.change("endY")}),Object($t.jsx)(AT,{children:"\\Large)"})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(_T,{value:this.props.color,onChange:this.change("color")})}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(MT,{value:this.props.strokeDasharray,onChange:this.change("strokeDasharray")}),"\xa0 \xa0",Object($t.jsx)(kT,{value:this.props.arrows,onChange:this.change("arrows")})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["Width:"," ",Object($t.jsx)(ET,{value:this.props.strokeWidth,placeholder:2,onChange:this.change("strokeWidth")})]})})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return CT.change.apply(this,t)},serialize(){return ST.serialize.call(this)}}),qT=createReactClass({displayName:"MovablePointEditor",getDefaultProps:function(){return{startX:"0",startY:"0",constraint:"none",snap:.5,constraintFn:"0",constraintXMin:"-10",constraintXMax:"10",constraintYMin:"-10",constraintYMax:"10"}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Start: ",Object($t.jsx)(AT,{children:"\\Large("}),Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.startX,onChange:this.change("startX")}),Object($t.jsx)(AT,{children:","})," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.startY,onChange:this.change("startY")}),Object($t.jsx)(AT,{children:"\\Large)"})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Update ",Object($t.jsx)(AT,{children:"(x_n, y_n)"})," for ",Object($t.jsx)(AT,{children:"n ="})," ",Object($t.jsx)(ET,{value:this.props.varSubscript,placeholder:0,onChange:this.change("varSubscript")})]}),Object($t.jsx)(TT,{...this.props})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return CT.change.apply(this,t)},serialize(){return ST.serialize.call(this)}}),WT=createReactClass({displayName:"MovableLineEditor",getDefaultProps:function(){return{startX:"-5",startY:"5",endX:"5",endY:"5",constraint:"none",snap:.5,constraintFn:"0",constraintXMin:"-10",constraintXMax:"10",constraintYMin:"-10",constraintYMax:"10"}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:["Initial position:",Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Start: ",Object($t.jsx)(AT,{children:"\\Large("}),Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.startX,onChange:this.change("startX")}),Object($t.jsx)(AT,{children:","})," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.startY,onChange:this.change("startY")}),Object($t.jsx)(AT,{children:"\\Large)"})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["End: ",Object($t.jsx)(AT,{children:"\\Large("}),Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.endX,onChange:this.change("endX")}),Object($t.jsx)(AT,{children:","})," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.endY,onChange:this.change("endY")}),Object($t.jsx)(AT,{children:"\\Large)"})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Start updates ",Object($t.jsx)(AT,{children:"(x_n, y_n)"})," for ",Object($t.jsx)(AT,{children:"n ="}),Object($t.jsx)(ET,{value:this.props.startSubscript,placeholder:0,onChange:this.change("startSubscript")})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["End updates ",Object($t.jsx)(AT,{children:"(x_m, y_m)"})," for ",Object($t.jsx)(AT,{children:"m ="}),Object($t.jsx)(ET,{value:this.props.endSubscript,placeholder:0,onChange:this.change("endSubscript")})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:"All constraints are applied to the start point."}),Object($t.jsx)(TT,{...this.props})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return CT.change.apply(this,t)},serialize(){return ST.serialize.call(this)}}),BT=createReactClass({displayName:"FunctionEditor",getDefaultProps:function(){return{value:"x",rangeMin:"-10",rangeMax:"10",color:DT.BLUE,strokeDasharray:"",strokeWidth:2}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(AT,{children:this.props.funcName+"(x)="})," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.value,onChange:this.change("value")})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Range: ",Object($t.jsx)(AT,{children:"\\Large("}),Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.rangeMin,onChange:this.change("rangeMin")}),Object($t.jsx)(AT,{children:","})," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.rangeMax,onChange:this.change("rangeMax")}),Object($t.jsx)(AT,{children:"\\Large)"})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(_T,{value:this.props.color,onChange:this.change("color")})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(MT,{value:this.props.strokeDasharray,onChange:this.change("strokeDasharray")})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["Width:"," ",Object($t.jsx)(ET,{value:this.props.strokeWidth,placeholder:2,onChange:this.change("strokeWidth")})]})})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return CT.change.apply(this,t)},serialize(){return ST.serialize.call(this)}}),VT=createReactClass({displayName:"ParametricEditor",getDefaultProps:function(){return{x:"cos(t)",y:"sin(t)",rangeMin:"0",rangeMax:"2\\pi",color:DT.BLUE,strokeDasharray:"",strokeWidth:2}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(AT,{children:"X(t) ="})," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.x,onChange:this.change("x")})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(AT,{children:"Y(t) ="})," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.y,onChange:this.change("y")})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Range: ",Object($t.jsx)(AT,{children:"\\Large("}),Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.rangeMin,onChange:this.change("rangeMin")}),Object($t.jsx)(AT,{children:","})," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.rangeMax,onChange:this.change("rangeMax")}),Object($t.jsx)(AT,{children:"\\Large)"})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(_T,{value:this.props.color,onChange:this.change("color")})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(MT,{value:this.props.strokeDasharray,onChange:this.change("strokeDasharray")})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["Width:"," ",Object($t.jsx)(ET,{value:this.props.strokeWidth,placeholder:2,onChange:this.change("strokeWidth")})]})})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return CT.change.apply(this,t)},serialize(){return ST.serialize.call(this)}}),HT=createReactClass({displayName:"LabelEditor",getDefaultProps:function(){return{coordX:"0",coordY:"0",color:DT.BLACK,label:"\\phi"}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(RT,{value:this.props.label,onChange:this.change("label"),style:{width:"100%"}})}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Location: ",Object($t.jsx)(AT,{children:"\\Large("}),Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.coordX,onChange:this.change("coordX")}),Object($t.jsx)(AT,{children:","})," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.coordY,onChange:this.change("coordY")}),Object($t.jsx)(AT,{children:"\\Large)"})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(_T,{value:this.props.color,onChange:this.change("color")})})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return CT.change.apply(this,t)},serialize(){return ST.serialize.call(this)}}),UT=createReactClass({displayName:"RectangleEditor",getDefaultProps:function(){return{coordX:"-5",coordY:"5",width:"2",height:"3",color:DT.LIGHT_BLUE}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Bottom left: ",Object($t.jsx)(AT,{children:"\\Large("}),Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.coordX,onChange:this.change("coordX")}),Object($t.jsx)(AT,{children:","})," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.coordY,onChange:this.change("coordY")}),Object($t.jsx)(AT,{children:"\\Large)"})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Width:"," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.width,onChange:this.change("width")})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Height:"," ",Object($t.jsx)(IT,{buttonSets:[],buttonsVisible:"never",value:this.props.height,onChange:this.change("height")})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(_T,{value:this.props.color,lightColors:!0,onChange:this.change("color")})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:"You want a border? Sorry, draw your own."})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return CT.change.apply(this,t)},serialize(){return ST.serialize.call(this)}}),GT=createReactClass({displayName:"InteractionEditor",getDefaultProps:function(){return LT},getInitialState:function(){return{usedVarSubscripts:this._getAllVarSubscripts(this.props.elements),usedFunctionNames:this._getAllFunctionNames(this.props.elements)}},componentWillReceiveProps:function(e){this.setState({usedVarSubscripts:this._getAllVarSubscripts(e.elements),usedFunctionNames:this._getAllFunctionNames(e.elements)})},_getAllVarSubscripts:function(e){return OT.map(OT.where(e,{type:"movable-point"}),(e=>e.options.varSubscript)).concat(OT.map(OT.where(e,{type:"movable-line"}),(e=>e.options.startSubscript))).concat(OT.map(OT.where(e,{type:"movable-line"}),(e=>e.options.endSubscript)))},_getAllFunctionNames:function(e){return OT.map(OT.where(e,{type:"function"}),(e=>e.options.funcName))},_updateGraphProps:function(e){this.change({graph:OT.extend(OT.omit(e,"step"),{tickStep:e.step})})},_addNewElement:function(e){var t=e.target.value;if(""!==t){e.target.value="";var n,s={type:t,key:t+"-"+(16777215*Math.random()|0).toString(16),options:"point"===t?OT.clone(FT.defaultProps):"line"===t?OT.clone(zT.defaultProps):"movable-point"===t?OT.clone(qT.defaultProps):"movable-line"===t?OT.clone(WT.defaultProps):"function"===t?OT.clone(BT.defaultProps):"parametric"===t?OT.clone(VT.defaultProps):"label"===t?OT.clone(HT.defaultProps):"rectangle"===t?OT.clone(UT.defaultProps):{}};if("movable-point"===t)n=OT.max([OT.max(this.state.usedVarSubscripts),-1])+1,s.options.varSubscript=n;else if("movable-line"===t)n=OT.max([OT.max(this.state.usedVarSubscripts),-1])+1,s.options.startSubscript=n,s.options.endSubscript=n+1;else if("function"===t){var i=String.fromCharCode(OT.max([OT.max(OT.map(this.state.usedFunctionNames,(function(e){return e.charCodeAt(0)}))),"e".charCodeAt(0)])+1);s.options.funcName=i}this.change({elements:this.props.elements.concat(s)})}},_deleteElement:function(e){var t=this.props.elements[e];this.change({elements:OT.without(this.props.elements,t)})},_moveElementUp:function(e){var t=this.props.elements[e],n=OT.without(this.props.elements,t);n.splice(e-1,0,t),this.change({elements:n})},_moveElementDown:function(e){var t=this.props.elements[e],n=OT.without(this.props.elements,t);n.splice(e+1,0,t),this.change({elements:n})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return CT.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{className:"perseus-widget-interaction-editor",children:[Object($t.jsxs)(NT,{title:"Grid settings",children:[Object($t.jsx)(PT,{editableSettings:["canvas","graph"],box:this.props.graph.box,labels:this.props.graph.labels,range:this.props.graph.range,step:this.props.graph.tickStep,gridStep:this.props.graph.gridStep,markings:this.props.graph.markings,onChange:this._updateGraphProps}),!0!==this.props.graph.valid&&Object($t.jsx)("div",{children:this.props.graph.valid})]}),OT.map(this.props.elements,(function(e,t){return"movable-point"===e.type?Object($t.jsx)(NT,{title:Object($t.jsxs)("span",{children:["Movable point"," ",Object($t.jsx)(AT,{children:"(x_{"+e.options.varSubscript+"}, y_{"+e.options.varSubscript+"})"})]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement.bind(this,t),children:Object($t.jsx)(qT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));OT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"movable-line"===e.type?Object($t.jsx)(NT,{title:Object($t.jsxs)("span",{children:["Movable line"," ",Object($t.jsx)(AT,{children:"(x_{"+e.options.startSubscript+"}, y_{"+e.options.startSubscript+"})"})," ","to"," ",Object($t.jsx)(AT,{children:"(x_{"+e.options.endSubscript+"}, y_{"+e.options.endSubscript+"})"})]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement.bind(this,t),children:Object($t.jsx)(WT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));OT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"point"===e.type?Object($t.jsx)(NT,{title:Object($t.jsxs)("span",{children:["Point"," ",Object($t.jsx)(AT,{children:"("+e.options.coordX+", "+e.options.coordY+")"})]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement.bind(this,t),children:Object($t.jsx)(FT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));OT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"line"===e.type?Object($t.jsx)(NT,{title:Object($t.jsxs)("span",{children:["Line"," ",Object($t.jsx)(AT,{children:"("+e.options.startX+", "+e.options.startY+")"})," ","to"," ",Object($t.jsx)(AT,{children:"("+e.options.endX+", "+e.options.endY+")"})]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement.bind(this,t),children:Object($t.jsx)(zT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));OT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"function"===e.type?Object($t.jsx)(NT,{title:Object($t.jsxs)("span",{children:["Function"," ",Object($t.jsx)(AT,{children:e.options.funcName+"(x) = "+e.options.value})]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement,children:Object($t.jsx)(BT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));OT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"parametric"===e.type?Object($t.jsx)(NT,{title:Object($t.jsx)("span",{children:"Parametric"}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement,children:Object($t.jsx)(VT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));OT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"label"===e.type?Object($t.jsx)(NT,{title:Object($t.jsxs)("span",{children:["Label"," ",Object($t.jsx)(AT,{children:e.options.label})," "]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement,children:Object($t.jsx)(HT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));OT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"rectangle"===e.type?Object($t.jsx)(NT,{title:Object($t.jsxs)("span",{children:["Rectangle"," ",Object($t.jsx)(AT,{children:"("+e.options.coordX+", "+e.options.coordY+")"}),"\xa0\u2014\xa0",Object($t.jsx)(AT,{children:e.options.width+" \\times "+e.options.height})]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement,children:Object($t.jsx)(UT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));OT.extend(n[t].options,e),this.change({elements:n})}})},e.key):void 0}),this),Object($t.jsx)("div",{className:"perseus-widget-interaction-editor-select-element",children:Object($t.jsxs)("select",{onChange:this._addNewElement,children:[Object($t.jsxs)("option",{value:"",children:["Add an element","\u2026"]}),Object($t.jsx)("option",{disabled:!0,children:"--"}),Object($t.jsx)("option",{value:"point",children:"Point"}),Object($t.jsx)("option",{value:"line",children:"Line segment"}),Object($t.jsx)("option",{value:"function",children:"Function plot"}),Object($t.jsx)("option",{value:"parametric",children:"Parametric plot"}),Object($t.jsx)("option",{value:"label",children:"Label"}),Object($t.jsx)("option",{value:"rectangle",children:"Rectangle"}),Object($t.jsx)("option",{value:"movable-point",children:"\u2605 Movable point"}),Object($t.jsx)("option",{value:"movable-line",children:"\u2605 Movable line segment"})]})})]})},serialize(){return ST.serialize.call(this)}});wT.exports=GT;var $T=wT.exports,YT={exports:{}},KT=(YT.exports,h.a,x.b),XT=mu,ZT=hc,JT=ZT.Label,QT=ZT.Line,eM=ZT.MovablePoint,tM=ZT.MovableLine,nM=ZT.Plot,sM=ZT.PlotParametric,iM=ZT.Point,rM=ZT.Rect,oM=G.a.vector,aM=(e,t)=>{for(var n=e+"||"+(t=t||{}).decimal_separatpr+"||",s=t.functions,i=s?s.length:0,r=0;r<i;r++)n+=s[r]+"|";return n},lM=Object.create(null),cM=(e,t)=>{var n=aM(e,t),s=lM[n];return s||(s=U.parse(e,t),lM[n]=s,s)},hM=Object.create(null),pM=(e,t)=>{var n=aM(e,t),s=hM[n];if(s)return s;var i=U.parse(e,t).expr;return s=i?i.compile():function(){return 0},hM[n]=s,s},uM={graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],tickStep:[1,1],gridStep:[1,1],markings:"graph"},elements:[]},dM=createReactClass({displayName:"Interaction",getDefaultProps:function(){return uM},getInitialState:function(){return{variables:this._getInitialVariables(this.props.elements),functions:this._getInitialFunctions(this.props.elements)}},_getInitialVariables:function(e){var t={};return KT.each(KT.where(e,{type:"movable-point"}),(function(e){var n=e.options.varSubscript,s=cM(e.options.startX||"0").expr,i=cM(e.options.startY||"0").expr,r=0,o=0;s&&(r=s.eval({})||0),i&&(o=i.eval({})||0),t["x_"+n]=r,t["y_"+n]=o}),this),KT.each(KT.where(e,{type:"movable-line"}),(function(e){var n=e.options.startSubscript,s=e.options.endSubscript,i=cM(e.options.startX||"0").expr,r=cM(e.options.startY||"0").expr,o=cM(e.options.endX||"0").expr,a=cM(e.options.endY||"0").expr,l=0,c=0,h=0,p=0;i&&(l=i.eval({})||0),r&&(c=r.eval({})||0),o&&(h=o.eval({})||0),a&&(p=a.eval({})||0),t["x_"+n]=l,t["y_"+n]=c,t["x_"+s]=h,t["y_"+s]=p}),this),KT.each(KT.where(e,{type:"function"}),(function(e){t[e.options.funcName]=e.options.value})),t},_getInitialFunctions:function(e){return KT.map(KT.where(e,{type:"function"}),(e=>e.options.funcName))},componentWillReceiveProps:function(e){this.setState({variables:this._getInitialVariables(e.elements),functions:this._getInitialFunctions(e.elements)})},_setupGraphie:function(e,t){if(e.graphInit(KT.extend({},t,{grid:KT.contains(["graph","grid"],this.props.graph.markings),axes:KT.contains(["graph"],this.props.graph.markings),ticks:KT.contains(["graph"],this.props.graph.markings),labels:KT.contains(["graph"],this.props.graph.markings),labelFormat:function(e){return"\\small{"+e+"}"},axisArrows:"<->",unityLabels:!1})),"graph"===this.props.graph.markings){var n=this.props.graph.labels,s=this.props.graph.range;e.label([0,s[1][1]],n[1],"above"),e.label([s[0][1],0],n[0],"right")}},_updatePointLocation:function(e,t){var n=KT.clone(this.state.variables);n["x_"+e]=t[0],n["y_"+e]=t[1],this.setState({variables:n}),this.props.trackInteraction()},_updateLineLocation:function(e,t){var n=this._eval("("+e.endX+")-("+e.startX+")"),s=this._eval("("+e.endY+")-("+e.startY+")"),i=oM.add(t,[n,s]),r=KT.clone(this.state.variables);r["x_"+e.startSubscript]=t[0],r["y_"+e.startSubscript]=t[1],r["x_"+e.endSubscript]=i[0],r["y_"+e.endSubscript]=i[1],this.setState({variables:r}),this.props.trackInteraction()},_eval:function(e,t){var n=pM(e,{functions:this.state.functions}),s=KT.extend({},this.state.variables,t);return KT.each(KT.keys(s),(e=>{if(KT.isString(s[e])){var t=pM(s[e],{functions:this.state.functions});s[e]=function(e){return t(KT.extend({},s,{x:e}))}}})),n(s)||0},_extractVars:function(e){if(null==e)return[];var t=[];return KT.each(e.args(),(function(e){e&&"Expr"===e.constructor.name&&(t=t.concat(this._extractVars(e)))}),this),"Var"===e.name()&&t.push(e.prettyPrint()),t},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return XT.change.apply(this,t)},render:function(){return Object($t.jsx)(ZT,{box:this.props.graph.box,range:this.props.graph.range,options:this.props.graph,setup:this._setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,children:KT.map(this.props.elements,(function(e,t){if("point"===e.type)return Object($t.jsx)(iM,{coord:[this._eval(e.options.coordX),this._eval(e.options.coordY)],color:e.options.color},e.key);if("line"===e.type){var n=[this._eval(e.options.startX),this._eval(e.options.startY)],s=[this._eval(e.options.endX),this._eval(e.options.endY)];return Object($t.jsx)(QT,{start:n,end:s,style:{stroke:e.options.color,strokeWidth:e.options.strokeWidth,strokeDasharray:e.options.strokeDasharray,arrows:e.options.arrows}},e.key)}if("movable-point"===e.type){var i=[t=>[Math.max(this._eval(e.options.constraintXMin),Math.min(this._eval(e.options.constraintXMax),t[0])),Math.max(this._eval(e.options.constraintYMin),Math.min(this._eval(e.options.constraintYMax),t[1]))]];return"snap"===e.options.constraint?i.push(eM.constraints.snap(e.options.snap)):"x"===e.options.constraint?i.push((t=>[this._eval(e.options.constraintFn,{y:t[1]}),t[1]])):"y"===e.options.constraint&&i.push((t=>[t[0],this._eval(e.options.constraintFn,{x:t[0]})])),Object($t.jsx)(eM,{coord:[this.state.variables["x_"+e.options.varSubscript],this.state.variables["y_"+e.options.varSubscript]],constraints:i,foo_x:e.options.constraint,foo_y:e.options.constraintFn,foo_z:e.options.snap,onMove:KT.partial(this._updatePointLocation,e.options.varSubscript)},e.key)}if("movable-line"===e.type){i=[t=>[Math.max(this._eval(e.options.constraintXMin),Math.min(this._eval(e.options.constraintXMax),t[0])),Math.max(this._eval(e.options.constraintYMin),Math.min(this._eval(e.options.constraintYMax),t[1]))]];"snap"===e.options.constraint?i.push(eM.constraints.snap(e.options.snap)):"x"===e.options.constraint?i.push((t=>[this._eval(e.options.constraintFn,{y:t[1]}),t[1]])):"y"===e.options.constraint&&i.push((t=>[t[0],this._eval(e.options.constraintFn,{x:t[0]})]));n=[this.state.variables["x_"+e.options.startSubscript],this.state.variables["y_"+e.options.startSubscript]],s=[this.state.variables["x_"+e.options.endSubscript],this.state.variables["y_"+e.options.endSubscript]];return Object($t.jsxs)(tM,{constraints:i,onMove:KT.bind(this._updateLineLocation,this,e.options),foo_x:e.options.constraint,foo_y:e.options.constraintFn,foo_z:e.options.snap,children:[Object($t.jsx)(eM,{coord:n,static:!0,normalStyle:{stroke:"none",fill:"none"}}),Object($t.jsx)(eM,{coord:s,static:!0,normalStyle:{stroke:"none",fill:"none"}})]},e.key)}if("function"===e.type){var r=t=>this._eval(e.options.value,{x:t}),o=KT.without(this._extractVars(cM(e.options.value).expr),"x"),a=KT.object(o,KT.map(o,(e=>this.state.variables[e]))),l=[this._eval(e.options.rangeMin,this.state.variables),this._eval(e.options.rangeMax,this.state.variables)];return Object($t.jsx)(nM,{fn:r,foo_fn:e.options.value,foo_varvalues:a,range:l,style:{stroke:e.options.color,strokeWidth:e.options.strokeWidth,strokeDasharray:e.options.strokeDasharray,plotPoints:100}},e.key)}if("parametric"===e.type){r=t=>[this._eval(e.options.x,{t:t}),this._eval(e.options.y,{t:t})],o=KT.without(this._extractVars(cM(e.options.x).expr).concat(this._extractVars(cM(e.options.y).expr)),"t"),a=KT.object(o,KT.map(o,(e=>this.state.variables[e]))),l=[this._eval(e.options.rangeMin,this.state.variables),this._eval(e.options.rangeMax,this.state.variables)];return Object($t.jsx)(sM,{fn:r,foo_fnx:e.options.x,foo_fny:e.options.y,foo_varvalues:a,range:l,style:{stroke:e.options.color,strokeWidth:e.options.strokeWidth,strokeDasharray:e.options.strokeDasharray,plotPoints:100}},e.key)}if("label"===e.type){var c=[this._eval(e.options.coordX),this._eval(e.options.coordY)];return Object($t.jsx)(JT,{coord:c,text:e.options.label,style:{color:e.options.color}},t+1)}return"rectangle"===e.type?Object($t.jsx)(rM,{x:this._eval(e.options.coordX),y:this._eval(e.options.coordY),width:KT.max([this._eval(e.options.width),0]),height:KT.max([this._eval(e.options.height),0]),style:{stroke:"none",fill:e.options.color}},t+1):void 0}),this)})},getUserInput:function(){return{}},simpleValidate:function(e){return dM.validate(this.getUserInput(),e)}});KT.extend(dM,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),YT.exports={name:"interaction",displayName:"Interaction",widget:dM,transform:KT.identity,hidden:!0};var gM=YT.exports,fM={exports:{}};fM.exports;h.a;const mM=x.b,bM=ce,vM=mu,xM=pu,yM=id.a,jM=lv,wM=cd,OM=Kt,CM=Bf,SM=[0,10],kM={url:null,width:0,height:0},_M=new RegExp("^(https?|web\\+graphie)://[^/]*(ka-.*.s3.amazonaws.com|(fastly|cdn).kastatic.org|khanacademy.org|kasandbox.org)");var TM=["center","above","above right","right","below right","below","below left","left","above left"];const MM=createReactClass({displayName:"ImageEditor",componentDidMount:function(){mM.defer((()=>{var e=this.props.backgroundImage.url;this.onUrlChange(e,!0)}))},getDefaultProps:function(){return{title:"",range:[SM,SM],box:[400,400],backgroundImage:kM,labels:[],alt:"",caption:""}},getInitialState:function(){return{backgroundImageError:""}},render:function(){var e=this.props.backgroundImage,t=Object($t.jsxs)("div",{className:"image-settings",children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[Object($t.jsxs)("div",{children:["Alt text:",Object($t.jsx)(wM,{children:"This is important for screenreaders. The content of this alt text will be formatted as markdown (tables, emphasis, etc. are supported)."})]}),Object($t.jsx)(jM,{apiOptions:this.props.apiOptions,content:this.props.alt,onChange:e=>{null!=e.content&&this.change("alt",e.content)},widgetEnabled:!1})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[Object($t.jsx)("div",{children:"Caption:"}),Object($t.jsx)(jM,{apiOptions:this.props.apiOptions,content:this.props.caption,onChange:e=>{null!=e.content&&this.change("caption",e.content)},widgetEnabled:!1})]})})]}),n=Object($t.jsx)("div",{className:"renderer-widget-error",children:this.state.backgroundImageError});return Object($t.jsxs)("div",{className:"perseus-image-editor",children:[Object($t.jsxs)("label",{children:["Image url:",Object($t.jsx)(wM,{children:"Paste an image or graphie image URL."}),this.state.backgroundImageError&&n,Object($t.jsx)(yM,{value:e.url||"",style:{width:332},onChange:e=>this.onUrlChange(e,!1)})]}),e.url&&t]})},_renderRowForLabel:function(e,t){return Object($t.jsxs)("tr",{children:[Object($t.jsx)("td",{children:Object($t.jsx)(CM,{value:e.coordinates,onChange:this.onCoordinateChange.bind(this,t)})}),Object($t.jsx)("td",{style:{verticalAlign:"bottom",width:"5px"},children:Object($t.jsx)("input",{type:"text",className:"graph-settings-axis-label",value:e.content,onChange:this.onContentChange.bind(this,t)})}),Object($t.jsx)("td",{children:Object($t.jsx)("select",{className:"perseus-widget-dropdown",value:e.alignment,onChange:this.onAlignmentChange.bind(this,t),children:TM.map((function(e,t){return Object($t.jsx)("option",{value:e,children:e},""+t)}),this)})}),Object($t.jsx)("td",{children:Object($t.jsx)("a",{href:"#",className:"simple-button orange delete-label",title:"Remove this label",onClick:this.removeLabel.bind(this,t),children:Object($t.jsx)(OM,{..._a})})})]},t)},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vM.change.apply(this,t)},removeLabel:function(e,t){t.preventDefault();var n=mM.clone(this.props.labels);n.splice(e,1),this.props.onChange({labels:n})},onCoordinateChange:function(e,t){var n=this.props.labels.slice();n[e]=mM.extend({},n[e],{coordinates:t}),this.props.onChange({labels:n})},onContentChange:function(e,t){var n=t.target.value,s=this.props.labels.slice();s[e]=mM.extend({},s[e],{content:n}),this.props.onChange({labels:s})},onAlignmentChange:function(e,t){var n=t.target.value,s=this.props.labels.slice();s[e]=mM.extend({},s[e],{alignment:n}),this.props.onChange({labels:s})},setUrl:function(e,t,n,s){if(this.isMounted()){var i=mM.clone(this.props.backgroundImage);i.url=e,i.width=t,i.height=n;var r=[i.width,i.height];this.props.onChange({backgroundImage:i,box:r},null,s)}},onUrlChange:function(e,t){_M.test(e)?(this.setState({backgroundImageError:""}),this._leadingUrl=e,e?bM.getImageSize(e,((t,n)=>{this._leadingUrl===e&&this.setUrl(e,t,n,!0)})):this.setUrl(e,0,0,t)):this.setState({backgroundImageError:"Images must be from sites hosted by Khan Academy. Please input a Khan Academy-owned address, or use the Add Image tool to rehost an existing image"})},onRangeChange:function(e,t){var n=this.props.range.slice();n[e]=t,this.props.onChange({range:n})},serialize(){return xM.serialize.call(this)}});fM.exports=MM;var NM=fM.exports,PM={exports:{}},IM=(PM.exports,v.a),EM=(h.a,x.b),AM=mu;const RM=mh;var DM=gh,LM=Ic,FM=[0,10],zM={url:null,width:0,height:0};const qM="block";var WM=createReactClass({displayName:"ImageWidget",statics:{styles:Nn.StyleSheet.create({caption:{display:"inline-block",marginTop:On,maxWidth:640,[RM.lgOrSmaller]:{maxWidth:540},[RM.smOrSmaller]:{maxWidth:450}}})},getDefaultProps:function(){return{alignment:qM,title:"",range:[FM,FM],box:[400,400],backgroundImage:zM,labels:[],alt:"",caption:"",linterContext:je}},render:function(){var e,t,n,s,{apiOptions:i}=this.props,r=this.props.backgroundImage;if(r.url&&(e=Object($t.jsx)(LM,{src:r.url,alt:this.props.alt?"":void 0,width:r.width,height:r.height,preloader:i.imagePreloader,extraGraphie:{box:this.props.box,range:this.props.range,labels:this.props.labels},trackInteraction:this.props.trackInteraction,zoomToFullSizeOnMobile:i.isMobile,constrainHeight:i.isMobile,allowFullBleed:i.isMobile})),this.props.alt&&(t=Object($t.jsx)("span",{className:"perseus-sr-only",children:Object($t.jsx)(DM,{content:this.props.alt,apiOptions:i,linterContext:this.props.linterContext})})),i.isMobile){var o;if(this.props.title||this.props.caption){let e=this.props.title;e&&(this.props.caption&&!/[.?!"']\s*$/.test(e)&&(e+="."),e=`**${e}** `);const t=IM({"perseus-image-caption":!0,"has-title":!!e}),n=this.props.alignment,s="block"===n||"full-width"===n?null:"0 !important";o=Object($t.jsx)("div",{className:t,children:Object($t.jsx)("div",{className:Object(Nn.css)(WM.styles.caption),style:{minWidth:s},children:Object($t.jsx)(DM,{content:e+this.props.caption,apiOptions:i,linterContext:this.props.linterContext})})})}return Object($t.jsxs)("div",{className:"perseus-image-widget",children:[e,t,o]})}return this.props.title&&(n=Object($t.jsx)("div",{className:"perseus-image-title",children:Object($t.jsx)(DM,{content:this.props.title,apiOptions:i,linterContext:this.props.linterContext})})),this.props.caption&&(s=Object($t.jsx)("div",{className:"perseus-image-caption",children:Object($t.jsx)(DM,{content:this.props.caption,apiOptions:i,linterContext:this.props.linterContext})})),Object($t.jsxs)("div",{className:"perseus-image-widget",children:[n,e,t,s]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return AM.change.apply(this,t)},getUserInput:function(){return null},simpleValidate:function(e){return WM.validate(this.getUserInput(),e)},focus:$.noop});EM.extend(WM,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),PM.exports={name:"image",accessible:e=>{var t=e.backgroundImage;return!(t&&t.url&&!e.alt)},defaultAlignment:qM,supportedAlignments:["block","full-width"],displayName:"Image",widget:WM,isLintable:!0};var BM=PM.exports,VM={exports:{}};VM.exports;h.a;const HM=x.b,UM=mu,GM=pu,$M=id.a,YM=Lf,KM=createReactClass({displayName:"PairEditor",getDefaultProps:function(){return{name:"",value:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return UM.change.apply(this,t)},render:function(){return Object($t.jsxs)("fieldset",{children:[Object($t.jsxs)("label",{children:["Name:",Object($t.jsx)($M,{value:this.props.name,onChange:this.change("name")})]}),Object($t.jsxs)("label",{children:["Value:",Object($t.jsx)($M,{value:this.props.value,onChange:this.change("value")})]})]})},serialize(){return GM.serialize.call(this)}});var XM=createReactClass({displayName:"PairsEditor",render:function(){var e=HM.map(this.props.pairs,((e,t)=>Object($t.jsx)(KM,{name:e.name,value:e.value,onChange:this.handlePairChange.bind(this,t)},t)));return Object($t.jsx)("div",{children:e})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return UM.change.apply(this,t)},handlePairChange:function(e,t){var n=this.props.pairs.slice();n[e]=t;var s=n[n.length-1];s.name&&s.value&&n.push({name:"",value:""}),this.change("pairs",n)},serialize(){return GM.serialize.call(this)}}),ZM=createReactClass({displayName:"IframeEditor",getDefaultProps:function(){return{url:"",settings:[{name:"",value:""}],width:"400",height:"400",allowFullScreen:!1,allowTopNavigation:!1}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return UM.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{style:{fontWeight:"bold",textAlign:"center"},children:["This widget is deprecated! ",Object($t.jsx)("br",{}),"Try using the Video or CS Program widgets instead."]}),Object($t.jsxs)("label",{children:["Url or Program ID:",Object($t.jsx)($M,{name:"url",value:this.props.url,onChange:this.change("url")})]}),Object($t.jsx)("br",{}),Object($t.jsxs)("label",{children:["Settings:",Object($t.jsx)(XM,{name:"settings",pairs:this.props.settings,onChange:this.handleSettingsChange})]}),Object($t.jsx)("br",{}),Object($t.jsxs)("label",{children:["Width:",Object($t.jsx)($M,{name:"width",value:this.props.width,onChange:this.change("width")})]}),Object($t.jsxs)("label",{children:["Height:",Object($t.jsx)($M,{name:"height",value:this.props.height,onChange:this.change("height")})]}),Object($t.jsx)(YM,{label:"Allow full screen",allowFullScreen:this.props.allowFullScreen,onChange:this.props.onChange}),Object($t.jsx)("br",{}),Object($t.jsx)(YM,{label:"Allow iframe content to redirect the page",allowTopNavigation:this.props.allowTopNavigation,onChange:this.props.onChange})]})},handleSettingsChange:function(e){this.change({settings:e.pairs})},serialize(){return GM.serialize.call(this)}});VM.exports=ZM;var JM=VM.exports,QM={exports:{}},eN=(QM.exports,h.a,x.b),tN=mu,nN=Bu,sN=ce.updateQueryString,iN=createReactClass({displayName:"Iframe",getDefaultProps:function(){return{status:"incomplete",message:null,allowFullScreen:!1,allowTopNavigation:!1}},getUserInput:function(){return nN.getUserInput.call(this)},handleMessageEvent:function(e){var t={};try{t=JSON.parse(e.originalEvent.data)}catch(s){return}if(!eN.isUndefined(t.testsPassed)){var n=t.testsPassed?"correct":"incorrect";this.change({status:n,message:t.message})}},componentDidMount:function(){$(window).on("message",this.handleMessageEvent)},componentWillUnmount:function(){$(window).off("message",this.handleMessageEvent)},render:function(){var e={width:this.props.width,height:this.props.height},t=this.props.url;if(t&&t.length&&0!==t.indexOf("http")&&(t=sN(t="https://www.khanacademy.org/computer-programming/program/"+t+"/embedded?buttons=no&embed=yes&editor=no&author=no","width",this.props.width),t=sN(t,"height",this.props.height),t=sN(t,"origin",window.location.origin)),"undefined"!==typeof KA&&KA.isZeroRated&&(t.match(/https?:\/\/[^\/]*khanacademy.org/)?t.match(/zero.khanacademy.org/)||(t=t.replace("khanacademy.org","zero.khanacademy.org")):t="/zero/external-link?context=iframe&url="+encodeURIComponent(t)),this.props.settings){var n={};eN.each(this.props.settings,(function(e){e.name&&e.value&&(n[e.name]=e.value)})),t=sN(t,"settings",JSON.stringify(n))}let s="allow-same-origin allow-scripts";return s+=" allow-top-navigation",Object($t.jsx)("iframe",{sandbox:"allow-same-origin allow-scripts allow-top-navigation",style:e,src:t,allowFullScreen:this.props.allowFullScreen})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return tN.change.apply(this,t)},simpleValidate:function(e){return iN.validate(this.getUserInput(),e)}});eN.extend(iN,{validate:function(e,t){return"correct"===e.status?{type:"points",earned:1,total:1,message:e.message||null}:"incorrect"===e.status?{type:"points",earned:0,total:1,message:e.message||null}:{type:"invalid",message:"Keep going, you're not there yet!"}}}),QM.exports={name:"iframe",displayName:"Iframe",widget:iN,hidden:!0};var rN=QM.exports,oN={exports:{}};oN.exports;h.a;const aN=x.b,lN=mu,cN=lv,hN=createReactClass({displayName:"GroupEditor",getDefaultProps:function(){return{content:"",widgets:{},images:{},metadata:void 0}},render:function(){return Object($t.jsxs)("div",{className:"perseus-group-editor",children:[Object($t.jsx)("div",{children:this._renderMetadataEditor()}),Object($t.jsx)(cN,{ref:"editor",content:this.props.content,widgets:this.props.widgets,apiOptions:this.props.apiOptions,images:this.props.images,widgetEnabled:!0,immutableWidgets:!1,onChange:this.props.onChange})]})},_renderMetadataEditor:function(){var e=this.props.apiOptions.GroupMetadataEditor;return Object($t.jsx)(e,{value:this.props.metadata,onChange:this.change("metadata")})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return lN.change.apply(this,t)},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(){return aN.extend({},this.refs.editor.serialize(),{metadata:this.props.metadata})}});oN.exports=hN;var pN=oN.exports,uN={exports:{}},dN=(uN.exports,v.a),gN=(h.a,x.b),fN=Is.Options,mN=mu,bN=gh,vN=createReactClass({displayName:"Group",getDefaultProps:function(){return{content:"",widgets:{},images:{},icon:null,linterContext:je}},componentDidMount:function(){this.forceUpdate()},render:function(){var e=gN.extend({},fN.defaults,this.props.apiOptions,{onFocusChange:(e,t)=>{t&&this.props.onBlur(t),e&&this.props.onFocus(e)}}),t=gN.indexOf(this.props.findWidgets("group"),this),n=this.props.apiOptions.groupAnnotator(t,this.props.widgetId),s=this.refs.renderer&&this.refs.renderer.score(),i=s&&"invalid"!==s.type,r=s&&"invalid"===s.type;return Object($t.jsxs)("div",{className:dN({"perseus-group":!0,"perseus-group-valid-answer":i,"perseus-group-invalid-answer":r}),children:[n,Object($t.jsx)(bN,{...this.props,ref:"renderer",apiOptions:e,findExternalWidgets:this.props.findWidgets,reviewMode:!!this.props.reviewModeRubric,onInteractWithWidget:e=>{this.refs.renderer&&this.change("widgets",this.refs.renderer.props.widgets)},linterContext:this.props.linterContext}),this.props.icon&&Object($t.jsx)("div",{className:"group-icon",children:this.props.icon})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return mN.change.apply(this,t)},getUserInput:function(){return this.refs.renderer.getUserInput()},getSerializedState:function(){return this.refs.renderer.getSerializedState()},restoreSerializedState:function(e,t){return this.refs.renderer.restoreSerializedState(e,t),null},simpleValidate:function(e){return this.refs.renderer.score()},getInputPaths:function(){return this.refs.renderer.getInputPaths()},setInputValue:function(e,t,n){return this.refs.renderer.setInputValue(e,t,n)},getAcceptableFormatsForInputPath:function(e){return this.refs.renderer.getAcceptableFormatsForInputPath(e)},getRenderer:function(){return this.refs.renderer},focus:function(){return this.refs.renderer.focus()},focusInputPath:function(e){this.refs.renderer.focusPath(e)},blurInputPath:function(e){this.refs.renderer.blurPath(e)},showRationalesForCurrentlySelectedChoices(){this.refs.renderer.showRationalesForCurrentlySelectedChoices()}});uN.exports={name:"group",displayName:"Group (SAT only)",widget:vN,traverseChildWidgets:function(e,t){return gN.extend({},e,t(e))},hidden:!1,isLintable:!0};var xN=uN.exports,yN={exports:{}};yN.exports;h.a,x.b;const jN=mu,wN=lv,ON=$x,CN=Kt,SN=createReactClass({displayName:"GradedGroupEditor",getDefaultProps:function(){return{title:"",content:"",widgets:{},images:{},hint:null}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return jN.change.apply(this,t)},handleAddHint:function(){this.props.onChange({hint:{content:""}},(()=>{this.refs["hint-editor"].focus()}))},handleRemoveHint:function(e){this.props.onChange({hint:null})},render:function(){return Object($t.jsxs)("div",{className:"perseus-group-editor",children:[Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{className:Object(Nn.css)(kN.title),children:["Title:"," ",Object($t.jsx)(ON,{value:this.props.title,className:Object(Nn.css)(kN.input),onChange:this.change("title")})]})}),Object($t.jsx)(wN,{ref:"editor",content:this.props.content,widgets:this.props.widgets,apiOptions:this.props.apiOptions,images:this.props.images,widgetEnabled:!0,immutableWidgets:!1,onChange:this.props.onChange,warnNoPrompt:!0,warnNoWidgets:!0}),!this.props.hint&&Object($t.jsxs)("button",{type:"button",style:{marginTop:10},className:"add-hint simple-button orange",onClick:this.handleAddHint,children:[Object($t.jsx)(CN,{...wa})," Add a hint"]}),this.props.hint&&Object($t.jsxs)("div",{className:"perseus-hint-editor",children:[Object($t.jsx)("div",{className:Object(Nn.css)(kN.hintsTitle),children:"Hint"}),Object($t.jsx)(wN,{ref:"hint-editor",content:this.props.hint?this.props.hint.content:"",widgets:this.props.hint?this.props.hint.widgets:{},apiOptions:this.props.apiOptions,images:this.props.hint&&this.props.hint.images,widgetEnabled:!0,immutableWidgets:!1,onChange:e=>{this.change("hint",Object.assign({},this.props.hint,e))}}),Object($t.jsxs)("button",{type:"button",className:"remove-hint simple-button orange",onClick:this.handleRemoveHint,children:[Object($t.jsx)(CN,{..._a})," Remove this hint"]})]})]})},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(){return{title:this.props.title,...this.refs.editor.serialize(),hint:this.refs["hint-editor"]&&this.refs["hint-editor"].serialize()}}}),kN=Nn.StyleSheet.create({title:{fontSize:18,fontWeight:"bold"},input:{fontSize:18},hintsTitle:{marginTop:10,fontSize:"110%",fontWeight:"bold"}});yN.exports=SN;var _N=yN.exports,TN={exports:{}};TN.exports;h.a,x.b;const MN=mu,NN=_N,PN=createReactClass({displayName:"GradedGroupSetEditor",getDefaultProps:()=>({gradedGroups:[]}),componentWillMount(){this._editors=[]},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return MN.change.apply(this,t)},getSaveWarnings(){return[].concat(...this._editors.map((e=>e.getSaveWarnings())))},serialize(){return{gradedGroups:this.props.gradedGroups}},renderGroups(){return this.props.gradedGroups?this.props.gradedGroups.map(((e,t)=>Object($t.jsx)(NN,{ref:e=>this._editors[t]=e,...e,apiOptions:this.props.apiOptions,widgetEnabled:!0,immutableWidgets:!1,onChange:e=>this.change("gradedGroups",IN(this.props.gradedGroups,t,{...this.props.gradedGroups[t],...e}))},t))):null},addGroup(){const e=this.props.gradedGroups||[];this.change("gradedGroups",e.concat([NN.getDefaultProps()]))},render(){return Object($t.jsxs)("div",{className:"perseus-group-editor",children:[this.renderGroups(),Object($t.jsx)("button",{onClick:this.addGroup,children:"Add group"})]})}}),IN=(e,t,n)=>[...e.slice(0,t),n,...e.slice(t+1)];TN.exports=PN;var EN=TN.exports,AN={exports:{}};AN.exports;h.a;const RN=Kt,DN={HIDDEN:Symbol("HIDDEN"),ACTIVE:Symbol("ACTIVE"),INACTIVE:Symbol("INACTIVE"),INCORRECT:Symbol("INCORRECT"),CORRECT:Symbol("CORRECT")},LN=createReactClass({displayName:"GradedGroupAnswerBar",render(){const{apiOptions:e,answerBarState:t,onCheckAnswer:n,onNextQuestion:s}=this.props,i={...FN.answerBar,backgroundColor:t===DN.CORRECT?nn:"white",justifyContent:t!==DN.CORRECT||s?"space-between":"center"},r={...FN.button,backgroundColor:t===DN.ACTIVE||t===DN.CORRECT?Jt:sn},o={...FN.text,color:t===DN.CORRECT?Jt:on},a=t===DN.INCORRECT?Object($t.jsxs)("span",{style:o,children:[Object($t.jsx)("span",{style:FN.tryAgainIcon,children:Object($t.jsx)(RN,{...Sa})}),Object($t.jsx)("span",{style:{marginLeft:8},children:i18n._("Keep trying")})]}):Object($t.jsx)("span",{});if(t!==DN.CORRECT){const s=t===DN.INCORRECT?i18n._("Try again"):i18n._("Check");return Object($t.jsxs)("div",{style:i,children:[a,Object($t.jsx)("button",{style:r,disabled:e.readOnly||t!==DN.ACTIVE,onClick:n,children:s})]})}return Object($t.jsxs)("div",{style:i,children:[Object($t.jsxs)("span",{style:o,children:[Object($t.jsx)("span",{style:{fontSize:28,color:"#FFB300"},children:Object($t.jsx)(RN,{...Ca,style:{marginBottom:5}})}),Object($t.jsx)("span",{style:{marginLeft:8},children:i18n._("Correct!")})]}),s&&Object($t.jsx)("button",{style:r,onClick:s,children:i18n._("Next question")})]})}}),FN={answerBar:{display:"flex",alignItems:"center",height:68,marginLeft:wn,marginRight:wn,marginBottom:wn,marginTop:jn,paddingLeft:jn,paddingRight:10,borderTop:`1px solid ${rn}`},button:{height:48,width:143,borderRadius:4,color:"white",fontFamily:Zt,fontSize:17,border:"none"},tryAgainIcon:{fontSize:28,color:"#63D9EA",transform:"scale(-1,1) rotate(-268deg)"},text:{display:"flex",flexDirection:"row",alignItems:"center",fontFamily:Zt,fontSize:17}};LN.ANSWER_BAR_STATES=DN,AN.exports=LN;var zN=AN.exports,qN={exports:{}};qN.exports;const WN=v.a,BN=(h.a,x.b),VN=Is.Options,HN=mu,UN=Kt,GN=gh,$N=zN,YN="ungraded",KN="correct",XN="incorrect",ZN="invalid",JN=$N.ANSWER_BAR_STATES,QN=(e,t)=>{switch(e){case JN.HIDDEN:return t?JN.ACTIVE:e;case JN.ACTIVE:return t?e:JN.INACTIVE;case JN.INACTIVE:return t?JN.ACTIVE:e;case JN.INCORRECT:return t?JN.ACTIVE:JN.INACTIVE;default:return e}},eP="We couldn't grade your answer.",tP=createReactClass({displayName:"GradedGroup",getDefaultProps:function(){return{title:"",content:"",widgets:{},images:{},hint:null,hasHint:!1,linterContext:je}},getInitialState:function(){return{status:YN,showHint:!1,message:"",answerBarState:JN.HIDDEN}},shouldComponentUpdate:function(e,t){return e!==this.props||t!==this.state},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return HN.change.apply(this,t)},_onInteractWithWidget:function(e){if(this.setState({status:YN,message:""}),this.refs.renderer){this.change("widgets",this.props.widgets);const e=0===this.refs.renderer.emptyWidgets().length,t=this.state.answerBarState;this.setState({answerBarState:QN(t,e)})}},_checkAnswer:function(){this.refs.renderer.showRationalesForCurrentlySelectedChoices();const e=this.refs.renderer.score();let t,n;"points"===e.type?(t=e.total===e.earned?KN:XN,n=e.message||""):(t=ZN,n=e.message?`${eP} ${e.message}`:`${eP} It looks like you left something blank or entered in an invalid answer.`),this.setState({status:t,message:n,answerBarState:"correct"===t?JN.CORRECT:JN.INCORRECT}),this.props.trackInteraction({status:t})},getInputPaths:function(){return this.refs.renderer.getInputPaths()},setInputValue:function(e,t,n){return this.refs.renderer.setInputValue(e,t,n)},getAcceptableFormatsForInputPath:function(e){return this.refs.renderer.getAcceptableFormatsForInputPath(e)},focus:function(){return this.refs.renderer.focus()},focusInputPath:function(e){this.refs.renderer.focusPath(e)},blurInputPath:function(e){this.refs.renderer.blurPath(e)},render:function(){const e=BN.extend({},VN.defaults,this.props.apiOptions,{onFocusChange:(e,t)=>{t&&this.props.onBlur(t),e&&this.props.onFocus(e)}});let t=null;this.state.status===KN?t=Object($t.jsx)(UN,{...ja,style:{color:"#526f03"}}):this.state.status===XN&&(t=Object($t.jsx)(UN,{...Oa,style:{color:"#ff5454"}}));const n=this.props.inGradedGroupSet?Object(Nn.css)(nP.gradedGroupInSet):Object(Nn.css)(nP.gradedGroup),s=WN({[n]:e.isMobile,"perseus-graded-group":!0,"answer-correct":!e.isMobile&&this.state.status===KN,"answer-incorrect":!e.isMobile&&this.state.status===XN}),{answerBarState:i}=this.state,r=i===JN.CORRECT,o=e.readOnly||e.isMobile&&r;return Object($t.jsxs)("div",{className:s,children:[!!this.props.title&&Object($t.jsx)("div",{className:Object(Nn.css)(nP.title),children:this.props.title}),Object($t.jsx)(GN,{...this.props,ref:"renderer",apiOptions:{...e,readOnly:o},onInteractWithWidget:this._onInteractWithWidget,linterContext:this.props.linterContext}),!e.isMobile&&t&&Object($t.jsx)("div",{className:"group-icon",children:t}),!e.isMobile&&Object($t.jsx)("p",{children:this.state.message}),!e.isMobile&&Object($t.jsx)("input",{type:"button",value:i18n._("Check"),className:"simple-button",disabled:this.props.apiOptions.readOnly,onClick:this._checkAnswer}),!e.isMobile&&r&&this.props.onNextQuestion&&Object($t.jsx)("input",{type:"button",value:i18n._("Next question"),className:"simple-button",disabled:this.props.apiOptions.readOnly,onClick:this.props.onNextQuestion,style:{marginLeft:5}}),this.props.hint&&this.props.hint.content&&(this.state.showHint?Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:Object(Nn.css)(nP.explanationTitle),onClick:()=>this.setState({showHint:!1}),children:i18n._("Hide explanation")}),Object($t.jsx)(GN,{...this.props.hint,ref:"hints-renderer",apiOptions:e,linterContext:this.props.linterContext})]}):Object($t.jsx)("div",{onClick:()=>this.setState({showHint:!0}),className:Object(Nn.css)(nP.showHintLink),children:i18n._("Explain")})),e.isMobile&&i!==JN.HIDDEN&&Object($t.jsx)($N,{apiOptions:e,answerBarState:i,onCheckAnswer:this._checkAnswer,onNextQuestion:this.props.onNextQuestion})]})}});qN.exports={name:"graded-group",displayName:"Graded group (articles only)",widget:tP,traverseChildWidgets:function(e,t){return BN.extend({},e,t(e))},hidden:!1,tracking:"all",isLintable:!0};const nP=Nn.StyleSheet.create({gradedGroupInSet:{marginLeft:0,paddingLeft:0},gradedGroup:{borderTop:`1px solid ${rn}`,borderBottom:`1px solid ${rn}`,backgroundColor:fn,marginLeft:wn,marginRight:wn,paddingBottom:jn,paddingLeft:jn,paddingRight:jn,paddingTop:10,width:"auto"},showHintLink:{marginTop:20,color:Jt,cursor:"pointer"},explanationTitle:{marginTop:20,color:Jt,marginBottom:10,cursor:"pointer"},title:{fontSize:12,color:rn,textTransform:"uppercase",marginBottom:11,letterSpacing:.8}});var sP=qN.exports,iP={exports:{}};iP.exports;h.a,x.b;const rP=mu,oP=sP.widget,aP=createReactClass({displayName:"Indicators",render(){const e=[];for(let t=0;t<this.props.numGroups;t++)e.push(Object($t.jsx)("div",{className:Object(Nn.css)(cP.indicator,t===this.props.currentGroup&&cP.selectedIndicator),onClick:()=>this.props.onChangeCurrentGroup(t)},t));return Object($t.jsx)("div",{className:Object(Nn.css)(cP.indicatorContainer),children:e})}}),lP=createReactClass({displayName:"GradedGroupSet",getDefaultProps:()=>({gradedGroups:[],linterContext:je}),getInitialState:()=>({currentGroup:0}),shouldComponentUpdate(e,t){return e!==this.props||t!==this.state},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return rP.change.apply(this,t)},getInputPaths(){return this._childGroup.getInputPaths()},setInputValue(e,t,n){return this._childGroup.setInputValue(e,t,n)},getAcceptableFormatsForInputPath(e){return this._childGroup.getAcceptableFormatsForInputPath(e)},focus(){return this._childGroup.focus()},focusInputPath(e){this._childGroup.focusInputPath(e)},blurInputPath(e){this._childGroup.blurInputPath(e)},handleNextQuestion(){const{currentGroup:e}=this.state;e<this.props.gradedGroups.length-1&&this.setState({currentGroup:e+1})},render(){const e=this.props.gradedGroups[this.state.currentGroup];if(!e)return Object($t.jsx)("span",{children:"No current group..."});const t=this.props.gradedGroups.length,n=this.state.currentGroup<t-1?this.handleNextQuestion:null;return Object($t.jsxs)("div",{className:Object(Nn.css)(cP.container),children:[Object($t.jsxs)("div",{className:Object(Nn.css)(cP.top),children:[Object($t.jsx)("div",{className:Object(Nn.css)(cP.title),children:e.title}),Object($t.jsx)("div",{className:Object(Nn.css)(cP.spacer)}),Object($t.jsx)(aP,{numGroups:t,currentGroup:this.state.currentGroup,onChangeCurrentGroup:e=>this.setState({currentGroup:e})})]}),Object($t.jsx)(oP,{ref:e=>this._childGroup=e,...this.props,...e,inGradedGroupSet:!0,title:null,onNextQuestion:n,linterContext:this.props.linterContext},this.state.currentGroup)]})}});iP.exports={name:"graded-group-set",displayName:"Graded group set (articles only)",widget:lP,traverseChildWidgets:function(e,t){return{groups:e.gradedGroups.map(t)}},hidden:!1,tracking:"all",isLintable:!0};const cP=Nn.StyleSheet.create({top:{display:"flex",flexDirection:"row"},spacer:{flex:1},title:{fontSize:12,color:rn,textTransform:"uppercase",marginBottom:11,letterSpacing:.8},indicatorContainer:{display:"flex",flexDirection:"row"},indicator:{width:10,height:10,borderRadius:5,backgroundColor:"#AAAAAA",marginLeft:5,cursor:"pointer"},selectedIndicator:{backgroundColor:Jt},container:{borderTop:`1px solid ${rn}`,borderBottom:`1px solid ${rn}`,backgroundColor:fn,marginLeft:wn,marginRight:wn,paddingBottom:jn,paddingLeft:jn,paddingRight:jn,paddingTop:10,width:"auto"}});var hP=iP.exports;const pP=x.b,uP=ce,dP=hc,gP=dP.Plot,fP=G.a.point,mP={url:null};function bP(e){var t=e[0],n=e[1],s=e[2],i=e[3];t<0&&(t*=-1,n*=-1,s*=-1);var r=2*Math.PI;for(n<0&&(n*=-1,s*=-1,s+=r/2);s>0;)s-=r;for(;s<0;)s+=r;return[t,n,s,i]}function vP(e){var t=e[0],n=e[1],s=e[2],i=e[3];t<0&&(t*=-1,n*=-1,s*=-1);var r=Math.PI;for(n<0&&(n*=-1,s*=-1,s+=r/2);s>0;)s-=r;for(;s<0;)s+=r;return[t,n,s,i]}var xP={areEqual:function(e,t){return uP.deepEq(e,t)},Movable:gP,getPropsForCoeffs:function(e){return{fn:pP.partial(this.getFunctionForCoeffs,e)}}},yP=pP.extend({},xP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/67aaf581e6d9ef9038c10558a1f70ac21c11c9f8.png",defaultCoords:[[.25,.75],[.75,.75]],getCoefficients:function(e){var t=e[0],n=e[1],s=n[0]-t[0],i=n[1]-t[1];if(0!==s){var r=i/s;return[r,n[1]-r*n[0]]}},getFunctionForCoeffs:function(e,t){return e[0]*t+e[1]},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],s=t[1];return"y = "+n.toFixed(3)+"x + "+s.toFixed(3)}}),jP=pP.extend({},xP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/e23d36e6fc29ee37174e92c9daba2a66677128ab.png",defaultCoords:[[.5,.5],[.75,.75]],Movable:dP.Parabola,getCoefficients:function(e){var t=e[0],n=e[1],s=t[0],i=t[1],r=(n[1]-i)/((n[0]-s)*(n[0]-s));return[r,-2*s*r,r*s*s+i]},getFunctionForCoeffs:function(e,t){return(e[0]*t+e[1])*t+e[2]},getPropsForCoeffs:function(e){return{a:e[0],b:e[1],c:e[2]}},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],s=t[1],i=t[2];return"y = "+n.toFixed(3)+"x^2 + "+s.toFixed(3)+"x + "+i.toFixed(3)}}),wP=pP.extend({},xP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/3d68e7718498475f53b206c2ab285626baf8857e.png",defaultCoords:[[.5,.5],[.6,.6]],Movable:dP.Sinusoid,getCoefficients:function(e){var t=e[0],n=e[1],s=n[1]-t[1],i=Math.PI/(2*(n[0]-t[0]));return[s,i,t[0]*i,t[1]]},getFunctionForCoeffs:function(e,t){var n=e[0],s=e[1],i=e[2],r=e[3];return n*Math.sin(s*t-i)+r},getPropsForCoeffs:function(e){return{a:e[0],b:e[1],c:e[2],d:e[3]}},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],s=t[1],i=t[2],r=t[3];return"y = "+n.toFixed(3)+" sin("+s.toFixed(3)+"x - "+i.toFixed(3)+") + "+r.toFixed(3)},areEqual:function(e,t){return uP.deepEq(bP(e),bP(t))}}),OP=pP.extend({},xP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/7db80d23c35214f98659fe1cf0765811c1bbfbba.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(e){var t=e[0],n=e[1],s=n[1]-t[1],i=Math.PI/(4*(n[0]-t[0]));return[s,i,t[0]*i,t[1]]},getFunctionForCoeffs:function(e,t){var n=e[0],s=e[1],i=e[2],r=e[3];return n*Math.tan(s*t-i)+r},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],s=t[1],i=t[2],r=t[3];return"y = "+n.toFixed(3)+" sin("+s.toFixed(3)+"x - "+i.toFixed(3)+") + "+r.toFixed(3)},areEqual:function(e,t){return uP.deepEq(vP(e),vP(t))}}),CP=pP.extend({},xP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/9cbfad55525e3ce755a31a631b074670a5dad611.png",defaultCoords:[[.5,.55],[.75,.75]],defaultAsymptote:[[0,.5],[1,.5]],extraCoordConstraint:function(e,t,n,s,i){var r=pP.head(s)[1];return pP.all(n,(e=>e[1]!==r))},extraAsymptoteConstraint:function(e,t,n,s,i){var r=e[1];if(pP.all(n,(e=>e[1]>r))||pP.all(n,(e=>e[1]<r)))return[t[0],r];var o=t[1];if(pP.all(n,(e=>e[1]>o))){var a=pP.min(pP.map(n,(e=>e[1])));return[t[0],a-i.snapStep[1]]}var l=pP.max(pP.map(n,(e=>e[1])));return[t[0],l+i.snapStep[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(e,t){var n=e[0],s=e[1],i=pP.head(t)[1],r=Math.log((n[1]-i)/(s[1]-i))/(n[0]-s[0]);return[(n[1]-i)/Math.exp(r*n[0]),r,i]},getFunctionForCoeffs:function(e,t){var n=e[0],s=e[1],i=e[2];return n*Math.exp(s*t)+i},getEquationString:function(e,t){if(!t)return null;var n=this.getCoefficients(e,t),s=n[0],i=n[1],r=n[2];return"y = "+s.toFixed(3)+"e^("+i.toFixed(3)+"x) + "+r.toFixed(3)}}),SP=pP.extend({},xP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/f6491e99d34af34d924bfe0231728ad912068dc3.png",defaultCoords:[[.55,.5],[.75,.75]],defaultAsymptote:[[.5,0],[.5,1]],extraCoordConstraint:function(e,t,n,s,i){var r=pP.head(s)[0];return pP.all(n,(e=>e[0]!==r))&&n[0][1]!==n[1][1]},extraAsymptoteConstraint:function(e,t,n,s,i){var r=e[0];if(pP.all(n,(e=>e[0]>r))||pP.all(n,(e=>e[0]<r)))return[r,t[1]];var o=t[0];return pP.all(n,(e=>e[0]>o))?[pP.min(pP.map(n,(e=>e[0])))-i.snapStep[0],t[1]]:[pP.max(pP.map(n,(e=>e[0])))+i.snapStep[0],t[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(e,t){var n=e=>[e[1],e[0]],s=CP.getCoefficients(pP.map(e,n),pP.map(t,n)),i=-s[2]/s[0],r=1/s[0];return[1/s[1],r,i]},getFunctionForCoeffs:function(e,t,n){var s=e[0],i=e[1],r=e[2];return s*Math.log(i*t+r)},getEquationString:function(e,t){if(!t)return null;var n=this.getCoefficients(e,t),s=n[0],i=n[1],r=n[2];return"y = ln("+s.toFixed(3)+"x + "+i.toFixed(3)+") + "+r.toFixed(3)}}),kP=pP.extend({},xP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/8256a630175a0cb1d11de223d6de0266daf98721.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(e){var t=e[0],n=e[1],s=n[0]-t[0],i=n[1]-t[1];if(0!==s){var r=Math.abs(i/s);return n[1]<t[1]&&(r*=-1),[r,t[0],t[1]]}},getFunctionForCoeffs:function(e,t){var n=e[0],s=e[1],i=e[2];return n*Math.abs(t-s)+i},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],s=t[1],i=t[2];return"y = "+n.toFixed(3)+"| x - "+s.toFixed(3)+"| + "+i.toFixed(3)}}),_P={linear:yP,quadratic:jP,sinusoid:wP,tangent:OP,exponential:CP,logarithm:SP,absolute_value:kP},TP=pP.keys(_P);function MP(e){return _P[e]}var NP={validate:function(e,t){if(e.type!==t.correct.type)return{type:"points",earned:0,total:1,message:null};if(null==e.coords)return{type:"invalid",message:null};var n=MP(e.type),s=n.getCoefficients(e.coords,e.asymptote),i=n.getCoefficients(t.correct.coords,t.correct.asymptote);return null==s||null==i?{type:"invalid",message:null}:n.areEqual(s,i)?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}},getEquationString:function(e){var t=e.plot;return t.type&&t.coords&&MP(t.type).getEquationString(t.coords,t.asymptote)||""},pointsFromNormalized:function(e,t,n,s){return pP.map(e,(function(e){var i=pP.map(e,(function(e,s){var i=t[s],r=n[s],o=function(e,t){return Math.floor((e[1]-e[0])/t)}(i,r),a=Math.round(e*o);return i[0]+r*a}));return fP.roundTo(i,s)}))},maybePointsFromNormalized:function(e,t,n,s){return e?this.pointsFromNormalized(e,t,n,s):e},defaultPlotProps:function(e,t){var n=MP(e),s=uP.snapStepFromGridStep([1,1]);return{type:e,asymptote:this.maybePointsFromNormalized(n.defaultAsymptote,t.range,t.step,s),coords:null}},chooseType:pP.first,getGridAndSnapSteps:function(e,t){var n=e.gridStep||uP.getGridStep(e.range,e.step,t);return{gridStep:n,snapStep:e.snapStep||uP.snapStepFromGridStep(n)}}},PP={};function IP(e){var t=e.charAt(0).toUpperCase()+e.substring(1);return{value:e,title:t,content:Object($t.jsx)("img",{src:MP(e).url,alt:t})}}PP.graph={labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],backgroundImage:mP,markings:"graph",rulerLabel:"",rulerTicks:10,valid:!0,showTooltips:!1},PP.plot=NP.defaultPlotProps("linear",PP.graph),PP.availableTypes=[PP.plot.type];var EP={exports:{}},AP=(EP.exports,h.a,x.b),RP=Cl,DP=Ic,LP=ce,FP=Vf.a,zP=hc,qP=zP.MovablePoint,WP=zP.MovableLine;const BP=rr;var VP=G.a.number,HP=G.a.vector,UP=G.a.point;const GP=Di;var $P=mu;var YP={padding:"5px 5px"},KP=createReactClass({displayName:"FunctionGrapher",_coords:function(e){var t=(e=e||this.props).graph,n=e.model&&NP.maybePointsFromNormalized(e.model.defaultCoords,t.range,t.step,t.snapStep);return e.coords||n||null},_asymptote:function(e){return(e=e||this.props).asymptote},getDefaultProps:function(){return{graph:{range:[[-10,10],[-10,10]],step:[1,1]},coords:null,asymptote:null,isMobile:!1}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return $P.change.apply(this,t)},render:function(){var e=AP.map(this._coords(),((e,t)=>Object($t.jsx)(qP,{coord:e,static:this.props.static,constraints:[RP.MovablePoint.constraints.bound(),RP.MovablePoint.constraints.snap(),e=>{var n=AP.all(this._coords(),((n,s)=>t===s||!n||!VP.equal(e[0],n[0])));if(!n)return!1;if(this.props.model&&this.props.model.extraCoordConstraint){var s=this.props.model.extraCoordConstraint,i=AP.clone(this._coords()),r=AP.clone(i[t]);return i[t]=e,s(e,r,i,this._asymptote(),this.props.graph)}return n}],onMove:(e,n)=>{var s,i=this._asymptote();s=i&&this.props.model.allowReflectOverAsymptote&&function(e,t,n){var s=(e,t,n)=>(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1]);return s(n[0],n[1],t)>0!==s(n[0],n[1],e)>0}(e,n,i)?AP.map(this._coords(),(e=>UP.reflectOverLine(e,i))):AP.clone(this._coords()),s[t]=e,this.props.onChange({coords:s})},showHairlines:this.props.showHairlines,hideHairlines:this.props.hideHairlines,showTooltips:this.props.showTooltips,isMobile:this.props.isMobile},t))),t=this.props.graph.box,n=this.props.graph.backgroundImage,s=null;if(n.url){var i=t[0]/Cn;s=Object($t.jsx)(DP,{src:n.url,width:n.width,height:n.height,scale:i})}return Object($t.jsx)("div",{className:"perseus-widget perseus-widget-grapher",style:{width:t[0],height:this.props.flexibleType?"auto":t[1],boxSizing:"initial"},children:Object($t.jsxs)("div",{className:"graphie-container above-scratchpad",style:{width:t[0],height:t[1]},children:[s,Object($t.jsxs)(zP,{...this.props.graph,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable,children:[this.props.model&&this.renderPlot(),this.props.model&&this.renderAsymptote(),this.props.model&&e]})]})})},renderPlot:function(){var e=this.props.model,t=this.props.graph.range[0],n={stroke:this.props.isMobile?GP.BLUE_C:GP.DYNAMIC,...this.props.isMobile?{"stroke-width":3}:{}},s=e.getCoefficients(this._coords(),this._asymptote());if(s){var i=e.getPropsForCoeffs(s,t);return Object(c.createElement)(e.Movable,{...i,key:this.props.model.url,range:t,style:n})}},renderAsymptote:function(){var e=this.props.model,t=this.props.graph,n=this._asymptote(),s={strokeDasharray:"- "};return n&&Object($t.jsx)(WP,{onMove:(e,t)=>{var n=HP.subtract(e,t),s=AP.map(this._asymptote(),(e=>HP.add(e,n)));this.props.onChange({asymptote:s})},constraints:[RP.MovableLine.constraints.bound(),RP.MovableLine.constraints.snap(),(n,s)=>{var i=HP.subtract(n,s),r=AP.map(this._asymptote(),(e=>HP.add(e,i)));return!e.extraAsymptoteConstraint||e.extraAsymptoteConstraint(n,s,this._coords(),r,t)}],normalStyle:s,highlightStyle:s,children:AP.map(n,((e,t)=>Object($t.jsx)(qP,{coord:e,static:!0,draw:null,extendLine:!0,showHairlines:this.props.showHairlines,hideHairlines:this.props.hideHairlines,showTooltips:this.props.showTooltips,isMobile:this.props.isMobile},`asymptoteCoord-${t}`)))})}}),XP=createReactClass({displayName:"Grapher",getDefaultProps:function(){return PP},render:function(){var e=this.props.plot.type,t=this.props.plot.coords,n=this.props.plot.asymptote,s=Object($t.jsx)("div",{style:YP,className:"above-scratchpad",children:Object($t.jsx)(FP,{value:e,allowEmpty:!0,buttons:AP.map(this.props.availableTypes,IP),onChange:this.handleActiveTypeChange})});const i=Gs(this.props.containerSizeClass),r={...this.props.graph,...NP.getGridAndSnapSteps(this.props.graph,i[0]),gridConfig:this._getGridConfig({...this.props.graph,box:i,...NP.getGridAndSnapSteps(this.props.graph,i[0])})};var o={graph:{box:i,range:r.range,step:r.step,snapStep:r.snapStep,backgroundImage:r.backgroundImage,options:r,setup:this._setupGraphie},onChange:this.handlePlotChanges,model:e&&MP(e),coords:t,asymptote:n,static:this.props.static,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,isMobile:this.props.apiOptions.isMobile,showTooltips:this.props.graph.showTooltips,showHairlines:this.showHairlines,hideHairlines:this.hideHairlines};return Object($t.jsxs)("div",{children:[Object($t.jsx)(KP,{...o}),this.props.availableTypes.length>1&&s]})},handlePlotChanges:function(e){var t=AP.extend({},this.props.plot,e);this.props.onChange({plot:t}),this.props.trackInteraction()},handleActiveTypeChange:function(e){var t=this.props.graph,n=AP.extend({},this.props.plot,NP.defaultPlotProps(e,t));this.props.onChange({plot:n})},_getGridConfig:function(e){return AP.map(e.step,(function(t,n){return LP.gridDimensionConfig(t,e.range[n],e.box[n],e.gridStep[n])}))},_calculateMobileTickStep(e,t,n){const s=LP.constrainedTickStepsFromTickSteps(t,n);return s[0]=s[0]/e[0],s[1]=s[1]/e[1],s},_setupGraphie:function(e,t){const n=this.props.apiOptions.isMobile;if("graph"===t.markings?(e.graphInit({range:t.range,scale:AP.pluck(t.gridConfig,"scale"),axisArrows:"<->",labelFormat:function(e){return"\\small{"+e+"}"},gridStep:t.gridStep,snapStep:t.snapStep,tickStep:n?this._calculateMobileTickStep(t.gridStep,t.step,t.range):AP.pluck(t.gridConfig,"tickStep"),labelStep:1,unityLabels:AP.pluck(t.gridConfig,"unityLabel"),isMobile:n}),e.label([0,t.range[1][1]],t.labels[1],n?"below right":"above"),e.label([t.range[0][1],0],t.labels[0],n?"above left":"right")):"grid"===t.markings?e.graphInit({range:t.range,scale:AP.pluck(t.gridConfig,"scale"),gridStep:t.gridStep,axes:!1,ticks:!1,labels:!1,isMobile:n}):"none"===t.markings&&e.init({range:t.range,scale:AP.pluck(t.gridConfig,"scale")}),this.props.apiOptions.isMobile){const t={normalStyle:{strokeWidth:1}};this.horizHairline=new BP(e,[0,0],[0,0],t),this.horizHairline.attr({stroke:GP.INTERACTIVE}),this.horizHairline.hide(),this.vertHairline=new BP(e,[0,0],[0,0],t),this.vertHairline.attr({stroke:GP.INTERACTIVE}),this.vertHairline.hide()}},showHairlines:function(e){this.props.apiOptions.isMobile&&"none"!==this.props.markings&&(this.horizHairline.moveTo([this.props.graph.range[0][0],e[1]],[this.props.graph.range[0][1],e[1]]),this.horizHairline.show(),this.vertHairline.moveTo([e[0],this.props.graph.range[1][0]],[e[0],this.props.graph.range[1][1]]),this.vertHairline.show())},hideHairlines:function(){this.props.apiOptions.isMobile&&(this.horizHairline.hide(),this.vertHairline.hide())},simpleValidate:function(e){return NP.validate(this.getUserInput(),e)},getUserInput:function(){return this.props.plot},focus:$.noop}),ZP=e=>{var t={availableTypes:e.availableTypes,graph:e.graph};if(1===t.availableTypes.length){var n=t.graph,s=NP.chooseType(t.availableTypes);t.plot=NP.defaultPlotProps(s,n)}return t};EP.exports={name:"grapher",displayName:"Grapher",widget:XP,transform:ZP,staticTransform:e=>AP.extend({},ZP(e),{availableTypes:[e.correct.type],plot:e.correct})};var JP=EP.exports,QP=n(61),eI={exports:{}};eI.exports;h.a;const tI=x.b,nI=mu,sI=sm,iI=cd,rI=QP.a,oI=JP.widget,aI=createReactClass({displayName:"GrapherEditor",getDefaultProps:function(){return{correct:PP.plot,graph:PP.graph,availableTypes:PP.availableTypes}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return nI.change.apply(this,t)},render:function(){const e=Us.SMALL;let t,n;if(!0===this.props.graph.valid){var s={graph:this.props.graph,plot:this.props.correct,availableTypes:this.props.availableTypes,onChange:(e,t)=>{var n=this.props.correct;n=n.type===e.plot.type?tI.extend({},n,e.plot):e.plot,this.props.onChange({correct:n},t)},trackInteraction:function(){}};n=Object($t.jsx)(oI,{...s,apiOptions:this.props.apiOptions,containerSizeClass:e}),t=NP.getEquationString(s)}else n=Object($t.jsx)("div",{className:"perseus-error",children:this.props.graph.valid});return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{children:["Correct answer"," ",Object($t.jsx)(iI,{children:Object($t.jsx)("p",{children:"Graph the correct answer in the graph below and ensure the equation or point coordinates displayed represent the correct answer."})})," ",": ",t]}),Object($t.jsx)(sI,{editableSettings:["graph","snap","image"],box:Gs(e),range:this.props.graph.range,labels:this.props.graph.labels,step:this.props.graph.step,gridStep:this.props.graph.gridStep,snapStep:this.props.graph.snapStep,valid:this.props.graph.valid,backgroundImage:this.props.graph.backgroundImage,markings:this.props.graph.markings,rulerLabel:this.props.graph.rulerLabel,rulerTicks:this.props.graph.rulerTicks,showTooltips:this.props.graph.showTooltips,onChange:this.change("graph")}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("label",{children:"Available functions:  "}),Object($t.jsx)(rI,{allowEmpty:!1,values:this.props.availableTypes,buttons:tI.map(TP,IP),onChange:this.handleAvailableTypesChange})]}),n]})},handleAvailableTypesChange:function(e){var t=this.props.correct;if(!tI.contains(e,this.props.correct.type)){var n=this.props.graph,s=NP.chooseType(e);t=NP.defaultPlotProps(s,n)}this.props.onChange({availableTypes:e,correct:t})},serialize:function(){return tI.chain(this.props).pick("correct","availableTypes").extend({graph:tI.omit(this.props.graph,"box")}).value()}});eI.exports=aI;var lI=eI.exports,cI={exports:{}};cI.exports;h.a;const hI=x.b,pI=mu,uI=pu,dI=lv,gI=$x,fI=createReactClass({displayName:"DefinitionEditor",getDefaultProps:function(){return{togglePrompt:"",definition:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return pI.change.apply(this,t)},serialize(){return uI.serialize.call(this)},render:function(){return Object($t.jsxs)("div",{className:"perseus-widget-definition-editor",children:[Object($t.jsx)("a",{href:"https://docs.google.com/document/d/1udaPef4imOfTMhmLDlWq4SM0mxL0r3YHFZE-5J1uGfo",target:"_blank",children:"Definition style guide"}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{children:["Word to be defined:"," ",Object($t.jsx)(gI,{value:this.props.togglePrompt,onChange:this.change("togglePrompt"),placeholder:"define me"})]})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(dI,{apiOptions:this.props.apiOptions,content:this.props.definition,widgetEnabled:!1,placeholder:"definition goes here",onChange:e=>{const t={};hI.has(e,"content")&&(t.definition=e.content),this.change(t)}})})]})}});cI.exports=fI;var mI=cI.exports,bI={exports:{}};bI.exports;h.a;const vI=x.b,xI=mu,yI=gh,jI=mh,wI=createReactClass({displayName:"Definition",getDefaultProps:function(){return{togglePrompt:"define me",definition:"definition goes here"}},getInitialState:function(){return{expanded:!1,belowScreen:!1,contentOffsetLeft:0,contentOffsetLeftMobile:0,contentWidth:0,contentWidthMobile:0,contentMarginTop:TI}},componentDidMount:function(){document.addEventListener("click",this.handleClick)},componentWillUnmount:function(){document.removeEventListener("click",this.handleClick)},handleClick:function(e){let t=e.target,n=!0;for(;t;){if(t===this.content||t===this.container){n=!1;break}t=t.parentNode}n&&this.close()},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return xI.change.apply(this,t)},close:function(){this.setState({expanded:!1})},getUserInput:function(){return{}},simpleValidate:function(e){return wI.validate(this.getUserInput(),e)},_definitionBelowScreen:function(){const e=window.innerHeight;return this.container.getBoundingClientRect().bottom>e-this.content.offsetHeight},_checkDefinitionPosition:function(){setTimeout((()=>{this._positionContentHorizontally(),this._definitionBelowScreen()?this.setState({belowScreen:!0},this._positionContentVertically):this.setState({belowScreen:!1},this._positionContentVertically)}),0)},_positionContentVertically:function(){if(this.state.belowScreen){const e=-this.content.offsetHeight-2*TI-4;this.setState({contentMarginTop:e})}else this.setState({contentMarginTop:TI})},_onClick:function(){if(!this.state.expanded){const e=this.props.findWidgets("definition");for(const t of e)t!==this&&t.close()}this.setState({expanded:!this.state.expanded},this._checkDefinitionPosition),this.props.trackInteraction()},_onMouseOver:function(){this.setState({expanded:!0},this._checkDefinitionPosition),this.props.trackInteraction()},_onMouseOut:function(){this.setState({expanded:!1}),this.props.trackInteraction()},_positionContentHorizontally:function(){const e=document.body.clientWidth,t=this.container.parentElement.parentElement.offsetLeft,n=e-2*t,s=e-t,i=this.container.offsetLeft-t,r=this.container.offsetLeft;this.setState({contentWidth:n,contentWidthMobile:s,contentOffsetLeft:-i,contentOffsetLeftMobile:-r})},render:function(){const{readOnly:e,isMobile:t}=this.props.apiOptions,n=this.props.togglePrompt;let s;const i=e?null:"javascript:void(0)",r=e?null:this._onClick,o=this._onMouseOver,a=this._onMouseOut;s=t?Object($t.jsx)("a",{className:Object(Nn.css)(NI.mobileDefinitionLink),href:i,onClick:r,children:n}):Object($t.jsx)("a",{className:Object(Nn.css)(NI.definitionLink),href:i,onMouseOver:o,onMouseOut:a,children:n});const l=t?NI.contentExpandedMobile:NI.contentExpanded,c=this.state.belowScreen?"scale(1, -1)":"scale(1, 1)";return Object($t.jsxs)("div",{className:Object(Nn.css)(NI.container),ref:e=>this.container=e,children:[Object($t.jsxs)("div",{className:Object(Nn.css)(NI.linkContainer),children:[s,this.state.expanded&&Object($t.jsxs)("svg",{className:Object(Nn.css)(NI.disclosureArrow),ref:e=>this.arrow=e,transform:c,style:{bottom:this.state.expanded&&this.state.belowScreen?"18px":"-18px"},children:[Object($t.jsxs)("filter",{id:"definition-widget-dropshadow",height:"150%",children:[Object($t.jsx)("feOffset",{dx:OI,dy:CI,result:"offsetblur"}),Object($t.jsx)("feGaussianBlur",{in:"SourceAlpha",stdDeviation:kI/2}),Object($t.jsx)("feComponentTransfer",{children:Object($t.jsx)("feFuncA",{type:"linear",slope:SI})}),Object($t.jsxs)("feMerge",{children:[Object($t.jsx)("feMergeNode",{}),Object($t.jsx)("feMergeNode",{in:"SourceGraphic"})]})]}),Object($t.jsx)("polyline",{fill:"white",filter:"url(#definition-widget-dropshadow)",points:`0,${TI} ${_I},${TI} `+_I/2+",0"})]})]}),Object($t.jsx)("div",{className:Object(Nn.css)(NI.content,t&&NI.contentMobile,this.state.expanded&&l),style:{height:this.state.expanded?"auto":0,overflow:this.state.expanded?"visible":"hidden",left:t?this.state.contentOffsetLeftMobile:this.state.contentOffsetLeft,width:t?this.state.contentWidthMobile:this.state.contentWidth,marginTop:this.state.contentMarginTop},ref:e=>this.content=e,children:Object($t.jsx)(yI,{apiOptions:this.props.apiOptions,content:this.props.definition,widgets:this.props.widgets})})]})}}),OI=0,CI=1,SI=.35,kI=4,_I=20,TI=14,MI=tn,NI=Nn.StyleSheet.create({container:{display:"inline",position:"relative"},linkContainer:{display:"inline-block"},definitionLink:{color:Qt,borderBottom:`dashed 1px ${Qt}`,textDecoration:"none"},mobileDefinitionLink:{color:Jt,borderBottom:`dashed 1px ${Jt}`,textDecoration:"none",[jI.xl]:{fontSize:22,lineHeight:1.4},[jI.lgOrSmaller]:{fontSize:20,lineHeight:1.5},[jI.smOrSmaller]:{fontSize:18,lineHeight:1.2}},content:{background:MI,opacity:.95,borderRadius:1,position:"absolute",transition:"margin-top 0.1s",paddingLeft:jn,paddingRight:jn,zIndex:2},contentExpanded:{boxShadow:`0px 0px 4px ${sn}`,border:`solid 0.5px ${sn}`},contentExpandedMobile:{paddingTop:32,paddingBottom:32,boxShadow:`0px 0px 4px ${sn}`,border:`solid 0.5px ${sn}`},disclosureArrow:{height:TI,left:"50%",marginLeft:-_I/2,position:"absolute",width:_I,zIndex:4}});vI.extend(wI,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),bI.exports={name:"definition",displayName:"Definition",defaultAlignment:"inline",widget:wI,transform:vI.identity};var PI=bI.exports,II={exports:{}},EI=(II.exports,h.a,x.b),AI=mu,RI=pu,DI=lv,LI=$x,FI={showPrompt:"Explain",hidePrompt:"Hide explanation",explanation:"explanation goes here\n\nmore explanation",widgets:{}},zI=createReactClass({displayName:"ExplanationEditor",getDefaultProps:function(){return FI},getInitialState:function(){return{}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return AI.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{className:"perseus-widget-explanation-editor",children:[Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{children:["Prompt to show explanation:"," ",Object($t.jsx)(LI,{value:this.props.showPrompt,onChange:this.change("showPrompt")})]})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{children:["Prompt to hide explanation:"," ",Object($t.jsx)(LI,{value:this.props.hidePrompt,onChange:this.change("hidePrompt")})]})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(DI,{apiOptions:this.props.apiOptions,content:this.props.explanation,widgets:this.props.widgets,widgetEnabled:!0,immutableWidgets:!1,onChange:e=>{var t={};EI.has(e,"content")&&(t.explanation=e.content),EI.has(e,"widgets")&&(t.widgets=e.widgets),this.change(t)}})})]})},serialize(){return RI.serialize.call(this)}});II.exports=zI;var qI=II.exports,WI={exports:{}};WI.exports;h.a;const BI=x.b,VI=mu,HI=gh,UI=mh,GI={showPrompt:"Explain",hidePrompt:"Hide explanation",explanation:"explanation goes here\n\nmore explanation",widgets:{},linterContext:je},$I=createReactClass({displayName:"Explanation",getDefaultProps:function(){return GI},getInitialState:function(){return{expanded:!1}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return VI.change.apply(this,t)},_onClick:function(){this.setState({expanded:!this.state.expanded}),this.props.trackInteraction()},render:function(){const{Link:e}=this.props.apiOptions.baseElements,{readOnly:t,isMobile:n}=this.props.apiOptions,s=this.state.expanded?this.props.hidePrompt:this.props.showPrompt;let i;const r=t?null:"javascript:void(0)",o=t?null:this._onClick;i=n?Object($t.jsxs)("div",{className:Object(Nn.css)(ZI.linkContainer),children:[Object($t.jsx)("a",{className:Object(Nn.css)(ZI.mobileExplanationLink),href:r,onClick:o,children:s}),this.state.expanded&&Object($t.jsx)("svg",{className:Object(Nn.css)(ZI.disclosureArrow),children:Object($t.jsx)("polygon",{style:{fill:XI},points:`0,${KI} ${YI},${KI} `+YI/2+",0"})})]}):Object($t.jsx)("div",{className:Object(Nn.css)(ZI.linkContainer),children:Object($t.jsx)(e,{className:Object(Nn.css)(ZI.explanationLink),href:r,onClick:o,children:`[${s}]`})});const a=n?ZI.contentExpandedMobile:ZI.contentExpanded;return Object($t.jsxs)("div",{className:Object(Nn.css)(ZI.container),children:[i,Object($t.jsx)("div",{className:Object(Nn.css)(ZI.content,n&&ZI.contentMobile,this.state.expanded&&a),style:{height:this.state.expanded?"auto":0,overflow:this.state.expanded?"visible":"hidden"},ref:"content",children:Object($t.jsx)(HI,{apiOptions:this.props.apiOptions,content:this.props.explanation,widgets:this.props.widgets,linterContext:this.props.linterContext})})]})},getUserInput:function(){return{}},simpleValidate:function(e){return $I.validate(this.getUserInput(),e)}}),YI=30,KI=14,XI=nn,ZI=Nn.StyleSheet.create({container:{display:"inline",position:"relative"},linkContainer:{display:"inline-block"},explanationLink:{fontStyle:"italic",color:"#007d96",[UI.xl]:{fontSize:20,lineHeight:1.1},[UI.lgOrSmaller]:{fontSize:17,lineHeight:1.4},[UI.smOrSmaller]:{fontSize:14,lineHeight:1.3}},mobileExplanationLink:{color:Jt,borderBottom:`dashed 1px ${Jt}`,textDecoration:"none",[UI.xl]:{fontSize:22,lineHeight:1.4},[UI.lgOrSmaller]:{fontSize:20,lineHeight:1.5},[UI.smOrSmaller]:{fontSize:18,lineHeight:1.2}},content:{position:"relative",transition:"margin-top 0.1s"},contentExpanded:{borderLeft:"5px solid #ccc",marginLeft:-23,paddingLeft:23,paddingBottom:10,marginBottom:KI,marginTop:KI},contentExpandedMobile:{boxSizing:"content-box",paddingTop:32,paddingBottom:32,marginTop:KI},contentMobile:{background:XI,marginLeft:wn,marginRight:wn,paddingLeft:jn,paddingRight:jn},disclosureArrow:{bottom:-(KI+5),height:KI,left:"50%",marginLeft:-YI/2,position:"absolute",width:YI}});BI.extend($I,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),WI.exports={name:"explanation",displayName:"Explanation",defaultAlignment:"inline",widget:$I,transform:BI.identity,isLintable:!0};var JI=WI.exports,QI={exports:{}},eE=(QI.exports,h.a,i.a),tE=x.b,nE=cd,sE=Kt,iE=pu,rE=createReactClass({displayName:"DropdownEditor",getDefaultProps:function(){return{placeholder:"",choices:[{content:"",correct:!1}]}},render:function(){var e=tE.uniqueId("perseus_dropdown_");return Object($t.jsxs)("div",{className:"perseus-widget-dropdown",children:[Object($t.jsxs)("div",{className:"dropdown-info",children:["Dropdown",Object($t.jsx)(nE,{children:Object($t.jsxs)("p",{children:["The drop down is useful for making inequalities in a custom format. We normally use the symbols ","<",","," ",">",', \u2264, \u2265 (in that order) which you can copy into the choices. When possible, use the "multiple choice" answer type instead.']})})]}),Object($t.jsxs)("div",{className:"dropdown-placeholder",children:[Object($t.jsx)("input",{type:"text",placeholder:"Placeholder value",value:this.props.placeholder,onChange:this.onPlaceholderChange}),Object($t.jsx)(nE,{children:Object($t.jsx)("p",{children:"This value will appear as the drop down default. It should give the user some indication of the values available in the drop down itself, e.g., Yes/No/Maybe."})})]}),Object($t.jsx)("div",{className:"clearfix"}),Object($t.jsx)("ul",{className:"dropdown-choices",children:this.props.choices.map((function(t,n){var s=t.correct?"correct":"incorrect";return Object($t.jsx)("li",{children:Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{ref:"radio"+n,type:"radio",name:e,checked:t.correct?"checked":"",onChange:this.onCorrectChange.bind(this,n),value:n}),Object($t.jsx)("input",{type:"text",ref:"editor"+n,onChange:this.onContentChange.bind(this,n),className:s,value:t.content}),Object($t.jsx)("a",{href:"#",className:"simple-button orange",onClick:this.removeChoice.bind(this,n),children:Object($t.jsx)("span",{className:"remove-choice",children:Object($t.jsx)(sE,{..._a})})})]})},""+n)}),this)}),Object($t.jsx)("div",{className:"add-choice-container",children:Object($t.jsxs)("a",{href:"#",className:"simple-button orange",onClick:this.addChoice,children:[Object($t.jsx)(sE,{...wa})," Add a choice"," "]})})]})},onPlaceholderChange:function(e){var t=e.target.value;this.props.onChange({placeholder:t})},onCorrectChange:function(e){var t=tE.map(this.props.choices,(function(t,n){return tE.extend({},t,{correct:n===e})}));this.props.onChange({choices:t})},onContentChange:function(e,t){var n=this.props.choices.slice(),s=tE.clone(n[e]);s.content=t.target.value,n[e]=s,this.props.onChange({choices:n})},addChoice:function(e){e.preventDefault();var t=this.props.choices;this.props.onChange({choices:t.concat([{content:"",correct:!1}])},this.focus.bind(this,t.length))},removeChoice:function(e,t){t.preventDefault();var n=tE.clone(this.props.choices);n.splice(e,1),this.props.onChange({choices:n})},focus:function(e){return eE.findDOMNode(this.refs["editor"+e]).focus(),!0},serialize(){return iE.serialize.call(this)}});QI.exports=rE;var oE=QI.exports,aE={exports:{}};aE.exports;const lE=v.a,cE=(h.a,i.a),hE=x.b,pE=Is.ClassNames,uE=Is.Options,dE=Kt,gE=createReactClass({displayName:"Dropdown",getDefaultProps:function(){return{choices:[],selected:0,placeholder:"",apiOptions:uE.defaults}},render:function(){var e=this.props.choices.slice(),t=lE({"perseus-widget-dropdown":!0});return Object($t.jsxs)("div",{children:[Object($t.jsxs)("select",{onChange:this._handleChangeEvent,onClick:e=>{e.stopPropagation(),e.target.focus()},onTouchStart:e=>{e.stopPropagation(),e.target.focus()},className:t+" nofastclick "+Object(Nn.css)(fE.dropdown)+" "+pE.INTERACTIVE,disabled:this.props.apiOptions.readOnly,value:this.props.selected,children:[Object($t.jsx)("option",{value:0,disabled:!0,children:this.props.placeholder}),e.map(((e,t)=>Object($t.jsx)("option",{value:t+1,children:e},""+(t+1))))]}),Object($t.jsx)(dE,{...ba,style:{marginLeft:"-24px",height:24,width:24}})]})},focus:function(){return cE.findDOMNode(this).focus(),!0},_handleChangeEvent:function(e){this._handleChange(parseInt(e.target.value))},_handleChange:function(e){this.props.trackInteraction(),this.props.onChange({selected:e})},getUserInput:function(){return{value:this.props.selected}},simpleValidate:function(e){return gE.validate(this.getUserInput(),e)}});hE.extend(gE,{validate:function(e,t){var n=e.value;return 0===n?{type:"invalid",message:null}:{type:"points",earned:t.choices[n-1].correct?1:0,total:1,message:null}}});const fE=Nn.StyleSheet.create({dropdown:{appearance:"none",backgroundColor:"transparent",border:`1px solid ${rn}`,borderRadius:4,boxShadow:"none",fontFamily:Xt,padding:"9px 25px 9px 9px",":focus":{outline:"none",border:`2px solid ${Jt}`,padding:"8px 24px 8px 8px"},":focus + svg":{color:`${Jt}`},":disabled":{color:on},":disabled + svg":{color:on}}});aE.exports={name:"dropdown",displayName:"Drop down",defaultAlignment:"inline-block",accessible:!0,widget:gE,transform:e=>({placeholder:e.placeholder,choices:hE.map(e.choices,(e=>e.content))})};var mE=aE.exports,bE={exports:{}},vE=(bE.exports,h.a,x.b),xE=mu,yE=pu,jE=id.a,wE=cd,OE=Lf,CE=createReactClass({displayName:"PairEditor",getDefaultProps:function(){return{name:"",value:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return xE.change.apply(this,t)},render:function(){return Object($t.jsxs)("fieldset",{className:"pair-editor",children:[Object($t.jsxs)("label",{children:["Name:"," ",Object($t.jsx)(jE,{value:this.props.name,onChange:this.change("name")})]}),Object($t.jsxs)("label",{children:[" ","Value:"," ",Object($t.jsx)(jE,{value:this.props.value,onChange:this.change("value")})]})]})},serialize(){return yE.serialize.call(this)}}),SE=createReactClass({displayName:"PairsEditor",render:function(){var e=vE.map(this.props.pairs,((e,t)=>Object($t.jsx)(CE,{name:e.name,value:e.value,onChange:this.handlePairChange.bind(this,t)},t)));return Object($t.jsx)("div",{children:e})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return xE.change.apply(this,t)},handlePairChange:function(e,t){var n=this.props.pairs.slice();n[e]=t;var s=n[n.length-1];s.name&&s.value&&n.push({name:"",value:""}),this.change("pairs",n)},serialize(){return yE.serialize.call(this)}}),kE=/khanacademy\.org\/computer-programming\/[^\/]+\/(\d+)/;var _E=createReactClass({displayName:"CSProgramEditor",getDefaultProps:function(){return{programID:"",settings:[{name:"",value:""}],showEditor:!1,showButtons:!1,width:400,height:400}},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Url or Program ID:"," ",Object($t.jsx)(jE,{name:"programID",value:this.props.programID,onChange:this._handleProgramIDChange})]}),Object($t.jsx)("br",{}),Object($t.jsx)(OE,{label:"Show Editor",showEditor:this.props.showEditor,onChange:this.props.onChange}),Object($t.jsx)(wE,{children:'If you show the editor, you should use the "full-width" alignment to make room for the width of the editor.'}),Object($t.jsx)("br",{}),Object($t.jsx)(OE,{label:"Show Buttons",showButtons:this.props.showButtons,onChange:this.props.onChange}),Object($t.jsx)("br",{}),Object($t.jsxs)("label",{children:["Settings:",Object($t.jsx)(SE,{name:"settings",pairs:this.props.settings,onChange:this._handleSettingsChange}),Object($t.jsxs)(wE,{children:["Settings that you add here are available to the program as an object returned by ",Object($t.jsx)("code",{children:"Program.settings()"})]})]})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return xE.change.apply(this,t)},_handleSettingsChange:function(e){this.change({settings:e.pairs})},_handleProgramIDChange:function(e){e=function(e){var t=kE.exec(e);return t&&(e=t[1]),e}(e),$.getJSON("https://www.khanacademy.org/api/internal/scratchpads/"+e).done((t=>{this.change({width:t.width,height:t.height,programID:e})})).fail(((t,n,s)=>{console.error("Error retrieving scratchpad info for program ID ",e),console.error(n+", "+s),this.change({width:400,height:400,programID:e})}))},serialize(){return yE.serialize.call(this)}});bE.exports=_E;var TE=bE.exports,ME={exports:{}},NE=(ME.exports,h.a,x.b),PE=mu,IE=ce.updateQueryString,EE=/khanacademy\.org/,AE="https://{hostname}/computer-programming/program/{programID}/embedded?embed=yes&author=no";var RE=createReactClass({displayName:"CSProgram",getDefaultProps:function(){return{showEditor:!1,showButtons:!1,status:"incomplete",message:null}},handleMessageEvent:function(e){var t={};try{t=JSON.parse(e.originalEvent.data)}catch(s){return}if(!NE.isUndefined(t.testsPassed)){var n=t.testsPassed?"correct":"incorrect";this.change({status:n,message:t.message})}},componentDidMount:function(){$(window).on("message",this.handleMessageEvent)},componentWillUnmount:function(){$(window).off("message",this.handleMessageEvent)},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return PE.change.apply(this,t)},render:function(){if(!this.props.programID)return Object($t.jsx)("div",{});var e,t=function(e){var t=AE.replace("{programID}",e),n=document.location.hostname,s="www.khanacademy.org";return EE.test(n)&&(s=n),t.replace("{hostname}",s)}(this.props.programID),n={height:this.props.height};if(this.props.showEditor?(t+="&editor=yes",n.width="100%",e="perseus-scratchpad-editor"):(t+="&editor=no",n.width=this.props.width+2,e="perseus-scratchpad"),this.props.showButtons?(t+="&buttons=yes",n.height+=50):t+="&buttons=no",this.props.settings){var s={};NE.each(this.props.settings,(function(e){e.name&&e.value&&(s[e.name]=e.value)})),t=IE(t,"settings",JSON.stringify(s))}var i=["allow-popups","allow-same-origin","allow-scripts","allow-top-navigation"].join(" ");return Object($t.jsx)("iframe",{sandbox:i,src:t,style:n,className:e,allowFullScreen:!0})},simpleValidate:function(e){return RE.validate({status:this.props.status,message:this.props.message},e)},statics:{validate:function(e,t){return"correct"===e.status?{type:"points",earned:1,total:1,message:e.message||null}:"incorrect"===e.status?{type:"points",earned:0,total:1,message:e.message||null}:{type:"invalid",message:"Keep going, you're not there yet!"}}}});ME.exports={name:"cs-program",displayName:"CS Program",supportedAlignments:["block","full-width"],widget:RE,hidden:!0};var DE=ME.exports,LE={exports:{}};LE.exports;h.a;const FE=v.a,zE=mu,qE=Bu,WE=x.b,BE=Is.ClassNames,VE=Kt,HE=gh,UE=ce,GE=mh,$E=xh,YE=createReactClass({displayName:"Categorizer",getDefaultProps:function(){return{items:[],categories:[],values:[],linterContext:je}},getInitialState:function(){return{uniqueId:WE.uniqueId("perseus_radio_")}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return zE.change.apply(this,t)},getUserInput:function(){return qE.getUserInput.call(this)},render:function(){const e=this,t=this.props.apiOptions.isMobile;let n=this.props.items.map(((e,t)=>[e,t]));this.props.randomizeItems&&(n=UE.shuffle(n,this.props.problemNum));const s=Object($t.jsxs)("table",{className:"categorizer-table",children:[Object($t.jsx)("thead",{children:Object($t.jsxs)("tr",{children:[Object($t.jsx)("th",{children:"\xa0"}),this.props.categories.map(((e,t)=>Object($t.jsx)("th",{className:Object(Nn.css)(KE.header),children:Object($t.jsx)(HE,{content:e,linterContext:this.props.linterContext})},t)))]})}),Object($t.jsx)("tbody",{children:n.map((n=>{var s=n[0],i=n[1],r=e.state.uniqueId+"_"+i;return Object($t.jsxs)("tr",{children:[Object($t.jsx)("td",{children:Object($t.jsx)(HE,{content:s,linterContext:this.props.linterContext})}),WE.range(e.props.categories.length).map((n=>{const s=e.props.values[i]===n;return Object($t.jsx)("td",{className:"category "+Object(Nn.css)(KE.cell,KE.responsiveCell),children:Object($t.jsxs)("div",{className:BE.INTERACTIVE,onClick:this.onChange.bind(this,i,n),children:[t&&Object($t.jsx)("input",{type:"radio",name:r,className:Object(Nn.css)($E.responsiveInput,$E.responsiveRadioInput),checked:s,onChange:this.onChange.bind(this,i,n),onClick:e=>e.stopPropagation()}),!t&&Object($t.jsx)("span",{className:Object(Nn.css)(KE.responsiveSpan,KE.radioSpan,s&&KE.checkedRadioSpan,this.props.static&&s&&KE.staticCheckedRadioSpan),children:s?Object($t.jsx)(VE,{...ua}):Object($t.jsx)(VE,{...fa})})]})},n)}))]},i)}))})]}),i=FE({"categorizer-container":!0,"static-mode":this.props.static}),r=this.props.apiOptions.isMobile?[KE.fullBleedContainer]:[];return Object($t.jsx)("div",{className:i+" "+Object(Nn.css)(...r),children:s})},onChange:function(e,t){var n=WE.clone(this.props.values);n[e]=t,this.change("values",n),this.props.trackInteraction()},simpleValidate:function(e){return YE.validate(this.getUserInput(),e)}});WE.extend(YE,{validate:function(e,t){var n=!0,s=!0;return WE.each(t.values,(function(t,i){null==e.values[i]&&(n=!1),e.values[i]!==t&&(s=!1)})),n?{type:"points",earned:s?1:0,total:1,message:null}:{type:"invalid",message:i18n._("Make sure you select something for every row.")}}});const KE=Nn.StyleSheet.create({fullBleedContainer:{[GE.mdOrSmaller]:{marginLeft:-16,marginRight:-16,overflowX:"auto"}},header:{textAlign:"center",verticalAlign:"bottom"},cell:{textAlign:"center",padding:0,color:"#ccc",verticalAlign:"middle"},radioSpan:{fontSize:30,paddingRight:3,":hover":{color:"#999"}},checkedRadioSpan:{color:"#333"},staticCheckedRadioSpan:{color:"#888"}});LE.exports={name:"categorizer",displayName:"Categorizer",widget:YE,transform:e=>WE.pick(e,"items","categories","randomizeItems"),staticTransform:e=>WE.pick(e,"items","categories","values","randomizeItems"),isLintable:!0};var XE=LE.exports,ZE={exports:{}};ZE.exports;h.a;const JE=mu,QE=x.b,eA=pu,tA=Lf,nA=Cs,sA=XE.widget,iA=createReactClass({displayName:"CategorizerEditor",getDefaultProps:function(){return{items:[],categories:[],values:[],randomizeItems:!1}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return JE.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(tA,{label:"Randomize item order",labelAlignment:"right",randomizeItems:this.props.randomizeItems,onChange:this.props.onChange})}),"Categories:",Object($t.jsx)(nA,{options:this.props.categories,onChange:e=>{this.change("categories",e)},layout:"horizontal"}),"Items:",Object($t.jsx)(nA,{options:this.props.items,onChange:e=>{this.change({items:e,values:QE.first(this.props.values,e.length)})},layout:"vertical"}),Object($t.jsx)(sA,{apiOptions:this.props.apiOptions,items:this.props.items,categories:this.props.categories,values:this.props.values,onChange:e=>{this.props.onChange(e)},trackInteraction:function(){}})]})},serialize(){return eA.serialize.call(this)}});ZE.exports=iA;var rA=ZE.exports;const oA=[n.p+"static/media/likert-face-1.e2a4a672.svg",n.p+"static/media/likert-face-2.3b5ea4d5.svg",n.p+"static/media/likert-face-3.59b6a841.svg",n.p+"static/media/likert-face-4.a3c5de77.svg"],aA=Nn.StyleSheet.create({container:{position:"relative",zIndex:3,userSelect:"none",display:"flex",flexDirection:"row",alignItems:"stretch"},choice:{display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"center",zIndex:0,borderWidth:1,borderRadius:0,marginRight:-1,borderColor:"gray",backgroundColor:"#eee",padding:15,":hover":{zIndex:1,outline:"2px solid aqua"},":focus-visible":{zIndex:1,outline:"2px solid aqua"},":active":{backgroundColor:"deepskyblue"}},first:{borderTopLeftRadius:5,borderBottomLeftRadius:5},last:{borderTopRightRadius:5,borderBottomRightRadius:5,marginRight:0},selectedChoice:{backgroundColor:"deepskyblue"},face:{display:"block",height:50,width:50,marginBottom:5}});class lA extends c.PureComponent{constructor(){super(...arguments),this.render=()=>{const e=this.props.selected===this.props.value;return Object($t.jsxs)("button",{type:"button",role:"radio","aria-checked":e,className:Object(Nn.css)(aA.choice,1===this.props.value&&aA.first,4===this.props.value&&aA.last,e&&aA.selectedChoice),onClick:this._handleSelect,children:[Object($t.jsx)("img",{className:Object(Nn.css)(aA.face),src:this.props.image,alt:this.props.alt,title:this.props.alt}),this.props.label]})},this._handleSelect=()=>{this.props.onSelect(this.props.value)}}}class cA extends c.PureComponent{constructor(e){super(e),this.render=()=>Object($t.jsx)("div",{role:"radiogroup",className:Object(Nn.css)(aA.container),children:this.props.labels.map(((e,t)=>Object($t.jsx)(lA,{value:t+1,image:oA[t],label:e,selected:this.props.selected,onSelect:this._handleChoice})))}),this._handleChoice=e=>{this.props.onChange({selected:e})},this.getUserInput=()=>({selected:this.props.selected,label:null==this.props.selected?null:this.props.labels[this.props.selected-1]}),this.simpleValidate=(e,t)=>null==this.props.selected?{type:"invalid",message:null}:{type:"points",earned:1,total:1}}}cA.defaultProps={selected:null};var hA={name:"likert-scale",version:{major:1,minor:0},displayName:"Likert Scale",defaultAlignment:"block",widget:cA,transform:e=>({labels:e.labels}),propUpgrades:{1:e=>{const t=e.labels,n=t.slice(0,2).concat(t.slice(3));return{...e,labels:n}}}};const pA=Nn.StyleSheet.create({face:{display:"inline-block",width:30,height:30,margin:5,verticalAlign:"middle"}});class uA extends c.Component{constructor(e){super(e),this._changeLabel=(e,t)=>{this.props.onChange({labels:this.props.labels.map(((n,s)=>s===e?t:n))})}}render(){return Object($t.jsxs)("div",{children:["Choice Labels:",this.props.labels.map(((e,t)=>Object($t.jsxs)("div",{children:[Object($t.jsx)("img",{className:Object(Nn.css)(pA.face),src:oA[t],alt:""}),Object($t.jsx)("input",{type:"text",className:Object(Nn.css)(pA.labelInput),value:e,onChange:e=>this._changeLabel(t,e.target.value)})]})))]})}serialize(){return{labels:this.props.labels}}}uA.defaultProps={labels:["","","",""]};var dA=[[XE,rA],[DE,TE],[mE,oE],[JI,qI],[PI,mI],[JP,lI],[sP,_N],[hP,EN],[xN,pN],[rN,JM],[BM,NM],[gM,$T],[d_,O_],[Ik,fk],[VS,JS],[vS,lS],[tS,$C],[Ay,DC],[MC,rC],[YO,DO],[TO,iw],[Xj,Vj],[Rj,Tj],[sj,Oj],[zy,ey],[Vx,Rx],[Tx,ix],[Xv,kv],[Um,vv],[Ef,Tm],[Ng,ig],[_d,vd],[hA,uA]],gA={exports:{}};gA.exports;gA.exports=function(e){const t=e.skipMathJax,n=$.Deferred();n.resolve();const s=$.Deferred();return t?s.resolve():(MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:"none","HTML-CSS":{availableFonts:["TeX"],imageFont:null,scale:100,showMathMenu:!1}}),MathJax.Hub.Configured(),MathJax.Hub.Queue(s.resolve)),n.then((()=>s))};var fA=gA.exports,mA=n(62),bA={exports:{}};bA.exports;h.a;const vA=mA.a,xA=x.b,yA=Is.ClassNames,jA=B_,wA=gh,OA=$x,CA=bg,SA=ls,kA=ce.captureScratchpadTouchStart,_A="math",TA="text",MA="tex",NA=createReactClass({displayName:"InputWithExamples",getDefaultProps:function(){return{type:TA,shouldShowExamples:!0,onFocus:function(){},onBlur:function(){},disabled:!1,linterContext:je}},getInitialState:function(){return{focused:!1,showExamples:!1}},_getUniqueId:function(){return`input-with-examples-${btoa(this.props.id).replace(/=/g,"")}`},_getInputClassName:function(){if(this.props.type===MA)return this.props.className;let e=yA.INPUT+" "+yA.INTERACTIVE;return this.state.focused&&(e+=" "+yA.FOCUSED),this.props.className&&(e+=" "+this.props.className),e},_getPropsForInputType:function(){const e={"aria-describedby":this._getUniqueId(),ref:"input",className:this._getInputClassName(),labelText:this.props.labelText,value:this.props.value,onFocus:this._handleFocus,onBlur:this._handleBlur,disabled:this.props.disabled};return this.props.type===MA?e:(xA.extend(e,{onChange:this.props.onChange,onTouchStart:kA}),this.props.type===_A?xA.extend({buttonSet:this.props.buttonSet,buttonsVisible:this.props.buttonsVisible,convertDotToTimes:this.props.convertDotToTimes},e):this.props.type===TA?xA.extend({autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:"false"},e):void 0)},_getComponentForInputType:function(){switch(this.props.type){case MA:return CA;case _A:return jA;case TA:return OA;default:return null}},_renderInput:function(){const e=this._getPropsForInputType(),t=this._getComponentForInputType();return Object($t.jsx)(t,{...e})},render:function(){const e=this._renderInput();if(this.props.type===MA)return e;const t=xA.map(this.props.examples,(e=>"- "+e)).join("\n"),n=this.props.shouldShowExamples&&this.state.showExamples;return Object($t.jsxs)(vA,{ref:"tooltip",className:"perseus-formats-tooltip preview-measure",horizontalPosition:"left",horizontalAlign:"left",verticalPosition:"bottom",arrowSize:10,borderColor:"#ccc",show:n,children:[e,Object($t.jsx)("div",{id:this._getUniqueId(),children:Object($t.jsx)(wA,{content:t,linterContext:SA.pushContextStack(this.props.linterContext,"input-with-examples")})})]})},_handleFocus:function(){this.props.onFocus(),this.setState({focused:!0,showExamples:!0})},show:function(){this.setState({showExamples:!0})},hide:function(){this.setState({showExamples:!1})},_handleBlur:function(){this.props.onBlur(),this.setState({focused:!1,showExamples:!1})},focus:function(){this.refs.input.focus()},blur:function(){this.refs.input.blur()},handleChange:function(e){this.props.onChange(e.target.value)}});bA.exports=NA;var PA=bA.exports,IA={exports:{}},EA=(IA.exports,v.a),AA=(h.a,i.a,mA.a),RA=x.b,DA=mu,LA=Is.Options,FA=Is.ClassNames;const zA=ie,qA=Kt;var WA=PA,BA=B_;const{KeypadInput:VA}=ye.a.components,{keypadConfigurationPropType:HA,keypadElementPropType:UA}=ye.a.propTypes,{KeypadTypes:GA}=ye.a.consts;var $A=i18n._("Sorry, I don't understand that!"),YA=(["An expression without an answer","is no expression to me.","Who can learn from an input","like the one that I see?","Put something in there","won't you please?","A few digits will do -","might I suggest some threes?"].join("\n"),e=>e.replace(/([_^])([^{])/g,"$1{$2}")),XA=createReactClass({displayName:"Expression",getDefaultProps:function(){return{value:"",times:!1,functions:[],buttonSets:["basic","trig","prealgebra","logarithms"],onFocus:function(){},onBlur:function(){},apiOptions:LA.defaults,linterContext:je}},getInitialState:function(){return{showErrorTooltip:!1,showErrorText:!1}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return DA.change.apply(this,t)},parse:function(e,t){var n=RA.pick(t||this.props,"functions");return window.icu&&window.icu.getDecimalFormatSymbols&&RA.extend(n,window.icu.getDecimalFormatSymbols()),U.parse(YA(e),n)},render:function(){if(this.props.apiOptions.customKeypad)return Object($t.jsx)(VA,{ref:"input",value:this.props.value,keypadElement:this.props.keypadElement,onChange:this.changeAndTrack,onFocus:()=>{this.props.keypadElement.configure(this.props.keypadConfiguration,(()=>{this.isMounted()&&this._handleFocus()}))},onBlur:this._handleBlur});if(this.props.apiOptions.staticRender)return Object($t.jsx)(WA,{ref:"input",value:this.props.value,type:"tex",examples:[],shouldShowExamples:!1,onChange:this.changeAndTrack,onFocus:this._handleFocus,onBlur:this._handleBlur,id:this.props.widgetId,linterContext:this.props.linterContext});var e=Object($t.jsx)("span",{className:"error-tooltip",children:Object($t.jsxs)(AA,{className:"error-text-container",horizontalPosition:"right",horizontalAlign:"left",verticalPosition:"top",arrowSize:10,borderColor:"#fcc335",show:this.state.showErrorText,children:[Object($t.jsx)("span",{className:"error-icon",onMouseEnter:()=>{this.setState({showErrorText:!0})},onMouseLeave:()=>{this.setState({showErrorText:!1})},onClick:()=>{this.setState({showErrorText:!this.state.showErrorText})},children:Object($t.jsx)(qA,{...va})}),Object($t.jsx)("div",{className:"error-text",children:$A})]})}),t=EA({"perseus-widget-expression":!0,"show-error-tooltip":this.state.showErrorTooltip});return Object($t.jsxs)("span",{className:t,children:[Object($t.jsx)(BA,{ref:"input",className:FA.INTERACTIVE,value:this.props.value,onChange:this.changeAndTrack,convertDotToTimes:this.props.times,buttonsVisible:this.props.buttonsVisible||"focused",buttonSets:this.props.buttonSets,onFocus:this._handleFocus,onBlur:this._handleBlur}),this.state.showErrorTooltip&&e]})},changeAndTrack:function(e,t){this.change("value",e,t),this.props.trackInteraction()},_handleFocus:function(){this.props.onFocus([])},_handleBlur:function(){this.props.onBlur([])},errorTimeout:null,componentWillReceiveProps:function(e){RA.isEqual(this.props.value,e.value)&&RA.isEqual(this.props.functions,e.functions)||(clearTimeout(this.errorTimeout),this.parse(e.value,e).parsed?this.setState({showErrorTooltip:!1}):this.errorTimeout=setTimeout((()=>{!1!==this.props.apiOptions.onInputError(null,this.props.value,$A)&&this.setState({showErrorTooltip:!0})}),2e3))},componentWillUnmount:function(){clearTimeout(this.errorTimeout)},focus:function(){return this.props.apiOptions.customKeypad&&this.refs.input.focus(),!0},focusInputPath:function(e){this.refs.input.focus()},blurInputPath:function(e){this.refs.input.blur()},insert:function(e){this.props.apiOptions.staticRender||this.refs.input.insert(e)},getInputPaths:function(){return[[]]},getGrammarTypeForPath:function(e){return"expression"},setInputValue:function(e,t,n){this.props.onChange({value:t},n)},getAcceptableFormatsForInputPath:function(){return null},getUserInput:function(){return YA(this.props.value)},simpleValidate:function(e,t){return t=t||function(){},XA.validate(this.getUserInput(),e,t)}});RA.extend(XA,{validate:function(e,t,n){var s=RA.clone(t);window.icu&&window.icu.getDecimalFormatSymbols&&RA.extend(s,window.icu.getDecimalFormatSymbols());var i,r,o=!0,a=!!t.answerForms.find((n=>{var a=(e=>zA.expression.createValidatorFunctional(U.parse(e.value,t).expr,RA.extend({},s,{simplify:e.simplify,form:e.form})))(n);return i=a(e),r=n,o=o&&i.empty,i.correct})),l=i&&i.message;return a?"ungraded"===r.considered?{type:"invalid",message:!1===n(null,e,l)?null:l}:{type:"points",earned:"correct"===r.considered?1:0,total:1,message:l}:o?{type:"invalid",message:null}:{type:"points",earned:0,total:1}}});const ZA=e=>{const t=GA.EXPRESSION,n={},s={};for(const a of e.answerForms){const t=U.parse(a.value,e);if(t.parsed){const e=t.expr,i=e=>"pi"===e||"theta"===e,r=e=>i(e)?e.toUpperCase():e;for(const t of e.getVars())n[r(t)]=!0;for(const t of e.getConsts())s[r(t)]=!0}}const i=Object.keys(n);i.sort();const r=Object.keys(s);r.sort();const o=[...i,...r];return o.length||o.push("PI"),{keypadType:t,extraKeys:o}};IA.exports={name:"expression",displayName:"Expression / Equation",defaultAlignment:"inline-block",widget:XA,transform:e=>{const{times:t,functions:n,buttonSets:s,buttonsVisible:i}=e;return{keypadConfiguration:ZA(e),times:t,functions:n,buttonSets:s,buttonsVisible:i}},version:{major:1,minor:0},propUpgrades:{1:e=>({times:e.times,buttonSets:e.buttonSets,functions:e.functions,buttonsVisible:e.buttonsVisible,answerForms:[{considered:"correct",form:e.form,simplify:e.simplify,value:e.value,key:0}]})},Expression:XA,isLintable:!0};var JA=IA.exports,QA=n(125),eR={exports:{}},tR=(eR.exports,h.a,x.b),nR=op,sR=mu,iR=cd,rR=Lf,oR=QA.a,aR=Ln.a,lR=A_,cR=JA.Expression,hR=["correct","wrong","ungraded"],pR=e=>{var t=[];e.forEach((e=>{t[e.key]=!0}));for(var n=0;n<t.length;n++)if(!t[n])return n;return t.length},uR=createReactClass({displayName:"ExpressionEditor",getDefaultProps:function(){return{answerForms:[],times:!1,buttonSets:["basic"],functions:["f","g","h"]}},getInitialState:function(){return{isTex:0===this.props.answerForms.length||this.props.answerForms.some((e=>{var{value:t}=e;return-1!==tR.indexOf(t,"\\")||-1!==tR.indexOf(t,"{")}))}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return sR.change.apply(this,t)},render:function(){var e=this.props.answerForms.map(((e,t)=>{var n={times:this.props.times,functions:this.props.functions,buttonSets:this.props.buttonSets,buttonsVisible:"focused",form:e.form,simplify:e.simplify,value:e.value,onChange:e=>this.updateForm(t,e),trackInteraction:()=>{},widgetId:this.props.widgetId+"-"+t};return nR(e).merge([],{draggable:!0,onChange:e=>this.updateForm(t,e),onDelete:()=>this.handleRemoveForm(t),expressionProps:n}).freeze()})).map((e=>Object($t.jsx)(dR,{...e}))),t=Object($t.jsx)(oR,{components:e,onReorder:this.handleReorder,className:"answer-options-list"}),n=lR.buttonSets.map(((e,t)=>{var n="basic"===t,s=tR.contains(this.props.buttonSets,t)||n,i=n?"button-set-label-float":"button-set-label";return Object($t.jsxs)("label",{className:i,children:[Object($t.jsx)("input",{type:"checkbox",checked:s,disabled:n,onChange:()=>this.handleButtonSet(t)}),t]},t)}));return n.splice(1,1,Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"checkbox",onChange:this.handleToggleDiv}),Object($t.jsxs)("span",{className:"show-div-button",children:["show ",Object($t.jsx)(aR,{children:"\\div"})," button"]})]},"show-div")),Object($t.jsxs)("div",{className:"perseus-widget-expression-editor",children:[Object($t.jsx)("h3",{className:"expression-editor-h3",children:"Global Options"}),Object($t.jsxs)("div",{children:[Object($t.jsx)(rR,{times:this.props.times,onChange:this.props.onChange,labelAlignment:"right",label:"Use \xd7 for rendering multiplication instead of a center dot."}),Object($t.jsx)(iR,{children:Object($t.jsx)("p",{children:"For pre-algebra problems this option displays multiplication as \\times instead of \\cdot in both the rendered output and the acceptable formats examples."})})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Function variables: ",Object($t.jsx)("input",{type:"text",defaultValue:this.props.functions.join(" "),onChange:this.handleFunctions})]}),Object($t.jsx)(iR,{children:Object($t.jsx)("p",{children:'Single-letter variables listed here will be interpreted as functions. This let us know that f(x) means "f of x" and not "f times x".'})})]}),Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:"Button sets:"}),n]}),this.state.isTex&&Object($t.jsx)(lR,{className:"math-input-buttons",sets:this.props.buttonSets,convertDotToTimes:this.props.times,onInsert:this.handleTexInsert}),Object($t.jsx)("h3",{className:"expression-editor-h3",children:"Answers"}),Object($t.jsx)("p",{style:{margin:"4px 0"},children:"student responses area matched against these from top to bottom"}),t,Object($t.jsx)("div",{children:Object($t.jsx)("button",{className:"simple-button orange",style:{fontSize:13},onClick:this.newAnswer,type:"button",children:"Add new answer"})})]})},serialize:function(){var e=["value","form","simplify","considered","key"],t=["answerForms","buttonSets","functions","times"],n=this.props.answerForms.map((t=>tR.pick(t,e)));return nR(this.props).set(["answerForms"],n).mod([],(e=>tR.pick(e,t))).freeze()},getSaveWarnings:function(){var e=[];0===this.props.answerForms.length?e.push("No answers specified"):(!!this.props.answerForms.find((e=>"correct"===e.considered))||e.push("No correct answer specified"),this.props.answerForms.forEach(((t,n)=>{if(""===this.props.value)e.push(`Answer ${n+1} is empty`);else{var s=U.parse(t.value);s.parsed?t.simplify&&!s.expr.isSimplified()&&e.push(`${t.value} isn't simplified, but is required" +\n                            " to be`):e.push(`Couldn't parse ${t.value}`)}})));return e},_newEmptyAnswerForm:function(){return{considered:"correct",form:!1,key:pR(this.props.answerForms),simplify:!1,value:""}},newAnswer:function(){var e=this.props.answerForms.slice();e.push(this._newEmptyAnswerForm()),this.change({answerForms:e})},handleRemoveForm:function(e){var t=this.props.answerForms.slice();t.splice(e,1),this.change({answerForms:t})},updateForm:function(e,t){var n=nR(this.props.answerForms).merge([e],t).freeze();this.change({answerForms:n})},handleReorder:function(e){var t=e.map((e=>{var t=tR.pick(e.props,"considered","form","simplify","value");return t.key=e.key,t}));this.change({answerForms:t})},handleButtonSet:function(e){var t=Object.keys(lR.buttonSets).filter((t=>tR.contains(this.props.buttonSets,t)!==(t===e)));this.props.onChange({buttonSets:t})},handleToggleDiv:function(){var e,t;tR.contains(this.props.buttonSets,"basic+div")?(e="basic",t="basic+div"):(e="basic+div",t="basic");var n=tR.reject(this.props.buttonSets,(e=>e===t)).concat(e);this.change("buttonSets",n)},handleTexInsert:function(e){this.refs.expression.insert(e)},handleFunctions:function(e){var t={};t.functions=tR.compact(e.target.value.split(/[ ,]+/)),this.props.onChange(t)}}),dR=createReactClass({displayName:"AnswerOption",getInitialState:function(){return{deleteFocused:!1}},handleDeleteBlur:function(){this.setState({deleteFocused:!1})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return sR.change.apply(this,t)},render:function(){var e=null;return e=this.state.deleteFocused?Object($t.jsx)("button",{type:"button",className:"simple-button orange",onClick:this.handleImSure,onBlur:this.handleDeleteBlur,children:"I'm sure!"}):Object($t.jsx)("button",{type:"button",className:"simple-button orange",onClick:this.handleDelete,children:"Delete"}),Object($t.jsxs)("div",{className:"expression-answer-option",children:[Object($t.jsx)("div",{className:"answer-handle"}),Object($t.jsxs)("div",{className:"answer-body",children:[Object($t.jsxs)("div",{className:"answer-considered",children:[Object($t.jsx)("div",{onClick:this.toggleConsidered,className:"answer-status "+this.props.considered,children:this.props.considered}),Object($t.jsx)("div",{className:"answer-expression",children:Object($t.jsx)(cR,{...this.props.expressionProps})})]}),Object($t.jsxs)("div",{className:"answer-option",children:[Object($t.jsx)(rR,{form:this.props.form,onChange:this.props.onChange,labelAlignment:"right",label:"Answer expression must have the same form."}),Object($t.jsx)(iR,{children:Object($t.jsx)("p",{children:"The student's answer must be in the same form. Commutativity and excess negative signs are ignored."})})]}),Object($t.jsxs)("div",{className:"answer-option",children:[Object($t.jsx)(rR,{simplify:this.props.simplify,onChange:this.props.onChange,labelAlignment:"right",label:"Answer expression must be fully expanded and simplified."}),Object($t.jsx)(iR,{children:Object($t.jsx)("p",{children:'The student\'s answer must be fully expanded and simplified. Answering this equation (x^2+2x+1) with this factored equation (x+1)^2 will render this response "Your answer is not fully expanded and simplified."'})})]}),Object($t.jsx)("div",{className:"remove-container",children:e})]})]})},handleImSure:function(){this.props.onDelete()},handleDelete:function(){this.setState({deleteFocused:!0})},toggleConsidered:function(){var e=function(e,t){var n=e.indexOf(t);return e[n=(n+1)%e.length]}(hR,this.props.considered);this.change({considered:e})}});eR.exports=uR;var gR=eR.exports,fR={exports:{}};fR.exports;h.a;const mR=x.b,bR=mu,vR=pu,xR=Vf.a,yR=lv,jR=cd,wR=Kt,OR=QP.a,CR=Gd,SR=Lf,kR=$x,_R=ce.firstNumericalParse,TR=[{title:"Integers",value:"integer",content:"6"},{title:"Decimals",value:"decimal",content:"0.75"},{title:"Proper fractions",value:"proper",content:"\u2157"},{title:"Improper fractions",value:"improper",content:"\u2077\u2044\u2084"},{title:"Mixed numbers",value:"mixed",content:"1\xbe"},{title:"Numbers with \u03c0",value:"pi",content:"\u03c0"}],MR=e=>({value:null,status:e,message:"",simplify:"required",answerForms:[],strict:!1,maxError:null}),NR=createReactClass({displayName:"NumericInputEditor",getDefaultProps:function(){return{answers:[MR("correct")],size:"normal",coefficient:!1,labelText:"",multipleNumberInput:!1}},getInitialState:function(){return{lastStatus:"wrong",showOptions:mR.map(this.props.answers,(()=>!1))}},render:function(){var e=this.props.answers,t=t=>Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("label",{children:"Unsimplified answers are"}),Object($t.jsx)(xR,{value:e[t].simplify,allowEmpty:!1,buttons:[{value:"required",content:"ungraded"},{value:"optional",content:"accepted"},{value:"enforced",content:"wrong"}],onChange:this.updateAnswer(t,"simplify")}),Object($t.jsxs)(jR,{children:[Object($t.jsx)("p",{children:'Normally select "ungraded". This will give the user a message saying the answer is correct but not simplified. The user will then have to simplify it and re-enter, but will not be penalized. (5th grade and after)'}),Object($t.jsx)("p",{children:'Select "accepted" only if the user is not expected to know how to simplify fractions yet. (Anything prior to 5th grade)'}),Object($t.jsxs)("p",{children:['Select "wrong" ',Object($t.jsx)("em",{children:"only"})," if we are specifically assessing the ability to simplify."]})]})]}),n=t=>Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("label",{children:"Choose the suggested answer formats"}),Object($t.jsx)(OR,{buttons:TR,values:e[t].answerForms,onChange:this.updateAnswer(t,"answerForms")}),Object($t.jsxs)(jR,{children:[Object($t.jsx)("p",{children:'Formats will be autoselected for you based on the given answer; to show no suggested formats and accept all types, simply have a decimal/integer be the answer. Values with \u03c0 will have format "pi", and values that are fractions will have some subset (mixed will be "mixed" and "proper"; improper/proper will both be "improper" and "proper"). If you would like to specify that it is only a proper fraction (or only a mixed/improper fraction), deselect the other format. Except for specific cases, you should not need to change the autoselected formats.'}),Object($t.jsxs)("p",{children:["To restrict the answer to ",Object($t.jsx)("em",{children:"only"}),' an improper fraction (i.e. 7/4), select the improper fraction and toggle "strict" to true. This ',Object($t.jsx)("b",{children:"will not"})," "," accept 1.75 as an answer."," "]}),Object($t.jsx)("p",{children:"Unless you are testing that specific skill, please do not restrict the answer format."})]})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(SR,{label:"Strictly match only these formats",strict:e[t].strict,onChange:this.updateAnswer.bind(this,t)})})]}),s=t=>Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{children:["Max error"," ",Object($t.jsx)(CR,{className:"max-error",value:e[t].maxError,onChange:this.updateAnswer(t,"maxError"),placeholder:"0"})]})}),i=Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("label",{children:"Width:  "}),Object($t.jsx)(xR,{value:this.props.size,allowEmpty:!1,buttons:[{value:"normal",content:"Normal (80px)"},{value:"small",content:"Small (40px)"}],onChange:this.change("size")}),Object($t.jsx)(jR,{children:Object($t.jsx)("p",{children:'Use size "Normal" for all text boxes, unless there are multiple text boxes in one line and the answer area is too narrow to fit them.'})})]}),r=Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("label",{children:["Label text:"," ",Object($t.jsx)(kR,{value:this.props.labelText,onChange:this.change("labelText")})]}),Object($t.jsx)(jR,{children:Object($t.jsx)("p",{children:"Text to describe this input. This will be shown to users using screenreaders."})})]}),o=Object($t.jsx)("div",{children:Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(SR,{label:"Coefficient",coefficient:this.props.coefficient,onChange:this.props.onChange}),Object($t.jsx)(jR,{children:Object($t.jsx)("p",{children:"A coefficient style number allows the student to use - for -1 and an empty string to mean 1."})})]})}),a=Object($t.jsx)("div",{children:Object($t.jsx)("a",{href:"javascript:void(0)",className:"simple-button orange",onClick:()=>this.addAnswer(),onKeyDown:e=>this.onSpace(e,this.addAnswer),children:Object($t.jsx)("span",{children:"Add new answer"})})}),l={wrong:"(address the mistake/misconception)",ungraded:"(explain in detail to avoid confusion)",correct:"(reinforce the user's understanding)"};return Object($t.jsxs)("div",{className:"perseus-input-number-editor",children:[Object($t.jsx)("div",{ref:e=>this.multInputOption=e,children:Object($t.jsxs)("select",{onChange:this.onMultipleInputChange,children:[Object($t.jsx)("option",{value:"simple-numeric-input",children:"Ask for one correct solution"}),Object($t.jsx)("option",{value:"multiple-numeric-input",children:"Ask for all correct solutions"})]})}),Object($t.jsx)("div",{className:"ui-title",children:"User input"}),Object($t.jsx)("div",{className:"msg-title",children:"Message shown to user on attempt"}),(()=>e.map(((i,r)=>{var o=Object($t.jsx)(yR,{apiOptions:this.props.apiOptions,content:i.message||"",placeholder:"Why is this answer "+i.status+"?\t"+l[i.status],widgetEnabled:!1,onChange:e=>{"content"in e&&this.updateAnswer(r,{message:e.content})}});return Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("div",{className:"input-answer-editor-value-container"+(i.maxError?" with-max-error":""),children:[Object($t.jsx)(CR,{value:i.value,className:"numeric-input-value",placeholder:"answer",format:mR.last(i.answerForms),onFormatChange:(e,t)=>{var n;"pi"===t?n=["pi"]:"mixed"===t?n=["proper","mixed"]:"proper"!==t&&"improper"!==t||(n=["proper","improper"]),this.updateAnswer(r,{value:_R(e),answerForms:n})},onChange:e=>{this.updateAnswer(r,{value:_R(e)})}}),i.strict&&Object($t.jsx)("div",{className:"is-strict-indicator",title:"strictly equivalent to",children:"\u2261"}),"required"!==i.simplify&&"correct"===i.status&&Object($t.jsx)("div",{className:"simplify-indicator "+i.simplify,title:"accepts unsimplified answers",children:"\u2030"}),i.maxError?Object($t.jsxs)("div",{className:"max-error-container",children:[Object($t.jsx)("div",{className:"max-error-plusmn",children:"\xb1"}),Object($t.jsx)(CR,{placeholder:0,value:e[r].maxError,format:mR.last(i.answerForms),onChange:this.updateAnswer(r,"maxError")})]}):null,Object($t.jsx)("div",{className:"value-divider"}),Object($t.jsx)("a",{href:"javascript:void(0)",className:"answer-status "+i.status,onClick:()=>this.onStatusChange(r),onKeyDown:e=>this.onSpace(e,this.onStatusChange,r),children:i.status}),Object($t.jsx)("a",{href:"javascript:void(0)",className:"answer-trash",onClick:()=>this.onTrashAnswer(r),onKeyDown:e=>this.onSpace(e,this.onTrashAnswer,r),children:Object($t.jsx)(wR,{..._a})}),Object($t.jsx)("a",{href:"javascript:void(0)",className:"options-toggle",onClick:()=>this.onToggleOptions(r),onKeyDown:e=>this.onSpace(e,this.onToggleOptions,r),children:Object($t.jsx)(wR,{...xa})})]}),Object($t.jsx)("div",{className:"input-answer-editor-message",children:o}),this.state.showOptions[r]&&Object($t.jsxs)("div",{className:"options-container",children:[s(r),"correct"===i.status&&t(r),n(r)]})]},r)})))(),a,i,o,r]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return bR.change.apply(this,t)},onToggleOptions:function(e){var t=this.state.showOptions.slice();t[e]=!t[e],this.setState({showOptions:t})},onTrashAnswer:function(e){if(e>=0&&e<this.props.answers.length){var t=this.props.answers.slice(0);t.splice(e,1),this.props.onChange({answers:t})}},onSpace:function(e,t){if(" "===e.key){e.preventDefault();var n=mR.toArray(arguments).slice(2);t.apply(this,n)}},onStatusChange:function(e){var t=["wrong","ungraded","correct"],n=this.props.answers,s=t[(mR.indexOf(t,n[e].status)+1)%t.length];this.updateAnswer(e,{status:s,simplify:"correct"===s?"required":"accepted"})},onMultipleInputChange:function(e){"multiple-numeric-input"===e.target.value?this.props.onChange({multipleNumberInput:!0}):this.props.onChange({multipleNumberInput:!1})},updateAnswer:function(e,t){if(!mR.isObject(t))return mR.partial(((e,t,n)=>{var s={};s[t]=n,this.updateAnswer(e,s)}),e,t);if(e===(s=mR.clone(this.props.answers)).length)var n=MR(this.state.lastStatus),s=s.concat(n);s[e]=mR.extend({},s[e],t),this.props.onChange({answers:s})},addAnswer:function(){var e=MR(this.state.lastStatus),t=this.props.answers.concat(e);this.props.onChange({answers:t})},getSaveWarnings:function(){var e=[];return mR.contains(mR.pluck(this.props.answers,"value"),"")&&e.push("One or more answers is empty"),this.props.answers.forEach(((t,n)=>{t.strict&&(!t.answerForms||0===t.answerForms.length)&&e.push(`Answer ${n+1} is set to string format matching, but no format was selected`)})),e},serialize(){return vR.serialize.call(this)}});fR.exports=NR;var PR=fR.exports,IR={exports:{}};IR.exports;h.a;const ER=x.b,AR=createReactClass({displayName:"PossibleAnswers",render:function(){const e=ER.uniq(this.props.answers),t=ER.map(e,(e=>Object($t.jsx)("dd",{children:e},e)));return Object($t.jsxs)("dl",{className:"perseus-possible-answers",children:[Object($t.jsx)("dt",{children:"Correct Answer"}),t]})}});IR.exports=AR;var RR=IR.exports,DR={exports:{}},LR=(DR.exports,v.a),FR=(h.a,x.b),zR=PA;const qR=Dg;var WR=cg.parseTex,BR=RR,VR=Is.ClassNames,HR=Is.Options;const UR=ie,GR=Z,{keypadElementPropType:$R}=ye.a.propTypes,YR=Kt;var KR=[{title:"Integers",value:"integer",content:"6"},{title:"Decimals",value:"decimal",content:"0.75"},{title:"Proper fractions",value:"proper",content:"\u2157"},{title:"Improper fractions",value:"improper",content:"\u2077\u2044\u2084"},{title:"Mixed numbers",value:"mixed",content:"1\xbe"},{title:"Numbers with \u03c0",value:"pi",content:"\u03c0"}],XR={integer:()=>i18n._("an integer, like $6$"),proper:e=>"optional"===e.simplify?i18n._("a *proper* fraction, like $1/2$ or $6/10$"):i18n._("a *simplified proper* fraction, like $3/5$"),improper:e=>"optional"===e.simplify?i18n._("an *improper* fraction, like $10/7$ or $14/8$"):i18n._("a *simplified improper* fraction, like $7/4$"),mixed:()=>i18n._("a mixed number, like $1\\ 3/4$"),decimal:()=>i18n._("an *exact* decimal, like $0.75$"),pi:()=>i18n._("a multiple of pi, like $12\\ \\text{pi}$ or $2/3\\ \\text{pi}$")},ZR=createReactClass({displayName:"NumericInput",getDefaultProps:function(){return{currentValue:"",currentMultipleValues:[""],size:"normal",apiOptions:HR.defaults,coefficient:!1,answerForms:[],labelText:"",linterContext:je,multipleNumberInput:!1}},getInitialState:function(){return{numSolutions:"no-solutions",previousValues:[""]}},getAnswerBlurb:function(e){var t,n;if(this.props.apiOptions.satStyling&&e){var s=this.simpleValidate(e);if(!(t="points"===s.type&&s.earned===s.total)){var i=FR.filter(e.answers,(e=>"correct"===e.status)),r=FR.map(i,(e=>{var t="decimal";e.answerForms&&e.answerForms[0]&&(t=e.answerForms[0]);var n=GR.toNumericString(e.value,t);return e.maxError&&(n+=" \xb1 "+GR.toNumericString(e.maxError,t)),n}));n=Object($t.jsx)(BR,{answers:r})}}return[n,t]},getClasses:function(e,t){const n={};return n["perseus-input-size-"+this.props.size]=!0,n[VR.CORRECT]=t&&e&&this.props.currentValue,n[VR.INCORRECT]=t&&!e&&this.props.currentValue,n[VR.UNANSWERED]=t&&!this.props.currentValue,n},render:function(){const e=this.props.reviewModeRubric,t=this.getAnswerBlurb(e),n=t[0],s=t[1],i=this.getClasses(s,e);var r=this.props.labelText;null!=r&&""!==r||(r=i18n._("Your answer:"));var o=LR({"perseus-widget-dropdown":!0});const a=Object($t.jsxs)("div",{children:[Object($t.jsxs)("select",{onChange:this.handleNumSolutionsChange,className:o+" "+Object(Nn.css)(QR.dropdown)+" "+VR.INTERACTIVE,value:this.state.numSolutions,children:[Object($t.jsx)("option",{value:"no-solutions",children:i18n._("0 solutions")}),Object($t.jsx)("option",{value:"finite-solutions",children:i18n._("Finite solutions")})]}),Object($t.jsx)(YR,{...ba,style:{marginLeft:-24,height:24,width:24}})]});var l;if(this.props.multipleNumberInput){if("no-solutions"===this.state.numSolutions)return a;{const e=Object($t.jsx)("div",{className:Object(Nn.css)(QR.addInputButton),onClick:this._addInput,children:"+"});l=Object($t.jsxs)("div",{children:[this.props.currentMultipleValues.map(((e,t)=>Object($t.jsxs)("div",{className:Object(Nn.css)(QR.numberInputContainer),children:[t>0&&Object($t.jsx)("div",{className:Object(Nn.css)(QR.removeInputButton),onClick:e=>this._removeInput(t,e),"aria-label":"Remove this answer",children:"-"}),this.props.apiOptions.customKeypad?Object($t.jsx)(qR,{ref:"input",value:this.props.currentMultipleValues[t],keypadElement:this.props.keypadElement,onChange:e=>this.handleMultipleInputChange(t,e),onFocus:this._handleFocus,onBlur:this._handleBlur}):Object($t.jsx)(zR,{ref:"input",value:this.props.currentMultipleValues[t],onChange:e=>this.handleMultipleInputChange(t,e),className:LR(i,Object(Nn.css)(QR.numberInput)),labelText:r,type:this._getInputType(),examples:this.examples(),shouldShowExamples:this.shouldShowExamples(),onFocus:this._handleFocus,onBlur:this._handleBlur,id:this.props.widgetId,disabled:this.props.apiOptions.readOnly,highlightLint:this.props.highlightLint})]},t))),e,"Add answer"]})}}else{if(this.props.apiOptions.customKeypad)return Object($t.jsx)(qR,{ref:"input",value:this.props.currentValue,keypadElement:this.props.keypadElement,onChange:this.handleChange,onFocus:this._handleFocus,onBlur:this._handleBlur});l=Object($t.jsx)(zR,{ref:"input",value:this.props.currentValue,onChange:this.handleChange,className:LR(i),labelText:r,type:this._getInputType(),examples:this.examples(),shouldShowExamples:this.shouldShowExamples(),onFocus:this._handleFocus,onBlur:this._handleBlur,id:this.props.widgetId,disabled:this.props.apiOptions.readOnly,highlightLint:this.props.highlightLint})}return n?Object($t.jsxs)("span",{className:"perseus-input-with-answer-blurb",children:[this.props.multipleNumberInput&&a,l,n]}):this.props.apiOptions.satStyling?Object($t.jsxs)("label",{className:"perseus-input-with-label","aria-hidden":"true",children:[Object($t.jsx)("span",{className:"perseus-input-label",children:i18n.i18nDoNotTranslate("Answer:")}),this.props.multipleNumberInput&&a,l]}):Object($t.jsxs)("div",{children:[this.props.multipleNumberInput&&a,l]})},handleChange:function(e,t){this.props.onChange({currentValue:e},t),this.props.trackInteraction()},handleMultipleInputChange:function(e,t){const n=this.props.currentMultipleValues.slice();n[e]=t,this.props.onChange({currentMultipleValues:n}),this.props.trackInteraction()},handleNumSolutionsChange:function(e){const t=e.target.value;this.setState({numSolutions:t}),"no-solutions"===t?(this.setState({previousValues:this.props.currentMultipleValues}),this.props.onChange({currentMultipleValues:[]})):(this.props.onChange({currentMultipleValues:this.state.previousValues}),this.setState({previousValues:[]}))},_getInputType:function(){return this.props.apiOptions.staticRender?"tex":"text"},_handleFocus:function(){this.props.onFocus([]);const{interactionCallback:e}=this.props.apiOptions;e&&e()},_handleBlur:function(){this.props.onBlur([])},_addInput:function(){this.props.onChange({currentMultipleValues:this.props.currentMultipleValues.concat([""])})},_removeInput:function(e,t){const n=this.props.currentMultipleValues.length,s=this.props.currentMultipleValues.slice(0,e).concat(this.props.currentMultipleValues.slice(e+1,n));this.props.onChange({currentMultipleValues:s})},focus:function(){return this.refs.input.focus(),!0},focusInputPath:function(e){this.refs.input.focus()},blurInputPath:function(e){this.refs.input.blur()},getInputPaths:function(){return[[]]},getGrammarTypeForPath:function(e){return"number"},setInputValue:function(e,t,n){this.props.onChange({currentValue:t},n)},getUserInput:function(){const e=this.props.multipleNumberInput;return{multInput:e,currentValue:e?this.props.currentMultipleValues:this.props.currentValue}},simpleValidate:function(e){return ZR.validate(this.getUserInput(),e)},shouldShowExamples:function(){var e=0===this.props.answerForms.length,t=FR.uniq(this.props.answerForms.map((e=>e.name))).length>=FR.size(XR);return!e&&!t},examples:function(){var e=0!==this.props.answerForms.length?this.props.answerForms:FR.map(FR.keys(XR),(e=>({name:e,simplify:"required"}))),t=FR.map(e,(e=>XR[e.name](e)));return t=FR.uniq(t),[i18n._("**Your answer should be** ")].concat(t)}});FR.extend(ZR,{validate:function(e,t){var n=FR.pluck(KR,"value"),s=e=>UR.number.createValidatorFunctional(e.value,{message:e.message,simplify:"correct"===e.status?e.simplify:"optional",inexact:!0,maxError:e.maxError,forms:e.strict&&e.answerForms&&0!==e.answerForms.length?e.answerForms:n}),i=WR(e.currentValue),r=FR.where(t.answers,{status:"correct"});if(e.multInput){var o=i.split(",").sort();if(r.sort(((e,t)=>e.value>t.value?1:-1)),o.length!==r.length)return{type:"points",earned:0,total:1,message:"Incorrect number of answers"};var a,l=!0;return r.forEach((function(e,n){var i=o[n];t.coefficient&&(i?"-"===i&&(i=-1):i=1);const r=s(e)(i);l=l&&r.correct,r.message&&(a=r.message)})),{type:"points",earned:l?1:0,total:1,message:a}}var c=FR.find(FR.map(r,(e=>{var n=i;return t.coefficient&&(n?"-"===n&&(n=-1):n=1),s(e)(n)})),(e=>e.correct||e.empty));if(!c){var h=[].concat(FR.where(t.answers,{status:"ungraded"}),FR.where(t.answers,{status:"wrong"}));const e=FR.find(h,(e=>s(e)(i).correct));c={empty:!!e&&"ungraded"===e.status,correct:!!e&&"correct"===e.status,message:e?e.message:null,guess:i}}return c.empty?{type:"invalid",message:c.message}:{type:"points",earned:c.correct?1:0,total:1,message:c.message}}});var JR=function(e){var t,n,s=FR.flatten(e),i=(t=s,n=FR.isEqual,FR.reduce(t,((e,t)=>FR.find(e,n.bind(null,t))?e:e.concat([t])),[]));return FR.sortBy(i,(e=>FR.keys(XR).indexOf(e.name)))};const QR=Nn.StyleSheet.create({addInputButton:{cursor:"pointer",display:"inline-block",border:`2px solid ${Jt}`,backgroundColor:Jt,color:tn,fontSize:20,borderRadius:15,width:18,height:18,marginBottom:7,marginRight:8,marginTop:3,textAlign:"center",paddingTop:1},removeInputButton:{cursor:"pointer",display:"inline-block",border:`2px solid ${en}`,backgroundColor:en,color:tn,fontSize:20,borderRadius:15,width:18,height:18,marginBottom:7,marginRight:8,marginTop:4,textAlign:"center"},dropdown:{width:250,marginBottom:10,appearance:"none",backgroundColor:"transparent",border:`1px solid ${rn}`,borderRadius:4,boxShadow:"none",fontFamily:Xt,padding:"9px 25px 9px 9px",":focus":{outline:"none",border:`2px solid ${Jt}`,padding:"8px 25px 8px 8px"},":focus + svg":{color:`${Jt}`},":disabled":{color:on},":disabled + svg":{color:on}},numberInput:{float:"right",width:170,marginBottom:10,border:`1px solid ${rn}`,borderRadius:4,padding:"9px 25px 9px 9px",":focus":{outline:"none",border:`2px solid ${Jt}`,padding:"8px 25px 8px 8px"}},numberInputContainer:{display:"flex"}});DR.exports={name:"numeric-input",displayName:"Number text box",defaultAlignment:"inline-block",accessible:!0,widget:ZR,transform:function(e){return FR.extend(FR.omit(e,"answers"),{answerForms:JR(FR.map(e.answers,(e=>FR.map(e.answerForms,(t=>({simplify:e.simplify,name:t}))))))})},isLintable:!0};var eD=DR.exports,tD={exports:{}};tD.exports;h.a;const nD=i.a,sD=x.b,iD=ce,rD=id.a,oD=cd;var aD={number:{name:"Numbers",forms:"integer, decimal, proper, improper, mixed"},decimal:{name:"Decimals",forms:"decimal"},integer:{name:"Integers",forms:"integer"},rational:{name:"Fractions and mixed numbers",forms:"integer, proper, improper, mixed"},improper:{name:"Improper numbers (no mixed)",forms:"integer, proper, improper"},mixed:{name:"Mixed numbers (no improper)",forms:"integer, proper, mixed"},percent:{name:"Numbers or percents",forms:"integer, decimal, proper, improper, mixed, percent"},pi:{name:"Numbers with pi",forms:"pi"}};const lD=createReactClass({displayName:"InputNumberEditor",getDefaultProps:function(){return{value:0,simplify:"required",size:"normal",inexact:!1,maxError:.1,answerType:"number"}},handleAnswerChange:function(e){var t=iD.firstNumericalParse(e)||0;this.props.onChange({value:t})},render:function(){var e=sD.map(aD,(function(e,t){return Object($t.jsx)("option",{value:t,children:e.name},t)}),this);return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Correct answer:"," ",Object($t.jsx)(rD,{value:""+this.props.value,onChange:this.handleAnswerChange,ref:"input"})]})}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Unsimplified answers"," ",Object($t.jsxs)("select",{value:this.props.simplify,onChange:e=>{this.props.onChange({simplify:e.target.value})},children:[Object($t.jsx)("option",{value:"required",children:"will not be graded"}),Object($t.jsx)("option",{value:"optional",children:"will be accepted"}),Object($t.jsx)("option",{value:"enforced",children:"will be marked wrong"})]})]}),Object($t.jsxs)(oD,{children:[Object($t.jsx)("p",{children:'Normally select "will not be graded". This will give the user a message saying the answer is correct but not simplified. The user will then have to simplify it and re-enter, but will not be penalized. (5th grade and anything after)'}),Object($t.jsx)("p",{children:'Select "will be accepted" only if the user is not expected to know how to simplify fractions yet. (Anything prior to 5th grade)'}),Object($t.jsx)("p",{children:'Select "will be marked wrong" only if we are specifically assessing the ability to simplify.'})]})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"checkbox",checked:this.props.inexact,onChange:e=>{this.props.onChange({inexact:e.target.checked})}})," ","Allow inexact answers"]}),Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"checkbox",style:{visibility:"hidden"}}),"Max error:"," ",Object($t.jsx)("input",{type:"text",disabled:!this.props.inexact,defaultValue:this.props.maxError,onBlur:e=>{var t=""+(iD.firstNumericalParse(e.target.value)||0);e.target.value=t,this.props.onChange({maxError:t})}})]})]}),Object($t.jsxs)("div",{children:["Answer type:"," ",Object($t.jsx)("select",{value:this.props.answerType,onChange:e=>{this.props.onChange({answerType:e.target.value})},children:e}),Object($t.jsx)(oD,{children:Object($t.jsx)("p",{children:'Use the default "Numbers" unless the answer must be in a specific form (e.g., question is about converting decimals to fractions).'})})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Width"," ",Object($t.jsxs)("select",{value:this.props.size,onChange:e=>{this.props.onChange({size:e.target.value})},children:[Object($t.jsx)("option",{value:"normal",children:"Normal (80px)"}),Object($t.jsx)("option",{value:"small",children:"Small (40px)"})]})]}),Object($t.jsx)(oD,{children:Object($t.jsx)("p",{children:'Use size "Normal" for all text boxes, unless there are multiple text boxes in one line and the answer area is too narrow to fit them.'})})]})]})},focus:function(){return nD.findDOMNode(this.refs.input).focus(),!0},serialize:function(){return sD.pick(this.props,"value","simplify","size","inexact","maxError","answerType")}});tD.exports=lD;var cD=tD.exports,hD={exports:{}},pD=(hD.exports,v.a),uD=(h.a,x.b),dD=PA;const gD=Dg;var fD=cg.parseTex,mD=RR;const bD=ie,{keypadElementPropType:vD}=ye.a.propTypes;var xD=Is.ClassNames,yD=Is.Options,jD={number:{name:"Numbers",forms:"integer, decimal, proper, improper, mixed"},decimal:{name:"Decimals",forms:"decimal"},integer:{name:"Integers",forms:"integer"},rational:{name:"Fractions and mixed numbers",forms:"integer, proper, improper, mixed"},improper:{name:"Improper numbers (no mixed)",forms:"integer, proper, improper"},mixed:{name:"Mixed numbers (no improper)",forms:"integer, proper, mixed"},percent:{name:"Numbers or percents",forms:"integer, decimal, proper, improper, mixed, percent"},pi:{name:"Numbers with pi",forms:"pi"}},wD={integer:function(e){return i18n._("an integer, like $6$")},proper:function(e){return"optional"===e.simplify?i18n._("a *proper* fraction, like $1/2$ or $6/10$"):i18n._("a *simplified proper* fraction, like $3/5$")},improper:function(e){return"optional"===e.simplify?i18n._("an *improper* fraction, like $10/7$ or $14/8$"):i18n._("a *simplified improper* fraction, like $7/4$")},mixed:function(e){return i18n._("a mixed number, like $1\\ 3/4$")},decimal:function(e){return i18n._("an *exact* decimal, like $0.75$")},percent:function(e){return i18n._("a percent, like $12.34\\%$")},pi:function(e){return i18n._("a multiple of pi, like $12\\ \\text{pi}$ or $2/3\\ \\text{pi}$")}},OD=createReactClass({displayName:"InputNumber",getDefaultProps:function(){return{currentValue:"",size:"normal",answerType:"number",apiOptions:yD.defaults,linterContext:je}},shouldShowExamples:function(){return"number"!==this.props.answerType&&!this.props.apiOptions.staticRender},render:function(){if(this.props.apiOptions.customKeypad)return Object($t.jsx)(gD,{ref:"input",value:this.props.currentValue,keypadElement:this.props.keypadElement,onChange:this.handleChange,onFocus:this._handleFocus,onBlur:this._handleBlur});var e=this.props.reviewModeRubric,t=null,n=null;if(this.props.apiOptions.satStyling&&e){var s=this.simpleValidate(e);if(!(t="points"===s.type&&s.earned===s.total)){var i=String(e.value);e.inexact&&e.maxError&&(i+=" \xb1 "+e.maxError);var r=[i];n=Object($t.jsx)(mD,{answers:r})}}var o={};o["perseus-input-size-"+this.props.size]=!0,o[xD.CORRECT]=e&&t&&this.props.currentValue,o[xD.INCORRECT]=e&&!t&&this.props.currentValue,o[xD.UNANSWERED]=e&&!this.props.currentValue;var a=Object($t.jsx)(dD,{ref:"input",value:this.props.currentValue,onChange:this.handleChange,className:pD(o),type:this._getInputType(),examples:this.examples(),shouldShowExamples:this.shouldShowExamples(),onFocus:this._handleFocus,onBlur:this._handleBlur,id:this.props.widgetId,disabled:this.props.apiOptions.readOnly,linterContext:this.props.linterContext});return n?Object($t.jsxs)("span",{className:"perseus-input-with-answer-blurb",children:[a,n]}):a},handleChange:function(e,t){this.props.onChange({currentValue:e},t)},_getInputType:function(){return this.props.apiOptions.staticRender?"tex":"text"},_handleFocus:function(){this.props.onFocus([]);const{interactionCallback:e}=this.props.apiOptions;e&&e()},_handleBlur:function(){this.props.onBlur([])},focus:function(){return this.refs.input.focus(),!0},focusInputPath:function(e){this.refs.input.focus()},blurInputPath:function(e){this.refs.input.blur()},getInputPaths:function(){return[[]]},getGrammarTypeForPath:function(e){return"number"},setInputValue:function(e,t,n){this.props.onChange({currentValue:t},n)},getUserInput:function(){return{currentValue:this.props.currentValue}},simpleValidate:function(e,t){return t=t||function(){},OD.validate(this.getUserInput(),e,t)},examples:function(){var e=this.props.answerType,t=jD[e].forms.split(/\s*,\s*/),n=uD.map(t,(function(e){return wD[e](this.props)}),this);return[i18n._("**Your answer should be** ")].concat(n)}});uD.extend(OD,{validate:function(e,t,n){null==t.answerType&&(t.answerType="number");var s=bD.number.createValidatorFunctional(t.value,{simplify:t.simplify,inexact:t.inexact||void 0,maxError:t.maxError,forms:jD[t.answerType].forms})(fD(e.currentValue));return s.empty?{type:"invalid",message:!1===n(null,e.currentValue,s.message)?null:s.message}:{type:"points",earned:s.correct?1:0,total:1,message:s.message}}});hD.exports={name:"input-number",displayName:"Number text box (old)",defaultAlignment:"inline-block",hidden:!0,widget:OD,transform:e=>{const{simplify:t,size:n,answerType:s}=e;return{simplify:t,size:n,answerType:s}},isLintable:!0};var CD=hD.exports,SD={exports:{}};SD.exports;const kD=h.a;class _D extends kD.Component{render(){const{checked:e,correct:t}=this.props,n=`${t?i18n._("correct"):i18n._("incorrect")} ${e?i18n._("(selected)"):""}`,s=t?TD.correct:TD.incorrect;return Object($t.jsx)("div",{className:Object(Nn.css)(TD.text,s),children:n})}}const TD=Nn.StyleSheet.create({text:{alignItems:"center",display:"flex",fontSize:12,height:32,textTransform:"uppercase"},correct:{color:Jt},incorrect:{color:ln}});SD.exports=_D;var MD=SD.exports,ND={exports:{}};ND.exports;const PD=h.a;class ID extends PD.Component{render(){const e={borderColor:this.props.visible?this.props.color:"transparent"};return Object($t.jsx)("span",{className:Object(Nn.css)(ED.ring),style:e,children:this.props.children})}}ID.defaultProps={visible:!0,color:Jt};const ED=Nn.StyleSheet.create({ring:{margin:"auto",display:"inline-block",borderRadius:"50%",borderWidth:2,padding:2,borderStyle:"solid"}});ND.exports=ID;var AD=ND.exports,RD={exports:{}};RD.exports;const DD=h.a,LD=Kt,FD=AD;class zD extends DD.Component{constructStyles(e,t,n){let s,i=mn,r=mn;return e?t?(i=bn,r=n?tn:bn,s=n?bn:tn):n&&(i=xn,r=tn,s=xn):n&&(r=tn,s=mn),{color:r,backgroundColor:s,borderColor:i}}render(){const{letter:e,a11yText:t,reviewMode:n,checked:s,correct:i}=this.props,{color:r,backgroundColor:o,borderColor:a}=this.constructStyles(n,i,s);return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:Object(Nn.css)(BD.satCircle),style:{backgroundColor:o,borderColor:a}}),Object($t.jsxs)("div",{style:{color:r},className:Object(Nn.css)(BD.letter),children:[Object($t.jsx)("span",{className:"perseus-sr-only",children:t}),Object($t.jsx)("span",{"aria-hidden":"true",children:e})]})]})}}class qD extends DD.Component{getChoiceInner(){const{letter:e,showCorrectness:t,correct:n}=this.props;return t?n?Object($t.jsx)(LD,{...ca,style:{position:"relative",top:-1}}):Object($t.jsx)(LD,{...Ma}):e}getDynamicStyles(){const{checked:e,showCorrectness:t,pressed:n,primaryProductColor:s,correct:i}=this.props;if(!t&&n)return{borderColor:s,color:s,backgroundColor:tn};if(e){const e=t&&i?Jt:s;return{color:tn,backgroundColor:e,borderColor:e}}return{borderColor:on,color:on}}render(){const{checked:e,showCorrectness:t,correct:n,focused:s,primaryProductColor:i}=this.props;return Object($t.jsx)(FD,{color:i,visible:s,children:Object($t.jsx)("div",{style:this.getDynamicStyles(),className:Object(Nn.css)(BD.libraryCircle,t&&n&&BD.libraryCircleCorrect,t&&!n&&BD.libraryCircleIncorrect,t&&!n&&e&&BD.libraryCircleIncorrectSelected),"data-is-radio-icon":!0,children:this.getChoiceInner()})})}}class WD extends DD.Component{a11yText(e){return this.props.checked?this.props.showCorrectness?this.props.correct?i18n._("(Choice %(letter)s, Checked, Correct)",{letter:e}):i18n._("(Choice %(letter)s, Checked, Incorrect)",{letter:e}):i18n._("(Choice %(letter)s, Checked)",{letter:e}):this.props.showCorrectness&&this.props.correct?i18n._("(Choice %(letter)s, Correct Answer)",{letter:e}):i18n._("(Choice %(letter)s)",{letter:e})}getLetter(){const e=i18n._("A B C D E F G H I J K L M N O P Q R S T U V W X Y Z").split(" "),t=this.props.pos;return t<e.length?e[t]:" "}render(){const{reviewMode:e,checked:t,correct:n,product:s,showCorrectness:i,pressed:r,focused:o,primaryProductColor:a}=this.props,l=this.getLetter();return"sat"===s?Object($t.jsx)(zD,{letter:l,a11yText:this.a11yText(l),reviewMode:e,checked:t,correct:n}):Object($t.jsx)(qD,{letter:l,a11yText:this.a11yText(l),reviewMode:e,checked:t,pressed:r,focused:o,correct:n,showCorrectness:i,primaryProductColor:a})}}WD.defaultProps={primaryProductColor:Jt};const BD=Nn.StyleSheet.create({satCircle:{display:"block",borderRadius:25,borderStyle:"solid",borderWidth:2,content:"''",height:25,width:25,position:"absolute",top:1,left:1},libraryCircle:{width:24,height:24,boxSizing:"border-box",borderRadius:24,borderStyle:"solid",borderWidth:2,fontFamily:Xt,fontWeight:"bold",fontSize:12,display:"flex",alignItems:"center",justifyContent:"center",lineHeight:"1px"},libraryCircleCorrect:{fontSize:24},libraryCircleIncorrect:{fontSize:24,borderColor:ln,color:ln},libraryCircleIncorrectSelected:{backgroundColor:ln,color:tn},letter:{border:"2px solid transparent",width:25,height:25,position:"absolute",left:1,top:1,display:"flex",alignItems:"center",justifyContent:"center",fontFamily:Zt,fontSize:13}});RD.exports=WD;var VD=RD.exports,HD={exports:{}};HD.exports;h.a,x.b;const UD=createReactClass({displayName:"ToggleableRadioButton",handleClick:function(e){this.props.onChecked(!this.props.checked)},handleKeyUp:function(e){" "===e.key&&(this.props.onChecked(!this.props.checked),e.preventDefault())},handleChange:function(e){!this.props.checked&&e.target.checked&&this.props.onChecked(!0)},handleKeyDown:function(e){" "===e.key&&e.preventDefault()},render:function(){const{inputRef:e,onChecked:t,...n}=this.props;return Object($t.jsx)("input",{...n,type:"radio",onChange:this.handleChange,onClick:this.handleClick,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,ref:this.props.inputRef})}});HD.exports=UD;var GD=HD.exports,$D={exports:{}};$D.exports;x.b,h.a;const YD=v.a,KD=xh,XD=mh,ZD=GD,JD=VD,QD=MD,eL={backgroundColor:"#E4F3F9",outline:`2px solid ${mn}`,zIndex:1},tL="16px 16px",nL="12px 16px",sL=createReactClass({displayName:"Choice",statics:{styles:Nn.StyleSheet.create({pos:{display:"none"},description:{display:"inline-block",width:"100%"},satDescription:{display:"block",position:"relative",boxSizing:"border-box",cursor:"pointer",marginLeft:0,padding:"17px 14px"},satDescriptionInputFocused:{...eL},satDescriptionInputActive:{...eL,backgroundColor:"#D0EDF4"},satDescriptionCorrect:{color:bn},satDescriptionCorrectChecked:{backgroundColor:"#E4F7E4"},satDescriptionIncorrectChecked:{color:xn,backgroundColor:"#F2EBEB"},input:{display:"inline-block",width:20,margin:3,marginLeft:-20,marginRight:0,float:"none"},satReviewInput:{pointerEvents:"none"},satRadioOptionContent:{userSelect:"text",display:"block",marginLeft:45,cursor:"inherit"},satReviewRadioOptionContent:{fontWeight:"bold"},satCheckboxOptionContent:{position:"absolute",display:"block",top:"50%",margin:"-16px 0 0 0",width:"auto"},choiceIconWrapper:{display:"flex",marginRight:12,flexShrink:0},optionStatusContainer:{display:"block"},rationale:{display:"block"},nonSatRationale:{padding:tL,paddingTop:0,marginLeft:44,[XD.smOrSmaller]:{padding:nL,paddingTop:0}},satReviewRationale:{marginTop:13,marginLeft:45},label:{display:"block"},responsiveLabel:{WebkitTapHighlightColor:"transparent",display:"flex"},satLabel:{cursor:"pointer"},intermediateResponsiveCheckbox:{display:"flex",alignItems:"center",padding:tL,[XD.smOrSmaller]:{padding:nL}},intermediateResponsiveCheckboxReview:{alignItems:"flex-start"},crossOutLink:{textAlign:"right",alignSelf:"center",width:100}})},getDefaultProps:function(){return{checked:!1,classSet:{},disabled:!1,editMode:!1,showRationale:!1,type:"radio",pos:0}},getInitialState:function(){return{isInputFocused:!1,isInputActive:!1}},componentWillUpdate(e){this.state.isInputFocused&&e.disabled&&this.setState({isInputFocused:!1})},onInputFocus:function(){this.setState({isInputFocused:!0})},onInputBlur:function(){this.setState({isInputFocused:!1})},onInputMouseDown:function(e){"mousedown"===e.type&&this.justFinishedTouch||(this.setState({isInputActive:!0}),this.props.apiOptions.satStyling&&this._input&&this._input.focus())},onInputMouseUp:function(e){if("mouseup"!==e.type||!this.justFinishedTouch){if("touchend"===e.type)return this.justFinishedTouch=!0,void setTimeout((()=>{this.setState({isInputActive:!1}),this.justFinishedTouch=!1}),10);this.setState({isInputActive:!1}),this.props.apiOptions.satStyling&&this._input&&this._input.focus()}},onInputMouseOut:function(){this.setState({isInputActive:!1})},inputRef:function(e){this._input=e},renderOptionStatus(){const{correct:e,checked:t,reviewMode:n}=this.props;if(n&&!this.props.apiOptions.satStyling)return Object($t.jsx)(QD,{checked:t,correct:e})},renderChoiceIcon(){const{radioStyleVersion:e,primaryProductColor:t}=this.props.apiOptions.styling;return"undefined"!==typeof e&&"final"===e||this.props.apiOptions.satStyling?Object($t.jsx)(JD,{pos:this.props.pos,correct:this.props.correct,pressed:this.state.isInputActive,focused:this.state.isInputFocused,checked:this.props.checked,showCorrectness:this.props.showCorrectness,reviewMode:this.props.reviewMode,product:this.props.apiOptions.satStyling?"sat":"library",primaryProductColor:t}):null},_toggleCrossOut:function(){!this.props.crossedOut?this._sendChange({checked:!1,crossedOut:!0}):this._sendChange({crossedOut:!1})},_sendChange:function(e){const t=null!=e.checked?e.checked:this.props.checked,n=null!=e.crossedOut?e.crossedOut:this.props.crossedOut;this.props.onChange({checked:t,crossedOut:n})},render:function(){const e=sL.styles,t=this.props.apiOptions.satStyling,n=this.props.apiOptions.isMobile,{radioStyleVersion:s}=this.props.apiOptions.styling,i="undefined"!==typeof s&&"final"===s,r=YD(this.props.className,"checkbox-label",Object(Nn.css)(e.label,n&&KD.disableTextSelection,!t&&e.responsiveLabel,t&&e.satLabel)),o={type:this.props.type,name:this.props.groupName,id:`${this.props.groupName}-choice-${this.props.pos}`,checked:this.props.checked,disabled:this.props.disabled,onFocus:this.onInputFocus,onBlur:this.onInputBlur,className:Object(Nn.css)(!i&&KD.perseusInteractive,!i&&e.input,!i&&KD.responsiveInput,!i&&!t&&KD.responsiveRadioInput,!i&&!t&&this.state.isInputActive&&KD.responsiveRadioInputActive,i&&KD.perseusSrOnly,t&&KD.perseusSrOnly,t&&this.props.reviewMode&&e.satReviewInput)};let a=null;a="radio"===this.props.type?Object($t.jsx)(ZD,{onChecked:e=>{this._sendChange({checked:e})},inputRef:this.inputRef,...o}):Object($t.jsx)("input",{onChange:e=>{this._sendChange({checked:e.target.checked})},ref:this.inputRef,...o});const{reviewMode:l,correct:c,checked:h,isLastChoice:p}=this.props,u=t&&l&&c,d=t&&l&&!c&&h,g=YD("description",u&&"sat-correct",d&&"sat-incorrect",Object(Nn.css)(!t&&e.description,t&&this.state.isInputFocused&&e.satDescriptionInputFocused,t&&this.state.isInputActive&&e.satDescriptionInputActive,t&&e.satDescription,u&&e.satDescriptionCorrect,u&&h&&e.satDescriptionCorrectChecked,d&&e.satDescriptionIncorrectChecked,t&&p&&e.satDescriptionLastChoice)),f=YD("checkbox",Object(Nn.css)(KD.perseusInteractive,!t&&e.choiceIconWrapper,t&&e.satCheckboxOptionContent)),m=YD("checkbox-and-option",Object(Nn.css)(!t&&e.intermediateResponsiveCheckbox,!t&&l&&e.intermediateResponsiveCheckboxReview)),b=YD("perseus-radio-rationale-content",Object(Nn.css)(e.rationale,!t&&e.nonSatRationale,t&&e.satReviewRationale)),v=this.props.editMode?"div":"label",x=!this.props.showCorrectness&&!t&&document.location.href.indexOf("PERSEUS-HACK-SHOW-CROSS-OUT")>=0,y=!t&&!l&&this.props.apiOptions.readOnly||x&&this.props.crossedOut;return Object($t.jsxs)(v,{htmlFor:!this.props.editMode&&o.id,className:r,style:{opacity:y?.5:1},children:[Object($t.jsxs)("div",{className:g,onMouseDown:this.onInputMouseDown,onMouseUp:this.onInputMouseUp,onMouseOut:this.onInputMouseOut,onTouchStart:this.onInputMouseDown,onTouchEnd:this.onInputMouseUp,children:[Object($t.jsxs)("div",{className:m,children:[Object($t.jsxs)("span",{className:f,children:[a,this.renderChoiceIcon()]}),Object($t.jsxs)("span",{className:YD(Ps.RADIO.OPTION_CONTENT,Ps.INTERACTIVE,Object(Nn.css)(t&&e.satRadioOptionContent,t&&l&&e.satReviewRadioOptionContent)),style:{cursor:"default"},children:[Object($t.jsx)("div",{className:Object(Nn.css)(e.optionStatusContainer),children:this.renderOptionStatus()}),Object($t.jsx)("div",{children:this.props.content})]})]}),this.props.showRationale&&Object($t.jsx)("div",{className:b,children:this.props.rationale})]}),x&&Object($t.jsx)("a",{href:"javascript:void 0",onClick:this._toggleCrossOut,className:Object(Nn.css)(e.crossOutLink),children:this.props.crossedOut?i18n.i18nDoNotTranslate("Uncross out"):i18n.i18nDoNotTranslate("Cross out")})]})}});$D.exports=sL;var iL=$D.exports,rL={exports:{}};rL.exports;const oL=v.a,aL=(h.a,i.a),lL=x.b,cL=Is.ClassNames,hL=gh,pL=xh,uL=mh,dL=ce.captureScratchpadTouchStart,gL=iL,fL=createReactClass({displayName:"ChoiceNoneAbove",getDefaultProps:function(){return{showContent:!0}},render:function(){const e=lL.extend({},this.props,{className:oL(this.props.className,"none-of-above"),content:this.props.showContent?this.props.content:Object($t.jsx)(hL,{content:i18n._("None of the above")},"noneOfTheAboveRenderer")});return Object($t.jsx)(gL,{...e})}}),mL=Tn,bL=createReactClass({displayName:"BaseRadio",statics:{styles:Nn.StyleSheet.create({instructions:{display:"block",color:an,fontSize:14,lineHeight:1.25,fontStyle:"normal",fontWeight:"bold",marginBottom:16},instructionsMobile:{fontSize:18,[uL.smOrSmaller]:{fontSize:16},[uL.xl]:{fontSize:20}},radio:{width:"100%"},responsiveRadioContainer:{borderBottom:`1px solid ${mL}`,borderTop:`1px solid ${mL}`,width:"auto",[uL.smOrSmaller]:{marginLeft:wn,marginRight:wn}},radioContainerFirstHighlighted:{borderTop:"1px solid rgba(0, 0, 0, 0)"},radioContainerLastHighlighted:{borderBottom:"1px solid rgba(0, 0, 0, 0)"},satRadio:{background:"none",marginLeft:0,userSelect:"none"},satRadioOption:{margin:0,padding:0,borderBottom:"1px solid #ccc",":first-child":{borderTop:"1px solid #ccc"}},satRadioOptionCorrect:{borderBottomColor:vn,":first-child":{borderTopColor:vn}},satRadioOptionIncorrect:{borderBottomColor:yn,":first-child":{borderTopColor:yn}},satRadioOptionNextCorrect:{borderBottomColor:vn},satRadioOptionNextIncorrect:{borderBottomColor:yn},satReviewRadioOption:{pointerEvents:"none"},item:{marginLeft:20},inlineItem:{display:"inline-block",paddingLeft:20,verticalAlign:"middle"},responsiveItem:{marginLeft:0,padding:0,":not(:last-child)":{borderBottom:`1px solid ${mL}`}},selectedItem:{background:"white"},aboveBackdrop:{position:"relative",zIndex:1062},aboveBackdropMobile:{boxShadow:"0 0 4px 0 rgba(0, 0, 0, 0.2),0 0 2px 0 rgba(0, 0, 0, 0.1)",":not(:last-child)":{borderBottom:"1px solid rgba(0, 0, 0, 0)"}},nextHighlighted:{":not(:last-child)":{borderBottom:"1px solid rgba(0, 0, 0, 0)"}},responsiveContainer:{overflow:"auto",marginLeft:wn,marginRight:wn,paddingLeft:jn},responsiveFieldset:{paddingRight:jn}})},getDefaultProps:function(){return{editMode:!1}},getInitialState:function(){return{radioGroupName:lL.uniqueId("perseus_radio_")}},updateChoice:function(e,t){let n;n=t.checked&&!this.props.multipleSelect?this.props.choices.map((e=>!1)):this.props.choices.map((e=>e.checked));const s=this.props.choices.map((e=>e.crossedOut));n[e]=t.checked,s[e]=t.crossedOut,this.props.onChange({checked:n,crossedOut:s})},focus:function(e){return aL.findDOMNode(this.refs["radio"+(e||0)]).focus(),!0},getInstructionsText:function(){return this.props.multipleSelect?this.props.countChoices?i18n._("Choose %(numCorrect)s answers:",{numCorrect:this.props.numCorrect}):i18n._("Choose all answers that apply:"):i18n._("Choose 1 answer:")},deselectEnabled:function(){return this.props.apiOptions.isMobile||this.props.deselectEnabled},render:function(){const e=this.props.multipleSelect?"checkbox":"radio",t=this.props.reviewModeRubric,n=!!t,s=bL.styles,i=this.props.apiOptions.satStyling,r=this.props.apiOptions.isMobile,o=this.props.choices,a=o[0].highlighted,l=o[o.length-1].highlighted,c=oL("perseus-widget-radio",!this.props.editMode&&"perseus-rendered-radio",Object(Nn.css)(s.radio,!i&&s.responsiveRadioContainer,!i&&a&&r&&s.radioContainerFirstHighlighted,!i&&l&&r&&s.radioContainerLastHighlighted,i&&s.satRadio)),h=oL("instructions",Object(Nn.css)(s.instructions,r&&s.instructionsMobile)),p=this.getInstructionsText(),u=!i,d=Object(Nn.css)(s.responsiveFieldset),g=Object($t.jsxs)("fieldset",{className:`perseus-widget-radio-fieldset ${d}`,children:[Object($t.jsx)("legend",{className:"perseus-sr-only",children:p}),u&&Object($t.jsx)("div",{className:h,children:p}),Object($t.jsx)("ul",{className:c,children:this.props.choices.map((function(r,o){let a=gL;const l={ref:`radio${o}`,apiOptions:this.props.apiOptions,checked:r.checked,crossedOut:r.crossedOut,reviewMode:n,correct:r.correct,rationale:r.rationale,content:r.content,disabled:this.props.apiOptions.readOnly||r.disabled,editMode:this.props.editMode,groupName:this.state.radioGroupName,isLastChoice:o===this.props.choices.length-1,showCorrectness:n||!!r.showCorrectness,showRationale:r.hasRationale&&(n||r.showRationale),type:e,pos:o,deselectEnabled:this.deselectEnabled(),onChange:e=>{this.updateChoice(o,e)}};r.isNoneOfTheAbove&&(a=fL,lL.extend(l,{showContent:r.revealNoneOfTheAbove}));const c=this.props.choices[o+1],h=!!c&&c.highlighted,p=e=>{const o=i&&n&&e,a=i&&n&&c&&c.checked;return Object(Nn.css)(pL.aboveScratchpad,s.item,!i&&s.responsiveItem,!i&&e&&s.selectedItem,!i&&e&&r.highlighted&&s.aboveBackdrop,!i&&e&&r.highlighted&&this.props.apiOptions.isMobile&&s.aboveBackdropMobile,!i&&h&&this.props.apiOptions.isMobile&&s.nextHighlighted,i&&s.satRadioOption,o&&!r.correct&&s.satRadioOptionIncorrect,o&&r.correct&&s.satRadioOptionCorrect,a&&!c.correct&&s.satRadioOptionNextIncorrect,a&&c.correct&&s.satRadioOptionNextCorrect,i&&t&&s.satReviewRadioOption)};p(!0);const u=oL(p(r.checked),cL.RADIO.OPTION,r.checked&&cL.RADIO.SELECTED,n&&t.choices[o].correct&&cL.CORRECT,n&&!t.choices[o].correct&&cL.INCORRECT);let d=null,g=null;return this.props.editMode&&(g=e=>{let t=e.target;for(;t&&t!==d;){if(t.getAttribute("data-is-radio-icon"))return void this.updateChoice(o,{checked:!r.checked});t=t.parentNode}}),Object($t.jsx)("li",{ref:e=>d=e,className:u,onClick:g,onTouchStart:this.props.labelWrap?dL:null,children:Object($t.jsx)(a,{...l})},o)}),this)})]});return Object($t.jsx)("div",{className:Object(Nn.css)(!i&&s.responsiveContainer),children:g})}});rL.exports=bL;var vL=rL.exports,xL={exports:{}},yL=(xL.exports,h.a,x.b),jL=vL,wL=mu,OL=lv,CL=Kt,SL=Lf,kL=createReactClass({displayName:"ChoiceEditor",render:function(){var e=this.props.choice.correct?"correct":"incorrect",t="Type a choice here...";this.props.choice.isNoneOfTheAbove&&(t=this.props.choice.correct?"Type the answer to reveal to the user...":"None of the above");var n=Object($t.jsx)(OL,{ref:"content-editor",apiOptions:this.props.apiOptions,content:this.props.choice.content||"",widgetEnabled:!1,placeholder:t,disabled:this.props.choice.isNoneOfTheAbove&&!this.props.choice.correct,onChange:this.props.onContentChange}),s=Object($t.jsx)(OL,{ref:"clue-editor",apiOptions:this.props.apiOptions,content:this.props.choice.clue||"",widgetEnabled:!1,placeholder:i18n._(`Why is this choice ${e}?`),onChange:this.props.onClueChange}),i=Object($t.jsx)("a",{className:"simple-button orange delete-choice",href:"#",onClick:this.props.onDelete,title:"Remove this choice",children:Object($t.jsx)(CL,{..._a})});return Object($t.jsxs)("div",{className:"choice-clue-editors",children:[Object($t.jsx)("div",{className:`choice-editor ${e}`,children:n}),Object($t.jsx)("div",{className:"clue-editor",children:s}),this.props.showDelete&&i]})}}),_L=createReactClass({displayName:"RadioEditor",getDefaultProps:function(){return{choices:[{},{}],displayCount:null,randomize:!1,hasNoneOfTheAbove:!1,multipleSelect:!1,countChoices:!1,deselectEnabled:!1}},render:function(){var e=yL.reduce(this.props.choices,(function(e,t){return t.correct?e+1:e}),0);return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("a",{href:"https://docs.google.com/document/d/1frZf7yrWVWb1n4tVjqlzqVUiv1pn4cZXbxgP62-JDBY/edit#heading=h.8ng1isya19nu",target:"_blank",children:"Multiple choice style guide"}),Object($t.jsx)("br",{}),Object($t.jsx)("div",{className:"perseus-widget-left-col",children:Object($t.jsx)(SL,{label:"Multiple selections",labelAlignment:"right",multipleSelect:this.props.multipleSelect,onChange:this.onMultipleSelectChange})}),Object($t.jsx)("div",{className:"perseus-widget-right-col",children:Object($t.jsx)(SL,{label:"Randomize order",labelAlignment:"right",randomize:this.props.randomize,onChange:this.props.onChange})}),this.props.multipleSelect&&Object($t.jsx)("div",{className:"perseus-widget-left-col",children:Object($t.jsx)(SL,{label:"Specify number correct",labelAlignment:"right",countChoices:this.props.countChoices,onChange:this.onCountChoicesChange})})]}),Object($t.jsx)(jL,{ref:"baseRadio",multipleSelect:this.props.multipleSelect,countChoices:this.props.countChoices,numCorrect:e,editMode:!0,labelWrap:!1,apiOptions:this.props.apiOptions,choices:this.props.choices.map((function(e,t){return{content:Object($t.jsx)(kL,{ref:`choice-editor${t}`,apiOptions:this.props.apiOptions,choice:e,onContentChange:e=>{"content"in e&&this.onContentChange(t,e.content)},onClueChange:e=>{"content"in e&&this.onClueChange(t,e.content)},onDelete:this.onDelete.bind(this,t),showDelete:this.props.choices.length>=2}),isNoneOfTheAbove:e.isNoneOfTheAbove,checked:e.correct}}),this),onChange:this.onChange}),Object($t.jsxs)("div",{className:"add-choice-container",children:[Object($t.jsxs)("a",{className:"simple-button orange",href:"#",onClick:this.addChoice.bind(this,!1),children:[Object($t.jsx)(CL,{...wa})," Add a choice"," "]}),!this.props.hasNoneOfTheAbove&&Object($t.jsxs)("a",{className:"simple-button",href:"#",onClick:this.addChoice.bind(this,!0),children:[Object($t.jsx)(CL,{...wa})," None of the above"," "]})]})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return wL.change.apply(this,t)},onMultipleSelectChange:function(e){e=e.multipleSelect;var t=yL.reduce(this.props.choices,(function(e,t){return t.correct?e+1:e}),0);if(!e&&t>1){var n=yL.map(this.props.choices,(function(e){return yL.defaults({correct:!1},e)}));this.props.onChange({multipleSelect:e,choices:n})}else this.props.onChange({multipleSelect:e})},onCountChoicesChange:function(e){e=e.countChoices,this.props.onChange({countChoices:e})},onChange:function(e){let{checked:t}=e;var n=yL.map(this.props.choices,((e,n)=>yL.extend({},e,{correct:t[n],content:e.isNoneOfTheAbove&&!t[n]?"":e.content})));this.props.onChange({choices:n})},onContentChange:function(e,t){var n=this.props.choices.slice();n[e]=yL.extend({},n[e],{content:t}),this.props.onChange({choices:n})},onClueChange:function(e,t){var n=this.props.choices.slice();n[e]=yL.extend({},n[e],{clue:t}),""===t&&delete n[e].clue,this.props.onChange({choices:n})},onDelete:function(e,t){t.preventDefault();var n=this.props.choices.slice(),s=n[e];n.splice(e,1),this.props.onChange({choices:n,hasNoneOfTheAbove:this.props.hasNoneOfTheAbove&&!s.isNoneOfTheAbove})},addChoice:function(e,t){t.preventDefault();var n=this.props.choices.slice(),s={isNoneOfTheAbove:e},i=n.length-(this.props.hasNoneOfTheAbove?1:0);n.splice(i,0,s),this.props.onChange({choices:n,hasNoneOfTheAbove:e||this.props.hasNoneOfTheAbove},(()=>{this.refs[`choice-editor${i}`].refs["content-editor"].focus()}))},setDisplayCount:function(e){this.props.onChange({displayCount:e})},focus:function(){return this.refs["choice-editor0"].refs["content-editor"].focus(),!0},getSaveWarnings:function(){return yL.some(yL.pluck(this.props.choices,"correct"))?[]:["No choice is marked as correct."]},serialize:function(){return yL.pick(this.props,"choices","randomize","multipleSelect","countChoices","displayCount","hasNoneOfTheAbove","deselectEnabled")}});xL.exports=_L;var TL=xL.exports,ML={exports:{}};ML.exports;h.a;const NL=x.b,PL=gh,IL=Xj,EL=ce,AL=vL,RL=createReactClass({displayName:"Radio",getDefaultProps:function(){return{choices:[{}],displayCount:null,multipleSelect:!1,countChoices:!1,deselectEnabled:!1,linterContext:je}},_renderRenderer:function(e){let t=1;const n={},s=(e=e||"").replace(/\{\{passage-ref (\d+) (\d+)(?: "([^"]*)")?\}\}/g,((e,s,i,r)=>{const o="passage-ref "+t;return t++,n[o]={type:"passage-ref",graded:!1,options:{passageNumber:parseInt(s),referenceNumber:parseInt(i),summaryText:r},version:IL.version},"[["+EL.snowman+" "+o+"]]"}));return Object($t.jsx)(PL,{content:s,widgets:n,findExternalWidgets:this.props.findWidgets,alwaysUpdate:!0,linterContext:this.props.linterContext},"choiceContentRenderer")},focus:function(e){return this.refs.baseRadio.focus(e)},updateChoices:function(e){const{choiceStates:t,choices:n}=this.props;let s;s=t?t.map((e=>({...e}))):n.map((()=>({selected:!1,crossedOut:!1,highlighted:!1,rationaleShown:!1,correctnessShown:!1,readOnly:!1}))),s.forEach(((t,n)=>{t.selected=e.checked[n],t.crossedOut=e.crossedOut[n]})),this.props.onChange({choiceStates:s}),this.props.trackInteraction()},getUserInput:function(){if(this.props.choiceStates){let e=null,t=!1;const n=this.props.choiceStates,s=n.map((()=>!1)),i=this.props.countChoices,r=this.props.numCorrect;for(let o=0;o<s.length;o++){const i=this.props.choices[o].originalIndex;s[i]=n[o].selected,this.props.choices[o].isNoneOfTheAbove&&(e=i,s[o]&&(t=!0))}return{countChoices:i,choicesSelected:s,numCorrect:r,noneOfTheAboveIndex:e,noneOfTheAboveSelected:t}}if(this.props.values){let e=null,t=!1;const n=this.props.values.slice(),s=this.props.countChoices,i=this.props.numCorrect;for(let r=0;r<this.props.values.length;r++){const s=this.props.choices[r].originalIndex;n[s]=this.props.values[r],this.props.choices[r].isNoneOfTheAbove&&(e=s,n[r]&&(t=!0))}return{choicesSelected:n,noneOfTheAboveIndex:e,noneOfTheAboveSelected:t,countChoices:s,numCorrect:i}}return{choicesSelected:NL.map(this.props.choices,(()=>!1))}},simpleValidate:function(e){return RL.validate(this.getUserInput(),e)},enforceOrdering:function(e){const t=NL.pluck(e,"content");return NL.isEqual(t,[i18n._("False"),i18n._("True")])||NL.isEqual(t,[i18n._("No"),i18n._("Yes")])?[e[1]].concat([e[0]]):e},showRationalesForCurrentlySelectedChoices(e){if(this.props.choiceStates){const t=this.simpleValidate(e),n="points"===t.type&&t.total===t.earned,s=this.props.choiceStates.map((e=>({...e,highlighted:e.selected,rationaleShown:e.selected||e.rationaleShown||n,readOnly:e.selected||e.readOnly||n,correctnessShown:e.selected||e.correctnessShown})));this.props.onChange({choiceStates:s},null,!0)}},deselectIncorrectSelectedChoices(){if(this.props.choiceStates){const e=this.props.choiceStates.map(((e,t)=>({...e,selected:e.selected&&!!this.props.choices[t].correct,highlighted:!1})));this.props.onChange({choiceStates:e},null,!1)}},render:function(){let e,t=this.props.choices;return e=this.props.static?NL.map(t,(e=>({selected:e.correct,crossedOut:e.crossedOut,readOnly:!0,highlighted:!1,rationaleShown:!0,correctnessShown:!0}))):this.props.choiceStates?this.props.choiceStates:this.props.values?NL.map(this.props.values,(e=>({selected:e,crossedOut:!1,readOnly:!1,highlighted:!1,rationaleShown:!1,correctnessShown:!1}))):NL.map(t,(()=>({selected:!1,crossedOut:!1,readOnly:!1,highlighted:!1,rationaleShown:!1,correctnessShown:!1}))),t=NL.map(t,((t,n)=>{const s=t.isNoneOfTheAbove&&!t.content?i18n._("None of the above"):t.content,{selected:i,crossedOut:r,rationaleShown:o,correctnessShown:a,readOnly:l,highlighted:c}=e[n],h=this.props.reviewModeRubric&&this.props.reviewModeRubric.choices[n];return{content:this._renderRenderer(s),checked:i,correct:"undefined"===typeof t.correct?!!h&&h.correct:t.correct,disabled:l,hasRationale:!!t.clue,rationale:this._renderRenderer(t.clue),showRationale:o,showCorrectness:a,isNoneOfTheAbove:t.isNoneOfTheAbove,revealNoneOfTheAbove:this.props.questionCompleted&&i,crossedOut:r,highlighted:c}})),t=this.enforceOrdering(t),Object($t.jsx)(AL,{ref:"baseRadio",labelWrap:!0,multipleSelect:this.props.multipleSelect,countChoices:this.props.countChoices,numCorrect:this.props.numCorrect,choices:t,onChange:this.updateChoices,reviewModeRubric:this.props.reviewModeRubric,deselectEnabled:this.props.deselectEnabled,apiOptions:this.props.apiOptions})}});NL.extend(RL,{validate:function(e,t){const n=NL.reduce(e.choicesSelected,((e,t)=>e+(t?1:0)),0);if(0===n)return{type:"invalid",message:null};if(e.countChoices&&n!==e.numCorrect)return{type:"invalid",message:i18n._("Please choose the correct number of answers.")};if(e.noneOfTheAboveSelected&&n>1)return{type:"invalid",message:i18n._("'None of the above' may not be selected when other answers are selected.")};return{type:"points",earned:NL.all(e.choicesSelected,(function(n,s){let i;return i=e.noneOfTheAboveIndex===s?NL.all(t.choices,(function(e,t){return s===t||!e.correct})):!!t.choices[s].correct,i===n}))?1:0,total:1,message:null}}}),ML.exports=RL;var DL=ML.exports,LL={exports:{}},FL=(LL.exports,x.b),zL=ce.shuffle,qL=DL,WL=(e,t)=>{const n=((e,t)=>{var n,s=e.choices.slice();return s=FL.map(s,((e,t)=>FL.extend({},e,{originalIndex:t,correct:Boolean(e.correct)}))),function(e){var t=null,n=FL.reject(e,(function(e,n){if(e.isNoneOfTheAbove)return t=e,!0}));return t&&n.push(t),n}((n=s,e.randomize?zL(n,t):n))})(e,t),s=FL.reduce(e.choices,(function(e,t){return t.correct?e+1:e}),0),{hasNoneOfTheAbove:i,multipleSelect:r,countChoices:o,correctAnswer:a,deselectEnabled:l}=e;return{numCorrect:s,hasNoneOfTheAbove:i,multipleSelect:r,countChoices:o,correctAnswer:a,deselectEnabled:l,choices:n,selectedChoices:FL.pluck(n,"correct")}},BL={1:e=>{var t,n;if(e.noneOfTheAbove){t=FL.clone(e.choices);var s=FL.random(0,e.choices.length-1),i=FL.extend({},e.choices[s],{isNoneOfTheAbove:!0});t.splice(s,1),t.push(i),n=!0}else t=e.choices,n=!1;return FL.extend(FL.omit(e,"noneOfTheAbove"),{choices:t,hasNoneOfTheAbove:n})}};LL.exports={name:"radio",displayName:"Multiple choice",accessible:!0,widget:qL,transform:WL,staticTransform:WL,version:{major:1,minor:0},propUpgrades:BL,isLintable:!0};var VL=[[LL.exports,TL],[CD,cD],[eD,PR],[JA,gR]],HL={exports:{}};HL.exports;const UL=VL,GL=dA;HL.exports=UL.concat(GL);var $L=HL.exports,YL=n(42);const KL=YL;Hs.registerMany($L);KL.apiVersion,KL.itemDataVersion;const XL=fA;var ZL={apiVersion:KL.apiVersion,itemDataVersion:KL.itemDataVersion,init:fA,ArticleRenderer:iu,QuestionRenderer:$p,ItemRenderer:Hp,ServerItemRenderer:Ep,HintsRenderer:Bh,Renderer:gh,MultiItems:bp},JL={exports:{}};JL.exports;const QL=x.b,eF="unchanged",tF="changed",nF="added",sF="removed",iF=function(e,t,n){return"object"===typeof e||"object"===typeof t?function(e,t,n){const s=QL.isObject(e)?Object.keys(e):[],i=QL.isObject(t)?Object.keys(t):[],r=QL.union(s,i),o=QL.map(r,(function(n){return iF((e||{})[n],(t||{})[n],n)}));let a;a=void 0===e?nF:void 0===t?sF:QL.any(o,(function(e){return e.status!==eF}))?tF:eF;return{after:"",before:"",children:o,key:n,status:a}}(e,t,n):function(e,t,n){let s;return s=e===t?eF:void 0===e?nF:void 0===t?sF:tF,{after:JSON.stringify(t),before:JSON.stringify(e),children:[],key:n,status:s}}(e,t,n)};JL.exports=iF;var rF=JL.exports,oF={exports:{}};oF.exports;const aF=v.a,lF=(h.a,x.b),cF=rF,hF=Ic,pF=function(e){return 20*(e-1)},uF="before",dF="after",gF=createReactClass({displayName:"DiffSide",render:function(){const e=aF(this.props.className,{"diff-row":!0,before:this.props.side===uF,after:this.props.side===dF});return Object($t.jsx)("div",{className:e,children:Object($t.jsxs)("div",{style:{paddingLeft:pF(this.props.depth)},children:[this.props.showKey&&this.props.propKey+": ",Object($t.jsx)("span",{className:"inner-value dark "+this.props.className,children:this.props.value})]})})}}),fF=createReactClass({displayName:"CollapsedRow",getDefaultProps:function(){return{depth:0}},render:function(){const e=this;return Object($t.jsx)("div",{onClick:e.props.onClick,style:{clear:"both"},children:lF.map([uF,dF],(function(t){return Object($t.jsx)("div",{className:"diff-row collapsed "+t,children:Object($t.jsx)("div",{style:{paddingLeft:pF(e.props.depth)},children:Object($t.jsx)("span",{children:" [ show unmodified ] "})})},t)}))})}}),mF=createReactClass({displayName:"DiffEntry",getDefaultProps:function(){return{depth:0}},getInitialState:function(){return{expanded:this.props.expanded}},expand:function(){this.setState({expanded:!0})},render:function(){const e=this.props.entry,t="removed"===e.status,n="added"===e.status,s="changed"===e.status,i=e.children.length>0,r=aF({removed:t||s&&!i,dark:t,"blank-space":n}),o=aF({added:n||s&&!i,dark:n,"blank-space":t});let a;a=this.state.expanded?e.children:lF.select(e.children,(function(e){return"unchanged"!==e.status}));let l=a.length<e.children.length;e.children.length===a.length+1&&(a=e.children,l=!1);const c=this;return Object($t.jsxs)("div",{children:[e.key&&Object($t.jsxs)("div",{style:{clear:"both"},children:[Object($t.jsx)(gF,{side:uF,className:r,depth:this.props.depth,propKey:e.key,showKey:!n,value:e.before}),Object($t.jsx)(gF,{side:dF,className:o,depth:this.props.depth,propKey:e.key,showKey:!t,value:e.after})]}),lF.map(a,(function(e){return Object($t.jsx)(mF,{depth:c.props.depth+1,entry:e,expanded:c.state.expanded},e.key)})),l&&Object($t.jsx)(fF,{depth:this.props.depth+1,onClick:this.expand})]})}}),bF=createReactClass({displayName:"ImageWidgetDiff",render:function(){const{before:e,after:t}=this.props,n=e.options&&e.options.backgroundImage?e.options.backgroundImage.url:"",s=t.options&&t.options.backgroundImage?t.options.backgroundImage.url:"";return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:"diff-row before",children:n&&Object($t.jsx)("div",{className:aF({image:!0,"image-unchanged":n===s,"image-removed":n!==s}),children:Object($t.jsx)(hF,{src:n,title:n})})}),Object($t.jsx)("div",{className:"diff-row after",children:s&&Object($t.jsx)("div",{className:aF({image:!0,"image-unchanged":n===s,"image-added":n!==s}),children:Object($t.jsx)(hF,{src:s,title:s})})})]})}}),vF=createReactClass({displayName:"WidgetDiff",getDefaultProps:function(){return{after:{},before:{},type:""}},render:function(){const{after:e,before:t,title:n,type:s}=this.props,i=cF(t,e);return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:"diff-header",children:n}),Object($t.jsx)("div",{className:"diff-header",children:n}),Object($t.jsxs)("div",{className:"diff-body ui-helper-clearfix",children:["image"===s&&Object($t.jsx)(bF,{before:t,after:e}),Object($t.jsx)(mF,{entry:i})]})]})}});oF.exports=vF;var xF=oF.exports,yF=function(){function e(e){return{newPos:e.newPos,components:e.components.slice(0)}}function t(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t}function n(e){var t=e;return t=(t=(t=(t=t.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/"/g,"&quot;")}var s=function(e){this.ignoreWhitespace=e};s.prototype={diff:function(t,n){if(n===t)return[{value:n}];if(!n)return[{value:t,removed:!0}];if(!t)return[{value:n,added:!0}];n=this.tokenize(n),t=this.tokenize(t);var s=n.length,i=t.length,r=s+i,o=[{newPos:-1,components:[]}],a=this.extractCommon(o[0],n,t,0);if(o[0].newPos+1>=s&&a+1>=i)return o[0].components;for(var l=1;l<=r;l++)for(var c=-1*l;c<=l;c+=2){var h,p=o[c-1],u=o[c+1];a=(u?u.newPos:0)-c,p&&(o[c-1]=void 0);var d=p&&p.newPos+1<s,g=u&&0<=a&&a<i;if(d||g){!d||g&&p.newPos<u.newPos?(h=e(u),this.pushComponent(h.components,t[a],void 0,!0)):((h=e(p)).newPos++,this.pushComponent(h.components,n[h.newPos],!0,void 0));a=this.extractCommon(h,n,t,c);if(h.newPos+1>=s&&a+1>=i)return h.components;o[c]=h}else o[c]=void 0}},pushComponent:function(e,t,n,s){var i=e[e.length-1];i&&i.added===n&&i.removed===s?e[e.length-1]={value:this.join(i.value,t),added:n,removed:s}:e.push({value:t,added:n,removed:s})},extractCommon:function(e,t,n,s){for(var i=t.length,r=n.length,o=e.newPos,a=o-s;o+1<i&&a+1<r&&this.equals(t[o+1],n[a+1]);)o++,a++,this.pushComponent(e.components,t[o],void 0,void 0);return e.newPos=o,a},equals:function(e,t){var n=/\S/;return!(!this.ignoreWhitespace||n.test(e)||n.test(t))||e===t},join:function(e,t){return e+t},tokenize:function(e){return e}};var i=new s,r=new s(!0),o=new s;r.tokenize=o.tokenize=function(e){return t(e.split(/(\s+|\b)/))};var a=new s(!0);a.tokenize=function(e){return t(e.split(/([{}:;,]|\s+)/))};var l=new s;return l.tokenize=function(e){for(var t=[],n=e.split(/^/m),s=0;s<n.length;s++){var i=n[s],r=n[s-1];"\n"==i&&r&&"\r"===r[r.length-1]?t[t.length-1]+="\n":i&&t.push(i)}return t},{Diff:s,diffChars:function(e,t){return i.diff(e,t)},diffWords:function(e,t){return r.diff(e,t)},diffWordsWithSpace:function(e,t){return o.diff(e,t)},diffLines:function(e,t){return l.diff(e,t)},diffCss:function(e,t){return a.diff(e,t)},createPatch:function(e,t,n,s,i){var r=[];r.push("Index: "+e),r.push("==================================================================="),r.push("--- "+e+("undefined"===typeof s?"":"\t"+s)),r.push("+++ "+e+("undefined"===typeof i?"":"\t"+i));var o=l.diff(t,n);function a(e){return e.map((function(e){return" "+e}))}function c(e,t,n){var s=o[o.length-2],i=t===o.length-2,r=t===o.length-3&&(n.added!==s.added||n.removed!==s.removed);/\n$/.test(n.value)||!i&&!r||e.push("\\ No newline at end of file")}o[o.length-1].value||o.pop(),o.push({value:"",lines:[]});for(var h=0,p=0,u=[],d=1,g=1,f=0;f<o.length;f++){var m=o[f],b=m.lines||m.value.replace(/\n$/,"").split("\n");if(m.lines=b,m.added||m.removed){if(!h){var v=o[f-1];h=d,p=g,v&&(h-=(u=a(v.lines.slice(-4))).length,p-=u.length)}u.push.apply(u,b.map((function(e){return(m.added?"+":"-")+e}))),c(u,f,m),m.added?g+=b.length:d+=b.length}else{if(h)if(b.length<=8&&f<o.length-2)u.push.apply(u,a(b));else{var x=Math.min(b.length,4);r.push("@@ -"+h+","+(d-h+x)+" +"+p+","+(g-p+x)+" @@"),r.push.apply(r,u),r.push.apply(r,a(b.slice(0,x))),b.length<=4&&c(r,f,m),h=0,p=0,u=[]}d+=b.length,g+=b.length}}return r.join("\n")+"\n"},applyPatch:function(e,t){for(var n=t.split("\n"),s=[],i=!1,r=!1,o="I"===n[0][0]?4:0;o<n.length;o++)if("@"===n[o][0]){var a=n[o].split(/@@ -(\d+),(\d+) \+(\d+),(\d+) @@/);s.unshift({start:a[3],oldlength:a[2],oldlines:[],newlength:a[4],newlines:[]})}else"+"===n[o][0]?s[0].newlines.push(n[o].substr(1)):"-"===n[o][0]?s[0].oldlines.push(n[o].substr(1)):" "===n[o][0]?(s[0].newlines.push(n[o].substr(1)),s[0].oldlines.push(n[o].substr(1))):"\\"===n[o][0]&&("+"===n[o-1][0]?i=!0:"-"===n[o-1][0]&&(r=!0));var l=e.split("\n");for(o=s.length-1;o>=0;o--){for(var c=s[o],h=0;h<c.oldlength;h++)if(l[c.start-1+h]!==c.oldlines[h])return!1;Array.prototype.splice.apply(l,[c.start-1,+c.oldlength].concat(c.newlines))}if(i)for(;!l[l.length-1];)l.pop();else r&&l.push("");return l.join("\n")},convertChangesToXML:function(e){for(var t=[],s=0;s<e.length;s++){var i=e[s];i.added?t.push("<ins>"):i.removed&&t.push("<del>"),t.push(n(i.value)),i.added?t.push("</ins>"):i.removed&&t.push("</del>")}return t.join("")},convertChangesToDMP:function(e){for(var t,n=[],s=0;s<e.length;s++)t=e[s],n.push([t.added?1:t.removed?-1:0,t.value]);return n}}}(),jF=yF,wF={exports:{}};wF.exports;const OF=jF,CF=x.b,SF=function(e){return e.added?"added":e.removed?"removed":"unchanged"},kF=e=>CF.map(e.value,(t=>({value:t,status:SF(e)}))),_F=new OF.Diff;_F.tokenize=e=>CF.map(e,(e=>[e])),_F.join=(e,t)=>e.concat(t),_F.equals=CF.isEqual;const TF=e=>{return t=e,n=kF,CF.flatten(CF.map(t,n),!0);var t,n};wF.exports=function(e,t){const n=_F.diff(e,t),s=TF(n);return{before:CF.filter(s,(e=>"added"!==e.status)),after:CF.filter(s,(e=>"removed"!==e.status))}};var MF=wF.exports,NF={exports:{}};NF.exports;const PF=x.b;NF.exports=function(e){const t=[];let n=[];return PF.each(e,(e=>{const s=e.value.split("\n");PF.each(s,((s,i)=>{i>0&&(t.push(n),n=[]);const r=PF.extend({},e,{value:s});n.push(r)}))})),n.length&&t.push(n),t};var IF=NF.exports,EF={exports:{}};EF.exports;const AF=v.a,RF=(h.a,x.b),DF=jF,LF=IF,FF=MF,zF=Ic,qF="before",WF="after",BF=/http.*?\.png|web\+graphie[^)]*/g,VF=function(e){return e.match(BF)||[]},HF=function(e,t,n){return e.added?t:e.removed?n:""},UF=createReactClass({displayName:"ImageDiffSide",render:function(){return Object($t.jsx)("div",{children:RF.map(this.props.images,((e,t)=>{const n=AF({image:!0,"image-unchanged":"unchanged"===e.status,"image-added":"added"===e.status,"image-removed":"removed"===e.status});return Object($t.jsx)("div",{children:Object($t.jsx)("div",{className:n,children:Object($t.jsx)(zF,{src:e.value,title:e.value})})},t)}))})}}),GF=createReactClass({displayName:"TextDiff",getDefaultProps:function(){return{after:"",before:""}},getInitialState:function(){return{collapsed:this.props.before===this.props.after}},componentWillReceiveProps:function(e){this.setState({collapsed:e.before===e.after})},handleExpand:function(){this.setState({collapsed:!1})},render:function(){const e=DF.diffWords(this.props.before,this.props.after),t=LF(e),n=VF(this.props.before),s=VF(this.props.after),i=FF(n,s),r=RF.map(t,(e=>{const t={};return t.before=RF.map(e,(function(e,t){return Object($t.jsx)("span",{className:HF(e,"not-present","removed dark"),children:e.value},t)})),t.after=RF.map(e,(function(e,t){return Object($t.jsx)("span",{className:HF(e,"added dark","not-present"),children:e.value},t)})),t})),o=AF({"diff-row":!0,collapsed:this.state.collapsed});return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:"diff-header",children:this.props.title}),Object($t.jsx)("div",{className:"diff-header",children:this.props.title}),Object($t.jsx)("div",{className:"diff-body ui-helper-clearfix",children:RF.map([qF,WF],((e,t)=>Object($t.jsxs)("div",{className:"diff-row "+e,children:[!this.state.collapsed&&RF.map(r,((t,n)=>{const s=t[e].length>1,i=AF({"diff-line":!0,added:e===WF&&s,removed:e===qF&&s});return Object($t.jsx)("div",{className:i,children:t[e]},n)})),!this.state.collapsed&&Object($t.jsx)(UF,{images:i[e]})]},t)))}),RF.map([qF,WF],((e,t)=>Object($t.jsx)("div",{className:o+" "+e,onClick:this.handleExpand,children:this.state.collapsed&&Object($t.jsx)("span",{children:Object($t.jsxs)("span",{className:"expand-button",children:[" ","[ show unmodified ]"]})})},t)))]})}});EF.exports=GF;var $F=EF.exports,YF={exports:{}};YF.exports;h.a;const KF=x.b,XF=$F,ZF=xF,JF=Hs,QF=function(e,t){const{alignment:n,graded:s,options:i,type:r}=e||{},o={options:i};return t&&JF.getSupportedAlignments(r).length>1&&(o.alignment=n),"transformer"===r&&(o.graded=s),JF.supportsStaticMode(r)&&(o.static=e.static||void 0),o},ez=createReactClass({displayName:"RendererDiff",getDefaultProps:function(){return{after:{content:"",images:{},widgets:{}},before:{content:"",images:{},widgets:{}},showAlignmentOptions:!1,showSeparator:!1}},render:function(){const{after:e,before:t,showAlignmentOptions:n,showSeparator:s,title:i}=this.props;let r,o;(t.content||e.content)&&(r=Object($t.jsx)(XF,{before:t.content,after:e.content,title:i}));const a=Object.keys(t.widgets).filter((e=>t.content.includes(e))),l=Object.keys(e.widgets).filter((t=>e.content.includes(t)));if(a.length||l.length){o=KF.union(a,l).map((s=>Object($t.jsx)(ZF,{before:QF(t.widgets[s],n),after:QF(e.widgets[s],n),title:s,type:(t.widgets[s]||{}).type||(e.widgets[s]||{}).type},s)))}return Object($t.jsxs)("div",{children:[r,o,s&&Object($t.jsx)("div",{className:"diff-separator"})]})}});YF.exports=ez;var tz=YF.exports,nz={exports:{}};nz.exports;h.a;const sz=x.b,iz=tz,rz=createReactClass({displayName:"ArticleDiff",getInitialState:function(){return this._stateFromProps(this.props)},componentWillReceiveProps:function(e){this.setState(this._stateFromProps(e))},_stateFromProps:function(e){const{before:t,after:n}=e;return{before:Array.isArray(t)?t:[t],after:Array.isArray(n)?n:[n]}},render:function(){const{before:e,after:t}=this.state,n=Math.max(e.length,t.length),s=sz.times(n,(s=>Object($t.jsx)(iz,{before:s<e.length?e[s]:void 0,after:s<t.length?t[s]:void 0,title:`Section ${s+1}`,showAlignmentOptions:!0,showSeparator:s<n-1},s)));return Object($t.jsx)("div",{className:"framework-perseus",children:s})}});nz.exports=rz;var oz=nz.exports,az={exports:{}};az.exports;const lz=oz;class cz extends c.Component{constructor(){super(...arguments),this.state={swapped:!1},this.swap=()=>this.setState({swapped:!this.state.swapped})}render(){const{swapped:e}=this.state;return Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{type:"button",value:"Swap it!",onClick:this.swap}),Object($t.jsx)("div",{className:"perseus-diff",children:Object($t.jsx)(lz,{before:e?pz:hz,after:e?hz:pz})})]})}}const hz=[{content:"**What kind of structure is highlighted in green in the diagram shown?**\n \n![](https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png)![](https://ka-perseus-graphie.s3.amazonaws.com/a10ab9f9b66982637bd1cf1e3cfe493562144e15.png)\n\nHow  many apples? [[\u2603 numeric-input 1]]\n\n[[\u2603 image 1]]\n\nWhat's the structure? [[\u2603 dropdown 1]]",images:{"https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png":{width:250,height:150},"https://ka-perseus-graphie.s3.amazonaws.com/a10ab9f9b66982637bd1cf1e3cfe493562144e15.png":{width:397,height:397}},widgets:{"numeric-input 1":{type:"numeric-input",alignment:"default",static:!1,graded:!0,options:{static:!1,answers:[{value:8,status:"correct",message:"",simplify:"required",answerForms:["integer"],strict:!0,maxError:1}],size:"normal",coefficient:!1,labelText:""},version:{major:0,minor:0}},"image 1":{type:"image",alignment:"float-right",static:!1,graded:!0,options:{static:!1,title:"",range:[[0,10],[0,10]],box:[4288,2848],backgroundImage:{url:"https://ka-perseus-images.s3.amazonaws.com/f17ea8bfb4944b18ef2a3f61cc5a378a9d0b4900.jpg",width:4288,height:2848},labels:[],alt:"Freshly baked chocolate chip cookies on a cooling rack. ",caption:"*You might use stoichiometry skills to double a cookie recipe! Image credit: [Chocolate Chip Cookies](https://commons.wikimedia.org/wiki/File%3AChocolate_Chip_Cookies_-_kimberlykv.jpg) by Kimberley Vardeman on Wikimedia Commons, [CC-BY 2.0](https://creativecommons.org/licenses/by/2.0/deed.en)*"},version:{major:0,minor:0}},"dropdown 1":{type:"dropdown",alignment:"default",static:!1,graded:!0,options:{static:!1,placeholder:"",choices:[{content:"line segment",correct:!1},{content:"line",correct:!0},{content:"ray",correct:!1}]},version:{major:0,minor:0}}}}],pz=[{content:"**What kind of structure is highlighted in dashed green in the diagram shown?**\n \n![](https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png)\n![](web+graphie://ka-perseus-graphie.s3.amazonaws.com/70b65362dbffa72a371b2829549015149caaba73)\n\nHow  many apples? [[\u2603 numeric-input 1]]\n\n[[\u2603 image 1]]",images:{"https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png":{width:250,height:150},"web+graphie://ka-perseus-graphie.s3.amazonaws.com/70b65362dbffa72a371b2829549015149caaba73":{width:300,height:300}},widgets:{"numeric-input 1":{type:"numeric-input",alignment:"default",static:!1,graded:!0,options:{static:!1,answers:[{value:8,status:"correct",message:"",simplify:"required",answerForms:["integer"],strict:!1,errorBounds:{minError:.1,maxError:1}}],size:"normal",coefficient:!1,labelText:""},version:{major:0,minor:0}},"image 1":{type:"image",alignment:"float-right",static:!1,graded:!0,options:{static:!1,title:"",range:[[0,10],[0,10]],box:[4288,2848],backgroundImage:{url:"https://ka-perseus-images.s3.amazonaws.com/07d9e88e1dfccf69ec79f2eec619b886d81cd949.jpg",width:1536,height:2048},labels:[],alt:"Strawberry ice cream in a cone. ",caption:"*You might use stoichiometry skills to double an ice cream recipe! Image credit: [Ice Cream](https://commons.wikimedia.org/wiki/File%3ASoft_Ice_cream.jpg) by Kimberley Vardeman on Wikimedia Commons, [CC-BY 2.0](https://creativecommons.org/licenses/by/2.0/deed.en)*"},version:{major:0,minor:0}}}},{content:"A second section",images:{},widgets:{}}];az.exports=cz;var uz=az.exports,dz={exports:{}};dz.exports;h.a;const gz=x.b,fz=tz,mz=xF,bz=createReactClass({displayName:"ItemDiff",render:function(){const{before:e,after:t}=this.props,n=Math.max(e.hints.length,t.hints.length),s=Object($t.jsx)(fz,{before:e.question,after:t.question,title:"Question",showAlignmentOptions:!1,showSeparator:!0}),i=Object($t.jsx)(mz,{before:e.answerArea,after:t.answerArea,title:"Question extras"}),r=gz.times(n,(function(s){return Object($t.jsx)(fz,{before:s<e.hints.length?e.hints[s]:void 0,after:s<t.hints.length?t.hints[s]:void 0,title:`Hint ${s+1}`,showAlignmentOptions:!1,showSeparator:s<n-1},s)}));return Object($t.jsxs)("div",{className:"framework-perseus",children:[s,i,r&&Object($t.jsx)("div",{className:"diff-separator"}),r]})}});dz.exports=bz;var vz=dz.exports,xz={exports:{}};xz.exports;const yz=vz;class jz extends c.Component{constructor(){super(...arguments),this.state={swapped:!1},this.swap=()=>this.setState({swapped:!this.state.swapped})}render(){const{swapped:e}=this.state;return Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{type:"button",value:"Swap it!",onClick:this.swap}),Object($t.jsx)("div",{className:"perseus-diff",children:Object($t.jsx)(yz,{before:e?Oz:wz,after:e?wz:Oz})})]})}}const wz={question:{content:"**What kind of structure is highlighted in green in the diagram shown?**\n \n![](https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png)![](https://ka-perseus-graphie.s3.amazonaws.com/a10ab9f9b66982637bd1cf1e3cfe493562144e15.png)\n\nHow  many apples? [[\u2603 numeric-input 1]]\nWhat's the structure? [[\u2603 dropdown 1]]",images:{"https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png":{width:250,height:150},"https://ka-perseus-graphie.s3.amazonaws.com/a10ab9f9b66982637bd1cf1e3cfe493562144e15.png":{width:397,height:397}},widgets:{"numeric-input 1":{type:"numeric-input",alignment:"default",static:!1,graded:!0,options:{static:!1,answers:[{value:8,status:"correct",message:"",simplify:"required",answerForms:["integer"],strict:!0,maxError:null}],size:"normal",coefficient:!1,labelText:""},version:{major:0,minor:0}},"dropdown 1":{type:"dropdown",alignment:"default",static:!1,graded:!0,options:{static:!1,placeholder:"",choices:[{content:"line segment",correct:!1},{content:"line",correct:!0},{content:"ray",correct:!1}]},version:{major:0,minor:0}}}},answerArea:{calculator:!0},hints:[{content:"The highlighted part of the diagram has no starting point and no ending point; it continues forever in both directions, like this: \n\n![](https://ka-perseus-graphie.s3.amazonaws.com/2b6f0a4700f9fd840e5049de8c1f88206134fde1.png)",widgets:{}},{content:"A straight, one-dimensional structure continuing forever in both directions is called a *line*.",widgets:{}},{content:"The structure highlighted in green is a line.",widgets:{}}]},Oz={question:{content:"**What kind of structure is highlighted in dashed green in the diagram shown?**\n \n![](https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png)\n![](web+graphie://ka-perseus-graphie.s3.amazonaws.com/70b65362dbffa72a371b2829549015149caaba73)\n\nHow  many apples? [[\u2603 numeric-input 1]]\nWhat's the structure? [[\u2603 dropdown 1]]",images:{"https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png":{width:250,height:150},"web+graphie://ka-perseus-graphie.s3.amazonaws.com/70b65362dbffa72a371b2829549015149caaba73":{width:300,height:300}},widgets:{"numeric-input 1":{type:"numeric-input",alignment:"default",static:!1,graded:!0,options:{static:!1,answers:[{value:8,status:"correct",message:"",simplify:"required",answerForms:["integer"],strict:!1,maxError:null}],size:"normal",coefficient:!1,labelText:""},version:{major:0,minor:0}},"dropdown 1":{type:"dropdown",alignment:"default",static:!1,graded:!0,options:{static:!1,placeholder:"",choices:[{content:"line segment",correct:!0},{content:"line",correct:!1},{content:"ray",correct:!1}]},version:{major:0,minor:0}}}},answerArea:{calculator:!1},hints:[{content:"The highlighted part _of the diagram_ has *no* starting point and *no* ending point; it continues forever in both directions, like this: \n\n![](https://ka-perseus-graphie.s3.amazonaws.com/2b6f0a4700f9fd840e5049de8c1f88206134fde1.png)",widgets:{}},{content:"A straight, one-dimensional structure continuing forever in both directions is called a *line*.",widgets:{}},{content:"The structure highlighted in green is a line.",widgets:{}}]};xz.exports=jz;var Cz=xz.exports,Sz={exports:{}};Sz.exports;h.a;const kz=createReactClass({displayName:"SimpleButton",getDefaultProps:function(){return{children:null,color:"green",onClick:()=>{}}},render:function(){const{children:e,color:t,onClick:n,...s}=this.props;return Object($t.jsx)("div",{className:Object(Nn.css)(_z.baseButton,_z[t]),onClick:n,...s,children:e})}}),_z=Nn.StyleSheet.create({baseButton:{top:"0",fontSize:"11px",padding:"3px 10px",backgroundRepeat:"repeat-x",borderColor:"\n            rgba(0, 0, 0, 0.1)\n            rgba(0, 0, 0, 0.1)\n            rgba(0, 0, 0, 0.25)\n        ",color:"#ffffff",borderRadius:"3px",lineHeight:"15px",cursor:"pointer",transition:"box-shadow ease-in-out 0.15s",appearance:"none",textDecoration:"none",textAlign:"center",":hover":{boxShadow:"0 1px 1px rgba(0, 0, 0, 0.35),\n                inset 0 0 50px 5px rgba(255, 255, 255, 0.2)"}},green:{border:"1px solid #7fab07",backgroundColor:"#80ac07",backgroundImage:"linear-gradient(to bottom, #8aba08, #719807)",":hover":{borderBottomColor:"#547105",backgroundColor:"#719807"}},orange:{border:"1px solid #d45704",backgroundColor:"#d55704",backgroundImage:"linear-gradient(to bottom, #e35d04, #c04f03)",":hover":{borderBottomColor:"#983e03",bakgroundColor:"#c04f03"}}});Sz.exports=kz;var Tz=Sz.exports,Mz={exports:{}};Mz.exports,h.a;const Nz=x.b;var Pz=createReactClass({displayName:"JsonEditor",getInitialState:function(){return{currentValue:JSON.stringify(this.props.value,null,4),valid:!0}},componentWillReceiveProps:function(e){(!this.state.valid||!Nz.isEqual(e.value,JSON.parse(this.state.currentValue)))&&this.setState(this.getInitialState())},render:function(){var e="perseus-json-editor "+(this.state.valid?"valid":"invalid");return Object($t.jsx)("textarea",{className:e,value:this.state.currentValue,onChange:this.handleChange,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur})},handleKeyDown:function(e){if("Tab"===e.key){var t=e.target.selectionStart,n=e.target.value,s=n.substring(0,t),i=n.substring(t,n.length);e.target.value=s+"    "+i,e.target.selectionStart=s.length+4,e.target.selectionEnd=s.length+4,e.preventDefault(),this.handleChange(e)}},handleChange:function(e){var t=e.target.value;try{var n=JSON.parse(t);Nz.isString(n)&&(n=JSON.parse(n)),this.setState({currentValue:t,valid:!0},(function(){this.props.onChange(n)}))}catch(s){this.setState({currentValue:t,valid:!1})}},handleBlur:function(e){var t=e.target.value;try{var n=JSON.parse(t);Nz.isString(n)&&(n=JSON.parse(n)),this.setState({currentValue:JSON.stringify(n,null,4),valid:!0},(function(){this.props.onChange(n)}))}catch(s){this.setState({currentValue:JSON.stringify(this.props.value,null,4),valid:!0})}}});Mz.exports=Pz;var Iz=Mz.exports,Ez={exports:{}};Ez.exports;h.a;let Az=0;const Rz={},Dz={};window.iframeDataStore={},window.addEventListener("message",(e=>{if("string"===typeof e.data){const t=Rz[e.data];t&&t()}else e.data.id&&(void 0!==e.data.height?Dz[e.data.id](e.data.height):e.data.lintWarnings&&console.log("LINTER REPORT",e.data.lintWarnings))}));const Lz=createReactClass({displayName:"IframeContentRenderer",componentDidMount:function(){this.iframeID=Az,Az++,this._prepareFrame(),Rz[this.iframeID]=()=>{this.sendNewData(this._lastData)},Dz[this.iframeID]=e=>{this._lastHeight=e,this.isMounted()&&this.props.seamless&&(this.refs.container.style.height=e+"px")}},shouldComponentUpdate:function(e){return e.content!==this.props.content||e.datasetValue!==this.props.datasetValue||e.seamless!==this.props.seamless},componentDidUpdate:function(e){this.props.seamless?this.refs.container.style.height=this._lastHeight+"px":this.refs.container.style.height="100%",e.content===this.props.content&&e.datasetValue===this.props.datasetValue||this._prepareFrame()},componentWillUnmount:function(){Rz[this.iframeID]=null,Dz[this.iframeID]=null},_prepareFrame:function(){this._frame&&this.refs.container.removeChild(this._frame),this._frame=document.createElement("iframe"),this._frame.style.width="100%",this._frame.style.height="100%",this.props.datasetKey&&(this._frame.dataset[this.props.datasetKey]=this.props.datasetValue),this._frame.dataset.id=this.iframeID,this.props.seamless&&(this._frame.dataset.lintGutter=!0),this._frame.onload=()=>{this._frame.onload=null,setTimeout((()=>{this._frame.contentWindow.document.open(),this._frame.contentWindow.document.write(this.props.content),this._frame.contentWindow.document.close()}))},this.refs.container.appendChild(this._frame)},sendNewData:function(e){this.isMounted()&&e&&(this._lastData=e,window.iframeDataStore[this.iframeID]=e,this._frame.contentWindow.postMessage(this.iframeID,"*"))},render:function(){return Object($t.jsx)("div",{ref:"container",style:{width:"100%",height:"100%"}})}});Ez.exports=Lz;var Fz=Ez.exports;const zz={PHONE:"phone",TABLET:"tablet",DESKTOP:"desktop"};var qz={devices:zz,lintGutterWidth:36,perseusFrameBorderWidth:1},Wz={exports:{}};Wz.exports;h.a;const Bz=qz,Vz={phone:{width:320,height:480,framedWidth:320},tablet:{width:750,height:920,framedWidth:525},desktop:{width:688,height:600,framedWidth:688}},Hz=createReactClass({displayName:"DeviceFramer",render:function(){const e=this.props.deviceType;if(this.props.nochrome)return Object($t.jsx)("div",{children:Object($t.jsx)("div",{style:{width:Vz[e].framedWidth+2*Bz.perseusFrameBorderWidth+Bz.lintGutterWidth},children:Object($t.jsx)("div",{children:this.props.children})},"screen")});{const t=Vz[e].framedWidth/Vz[e].width,n={backgroundColor:"white",color:"black",textAlign:"left",width:Vz[e].width,height:Vz[e].height,border:"solid 1px #CCC",margin:8,zoom:t};return Object($t.jsx)("div",{className:"screen",style:n,children:this.props.children},"screen")}}});Wz.exports=Hz;var Uz=Wz.exports,Gz=(h.a,x.b),$z=cd;const Yz=Kt,Kz=createReactClass({displayName:"HintEditor",getDefaultProps:function(){return{content:"",replace:!1,showMoveButtons:!0,showTitle:!0,showRemoveButton:!0}},handleChange:function(e){this.props.onChange({replace:e.target.checked})},render:function(){return Object($t.jsxs)("div",{className:"perseus-hint-editor "+this.props.className,children:[this.props.showTitle&&Object($t.jsx)("div",{className:"pod-title",children:"Hint"}),Object($t.jsx)(lv,{ref:"editor",apiOptions:this.props.apiOptions,widgets:this.props.widgets,content:this.props.content,images:this.props.images,replace:this.props.replace,placeholder:"Type your hint here...",imageUploader:this.props.imageUploader,onChange:this.props.onChange}),Object($t.jsxs)("div",{className:"hint-controls-container clearfix",children:[this.props.showMoveButtons&&Object($t.jsxs)("span",{className:"reorder-hints",children:[Object($t.jsx)("button",{type:"button",className:this.props.isLast?"hidden":"",onClick:Gz.partial(this.props.onMove,1),children:Object($t.jsx)(Yz,{...da})})," ",Object($t.jsx)("button",{type:"button",className:this.props.isFirst?"hidden":"",onClick:Gz.partial(this.props.onMove,-1),children:Object($t.jsx)(Yz,{...ga})})," ",this.props.isLast&&Object($t.jsx)($z,{children:Object($t.jsx)("p",{children:"The last hint is automatically bolded."})})]}),Object($t.jsx)("input",{type:"checkbox",checked:this.props.replace,onChange:this.handleChange}),"Replace previous hint",this.props.showRemoveButton&&Object($t.jsxs)("button",{type:"button",className:"remove-hint simple-button orange",onClick:this.props.onRemove,children:[Object($t.jsx)(Yz,{..._a}),"Remove this hint"," "]})]})]})},focus:function(){this.refs.editor.focus()},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(e){return this.refs.editor.serialize(e)}}),Xz=createReactClass({displayName:"CombinedHintEditor",getDefaultProps:function(){return{highlightLint:!1}},updatePreview:function(){},componentDidMount:function(){this.updatePreview()},componentDidUpdate:function(){this.updatePreview()},render:function(){"phone"===this.props.deviceType||this.props.deviceType;return Object($t.jsxs)("div",{className:"perseus-combined-hint-editor perseus-editor-row",children:[Object($t.jsx)("div",{className:"perseus-editor-left-cell",children:Object($t.jsx)(Kz,{ref:"editor",isFirst:this.props.isFirst,isLast:this.props.isLast,widgets:this.props.hint.widgets,content:this.props.hint.content,images:this.props.hint.images,replace:this.props.hint.replace,imageUploader:this.props.imageUploader,onChange:this.props.onChange,onRemove:this.props.onRemove,onMove:this.props.onMove,apiOptions:this.props.apiOptions})}),Object($t.jsx)("div",{className:"perseus-editor-right-cell",children:Object($t.jsx)(gh,{apiOptions:this.props.apiOptions,...this.props.hint})})]})},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(e){return this.refs.editor.serialize(e)},focus:function(){this.refs.editor.focus()}});var Zz=createReactClass({displayName:"CombinedHintsEditor",statics:{HintEditor:Kz},getDefaultProps:function(){return{onChange:()=>{},hints:[],highlightLint:!1}},render:function(){var e=this.props.hints,t=Gz.map(e,(function(t,n){return Object($t.jsx)(Xz,{ref:"hintEditor"+n,isFirst:0===n,isLast:n+1===e.length,hint:t,pos:n,imageUploader:this.props.imageUploader,onChange:this.handleHintChange.bind(this,n),onRemove:this.handleHintRemove.bind(this,n),onMove:this.handleHintMove.bind(this,n),deviceType:this.props.deviceType,apiOptions:this.props.apiOptions,frameSource:this.props.frameSource,highlightLint:this.props.highlightLint},"hintEditor"+n)}),this);return Object($t.jsxs)("div",{className:"perseus-hints-editor perseus-editor-table",children:[t,Object($t.jsx)("div",{className:"perseus-editor-row",children:Object($t.jsx)("div",{className:"add-hint-container perseus-editor-left-cell",children:Object($t.jsxs)("button",{type:"button",className:"add-hint simple-button orange",onClick:this.addHint,children:[Object($t.jsx)(Yz,{...wa})," Add a hint"]})})})]})},handleHintChange:function(e,t,n,s){var i=Gz.clone(this.props.hints);i[e]=Gz.extend({},this.serializeHint(e,{keepDeletedWidgets:!0}),t),this.props.onChange({hints:i},n,s)},handleHintRemove:function(e){var t=Gz.clone(this.props.hints);t.splice(e,1),this.props.onChange({hints:t})},handleHintMove:function(e,t){var n=Gz.clone(this.props.hints),s=n.splice(e,1)[0];n.splice(e+t,0,s),this.props.onChange({hints:n},(()=>{this.refs["hintEditor"+(e+t)].focus()}))},addHint:function(){var e=Gz.clone(this.props.hints).concat([{content:""}]);this.props.onChange({hints:e},(()=>{var t=e.length-1;this.refs["hintEditor"+t].focus()}))},getSaveWarnings:function(){return Gz.chain(this.props.hints).map(((e,t)=>Gz.map(this.refs["hintEditor"+t].getSaveWarnings(),(e=>"Hint "+(t+1)+": "+e)))).flatten(!0).value()},serialize:function(e){return this.props.hints.map(((t,n)=>this.serializeHint(n,e)))},serializeHint:function(e,t){return this.refs["hintEditor"+e].serialize(t)}}),Jz={exports:{}};Jz.exports;const Qz=h.a,eq=i.a,tq=op,nq=Is.Options,sq=lv,iq=Kt,rq=Iz,oq=Tz,aq=createReactClass({displayName:"ModeDropdown",_handleSelectMode:function(e){this.props.onChange&&this.props.onChange(e.target.value)},render:function(){return Object($t.jsxs)("label",{children:["Mode:"," ",Object($t.jsxs)("select",{value:this.props.currentMode,onChange:this._handleSelectMode,children:[Object($t.jsx)("option",{value:"edit",children:"Edit"}),Object($t.jsx)("option",{value:"preview",children:"Preview"}),Object($t.jsx)("option",{value:"json",children:"Dev-only JSON"})]})]})}});function lq(e){return e.replace(/[A-Z]/g,(e=>" "+e.toLowerCase()))}function cq(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}function hq(e){return"s"===e.charAt(e.length-1)?e.slice(0,-1):e}function pq(e){return["_multi",...e]}function uq(e){let{depth:t,...n}=e;const s=`h${Math.min(t,5)+1}`;return Object($t.jsx)(s,{...n})}const dq=e=>{const{shape:t,data:n,path:s,actions:i,name:r,controls:o,...a}=e,l=r||lq(s[s.length-1]||"");let c;return c="array"===t.type?fq:"object"===t.type?mq:gq,Object($t.jsx)(c,{name:l,controls:o,path:s,shape:t,actions:i,children:Object($t.jsx)(bq,{...a,shape:t,data:n,path:s,actions:i})},s.join("."))},gq=e=>{let{name:t,controls:n,children:s,path:i,shape:r}=e;const o=("content"===r.type||"hint"===r.type)&&Object($t.jsx)("div",{className:Object(Nn.css)(kq.containerHeader),children:Object($t.jsx)(uq,{depth:i.length,className:Object(Nn.css)(kq.containerTitle),children:cq(t)})});return Object($t.jsxs)("div",{className:Object(Nn.css)(kq.container),children:[Object($t.jsxs)("span",{className:Object(Nn.css)(kq.row,kq.rowHeading),children:[Object($t.jsx)("div",{className:Object(Nn.css)(kq.columnLeft),children:Object($t.jsxs)("div",{className:"pod-title "+Object(Nn.css)(kq.containerHeader),children:[Object($t.jsx)("div",{className:Object(Nn.css)(kq.containerTitle),children:cq(t)}),n]})}),Object($t.jsx)("div",{className:Object(Nn.css)(kq.columnRight),children:o})]}),s]})},fq=e=>{const{name:t,controls:n,children:s,path:i,shape:r,actions:o}=e;return Object($t.jsxs)("div",{className:Object(Nn.css)(kq.container),children:[n&&Object($t.jsx)("div",{className:Object(Nn.css)(kq.columnLeft,kq.containerHeader),children:n}),Object($t.jsx)("div",{children:s}),Object($t.jsx)("div",{className:Object(Nn.css)(kq.columnLeft),children:Object($t.jsxs)("a",{href:"javascript:void 0",onClick:()=>o.addArrayElement(i,r.elementShape),children:["Add a ",hq(t)]})})]})},mq=e=>{let{name:t,controls:n,children:s,path:i}=e;const r=Object($t.jsxs)("div",{className:Object(Nn.css)(kq.containerHeader),children:[Object($t.jsx)(uq,{depth:i.length,className:Object(Nn.css)(kq.containerTitle),children:cq(t)}),n]}),o=(t||n)&&Object($t.jsx)("div",{className:Object(Nn.css)(kq.containerHeader,kq.previewCollectionHeader),children:Object($t.jsx)(uq,{depth:i.length,className:Object(Nn.css)(kq.containerTitle),children:cq(t)})}),a=r&&o;return Object($t.jsxs)("div",{className:Object(Nn.css)(kq.container),children:[a&&Object($t.jsxs)("span",{className:Object(Nn.css)(kq.row),children:[Object($t.jsx)("div",{className:Object(Nn.css)(kq.columnLeft),children:r}),Object($t.jsx)("div",{className:Object(Nn.css)(kq.columnRight),children:o})]}),Object($t.jsx)("div",{className:Object(Nn.css)(i.length>0&&kq.contentIndent),children:s})]})},bq=e=>{const{shape:t}=e;return"content"===t.type?Object($t.jsx)(yq,{...e}):"hint"===t.type?Object($t.jsx)(jq,{...e}):"tags"===t.type?Object($t.jsx)(wq,{...e}):"array"===t.type?Object($t.jsx)(Oq,{...e}):"object"===t.type?Object($t.jsx)(Cq,{...e}):void 0};function vq(e){return class extends Qz.Component{constructor(){super(...arguments),this.state={sticky:!1},this.updateStickiness=()=>{const e=eq.findDOMNode(this).offsetHeight>window.innerHeight;e!==this.state.sticky&&this.setState({sticky:e})}}componentDidMount(){this.stickynessTimer=setInterval(this.updateStickiness,1e3),this.updateStickiness()}componentWillUnmount(){clearInterval(this.stickynessTimer)}render(){return Object($t.jsx)(e,{sticky:this.state.sticky,...this.props})}}}function xq(e){return class extends Qz.Component{constructor(){super(...arguments),this._detached=!1,this._reattachTimer=null,this.getTextAreas=()=>eq.findDOMNode(this).querySelectorAll("textarea"),this.detach=()=>{this.getTextAreas().forEach((e=>{if(e===document.activeElement&&!this._detached){const t=e.getBoundingClientRect(),n=e.style;n.setProperty("position","fixed","important"),n.setProperty("top",`${t.y}px`,"important"),n.setProperty("left",`${t.x}px`,"important"),n.setProperty("width",`${t.width}px`,"important"),n.setProperty("height",`${t.height}px`,"important"),n.setProperty("z-index","1","important"),n.setProperty("height",`${t.height}px`,"important"),this._reattachTimer&&clearTimeout(this._reattachTimer)}})),this._detached=!0,this._reattachTimer=setTimeout(this.reattach,1e3)},this.reattach=()=>{this.getTextAreas().forEach((e=>{const t=e.style;t.removeProperty("position"),t.removeProperty("top"),t.removeProperty("left"),t.removeProperty("width"),t.removeProperty("z-index"),t.removeProperty("height")})),this._detached=!1}}render(){var t=this;const n=function(){const e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return e?parseInt(e[2],10):null}(),s=n&&n<62,i=this.props.sticky;if(!s||!i)return Object($t.jsx)(e,{...this.props});const r={...this.props.actions};return r.mergeValueAtPath=function(){t.props.actions.mergeValueAtPath(...arguments),t.detach()},Object($t.jsx)(e,{...this.props,actions:r})}}}const yq=vq(xq((e=>{const{data:t,path:n,actions:s,apiOptions:i,renderers:r,sticky:o}=e,a=Object($t.jsx)("div",{className:"framework-perseus",children:tq(r).get(n)});return Object($t.jsx)("span",{children:Object($t.jsxs)("div",{className:Object(Nn.css)(kq.row),children:[Object($t.jsx)("div",{className:Object(Nn.css)(kq.columnLeft),children:Object($t.jsx)("div",{className:Object(Nn.css)(o&&kq.sticky),children:Object($t.jsx)(sq,{...t,onChange:e=>s.mergeValueAtPath(n,e),apiOptions:i})})}),Object($t.jsx)("div",{className:Object(Nn.css)(kq.columnRight),children:Object($t.jsx)("div",{className:Object(Nn.css)(o&&kq.sticky),children:a})})]})})}))),jq=vq(xq((e=>{const{data:t,path:n,actions:s,apiOptions:i,renderers:r,sticky:o}=e,a=Object($t.jsx)("div",{className:"framework-perseus",children:tq(r).get(n)});return Object($t.jsxs)("div",{className:Object(Nn.css)(kq.row),children:[Object($t.jsx)("div",{className:Object(Nn.css)(kq.columnLeft),children:Object($t.jsx)("div",{className:Object(Nn.css)(o&&kq.sticky),children:Object($t.jsx)(Kz,{...t,className:Object(Nn.css)(kq.hintEditor),onChange:e=>s.mergeValueAtPath(n,e),apiOptions:i,showTitle:!1,showRemoveButton:!1,showMoveButtons:!1})})}),Object($t.jsx)("div",{className:Object(Nn.css)(kq.columnRight),children:Object($t.jsx)("div",{className:Object(Nn.css)(o&&kq.sticky),children:a})})]})}))),wq=e=>{const{data:t,path:n,actions:s,apiOptions:i}=e,{GroupMetadataEditor:r}=i;return Object($t.jsx)("div",{className:Object(Nn.css)(kq.columnLeft),children:Object($t.jsx)("div",{className:Object(Nn.css)(kq.tagsEditor),children:Object($t.jsx)(r,{value:t,onChange:e=>s.setValueAtPath(n,e),showTitle:!1})})})},Oq=e=>{const{shape:t,data:n,path:s,actions:i,...r}=e,o=hq(lq(s[s.length-1])),a=t.elementShape.type,l="content"===a||"hint"===a,h=n.map(((e,a)=>{const h=s.concat(a),p=[a>0&&Object($t.jsx)("div",{className:Object(Nn.css)(kq.control),children:Object($t.jsx)(oq,{color:"orange",title:"Move up",onClick:()=>i.moveArrayElementUp(h),children:Object($t.jsx)("div",{className:Object(Nn.css)(kq.verticalFlip),children:Object($t.jsx)(iq,{...ha})})})},"moveArrayElementUp"),a<n.length-1&&Object($t.jsx)("div",{className:Object(Nn.css)(kq.control),children:Object($t.jsx)(oq,{color:"orange",title:"Move down",onClick:()=>i.moveArrayElementDown(h),children:Object($t.jsx)(iq,{...ha})})},"moveArrayElementDown"),Object($t.jsx)("div",{className:Object(Nn.css)(kq.control),children:Object($t.jsx)(oq,{color:"orange",title:"Delete",onClick:()=>i.removeArrayElement(h),children:Object($t.jsx)(iq,{..._a})})},"removeArrayElement")];return Object($t.jsx)("div",{className:Object(Nn.css)(kq.arrayElement,!l&&kq.arrayElementAndNotLeaf),children:Object(c.createElement)(dq,{...r,key:a,shape:t.elementShape,data:e,path:h,actions:i,name:`${o} ${a+1}`,controls:p})},a)}));return Object($t.jsx)("div",{children:h})},Cq=e=>{const{shape:t,data:n,path:s,...i}=e,r=Object.keys(t.shape).map((e=>Object($t.jsx)("div",{className:Object(Nn.css)(kq.objectElement),children:Object($t.jsx)(dq,{...i,shape:t.shape[e],data:n[e],path:s.concat(e)})},e)));return Object($t.jsx)("div",{children:r})},Sq=createReactClass({displayName:"MultiRendererEditor",_renderLayout(){const{Layout:e,apiOptions:t,item:n}=this.props;return Object($t.jsx)(e,{ref:e=>this.layout=e,item:n,apiOptions:t})},_renderJson(){return Object($t.jsxs)("div",{children:[Object($t.jsx)(aq,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})}),Object($t.jsx)(rq,{multiLine:!0,value:this.props.item,onChange:e=>this.props.onChange({item:e})})]})},_renderPreview(){return Object($t.jsxs)("div",{children:[Object($t.jsx)(aq,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})}),this._renderLayout()]})},mergeValueAtPath(e,t){this.props.onChange({item:tq(this.props.item).merge(pq(e),t).freeze()})},setValueAtPath(e,t){this.props.onChange({item:tq(this.props.item).set(pq(e),t).freeze()})},addArrayElement(e,t){const n=tq(this.props.item).get(pq(e)).length,s=e.concat(n),i=Hh(t);this.props.onChange({item:tq(this.props.item).set(pq(s),i).freeze()})},removeArrayElement(e){this.props.onChange({item:tq(this.props.item).del(pq(e)).freeze()})},moveArrayElementDown(e){const t=e[e.length-1]+1,n=e.slice(0,-1).concat(t),s=tq(this.props.item).get(pq(e)),i=tq(this.props.item).get(pq(n));this.props.onChange({item:tq(this.props.item).set(pq(e),i).set(pq(n),s).freeze()})},moveArrayElementUp(e){const t=e[e.length-1],n=e.slice(0,-1).concat(t-1);this.moveArrayElementDown(n)},_renderEdit(){const e={...nq.defaults,...this.props.apiOptions},t=this.props.item,n=this.props.Layout.shape;return Object($t.jsxs)("div",{className:"perseus-multirenderer-editor",children:[Object($t.jsx)(aq,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})}),Object($t.jsx)(fp,{item:t,shape:n,apiOptions:e,children:s=>{let{renderers:i}=s;return Object($t.jsx)(dq,{mode:"edit",shape:n,data:Xh(t),path:[],actions:this,apiOptions:e,renderers:i})}})]})},score(){if(this.layout)return this.layout.score()},getSerializedState(){if(this.layout)return this.layout.getSerializedState()},restoreSerializedState(e){this.layout&&this.layout.restoreSerializedState(e)},_renderContent(){switch(this.props.editorMode){case"json":return this._renderJson();case"preview":return this._renderPreview();case"edit":return this._renderEdit();default:return Object($t.jsx)(aq,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})})}},render(){return Object($t.jsx)("div",{id:"perseus",children:this._renderContent()})}}),kq=Nn.StyleSheet.create({editor:{width:"100%"},treePreview:{position:"relative"},verticalFlip:{transform:"scaleY(-1)"},control:{marginLeft:12},containerHeader:{alignItems:"flex-end",display:"flex",flexDirection:"row"},previewCollectionHeader:{marginBottom:16},containerTitle:{flexGrow:1,margin:0},contentIndent:{marginLeft:8},hintEditor:{paddingBottom:0},arrayElement:{marginBottom:16},arrayElementAndNotLeaf:{borderBottom:"1px solid #ccc",":first-child":{borderTop:"1px solid #ccc",paddingTop:16}},objectElement:{marginBottom:16},tagsEditor:{border:"1px solid #ddd",padding:"5px 10px"},row:{display:"flex",position:"relative"},columnLeft:{width:360,marginRight:30,position:"relative"},columnRight:{flex:1,marginLeft:30,position:"relative"},sticky:{position:"sticky",top:33},rowHeading:{position:"sticky",backgroundColor:"white",width:"100%",zIndex:101,top:-1}});Jz.exports=Sq;var _q=Jz.exports,Tq={exports:{}};Tq.exports;h.a;const Mq=_q,Nq=ce,Pq=createReactClass({displayName:"DemoLayout",statics:{shape:mp.shape({sharedContext:mp.content,questions:mp.arrayOf(mp.shape({tags:mp.tags,question:mp.content})),hints:mp.hints})},getInitialState:()=>({numHints:0}),score(){return this.multirenderer.score()},getSerializedState(){return this.multirenderer.getSerializedState()},restoreSerializedState(e){this.multirenderer.restoreSerializedState(e)},addHint(){this.setState((e=>{let{numHints:t}=e;return{numHints:t+1}}))},clearHints(){this.setState({numHints:0})},render(){return Object($t.jsx)(fp,{ref:e=>this.multirenderer=e,item:this.props.item,shape:Pq.shape,children:e=>{let{renderers:t}=e;return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:Object(Nn.css)(Iq.left),children:t.sharedContext}),Object($t.jsxs)("div",{className:Object(Nn.css)(Iq.right),children:[Object($t.jsx)("h2",{children:"Questions"}),Object($t.jsx)("ul",{children:t.questions.map(((e,t)=>Object($t.jsx)("li",{children:e.question},t)))}),t.hints.length>0&&Object($t.jsxs)("div",{children:[Object($t.jsx)("h2",{children:"Hints"}),t.hints.firstN(this.state.numHints),this.state.numHints<t.hints.length&&Object($t.jsx)("div",{children:Object($t.jsx)("button",{onClick:this.addHint,children:"Get a hint"})}),this.state.numHints>0&&Object($t.jsx)("div",{children:Object($t.jsx)("button",{onClick:this.clearHints,children:"Clear hints"})})]})]})]})}})}}),Iq=Nn.StyleSheet.create({left:{float:"left"},right:{float:"right"}}),Eq=createReactClass({displayName:"MultiRendererDemo",getDefaultProps:()=>({item:Uh(Pq.shape)}),getInitialState(){return{item:this.props.item,editorMode:"edit"}},getEditorProps(){return{Layout:Pq,apiOptions:{onFocusChange:function(e,t){console.log("onFocusChange",e,t)},trackInteraction:function(e){console.log("Interaction with",e.type,e)}},item:this.state.item,editorMode:this.state.editorMode}},handleChange(e){this.setState(e)},_getContentHash:function(){return Nq.strongEncodeURIComponent(JSON.stringify(this.state.item))},handlePermalink(e){window.location.hash=`content=${this._getContentHash()}`,e.preventDefault()},handleScore(){console.log(this.editor.score())},handleSerializeState(){this._state=this.editor.getSerializedState()},handleRestoreState(){this.editor.restoreSerializedState(this._state)},render(){const e="edit"===this.state.editorMode||"preview"===this.state.editorMode;return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{id:"extras",children:[Object($t.jsx)("button",{onClick:this.handlePermalink,children:"Permalink"})," ",Object($t.jsx)("button",{onClick:this.handleScore,disabled:!e,children:"Score"})," ",Object($t.jsx)("button",{onClick:this.handleSerializeState,disabled:!e,children:"Store state"})," ",Object($t.jsx)("button",{onClick:this.handleRestoreState,disabled:!e,children:"Restore state"})]}),Object($t.jsx)("div",{className:"framework-perseus",children:Object($t.jsx)(Mq,{...this.getEditorProps(),onChange:this.handleChange,ref:e=>this.editor=e})})]})}});Tq.exports=Eq;var Aq=Tq.exports,Rq={exports:{}};Rq.exports;h.a;const Dq=createReactClass({displayName:"HUD",renderVisibleIcon:function(){return Object($t.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",className:Object(Nn.css)(Lq.icon),children:[Object($t.jsx)("defs",{children:Object($t.jsx)("path",{id:"a",d:"M7.401 10.035c-1.424.748-2.599 1.905-3.544 3.48a1 1 0 0 1-1.714-1.03C4.325 8.849 7.652 7 12 7c4.348 0 7.675 1.848 9.857 5.486a1 1 0 0 1-1.714 1.028c-.945-1.574-2.12-2.73-3.544-3.48a5 5 0 1 1-9.198 0zM12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"})}),Object($t.jsxs)("g",{fill:"none",fillRule:"evenodd",children:[Object($t.jsx)("path",{fill:"none",d:"M0 0h24v24H0z"}),Object($t.jsx)("mask",{id:"b",fill:"#fff",children:Object($t.jsx)("use",{href:"#a"})}),Object($t.jsx)("use",{fill:"#fff",fillRule:"nonzero",href:"#a"}),Object($t.jsx)("g",{fill:"#fff",mask:"url(#b)",children:Object($t.jsx)("path",{d:"M0 0h24v24H0z"})})]})]})},renderHiddenIcon:function(){return Object($t.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",className:Object(Nn.css)(Lq.icon),children:[Object($t.jsx)("defs",{children:Object($t.jsx)("path",{id:"a",d:"M8.794 7.38C9.791 7.127 10.86 7 12 7c4.348 0 7.675 1.848 9.857 5.486a1 1 0 0 1-1.714 1.028c-.945-1.574-2.12-2.73-3.544-3.48.258.604.401 1.268.401 1.966 0 1.02-.305 1.967-.828 2.757l2.535 2.536a1 1 0 0 1-1.414 1.414l-12-12a1 1 0 0 1 1.414-1.414L8.794 7.38zm5.914 5.913a3 3 0 0 0-4.001-4.001l4 4.001zM6.072 8.486l2.976 2.976a3 3 0 0 0 3.49 3.49l1.579 1.58A5 5 0 0 1 7.4 10.035c-1.424.747-2.599 1.904-3.544 3.478a1 1 0 0 1-1.714-1.028c1.049-1.75 2.363-3.085 3.929-4z"})}),Object($t.jsxs)("g",{fill:"none",fillRule:"evenodd",children:[Object($t.jsx)("path",{fill:"none",d:"M0 0h24v24H0z"}),Object($t.jsx)("mask",{id:"b",fill:"#fff",children:Object($t.jsx)("use",{href:"#a"})}),Object($t.jsx)("use",{fill:"#fff",fillRule:"nonzero",href:"#a"}),Object($t.jsx)("g",{fill:"#fff",mask:"url(#b)",children:Object($t.jsx)("path",{d:"M0 0h24v24H0z"})})]})]})},render:function(){let e,t;return this.props.enabled?(e=Lq.enabled,t=this.renderVisibleIcon()):(e=Lq.disabled,t=this.renderHiddenIcon()),Object($t.jsxs)("button",{className:Object(Nn.css)(Lq.hud,e),onClick:e=>{this.props.onClick()},children:[t,this.props.message]})}}),Lq=Nn.StyleSheet.create({hud:{position:"fixed",right:20,bottom:20,boxSizing:"border-box",height:36,padding:"9px 16px",borderRadius:18,fontFamily:Zt,fontSize:"15px",lineHeight:"18px",color:tn,userSelect:"none",borderWidth:0},icon:{width:24,height:24,marginRight:8,marginTop:-3,verticalAlign:"middle"},enabled:{backgroundColor:kn,":hover":{backgroundColor:_n},":active":{backgroundColor:"#c75300"}},disabled:{backgroundColor:rn,":hover":{backgroundColor:"#a1a5a9"},":active":{backgroundColor:on}}});Rq.exports=Dq;var Fq=Rq.exports,zq={exports:{}};zq.exports;h.a;const qq=x.b,Wq=Is.Options,Bq=lv,Vq=Kt,Hq=Iz,Uq=Uz,Gq=Fz,$q=Fq,Yq=createReactClass({displayName:"SectionControlButton",render:function(){const{icon:e,onClick:t,title:n}=this.props;return Object($t.jsx)("a",{href:"#",className:"section-control-button simple-button simple-button--small orange",onClick:e=>{e.preventDefault(),t()},title:n,children:Object($t.jsx)(Vq,{...e})})}}),Kq=createReactClass({displayName:"ArticleEditor",getDefaultProps:function(){return{contentPaths:[],json:[{}],mode:"edit",screen:"desktop",sectionImageUploadGenerator:()=>Object($t.jsx)("span",{}),useNewStyles:!1}},getInitialState:function(){return{highlightLint:!0}},componentDidMount:function(){this._updatePreviewFrames()},componentDidUpdate:function(){this._updatePreviewFrames()},_updatePreviewFrames:function(){"preview"===this.props.mode?this.refs["frame-all"].sendNewData({type:"article-all",data:this._sections().map(((e,t)=>this._apiOptionsForSection(e,t)))}):"edit"===this.props.mode&&this._sections().forEach(((e,t)=>{this.refs["frame-"+t].sendNewData({type:"article",data:this._apiOptionsForSection(e,t)})}))},_apiOptionsForSection:function(e,t){const n=this.refs[`editor${t}`];return{apiOptions:{...Wq.defaults,...this.props.apiOptions,showAlignmentOptions:!0,isArticle:!0},json:e,useNewStyles:this.props.useNewStyles,linterContext:{contentType:"article",highlightLint:this.state.highlightLint,paths:this.props.contentPaths},legacyPerseusLint:n?n.getSaveWarnings():[]}},_sections:function(){return qq.isArray(this.props.json)?this.props.json:[this.props.json]},_renderEditor:function(){const{imageUploader:e,sectionImageUploadGenerator:t}=this.props,n={...Wq.defaults,...this.props.apiOptions,showAlignmentOptions:!0,isArticle:!0},s=this._sections();return Object($t.jsxs)("div",{className:"perseus-editor-table",children:[s.map(((i,r)=>[Object($t.jsxs)("div",{className:"perseus-editor-row",children:[Object($t.jsxs)("div",{className:"perseus-editor-left-cell",children:[Object($t.jsxs)("div",{className:"pod-title",children:["Section ",r+1,Object($t.jsxs)("div",{style:{display:"inline-block",float:"right"},children:[t(r),Object($t.jsx)(Yq,{icon:wa,onClick:()=>{this._handleAddSectionAfter(r)},title:"Add a new section after this one"}),r+1<s.length&&Object($t.jsx)(Yq,{icon:da,onClick:()=>{this._handleMoveSectionLater(r)},title:"Move this section down"}),r>0&&Object($t.jsx)(Yq,{icon:ga,onClick:()=>{this._handleMoveSectionEarlier(r)},title:"Move this section up"}),Object($t.jsx)(Yq,{icon:_a,onClick:()=>{confirm("Are you sure you want to delete section "+(r+1)+"?")&&this._handleRemoveSection(r)},title:"Delete this section"})]})]}),Object($t.jsx)(Bq,{...i,apiOptions:n,imageUploader:e,onChange:qq.partial(this._handleEditorChange,r),placeholder:"Type your section text here...",ref:"editor"+r})]}),Object($t.jsx)("div",{className:"editor-preview",children:this._renderIframePreview(r,!0)})]})])),this._renderAddSection(),this._renderLinterHUD()]})},_renderAddSection:function(){return Object($t.jsx)("div",{className:"perseus-editor-row",children:Object($t.jsx)("div",{className:"perseus-editor-left-cell",children:Object($t.jsxs)("a",{href:"#",className:"simple-button orange",onClick:()=>{this._handleAddSectionAfter(this._sections().length-1)},children:[Object($t.jsx)(Vq,{...wa})," Add a section"]})})})},_renderLinterHUD:function(){return Object($t.jsx)($q,{message:"Style warnings",enabled:this.state.highlightLint,onClick:()=>{this.setState({highlightLint:!this.state.highlightLint})}})},_renderIframePreview:function(e,t){const n="phone"===this.props.screen||"tablet"===this.props.screen;return Object($t.jsx)(Uq,{deviceType:this.props.screen,nochrome:t,children:Object($t.jsx)(Gq,{ref:"frame-"+e,content:this.props.frameSource,datasetKey:"mobile",datasetValue:n,seamless:t},this.props.screen)})},_renderPreviewMode:function(){return Object($t.jsx)("div",{className:"standalone-preview",children:this._renderIframePreview("all",!1)})},_handleJsonChange:function(e){this.props.onChange({json:e})},_handleEditorChange:function(e,t){const n=qq.clone(this._sections());n[e]=qq.extend({},n[e],t),this.props.onChange({json:n})},_handleMoveSectionEarlier:function(e){if(0===e)return;const t=qq.clone(this._sections()),n=t[e];t.splice(e,1),t.splice(e-1,0,n),this.props.onChange({json:t})},_handleMoveSectionLater:function(e){const t=qq.clone(this._sections());if(e+1===t.length)return;const n=t[e];t.splice(e,1),t.splice(e+1,0,n),this.props.onChange({json:t})},_handleAddSectionAfter:function(e){const t=qq.clone(this.serialize()),n=e>=0?{widgets:t[e].widgets}:{};t.splice(e+1,0,n),this.props.onChange({json:t})},_handleRemoveSection:function(e){const t=qq.clone(this._sections());t.splice(e,1),this.props.onChange({json:t})},serialize:function(){if("edit"===this.props.mode)return this._sections().map(((e,t)=>this.refs["editor"+t].serialize()));if("preview"===this.props.mode||"json"===this.props.mode)return this.props.json;throw new Error("Could not serialize; mode "+this.props.mode+" not found")},getSaveWarnings:function(){if("edit"!==this.props.mode)throw new Error("Cannot only get save warnings in edit mode.");return this._sections().map(((e,t)=>this.refs["editor"+t].getSaveWarnings()))},render:function(){return Object($t.jsxs)("div",{className:"framework-perseus perseus-article-editor",children:["edit"===this.props.mode&&this._renderEditor(),"preview"===this.props.mode&&this._renderPreviewMode(),"json"===this.props.mode&&Object($t.jsxs)("div",{className:"json-editor",children:[Object($t.jsx)("div",{className:"json-editor-warning",children:Object($t.jsx)("span",{children:"Warning: Editing in this mode can lead to broken articles!"})}),Object($t.jsx)(Hq,{multiLine:!0,onChange:this._handleJsonChange,value:this.props.json})]})]})}});zq.exports=Kq;var Xq=zq.exports,Zq={exports:{}};Zq.exports;h.a;const Jq=x.b,Qq=Xq,eW=createReactClass({displayName:"StatefulArticleEditor",getInitialState:function(){return Object.assign({},this.props,{mode:"edit",onChange:this.handleChange,ref:"editor",screen:"phone"})},componentWillReceiveProps:function(e){this.setState(Jq.omit(e,"onChange","ref"))},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(){return this.refs.editor.serialize()},handleChange:function(e,t){this.isMounted()&&this.setState(e,t)},scorePreview:function(){return this.refs.editor.scorePreview()},render:function(){const{mode:e,screen:t}=this.state;return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{style:tW.controlBar,children:[Object($t.jsxs)("span",{style:tW.controls,children:["Mode:"," ",Object($t.jsx)("span",{onClick:()=>this.setState({mode:"edit"}),style:"edit"===e?tW.controlSelected:tW.control,children:"EDIT"})," | ",Object($t.jsx)("span",{onClick:()=>this.setState({mode:"preview"}),style:"preview"===e?tW.controlSelected:tW.control,children:"PREVIEW"})," | ",Object($t.jsx)("span",{onClick:()=>this.setState({mode:"json"}),style:"json"===e?tW.controlSelected:tW.control,children:"JSON"})]}),Object($t.jsxs)("span",{style:tW.controls,children:["Screen:"," ",Object($t.jsx)("span",{onClick:()=>this.setState({screen:"phone"}),style:"phone"===t?tW.controlSelected:tW.control,children:"PHONE"})," | ",Object($t.jsx)("span",{onClick:()=>this.setState({screen:"tablet"}),style:"tablet"===t?tW.controlSelected:tW.control,children:"TABLET"})," | ",Object($t.jsx)("span",{onClick:()=>this.setState({screen:"desktop"}),style:"desktop"===t?tW.controlSelected:tW.control,children:"DESKTOP"})]})]}),Object($t.jsx)("div",{style:tW.editor,children:Object($t.jsx)(Qq,{...this.state})})]})}}),tW={controlBar:{marginBottom:25,marginTop:5},controls:{marginRight:10},controlSelected:{cursor:"default",fontWeight:700},control:{cursor:"pointer"},editor:{marginTop:-20}};Zq.exports=eW;var nW=Zq.exports,sW={exports:{}};sW.exports;h.a;const iW=Xq,rW=nW,oW=ce,aW=[{content:"",images:{},widgets:{}}],lW=createReactClass({displayName:"ArticleDemo",getDefaultProps:()=>({content:aW}),getInitialState:function(){return{isMobile:-1!==navigator.userAgent.indexOf("Mobile")}},componentDidMount:function(){window.addEventListener("resize",this._handleResize)},componentWillUnmount:function(){window.removeEventListener("resize",this._handleResize)},serialize:function(){console.log(JSON.stringify(this.refs.editor.serialize(),null,4))},scorePreview:function(){console.log(this.refs.editor.scorePreview())},_getContentHash:function(){return oW.strongEncodeURIComponent(JSON.stringify(this.refs.editor.serialize()))},permalink:function(e){window.location.hash=`content=${this._getContentHash()}`,e.preventDefault()},_handleResize(){const e=-1!==navigator.userAgent.indexOf("Mobile");this.state.isMobile!==e&&this.setState({isMobile:e})},getEditorProps(){const{isMobile:e}=this.state;return{json:this.props.content,imageUploader:function(e,t){setTimeout(t,1e3,"http://fake.image.url")},apiOptions:{customKeypad:e,onFocusChange:function(e,t){console.log("onFocusChange",e,t)},trackInteraction:function(e){console.log("Interaction with",e.type,e)},isMobile:e},useNewStyles:!0,componentClass:iW,frameSource:'<!DOCTYPE html>\n                <html>\n                <head>\n                    <meta charset="utf-8">\n                    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0">\n\n                    <link rel="stylesheet" type="text/css" href="stylesheets/local-only/khan-site.css" />\n                    <link rel="stylesheet" type="text/css" href="stylesheets/local-only/khan-exercise.css" />\n                    <link rel="stylesheet" type="text/css" href="lib/katex/katex.css" />\n                    <link rel="stylesheet" type="text/css" href="lib/font-awesome.min.css">\n                    <link rel="stylesheet" type="text/css" href="lib/mathquill/mathquill.css" />\n                    <link rel="stylesheet" type="text/css" href="stylesheets/perseus-admin-package/devices.min.css" />\n\n                    <link rel="stylesheet/less" type="text/css" href="stylesheets/exercise-content-package/perseus.less" />\n                    <link rel="stylesheet/less" type="text/css" href="stylesheets/perseus-admin-package/editor.less" />\n                    <style>\n                        body {\n                            min-width: 0 !important;\n                            /* overrides body { min-width: 1000px; } in khan-site.css */\n                        }\n                    </style>\n\n                    <script>less = {env: \'development\', logLevel: 1};<\/script>\n                    <script src="lib/less.js"><\/script>\n                </head>\n                <body>\n                    <div id="content-container">\n                    </div>\n                    <script src="lib/babel-polyfills.min.js"><\/script>\n                    <script src="lib/jquery.js"><\/script>\n                    <script src="lib/underscore.js"><\/script>\n                    <script src="lib/react-with-addons.js"><\/script>\n                    <script src="lib/mathjax/2.1/MathJax.js?config=KAthJax-730d56e87e9c926b91584f6030314815&amp;delayStartupUntil=configured"><\/script>\n                    <script src="lib/katex/katex.js"><\/script>\n                    <script src="lib/mathquill/mathquill-basic.js"><\/script>\n                    <script src="lib/kas.js"><\/script>\n                    <script src="lib/i18n.js"><\/script>\n                    <script src="lib/jquery.qtip.js"><\/script>\n                    <script src="build/frame-perseus.js"><\/script>\n                </body>\n            </html>'}},render:function(){return Object($t.jsxs)("div",{id:"perseus-index",children:[Object($t.jsxs)("div",{id:"extras",children:[Object($t.jsx)("button",{onClick:this.serialize,children:"serialize"})," ",Object($t.jsx)("button",{onClick:this.scorePreview,children:"score"})," ",Object($t.jsx)("button",{onClick:this.permalink,children:"permalink"})," "]}),Object($t.jsx)("div",{style:{margin:20},children:Object($t.jsx)(rW,{ref:"editor",...this.getEditorProps()})})]})}});sW.exports=lW;var cW=sW.exports,hW={exports:{}};hW.exports;h.a;const pW=i.a,uW=Is.ClassNames,dW=Hp,gW=Tz,fW={question:{content:"",images:{},widgets:{}},answerArea:{calculator:!1},itemDataVersion:{major:0,minor:1},hints:[]},mW=createReactClass({displayName:"RendererDemo",getDefaultProps:function(){return{question:fW,problemNum:1}},getInitialState:function(){return{answer:{empty:!0,correct:null},scratchpadEnabled:!0,isMobile:-1!==navigator.userAgent.indexOf("Mobile")}},componentDidMount:function(){pW.findDOMNode(this.refs.itemRenderer).focus(),window.addEventListener("resize",this._handleResize)},componentWillUnmount:function(){window.removeEventListener("resize",this._handleResize)},onScore:function(){console.log(this.refs.itemRenderer.scoreInput())},checkAnswer:function(){this.refs.itemRenderer.showRationalesForCurrentlySelectedChoices(),this.setState({answer:this.refs.itemRenderer.scoreInput()},(()=>{this.refs.itemRenderer.deselectIncorrectSelectedChoices()}))},takeHint:function(){this.refs.itemRenderer.showHint()},_handleResize(){const e=-1!==navigator.userAgent.indexOf("Mobile");this.state.isMobile!==e&&this.setState({isMobile:e})},render:function(){const{isMobile:e}=this.state,t={getAnotherHint:()=>{this.refs.itemRenderer.showHint()},isMobile:e,customKeypad:e,setDrawingAreaAvailable:e=>{this.setState({scratchpadEnabled:e})},styling:{radioStyleVersion:"final"}},n=this.state.answer,s=Object($t.jsx)(dW,{item:this.props.question,ref:"itemRenderer",problemNum:this.props.problemNum,initialHintsVisible:0,apiOptions:t,reviewMode:n.correct}),i=!n.empty&&n.correct,r=Object($t.jsxs)("div",{children:[Object($t.jsx)(gW,{color:n.empty||n.correct?"green":"orange",onClick:this.checkAnswer,children:n.empty?"Check Answer":n.correct?"Correct!":"Incorrect, try again."}),Object($t.jsx)("img",{className:Object(Nn.css)(bW.smiley,!i&&bW.hideSmiley),src:"/images/face-smiley.png"})]}),o=this.state.scratchpadEnabled;if(e){const e="framework-perseus "+uW.MOBILE;return Object($t.jsx)("div",{className:e,children:Object($t.jsxs)("div",{className:Object(Nn.css)(bW.problemAndAnswer),children:[s,Object($t.jsxs)("div",{id:"problem-area",children:[Object($t.jsx)("div",{id:"workarea",style:{marginLeft:0}}),Object($t.jsx)("div",{id:"hintsarea"})]})]})})}return Object($t.jsxs)("div",{className:"renderer-demo framework-perseus",children:[Object($t.jsxs)("div",{className:Object(Nn.css)(bW.problemAndAnswer),children:[Object($t.jsxs)("div",{id:"problem-area",children:[Object($t.jsx)("div",{id:"workarea"}),Object($t.jsx)("div",{id:"hintsarea"})]}),Object($t.jsx)("div",{className:Object(Nn.css)(bW.answerAreaWrap),children:Object($t.jsxs)("div",{id:"answer-area",children:[Object($t.jsxs)("div",{className:Object(Nn.css)(bW.infoBox),children:[Object($t.jsx)("div",{id:"solutionarea"}),Object($t.jsx)("div",{className:Object(Nn.css)(bW.answerButtons),children:r})]}),Object($t.jsx)("div",{className:Object(Nn.css)(bW.infoBox),children:Object($t.jsx)(gW,{color:"orange",onClick:this.takeHint,children:"Hint"})})]})}),Object($t.jsx)("div",{style:{clear:"both"}})]}),Object($t.jsxs)("div",{className:"extras",style:{margin:20},children:[Object($t.jsx)("button",{onClick:this.onScore,children:"Score"}),Object($t.jsxs)("span",{style:{marginLeft:15},children:["Scratchpad",o?"":"not ","available"]})]}),s]})}}),bW=Nn.StyleSheet.create({problemAndAnswer:{minHeight:180,position:"relative"},smiley:{width:28,position:"absolute",top:7,left:5,cursor:"pointer"},hideSmiley:{display:"none"},answerAreaWrap:{margin:"0px -8px 0 0",position:"absolute",bottom:0,right:0,width:80,zIndex:1e4},answerButtons:{margin:"0 -10px",padding:"10px 10px 0",position:"relative"},infoBox:{background:"#eee",border:"1px solid #aaa",color:"#333",marginBottom:10,padding:10,position:"relative",zIndex:10,boxShadow:"0 1px 2px #ccc",overflow:"visible",":before":{content:'" "',borderRight:"8px solid transparent",borderBottom:"8px solid #cccccc",height:16,position:"absolute",right:-1,top:-24}}});hW.exports=mW;var vW=hW.exports,xW={exports:{}},yW=(xW.exports,x.b),jW=ve,wW=Hs,OW=function(){},CW=function(e,t,n,s){var i=e.content;if(null!=e.content){var r=t(e.content);void 0!==r&&(i=r)}var o=jW.mapObject(e.widgets||{},(function(e,t){return null==e||null==e.type?e:n(e,t)})),a=yW.extend({},e,{content:i,widgets:o}),l=s(a);return void 0!==l?l:a};xW.exports={traverseRendererDeep:function(e,t,n,s){return CW(e,t=t||OW,function(e,t,n){var s=function(i,r){var o,a=wW.upgradeWidgetInfoToLatestVersion(i),l=wW.getVersion(a.type);o=l&&a.version.major===l.major?wW.traverseChildWidgets(a,(t=>CW(t,e,s,n))):a;var c=t(o,r);return void 0!==c?c:o};return s}(t,n=n||OW,s=s||OW),s)}};var SW=xW.exports,kW={exports:{}};kW.exports;x.b;const _W=SW,TW=Hs,MW=function(e,t){let n=!0;return _W.traverseRendererDeep(e,null,(function(e){n=n&&function(e,t){if(null==e||null==e.type)return!0;const n=TW.upgradeWidgetInfoToLatestVersion(e);return function(e,t){if(null==t)return!1;const n=e.version||{major:0,minor:0};return t.major>n.major||!(t.major<n.major)&&t.minor>=n.minor}(n,t[n.type])}(e,t)})),n};kW.exports={isItemRenderableByVersion:function(e,t){if(null==e||null==t)throw new Error("missing parameter to Perseus.isRenderable.item");if(e._multi){const n=Yh(e);let s=!0;return Gh(e,n,(e=>{MW(e,t)||(s=!1)})),s}return MW(e.question,t)}};var NW=kW.exports,PW={exports:{}};PW.exports;h.a;const IW=Vf.a,EW=Kt,AW=createReactClass({displayName:"ViewportResizer",handleChange:function(e){this.props.onViewportSizeChanged(e)},render:function(){const e=Object($t.jsxs)("span",{children:[Object($t.jsx)(EW,{...ya})," Phone"]}),t=Object($t.jsxs)("span",{children:[Object($t.jsx)(EW,{...ka})," Tablet"]}),n=Object($t.jsxs)("span",{children:[Object($t.jsx)(EW,{...ma})," Desktop"]});return Object($t.jsxs)("span",{className:"viewport-resizer",children:["Viewport:"," ",Object($t.jsx)(IW,{value:this.props.deviceType,allowEmpty:!1,buttons:[{value:zz.PHONE,content:e},{value:zz.TABLET,content:t},{value:zz.DESKTOP,content:n}],onChange:this.handleChange})]})}});PW.exports=AW;var RW=PW.exports,DW=(n(266),{exports:{}}),LW=(DW.exports,h.a,cd),FW=createReactClass({displayName:"ItemExtrasEditor",getDefaultProps:function(){return{calculator:!1,chi2Table:!1,periodicTable:!1,tTable:!1,zTable:!1}},serialize:function(){return{calculator:this.props.calculator,chi2Table:this.props.chi2Table,periodicTable:this.props.periodicTable,tTable:this.props.tTable,zTable:this.props.zTable}},render:function(){return Object($t.jsx)("div",{className:"perseus-answer-editor",children:Object($t.jsxs)("div",{className:"perseus-answer-options",children:[Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show calculator:"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.calculator,onChange:e=>{this.props.onChange({calculator:e.target.checked})}})]}),Object($t.jsx)(LW,{children:"Use the calculator when completing difficult calculations is NOT the intent of the question. DON\u2019T use the calculator when testing the student\u2019s ability to complete different types of computations."})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show periodic table:"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.periodicTable,onChange:e=>{this.props.onChange({periodicTable:e.target.checked})}})]}),Object($t.jsx)(LW,{children:"This provides the student with the ability to view a periodic table of the elements, e.g., for answering chemistry questions."})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show z table (statistics):"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.zTable,onChange:e=>{this.props.onChange({zTable:e.target.checked})}})]}),Object($t.jsx)(LW,{children:"This provides the student with the ability to view a table of critical values for the z distribution, e.g. for answering statistics questions."})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show t table (statistics):"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.tTable,onChange:e=>{this.props.onChange({tTable:e.target.checked})}})]}),Object($t.jsx)(LW,{children:"This provides the student with the ability to view a table of critical values for the Student's t distribution, e.g. for answering statistics questions."})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show chi-squared table (statistics):"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.chi2Table,onChange:e=>{this.props.onChange({chi2Table:e.target.checked})}})]}),Object($t.jsx)(LW,{children:"This provides the student with the ability to view a table of critical values for the chi-squared distribution, e.g. for answering statistics questions."})]})]})})}});DW.exports=FW;var zW=DW.exports,qW={exports:{}},WW=(qW.exports,h.a,x.b),BW=zW,VW=YL.itemDataVersion;var HW=createReactClass({displayName:"ItemEditor",getDefaultProps:function(){return{onChange:()=>{},question:{},answerArea:{}}},updateProps:function(e,t,n){var s=WW.pick(this.props,"question","answerArea");this.props.onChange(Object.assign({},s,e),t,n)},render:function(){"phone"===this.props.deviceType||this.props.deviceType;return Object($t.jsxs)("div",{className:"perseus-editor-table",children:[Object($t.jsxs)("div",{className:"perseus-editor-row perseus-question-container",children:[Object($t.jsxs)("div",{className:"perseus-editor-left-cell",children:[Object($t.jsx)("div",{className:"pod-title",children:"Question"}),Object($t.jsx)(lv,{ref:"questionEditor",placeholder:"Type your question here...",className:"perseus-question-editor",imageUploader:this.props.imageUploader,onChange:this.handleEditorChange,apiOptions:this.props.apiOptions,showWordCount:!0,...this.props.question})]}),Object($t.jsx)("div",{className:"perseus-editor-right-cell",children:Object($t.jsxs)("div",{id:"problemarea",children:[Object($t.jsx)(gh,{ref:"questionRenderer",apiOptions:this.props.apiOptions,...this.props.question}),Object($t.jsx)("div",{id:"hintsarea",className:"hintsarea",style:{display:"none"}})]})})]}),Object($t.jsxs)("div",{className:"perseus-editor-row perseus-answer-container",children:[Object($t.jsxs)("div",{className:"perseus-editor-left-cell",children:[Object($t.jsx)("div",{className:"pod-title",children:"Question extras"}),Object($t.jsx)(BW,{ref:"itemExtrasEditor",onChange:this.handleItemExtrasChange,...this.props.answerArea})]}),Object($t.jsx)("div",{className:"perseus-editor-right-cell",children:Object($t.jsx)("div",{id:"answer_area"})})]})]})},triggerPreviewUpdate:function(e){},handleEditorChange:function(e,t,n){var s=WW.extend({},this.props.question,e);this.updateProps({question:s},t,n)},handleItemExtrasChange:function(e,t,n){var s=WW.extend({},this.props.answerArea,e);this.updateProps({answerArea:s},t,n)},getSaveWarnings:function(){return this.refs.questionEditor.getSaveWarnings()},serialize:function(e){return{question:this.refs.questionEditor.serialize(e),answerArea:this.refs.itemExtrasEditor.serialize(e),itemDataVersion:VW}},focus:function(){this.questionEditor.focus()}});qW.exports=HW;var UW=qW.exports,GW={exports:{}},$W=(GW.exports,x.b),YW=SW,KW=new RegExp('(\\[\\[\u2603 (passage-ref [0-9]+)\\]\\])\\s\\(["\u201c]([\\s\\S]*)["\u201d]\\)',"g"),XW=e=>{var t=$W.clone(e.widgets||{}),n=(e.content||"").replace(KW,((e,n,s,i)=>(t[s]=$W.extend({},t[s],{options:$W.extend({},t[s].options,{summaryText:i})}),n)));return $W.extend({},e,{content:n,widgets:t})},ZW=new RegExp('\\{\\{(passage-ref \\d+ \\d+)}}\\s+\\(["\\u201C]([^"]*)["\\u201D]\\)',"g"),JW=(e,t,n)=>/\n\n/.test(n)?e:"{{"+t+' "'+n+'"}}',QW=e=>{if("radio"!==e.type||!e.options||!e.options.choices)return e;var t=$W.map(e.options.choices,(e=>{if(!e.content)return e;var t=e.content.replace(ZW,JW);return $W.extend({},e,{content:t})}));return $W.extend({},e,{options:$W.extend({},e.options,{choices:t})})},eB=e=>YW.traverseRendererDeep(e,null,QW,XW);GW.exports=e=>{if(e._multi)return e;var t=eB(e.question),n=$W.map(e.hints,(e=>eB(e)));return $W.extend({},e,{question:t,hints:n})};var tB=GW.exports,nB={exports:{}},sB=(nB.exports,h.a,x.b);const iB=Is.ClassNames,rB=Ds;var oB=Zz,aB=tB,lB=UW,cB=Iz,hB=RW;const pB=Fq;var uB=createReactClass({displayName:"EditorPage",getDefaultProps:function(){return{developerMode:!1,jsonMode:!1,onChange:()=>{}}},getInitialState:function(){return{json:sB.pick(this.props,"question","answerArea","hints","itemDataVersion"),gradeMessage:"",wasAnswered:!1,highlightLint:!0}},handleCheckAnswer:function(){var e=this.scorePreview();this.setState({gradeMessage:e.message,wasAnswered:e.correct})},toggleJsonMode:function(){this.setState({json:this.serialize({keepDeletedWidgets:!0})},(function(){this.props.onChange({jsonMode:!this.props.jsonMode})}))},componentDidMount:function(){this.rendererMountNode=document.createElement("div"),this.updateRenderer()},componentDidUpdate:function(){this.updateRenderer()},updateRenderer:function(){const e=!this.props.developerMode||!this.props.jsonMode;if(!this.isMounted()||!e)return;const t="phone"===this.props.previewDevice||"tablet"===this.props.previewDevice,n=Object.assign(this.getApiOptions(),{customKeypad:t,isMobile:t});this.refs.itemEditor.triggerPreviewUpdate({type:"question",data:Object.assign({item:this.serialize(),apiOptions:n,initialHintsVisible:0,device:this.props.previewDevice,linterContext:{contentType:"exercise",highlightLint:this.state.highlightLint,paths:this.props.contentPaths},reviewMode:!0,legacyPerseusLint:this.refs.itemEditor.getSaveWarnings()},sB.pick(this.props,"workAreaSelector","solutionAreaSelector","hintsAreaSelector","problemNum"))})},getApiOptions(){return rB.getApiOptions.call(this)},handleChange:function(e,t,n){var s=sB.pick(this.props,"question","hints","answerArea");sB.extend(s,e),this.props.onChange(s,t,n)},changeJSON:function(e){this.setState({json:e}),this.props.onChange(e)},_fixPassageRefs:function(){var e=this.serialize(),t=aB(e);this.setState({json:t}),this.props.onChange(t)},scorePreview:function(){return this.renderer?this.renderer.scoreInput():null},render:function(){let e="framework-perseus";const t="phone"===this.props.previewDevice||"tablet"===this.props.previewDevice,n=Object.assign(this.getApiOptions(),{customKeypad:t,isMobile:t});return n.isMobile&&(e+=" "+iB.MOBILE),Object($t.jsxs)("div",{id:"perseus",className:e,children:[Object($t.jsxs)("div",{style:{marginBottom:10},children:[this.props.developerMode&&Object($t.jsxs)("span",{children:[Object($t.jsxs)("label",{children:[" ","Developer JSON Mode:"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.jsonMode,onChange:this.toggleJsonMode})]})," ",Object($t.jsx)("button",{type:"button",onClick:this._fixPassageRefs,children:"Fix passage-refs"})," "]}),!this.props.jsonMode&&Object($t.jsx)(hB,{deviceType:this.props.previewDevice,onViewportSizeChanged:this.props.onPreviewDeviceChange}),!this.props.jsonMode&&Object($t.jsx)(pB,{message:"Style warnings",enabled:this.state.highlightLint,onClick:()=>{this.setState({highlightLint:!this.state.highlightLint})}})]}),this.props.developerMode&&this.props.jsonMode&&Object($t.jsx)("div",{children:Object($t.jsx)(cB,{multiLine:!0,value:this.state.json,onChange:this.changeJSON})}),(!this.props.developerMode||!this.props.jsonMode)&&Object($t.jsx)(lB,{ref:"itemEditor",rendererOnly:this.props.jsonMode,question:this.props.question,answerArea:this.props.answerArea,imageUploader:this.props.imageUploader,onChange:this.handleChange,wasAnswered:this.state.wasAnswered,gradeMessage:this.state.gradeMessage,onCheckAnswer:this.handleCheckAnswer,deviceType:this.props.previewDevice,apiOptions:n,frameSource:this.props.frameSource}),(!this.props.developerMode||!this.props.jsonMode)&&Object($t.jsx)(oB,{ref:"hintsEditor",hints:this.props.hints,imageUploader:this.props.imageUploader,onChange:this.handleChange,deviceType:this.props.previewDevice,apiOptions:n,frameSource:this.props.frameSource,highlightLint:this.state.highlightLint})]})},getSaveWarnings:function(){var e=this.refs.itemEditor.getSaveWarnings(),t=this.refs.hintsEditor.getSaveWarnings();return e.concat(t)},serialize:function(e){return this.props.jsonMode?this.state.json:sB.extend(this.refs.itemEditor.serialize(e),{hints:this.refs.hintsEditor.serialize(e)})}});nB.exports=uB;var dB=nB.exports,gB={exports:{}},fB=(gB.exports,h.a,x.b),mB=dB,bB=createReactClass({displayName:"StatefulEditorPage",getDefaultProps:function(){return{componentClass:mB}},render:function(){return Object($t.jsx)(this.props.componentClass,{...this.state})},getInitialState:function(){return fB.extend({},fB.omit(this.props,"componentClass"),{onChange:this.handleChange,ref:"editor"})},componentWillReceiveProps:function(e){this.setState(fB.pick(e,"apiOptions","imageUploader","developerMode","problemNum","previewDevice","frameSource"))},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(){return this.refs.editor.serialize()},handleChange:function(e,t){this.isMounted()&&this.setState(e,t)},scorePreview:function(){return this.refs.editor.scorePreview()}});gB.exports=bB;var vB=gB.exports,xB={exports:{}};xB.exports;h.a;const yB=vB,jB=dB,wB=ce,OB=NW,CB={question:{content:"",images:{},widgets:{}},answerArea:{calculator:!1},itemDataVersion:{major:0,minor:1},hints:[]},SB=createReactClass({displayName:"EditorDemo",getDefaultProps:function(){return{question:CB,problemNum:1}},getInitialState:function(){return{deviceType:"desktop",scratchpadEnabled:!0}},componentDidMount:function(){window.editorPage=this.refs.editor.refs.editor,window.itemRenderer=window.editorPage.renderer},serialize:function(){console.log(JSON.stringify(this.refs.editor.serialize(),null,4))},scorePreview:function(){console.log(this.refs.editor.scorePreview())},_getContentHash:function(){return wB.strongEncodeURIComponent(JSON.stringify(this.refs.editor.serialize()))},permalink:function(e){window.location.hash=`content=${this._getContentHash()}`,e.preventDefault()},viewRendered:function(e){const t=document.createElement("a");t.href=window.location.pathname+`?renderer#content=${this._getContentHash()}`,t.target="_blank",t.click(),e.preventDefault()},inputVersion:function(e){e.preventDefault(),console.log(OB.isItemRenderableByVersion(this.refs.editor.serialize(),{"::renderer::":{major:100,minor:0},group:{major:100,minor:0},sequence:{major:100,minor:0},"input-number":{major:100,minor:0},"numeric-input":{major:100,minor:0}}))},saveWarnings:function(e){e.preventDefault(),console.log(this.refs.editor.getSaveWarnings())},getEditorProps(){const{deviceType:e}=this.state,t="phone"===e||"tablet"===e;return{...this.props.question,problemNum:this.props.problemNum,developerMode:!0,imageUploader:function(e,t){setTimeout(t,1e3,"https://cdn.kastatic.org/images/khan-logo-vertical-transparent.png")},apiOptions:{onFocusChange:function(e,t){console.log("onFocusChange",e,t)},customKeypad:t,isMobile:t,setDrawingAreaAvailable:e=>{this.setState({scratchpadEnabled:e})}},componentClass:jB,onPreviewDeviceChange:e=>{this.setState({deviceType:e})},previewDevice:e,frameSource:'<!DOCTYPE html>\n                <html>\n                <head>\n                    <meta charset="utf-8">\n                    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0">\n\n                    <link rel="stylesheet" type="text/css" href="stylesheets/local-only/khan-site.css" />\n                    <link rel="stylesheet" type="text/css" href="stylesheets/local-only/khan-exercise.css" />\n                    <link rel="stylesheet" type="text/css" href="lib/katex/katex.css" />\n                    <link rel="stylesheet" type="text/css" href="lib/font-awesome.min.css">\n                    <link rel="stylesheet" type="text/css" href="lib/mathquill/mathquill.css" />\n                    <link rel="stylesheet" type="text/css" href="stylesheets/perseus-admin-package/devices.min.css" />\n\n                    <link rel="stylesheet/less" type="text/css" href="stylesheets/exercise-content-package/perseus.less" />\n                    <link rel="stylesheet/less" type="text/css" href="stylesheets/perseus-admin-package/editor.less" />\n                    <style>\n                        body {\n                            min-width: 0 !important;\n                            /* overrides body { min-width: 1000px; } in khan-site.css */\n\n                            overflow: hidden;\n                        }\n                    </style>\n\n                    <script>less = {env: \'development\', logLevel: 1};<\/script>\n                    <script src="lib/less.js"><\/script>\n                </head>\n                <body>\n                    <div id="content-container">\n                    </div>\n                    <script src="lib/babel-polyfills.min.js"><\/script>\n                    <script src="lib/jquery.js"><\/script>\n                    <script src="lib/underscore.js"><\/script>\n                    <script src="lib/react-with-addons.js"><\/script>\n                    <script src="lib/mathjax/2.1/MathJax.js?config=KAthJax-730d56e87e9c926b91584f6030314815&amp;delayStartupUntil=configured"><\/script>\n                    <script src="lib/katex/katex.js"><\/script>\n                    <script src="lib/mathquill/mathquill-basic.js"><\/script>\n                    <script src="lib/kas.js"><\/script>\n                    <script src="lib/i18n.js"><\/script>\n                    <script src="lib/jquery.qtip.js"><\/script>\n                    <script src="build/frame-perseus.js"><\/script>\n                </body>\n            </html>'}},render:function(){const e=this.getEditorProps();return Object($t.jsxs)("div",{id:"perseus-index",children:[Object($t.jsxs)("div",{className:"extras",children:[Object($t.jsx)("button",{onClick:this.serialize,children:"serialize"})," ",Object($t.jsx)("button",{onClick:this.scorePreview,children:"score"})," ",Object($t.jsx)("button",{onClick:this.permalink,children:"permalink"})," ",Object($t.jsx)("button",{onClick:this.viewRendered,children:"view rendered"})," ",Object($t.jsx)("button",{onClick:this.inputVersion,children:"contains only inputs?"})," ",Object($t.jsx)("button",{onClick:this.saveWarnings,children:"save warnings"})," ",Object($t.jsxs)("span",{children:["Seed:",this.props.problemNum," "]})," ",Object($t.jsxs)("span",{children:["Scratchpad:",this.state.scratchpadEnabled?"enabled":"disabled"]})]}),Object($t.jsx)(yB,{ref:"editor",...e},this.props.question)]})}});xB.exports=SB;var kB=xB.exports,_B={exports:{}};_B.exports;const TB=x.b,MB=SW,NB=ns;function PB(e,t){const n=NB.parse(e);NB.traverseContent(n,(function(e){"image"===e.type&&t.push(e.target)}))}function IB(e,t){e&&e.backgroundImage&&e.backgroundImage.url&&t.push(e.backgroundImage.url)}function EB(e){const t=[];return TB.each(e,(e=>{MB.traverseRendererDeep(e,(e=>{PB(e,t)}),(e=>function(e,t){e.options&&("categorizer"===e.type?(TB.each(e.options.items,(function(e){PB(e,t)})),TB.each(e.options.categories,(function(e){PB(e,t)}))):"image"===e.type?(PB(e.options.title,t),PB(e.options.caption,t)):"matcher"===e.type?(TB.each(e.options.left,(function(e){PB(e,t)})),TB.each(e.options.right,(function(e){PB(e,t)})),TB.each(e.options.labels,(function(e){PB(e,t)}))):"matrix"===e.type?(PB(e.options.prefix,t),PB(e.options.suffix,t)):"orderer"===e.type?TB.each(e.options.options,(function(e){PB(e.content,t)})):"passage"===e.type?PB(e.options.passageTitle,t):"radio"===e.type?TB.each(e.options.choices,(function(e){PB(e.content,t)})):"sorter"===e.type?TB.each(e.options.correct,(function(e){PB(e,t)})):"table"===e.type&&TB.each(e.options.headers,(function(e){PB(e,t)})),"grapher"===e.type?IB(e.options.graph,t):"image"===e.type||"interactive-graph"===e.type?IB(e.options,t):"measurer"===e.type&&e.options.image?t.push(e.options.image.url):"plotter"===e.type?t.push(e.options.picUrl):"transformer"===e.type&&IB(e.options.graph,t))}(e,t)))})),t}_B.exports={findImagesInArticles:function(e){return EB(e)},findImagesInItemData:function(e){let t=[];if(e._multi){const n=Yh(e);Gh(e,n,(e=>t.push(e))),$h(e,n,(e=>t.push(e)))}else t=[e.question,...e.hints];return EB(t)}};var AB=_B.exports,RB={exports:{}};RB.exports;const DB=x.b,LB=SW,FB=Hs;function zB(e,t){LB.traverseRendererDeep(e,null,(function(e){e.type&&!FB.isAccessible(e)&&t.push(e.type)}))}RB.exports={violatingWidgets:function(e){const t=[];if(e._multi){Gh(e,Yh(e),(e=>zB(e,t)))}else zB(e.question,t);return DB.uniq(t)}};var qB=RB.exports,WB={exports:{}};WB.exports;const BB=$L,VB=Hs,HB=YL;VB.registerMany(BB);const UB=VB.getVersionVector();UB["::renderer::"]=HB.itemDataVersion,WB.exports=UB;var GB=WB.exports,$B={exports:{}};$B.exports;const YB=ZL;$B.exports={itemVersion:GB,ItemDiff:vz,ArticleDiff:oz,StatefulArticleEditor:nW,StatefulEditorPage:vB,ClassNames:Is.ClassNames,Util:ce,ViewportResizer:RW,DeviceFramer:Uz,renderability:NW,accessibility:qB,i18n:AB,ArticleEditor:Xq,Editor:lv,EditorPage:dB,IframeContentRenderer:Fz,MultiRendererEditor:_q,Gorgon:ls,JiptHack:di,...YB};$B.exports;window.icu={getDecimalFormatSymbols:function(){return{decimal_separator:".",grouping_separator:",",minus:"-"}}},window.KhanUtil={debugLog:function(){},localeToFixed:function(e,t){return e.toFixed(t)}},window.Exercises={localMode:!0,useKatex:!0,khanExercisesUrlBase:"../",getCurrentFramework:function(){return"khan-exercises"},PerseusBridge:{cleanupProblem:function(){return!1}}};window.Khan={Util:KhanUtil,error:function(){},query:{debug:""},imageBase:"/images/"};const KB=kB,XB=vW,ZB=cW,JB=Aq,QB=Cz,eV=uz,tV=ce.parseQueryString(window.location.hash.substring(1)),nV=tV.content&&JSON.parse(tV.content),sV=Math.floor(100*Math.random()),iV=window.location.search.substring(1),rV={renderer:[XB,{question:nV,problemNum:sV}],article:[ZB,{content:nV}],multirenderer:[JB,{item:nV}],"item-diff":[QB,{}],"article-diff":[eV,{}],"":[KB,{question:nV,problemNum:sV}]};XL({skipMathJax:!0,loadExtraWidgets:!0}).then((function(){i.a.render(React.createElement(...rV[iV]||rV[""]),document.getElementById("root"))})).then((function(){}),(function(e){console.error(e)}))},42:function(e){e.exports=JSON.parse('{"apiVersion":{"major":10,"minor":2},"itemDataVersion":{"major":0,"minor":1}}')}},[[267,1,2]]]);
//# sourceMappingURL=main.e8223aeb.chunk.js.map